(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const d of l)if(d.type==="childList")for(const v of d.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&s(v)}).observe(document,{childList:!0,subtree:!0});function o(l){const d={};return l.integrity&&(d.integrity=l.integrity),l.referrerPolicy&&(d.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?d.credentials="include":l.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(l){if(l.ep)return;l.ep=!0;const d=o(l);fetch(l.href,d)}})();var Pw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Zh={exports:{}},Mf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1;function Om(){if(r1)return Mf;r1=1;var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function o(s,l,d){var v=null;if(d!==void 0&&(v=""+d),l.key!==void 0&&(v=""+l.key),"key"in l){d={};for(var p in l)p!=="key"&&(d[p]=l[p])}else d=l;return l=d.ref,{$$typeof:n,type:s,key:v,ref:l!==void 0?l:null,props:d}}return Mf.Fragment=r,Mf.jsx=o,Mf.jsxs=o,Mf}var o1;function Um(){return o1||(o1=1,Zh.exports=Om()),Zh.exports}var i=Um(),Jh={exports:{}},xi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a1;function Fm(){if(a1)return xi;a1=1;var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),v=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),M=Symbol.iterator;function S(k){return k===null||typeof k!="object"?null:(k=M&&k[M]||k["@@iterator"],typeof k=="function"?k:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,N={};function g(k,A,V){this.props=k,this.context=A,this.refs=N,this.updater=V||F}g.prototype.isReactComponent={},g.prototype.setState=function(k,A){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,A,"setState")},g.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function ae(){}ae.prototype=g.prototype;function E(k,A,V){this.props=k,this.context=A,this.refs=N,this.updater=V||F}var q=E.prototype=new ae;q.constructor=E,_(q,g.prototype),q.isPureReactComponent=!0;var re=Array.isArray;function J(){}var Y={H:null,A:null,T:null,S:null},ee=Object.prototype.hasOwnProperty;function U(k,A,V){var W=V.ref;return{$$typeof:n,type:k,key:A,ref:W!==void 0?W:null,props:V}}function $(k,A){return U(k.type,A,k.props)}function H(k){return typeof k=="object"&&k!==null&&k.$$typeof===n}function R(k){var A={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(V){return A[V]})}var Z=/\/+/g;function G(k,A){return typeof k=="object"&&k!==null&&k.key!=null?R(""+k.key):A.toString(36)}function we(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(J,J):(k.status="pending",k.then(function(A){k.status==="pending"&&(k.status="fulfilled",k.value=A)},function(A){k.status==="pending"&&(k.status="rejected",k.reason=A)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function te(k,A,V,W,se){var Te=typeof k;(Te==="undefined"||Te==="boolean")&&(k=null);var le=!1;if(k===null)le=!0;else switch(Te){case"bigint":case"string":case"number":le=!0;break;case"object":switch(k.$$typeof){case n:case r:le=!0;break;case T:return le=k._init,te(le(k._payload),A,V,W,se)}}if(le)return se=se(k),le=W===""?"."+G(k,0):W,re(se)?(V="",le!=null&&(V=le.replace(Z,"$&/")+"/"),te(se,A,V,"",function(De){return De})):se!=null&&(H(se)&&(se=$(se,V+(se.key==null||k&&k.key===se.key?"":(""+se.key).replace(Z,"$&/")+"/")+le)),A.push(se)),1;le=0;var _e=W===""?".":W+":";if(re(k))for(var ve=0;ve<k.length;ve++)W=k[ve],Te=_e+G(W,ve),le+=te(W,A,V,Te,se);else if(ve=S(k),typeof ve=="function")for(k=ve.call(k),ve=0;!(W=k.next()).done;)W=W.value,Te=_e+G(W,ve++),le+=te(W,A,V,Te,se);else if(Te==="object"){if(typeof k.then=="function")return te(we(k),A,V,W,se);throw A=String(k),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.")}return le}function de(k,A,V){if(k==null)return k;var W=[],se=0;return te(k,W,"","",function(Te){return A.call(V,Te,se++)}),W}function Ce(k){if(k._status===-1){var A=k._result;A=A(),A.then(function(V){(k._status===0||k._status===-1)&&(k._status=1,k._result=V)},function(V){(k._status===0||k._status===-1)&&(k._status=2,k._result=V)}),k._status===-1&&(k._status=0,k._result=A)}if(k._status===1)return k._result.default;throw k._result}var Re=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var A=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(A))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)},xe={map:de,forEach:function(k,A,V){de(k,function(){A.apply(this,arguments)},V)},count:function(k){var A=0;return de(k,function(){A++}),A},toArray:function(k){return de(k,function(A){return A})||[]},only:function(k){if(!H(k))throw Error("React.Children.only expected to receive a single React element child.");return k}};return xi.Activity=D,xi.Children=xe,xi.Component=g,xi.Fragment=o,xi.Profiler=l,xi.PureComponent=E,xi.StrictMode=s,xi.Suspense=b,xi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Y,xi.__COMPILER_RUNTIME={__proto__:null,c:function(k){return Y.H.useMemoCache(k)}},xi.cache=function(k){return function(){return k.apply(null,arguments)}},xi.cacheSignal=function(){return null},xi.cloneElement=function(k,A,V){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var W=_({},k.props),se=k.key;if(A!=null)for(Te in A.key!==void 0&&(se=""+A.key),A)!ee.call(A,Te)||Te==="key"||Te==="__self"||Te==="__source"||Te==="ref"&&A.ref===void 0||(W[Te]=A[Te]);var Te=arguments.length-2;if(Te===1)W.children=V;else if(1<Te){for(var le=Array(Te),_e=0;_e<Te;_e++)le[_e]=arguments[_e+2];W.children=le}return U(k.type,se,W)},xi.createContext=function(k){return k={$$typeof:v,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:d,_context:k},k},xi.createElement=function(k,A,V){var W,se={},Te=null;if(A!=null)for(W in A.key!==void 0&&(Te=""+A.key),A)ee.call(A,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(se[W]=A[W]);var le=arguments.length-2;if(le===1)se.children=V;else if(1<le){for(var _e=Array(le),ve=0;ve<le;ve++)_e[ve]=arguments[ve+2];se.children=_e}if(k&&k.defaultProps)for(W in le=k.defaultProps,le)se[W]===void 0&&(se[W]=le[W]);return U(k,Te,se)},xi.createRef=function(){return{current:null}},xi.forwardRef=function(k){return{$$typeof:p,render:k}},xi.isValidElement=H,xi.lazy=function(k){return{$$typeof:T,_payload:{_status:-1,_result:k},_init:Ce}},xi.memo=function(k,A){return{$$typeof:m,type:k,compare:A===void 0?null:A}},xi.startTransition=function(k){var A=Y.T,V={};Y.T=V;try{var W=k(),se=Y.S;se!==null&&se(V,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(J,Re)}catch(Te){Re(Te)}finally{A!==null&&V.types!==null&&(A.types=V.types),Y.T=A}},xi.unstable_useCacheRefresh=function(){return Y.H.useCacheRefresh()},xi.use=function(k){return Y.H.use(k)},xi.useActionState=function(k,A,V){return Y.H.useActionState(k,A,V)},xi.useCallback=function(k,A){return Y.H.useCallback(k,A)},xi.useContext=function(k){return Y.H.useContext(k)},xi.useDebugValue=function(){},xi.useDeferredValue=function(k,A){return Y.H.useDeferredValue(k,A)},xi.useEffect=function(k,A){return Y.H.useEffect(k,A)},xi.useEffectEvent=function(k){return Y.H.useEffectEvent(k)},xi.useId=function(){return Y.H.useId()},xi.useImperativeHandle=function(k,A,V){return Y.H.useImperativeHandle(k,A,V)},xi.useInsertionEffect=function(k,A){return Y.H.useInsertionEffect(k,A)},xi.useLayoutEffect=function(k,A){return Y.H.useLayoutEffect(k,A)},xi.useMemo=function(k,A){return Y.H.useMemo(k,A)},xi.useOptimistic=function(k,A){return Y.H.useOptimistic(k,A)},xi.useReducer=function(k,A,V){return Y.H.useReducer(k,A,V)},xi.useRef=function(k){return Y.H.useRef(k)},xi.useState=function(k){return Y.H.useState(k)},xi.useSyncExternalStore=function(k,A,V){return Y.H.useSyncExternalStore(k,A,V)},xi.useTransition=function(){return Y.H.useTransition()},xi.version="19.2.0",xi}var s1;function Yg(){return s1||(s1=1,Jh.exports=Fm()),Jh.exports}var I=Yg();const At=Bm(I);var Qh={exports:{}},Bf={},eg={exports:{}},tg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l1;function Em(){return l1||(l1=1,(function(n){function r(te,de){var Ce=te.length;te.push(de);e:for(;0<Ce;){var Re=Ce-1>>>1,xe=te[Re];if(0<l(xe,de))te[Re]=de,te[Ce]=xe,Ce=Re;else break e}}function o(te){return te.length===0?null:te[0]}function s(te){if(te.length===0)return null;var de=te[0],Ce=te.pop();if(Ce!==de){te[0]=Ce;e:for(var Re=0,xe=te.length,k=xe>>>1;Re<k;){var A=2*(Re+1)-1,V=te[A],W=A+1,se=te[W];if(0>l(V,Ce))W<xe&&0>l(se,V)?(te[Re]=se,te[W]=Ce,Re=W):(te[Re]=V,te[A]=Ce,Re=A);else if(W<xe&&0>l(se,Ce))te[Re]=se,te[W]=Ce,Re=W;else break e}}return de}function l(te,de){var Ce=te.sortIndex-de.sortIndex;return Ce!==0?Ce:te.id-de.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;n.unstable_now=function(){return d.now()}}else{var v=Date,p=v.now();n.unstable_now=function(){return v.now()-p}}var b=[],m=[],T=1,D=null,M=3,S=!1,F=!1,_=!1,N=!1,g=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function q(te){for(var de=o(m);de!==null;){if(de.callback===null)s(m);else if(de.startTime<=te)s(m),de.sortIndex=de.expirationTime,r(b,de);else break;de=o(m)}}function re(te){if(_=!1,q(te),!F)if(o(b)!==null)F=!0,J||(J=!0,R());else{var de=o(m);de!==null&&we(re,de.startTime-te)}}var J=!1,Y=-1,ee=5,U=-1;function $(){return N?!0:!(n.unstable_now()-U<ee)}function H(){if(N=!1,J){var te=n.unstable_now();U=te;var de=!0;try{e:{F=!1,_&&(_=!1,ae(Y),Y=-1),S=!0;var Ce=M;try{t:{for(q(te),D=o(b);D!==null&&!(D.expirationTime>te&&$());){var Re=D.callback;if(typeof Re=="function"){D.callback=null,M=D.priorityLevel;var xe=Re(D.expirationTime<=te);if(te=n.unstable_now(),typeof xe=="function"){D.callback=xe,q(te),de=!0;break t}D===o(b)&&s(b),q(te)}else s(b);D=o(b)}if(D!==null)de=!0;else{var k=o(m);k!==null&&we(re,k.startTime-te),de=!1}}break e}finally{D=null,M=Ce,S=!1}de=void 0}}finally{de?R():J=!1}}}var R;if(typeof E=="function")R=function(){E(H)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,G=Z.port2;Z.port1.onmessage=H,R=function(){G.postMessage(null)}}else R=function(){g(H,0)};function we(te,de){Y=g(function(){te(n.unstable_now())},de)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(te){te.callback=null},n.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<te?Math.floor(1e3/te):5},n.unstable_getCurrentPriorityLevel=function(){return M},n.unstable_next=function(te){switch(M){case 1:case 2:case 3:var de=3;break;default:de=M}var Ce=M;M=de;try{return te()}finally{M=Ce}},n.unstable_requestPaint=function(){N=!0},n.unstable_runWithPriority=function(te,de){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var Ce=M;M=te;try{return de()}finally{M=Ce}},n.unstable_scheduleCallback=function(te,de,Ce){var Re=n.unstable_now();switch(typeof Ce=="object"&&Ce!==null?(Ce=Ce.delay,Ce=typeof Ce=="number"&&0<Ce?Re+Ce:Re):Ce=Re,te){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=Ce+xe,te={id:T++,callback:de,priorityLevel:te,startTime:Ce,expirationTime:xe,sortIndex:-1},Ce>Re?(te.sortIndex=Ce,r(m,te),o(b)===null&&te===o(m)&&(_?(ae(Y),Y=-1):_=!0,we(re,Ce-Re))):(te.sortIndex=xe,r(b,te),F||S||(F=!0,J||(J=!0,R()))),te},n.unstable_shouldYield=$,n.unstable_wrapCallback=function(te){var de=M;return function(){var Ce=M;M=de;try{return te.apply(this,arguments)}finally{M=Ce}}}})(tg)),tg}var c1;function qm(){return c1||(c1=1,eg.exports=Em()),eg.exports}var ng={exports:{}},qs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u1;function Vm(){if(u1)return qs;u1=1;var n=Yg();function r(b){var m="https://react.dev/errors/"+b;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var T=2;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T])}return"Minified React error #"+b+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var s={d:{f:o,r:function(){throw Error(r(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},l=Symbol.for("react.portal");function d(b,m,T){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:D==null?null:""+D,children:b,containerInfo:m,implementation:T}}var v=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(b,m){if(b==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return qs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,qs.createPortal=function(b,m){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(r(299));return d(b,m,null,T)},qs.flushSync=function(b){var m=v.T,T=s.p;try{if(v.T=null,s.p=2,b)return b()}finally{v.T=m,s.p=T,s.d.f()}},qs.preconnect=function(b,m){typeof b=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(b,m))},qs.prefetchDNS=function(b){typeof b=="string"&&s.d.D(b)},qs.preinit=function(b,m){if(typeof b=="string"&&m&&typeof m.as=="string"){var T=m.as,D=p(T,m.crossOrigin),M=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;T==="style"?s.d.S(b,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:D,integrity:M,fetchPriority:S}):T==="script"&&s.d.X(b,{crossOrigin:D,integrity:M,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},qs.preinitModule=function(b,m){if(typeof b=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var T=p(m.as,m.crossOrigin);s.d.M(b,{crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(b)},qs.preload=function(b,m){if(typeof b=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var T=m.as,D=p(T,m.crossOrigin);s.d.L(b,T,{crossOrigin:D,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},qs.preloadModule=function(b,m){if(typeof b=="string")if(m){var T=p(m.as,m.crossOrigin);s.d.m(b,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:T,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(b)},qs.requestFormReset=function(b){s.d.r(b)},qs.unstable_batchedUpdates=function(b,m){return b(m)},qs.useFormState=function(b,m,T){return v.H.useFormState(b,m,T)},qs.useFormStatus=function(){return v.H.useHostTransitionStatus()},qs.version="19.2.0",qs}var d1;function Hm(){if(d1)return ng.exports;d1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(r){console.error(r)}}return n(),ng.exports=Vm(),ng.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f1;function Wm(){if(f1)return Bf;f1=1;var n=qm(),r=Yg(),o=Hm();function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function v(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function b(e){if(d(e)!==e)throw Error(s(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(s(188));return t!==e?null:e}for(var a=e,u=t;;){var h=a.return;if(h===null)break;var w=h.alternate;if(w===null){if(u=h.return,u!==null){a=u;continue}break}if(h.child===w.child){for(w=h.child;w;){if(w===a)return b(h),e;if(w===u)return b(h),t;w=w.sibling}throw Error(s(188))}if(a.return!==u.return)a=h,u=w;else{for(var O=!1,ue=h.child;ue;){if(ue===a){O=!0,a=h,u=w;break}if(ue===u){O=!0,u=h,a=w;break}ue=ue.sibling}if(!O){for(ue=w.child;ue;){if(ue===a){O=!0,a=w,u=h;break}if(ue===u){O=!0,u=w,a=h;break}ue=ue.sibling}if(!O)throw Error(s(189))}}if(a.alternate!==u)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?e:t}function T(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=T(e),t!==null)return t;e=e.sibling}return null}var D=Object.assign,M=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),ae=Symbol.for("react.consumer"),E=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),Y=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),$=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function R(e){return e===null||typeof e!="object"?null:(e=H&&e[H]||e["@@iterator"],typeof e=="function"?e:null)}var Z=Symbol.for("react.client.reference");function G(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Z?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case _:return"Fragment";case g:return"Profiler";case N:return"StrictMode";case re:return"Suspense";case J:return"SuspenseList";case U:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case F:return"Portal";case E:return e.displayName||"Context";case ae:return(e._context.displayName||"Context")+".Consumer";case q:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Y:return t=e.displayName||null,t!==null?t:G(e.type)||"Memo";case ee:t=e._payload,e=e._init;try{return G(e(t))}catch{}}return null}var we=Array.isArray,te=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ce={pending:!1,data:null,method:null,action:null},Re=[],xe=-1;function k(e){return{current:e}}function A(e){0>xe||(e.current=Re[xe],Re[xe]=null,xe--)}function V(e,t){xe++,Re[xe]=e.current,e.current=t}var W=k(null),se=k(null),Te=k(null),le=k(null);function _e(e,t){switch(V(Te,t),V(se,e),V(W,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?k0(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=k0(t),e=A0(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}A(W),V(W,e)}function ve(){A(W),A(se),A(Te)}function De(e){e.memoizedState!==null&&V(le,e);var t=W.current,a=A0(t,e.type);t!==a&&(V(se,e),V(W,a))}function Xe(e){se.current===e&&(A(W),A(se)),le.current===e&&(A(le),Df._currentValue=Ce)}var st,kt;function qt(e){if(st===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);st=t&&t[1]||"",kt=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+st+e+kt}var ye=!1;function ut(e,t){if(!e||ye)return"";ye=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(t){var Pt=function(){throw Error()};if(Object.defineProperty(Pt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Pt,[])}catch(ft){var ot=ft}Reflect.construct(e,[],Pt)}else{try{Pt.call()}catch(ft){ot=ft}e.call(Pt.prototype)}}else{try{throw Error()}catch(ft){ot=ft}(Pt=e())&&typeof Pt.catch=="function"&&Pt.catch(function(){})}}catch(ft){if(ft&&ot&&typeof ft.stack=="string")return[ft.stack,ot.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=u.DetermineComponentFrameRoot(),O=w[0],ue=w[1];if(O&&ue){var Fe=O.split(`
`),rt=ue.split(`
`);for(h=u=0;u<Fe.length&&!Fe[u].includes("DetermineComponentFrameRoot");)u++;for(;h<rt.length&&!rt[h].includes("DetermineComponentFrameRoot");)h++;if(u===Fe.length||h===rt.length)for(u=Fe.length-1,h=rt.length-1;1<=u&&0<=h&&Fe[u]!==rt[h];)h--;for(;1<=u&&0<=h;u--,h--)if(Fe[u]!==rt[h]){if(u!==1||h!==1)do if(u--,h--,0>h||Fe[u]!==rt[h]){var St=`
`+Fe[u].replace(" at new "," at ");return e.displayName&&St.includes("<anonymous>")&&(St=St.replace("<anonymous>",e.displayName)),St}while(1<=u&&0<=h);break}}}finally{ye=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?qt(a):""}function Gt(e,t){switch(e.tag){case 26:case 27:case 5:return qt(e.type);case 16:return qt("Lazy");case 13:return e.child!==t&&t!==null?qt("Suspense Fallback"):qt("Suspense");case 19:return qt("SuspenseList");case 0:case 15:return ut(e.type,!1);case 11:return ut(e.type.render,!1);case 1:return ut(e.type,!0);case 31:return qt("Activity");default:return""}}function Et(e){try{var t="",a=null;do t+=Gt(e,a),a=e,e=e.return;while(e);return t}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var ht=Object.prototype.hasOwnProperty,Qe=n.unstable_scheduleCallback,$t=n.unstable_cancelCallback,dn=n.unstable_shouldYield,rn=n.unstable_requestPaint,kn=n.unstable_now,Fn=n.unstable_getCurrentPriorityLevel,Be=n.unstable_ImmediatePriority,fe=n.unstable_UserBlockingPriority,lt=n.unstable_NormalPriority,it=n.unstable_LowPriority,$e=n.unstable_IdlePriority,at=n.log,Ot=n.unstable_setDisableYieldValue,Vt=null,jt=null;function Ft(e){if(typeof at=="function"&&Ot(e),jt&&typeof jt.setStrictMode=="function")try{jt.setStrictMode(Vt,e)}catch{}}var tn=Math.clz32?Math.clz32:cn,ln=Math.log,mt=Math.LN2;function cn(e){return e>>>=0,e===0?32:31-(ln(e)/mt|0)|0}var _t=256,Yt=262144,gn=4194304;function fn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function bn(e,t,a){var u=e.pendingLanes;if(u===0)return 0;var h=0,w=e.suspendedLanes,O=e.pingedLanes;e=e.warmLanes;var ue=u&134217727;return ue!==0?(u=ue&~w,u!==0?h=fn(u):(O&=ue,O!==0?h=fn(O):a||(a=ue&~e,a!==0&&(h=fn(a))))):(ue=u&~w,ue!==0?h=fn(ue):O!==0?h=fn(O):a||(a=u&~e,a!==0&&(h=fn(a)))),h===0?0:t!==0&&t!==h&&(t&w)===0&&(w=h&-h,a=t&-t,w>=a||w===32&&(a&4194048)!==0)?t:h}function ir(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Dn(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cr(){var e=gn;return gn<<=1,(gn&62914560)===0&&(gn=4194304),e}function Mr(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function Xt(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function mr(e,t,a,u,h,w){var O=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var ue=e.entanglements,Fe=e.expirationTimes,rt=e.hiddenUpdates;for(a=O&~a;0<a;){var St=31-tn(a),Pt=1<<St;ue[St]=0,Fe[St]=-1;var ot=rt[St];if(ot!==null)for(rt[St]=null,St=0;St<ot.length;St++){var ft=ot[St];ft!==null&&(ft.lane&=-536870913)}a&=~Pt}u!==0&&Ti(e,u,0),w!==0&&h===0&&e.tag!==0&&(e.suspendedLanes|=w&~(O&~t))}function Ti(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var u=31-tn(t);e.entangledLanes|=t,e.entanglements[u]=e.entanglements[u]|1073741824|a&261930}function Ln(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var u=31-tn(a),h=1<<u;h&t|e[u]&t&&(e[u]|=t),a&=~h}}function Rt(e,t){var a=t&-t;return a=(a&42)!==0?1:Ht(a),(a&(e.suspendedLanes|t))!==0?0:a}function Ht(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function tt(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Bt(){var e=de.p;return e!==0?e:(e=window.event,e===void 0?32:Z0(e.type))}function pn(e,t){var a=de.p;try{return de.p=e,t()}finally{de.p=a}}var An=Math.random().toString(36).slice(2),yn="__reactFiber$"+An,$n="__reactProps$"+An,li="__reactContainer$"+An,vi="__reactEvents$"+An,qi="__reactListeners$"+An,Br="__reactHandles$"+An,Ja="__reactResources$"+An,Qa="__reactMarker$"+An;function Ia(e){delete e[yn],delete e[$n],delete e[vi],delete e[qi],delete e[Br]}function Go(e){var t=e[yn];if(t)return t;for(var a=e.parentNode;a;){if(t=a[li]||a[yn]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=I0(e);e!==null;){if(a=e[yn])return a;e=I0(e)}return t}e=a,a=e.parentNode}return null}function Ca(e){if(e=e[yn]||e[li]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function di(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(s(33))}function To(e){var t=e[Ja];return t||(t=e[Ja]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Gn(e){e[Qa]=!0}var gs=new Set,fi={};function Uo(e,t){Di(e,t),Di(e+"Capture",t)}function Di(e,t){for(fi[e]=t,e=0;e<t.length;e++)gs.add(t[e])}var _s=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),es={},ts={};function ys(e){return ht.call(ts,e)?!0:ht.call(es,e)?!1:_s.test(e)?ts[e]=!0:(es[e]=!0,!1)}function Pr(e,t,a){if(ys(t))if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var u=t.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+a)}}function Gs(e,t,a){if(a===null)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+a)}}function br(e,t,a,u){if(u===null)e.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(a);return}e.setAttributeNS(t,a,""+u)}}function Ii(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function pi(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function dr(e,t,a){var u=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var h=u.get,w=u.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return h.call(this)},set:function(O){a=""+O,w.call(this,O)}}),Object.defineProperty(e,t,{enumerable:u.enumerable}),{getValue:function(){return a},setValue:function(O){a=""+O},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ns(e){if(!e._valueTracker){var t=pi(e)?"checked":"value";e._valueTracker=dr(e,t,""+e[t])}}function Gl(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),u="";return e&&(u=pi(e)?e.checked?"true":"false":e.value),e=u,e!==a?(t.setValue(e),!0):!1}function po(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var io=/[\n"\\]/g;function Vi(e){return e.replace(io,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Yo(e,t,a,u,h,w,O,ue){e.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?e.type=O:e.removeAttribute("type"),t!=null?O==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Ii(t)):e.value!==""+Ii(t)&&(e.value=""+Ii(t)):O!=="submit"&&O!=="reset"||e.removeAttribute("value"),t!=null?ca(e,O,Ii(t)):a!=null?ca(e,O,Ii(a)):u!=null&&e.removeAttribute("value"),h==null&&w!=null&&(e.defaultChecked=!!w),h!=null&&(e.checked=h&&typeof h!="function"&&typeof h!="symbol"),ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?e.name=""+Ii(ue):e.removeAttribute("name")}function Yl(e,t,a,u,h,w,O,ue){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(e.type=w),t!=null||a!=null){if(!(w!=="submit"&&w!=="reset"||t!=null)){ns(e);return}a=a!=null?""+Ii(a):"",t=t!=null?""+Ii(t):a,ue||t===e.value||(e.value=t),e.defaultValue=t}u=u??h,u=typeof u!="function"&&typeof u!="symbol"&&!!u,e.checked=ue?e.checked:!!u,e.defaultChecked=!!u,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(e.name=O),ns(e)}function ca(e,t,a){t==="number"&&po(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function fr(e,t,a,u){if(e=e.options,t){t={};for(var h=0;h<a.length;h++)t["$"+a[h]]=!0;for(a=0;a<e.length;a++)h=t.hasOwnProperty("$"+e[a].value),e[a].selected!==h&&(e[a].selected=h),h&&u&&(e[a].defaultSelected=!0)}else{for(a=""+Ii(a),t=null,h=0;h<e.length;h++){if(e[h].value===a){e[h].selected=!0,u&&(e[h].defaultSelected=!0);return}t!==null||e[h].disabled||(t=e[h])}t!==null&&(t.selected=!0)}}function Xl(e,t,a){if(t!=null&&(t=""+Ii(t),t!==e.value&&(e.value=t),a==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=a!=null?""+Ii(a):""}function Or(e,t,a,u){if(t==null){if(u!=null){if(a!=null)throw Error(s(92));if(we(u)){if(1<u.length)throw Error(s(93));u=u[0]}a=u}a==null&&(a=""),t=a}a=Ii(t),e.defaultValue=a,u=e.textContent,u===a&&u!==""&&u!==null&&(e.value=u),ns(e)}function ki(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var rl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ma(e,t,a){var u=t.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?u?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":u?e.setProperty(t,a):typeof a!="number"||a===0||rl.has(t)?t==="float"?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function Fo(e,t,a){if(t!=null&&typeof t!="object")throw Error(s(62));if(e=e.style,a!=null){for(var u in a)!a.hasOwnProperty(u)||t!=null&&t.hasOwnProperty(u)||(u.indexOf("--")===0?e.setProperty(u,""):u==="float"?e.cssFloat="":e[u]="");for(var h in t)u=t[h],t.hasOwnProperty(h)&&a[h]!==u&&Ma(e,h,u)}else for(var w in t)t.hasOwnProperty(w)&&Ma(e,w,t[w])}function xs(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Na=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $r(e){return Xo.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function pr(){}var ms=null;function Ba(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ys=null,zn=null;function Tt(e){var t=Ca(e);if(t&&(e=t.stateNode)){var a=e[$n]||null;e:switch(e=t.stateNode,t.type){case"input":if(Yo(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Vi(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var u=a[t];if(u!==e&&u.form===e.form){var h=u[$n]||null;if(!h)throw Error(s(90));Yo(u,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(t=0;t<a.length;t++)u=a[t],u.form===e.form&&Gl(u)}break e;case"textarea":Xl(e,a.value,a.defaultValue);break e;case"select":t=a.value,t!=null&&fr(e,!!a.multiple,t,!1)}}}var Qn=!1;function Oa(e,t,a){if(Qn)return e(t,a);Qn=!0;try{var u=e(t);return u}finally{if(Qn=!1,(Ys!==null||zn!==null)&&(So(),Ys&&(t=Ys,e=zn,zn=Ys=null,Tt(t),e)))for(t=0;t<e.length;t++)Tt(e[t])}}function ua(e,t){var a=e.stateNode;if(a===null)return null;var u=a[$n]||null;if(u===null)return null;a=u[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(s(231,t,typeof a));return a}var vn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jn=!1;if(vn)try{var ol={};Object.defineProperty(ol,"passive",{get:function(){jn=!0}}),window.addEventListener("test",ol,ol),window.removeEventListener("test",ol,ol)}catch{jn=!1}var Eo=null,En=null,mn=null;function Ai(){if(mn)return mn;var e,t=En,a=t.length,u,h="value"in Eo?Eo.value:Eo.textContent,w=h.length;for(e=0;e<a&&t[e]===h[e];e++);var O=a-e;for(u=1;u<=O&&t[a-u]===h[w-u];u++);return mn=h.slice(e,1<u?1-u:void 0)}function xn(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wi(){return!0}function Tn(){return!1}function Ko(e){function t(a,u,h,w,O){this._reactName=a,this._targetInst=h,this.type=u,this.nativeEvent=w,this.target=O,this.currentTarget=null;for(var ue in e)e.hasOwnProperty(ue)&&(a=e[ue],this[ue]=a?a(w):w[ue]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?wi:Tn,this.isPropagationStopped=Tn,this}return D(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=wi)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=wi)},persist:function(){},isPersistent:wi}),t}var Jt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ri=Ko(Jt),Qt=D({},Jt,{view:0,detail:0}),Si=Ko(Qt),Ua,Fa,ro,ka=D({},Qt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:on,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ro&&(ro&&e.type==="mousemove"?(Ua=e.screenX-ro.screenX,Fa=e.screenY-ro.screenY):Fa=Ua=0,ro=e),Ua)},movementY:function(e){return"movementY"in e?e.movementY:Fa}}),bs=Ko(ka),is=D({},ka,{dataTransfer:0}),Xs=Ko(is),Zc=D({},Qt,{relatedTarget:0}),vs=Ko(Zc),Jc=D({},Jt,{animationName:0,elapsedTime:0,pseudoElement:0}),j=Ko(Jc),Q=D({},Jt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pe=Ko(Q),Me=D({},Jt,{data:0}),qe=Ko(Me),xt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zt(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Wt[e])?!!t[e]:!1}function on(){return Zt}var qn=D({},Qt,{key:function(e){if(e.key){var t=xt[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xn(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vt[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:on,charCode:function(e){return e.type==="keypress"?xn(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xn(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ci=Ko(qn),Gr=D({},ka,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mi=Ko(Gr),vr=D({},Qt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:on}),wr=Ko(vr),Co=D({},Jt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ki=Ko(Co),da=D({},ka,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nr=Ko(da),fa=D({},Jt,{newState:0,oldState:0}),pa=Ko(fa),ws=[9,13,27,32],Zo=vn&&"CompositionEvent"in window,Aa=null;vn&&"documentMode"in document&&(Aa=document.documentMode);var oo=vn&&"TextEvent"in window&&!Aa,ha=vn&&(!Zo||Aa&&8<Aa&&11>=Aa),Hi=" ",za=!1;function ho(e,t){switch(e){case"keyup":return ws.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rs(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Wi=!1;function Yr(e,t){switch(e){case"compositionend":return rs(t);case"keypress":return t.which!==32?null:(za=!0,Hi);case"textInput":return e=t.data,e===Hi&&za?null:e;default:return null}}function wl(e,t){if(Wi)return e==="compositionend"||!Zo&&ho(e,t)?(e=Ai(),mn=En=Eo=null,Wi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ha&&t.locale!=="ko"?null:t.data;default:return null}}var Dc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ds(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Dc[e.type]:t==="textarea"}function Pa(e,t,a,u){Ys?zn?zn.push(u):zn=[u]:Ys=u,t=kp(t,"onChange"),0<t.length&&(a=new ri("onChange","change",null,a,u),e.push({event:a,listeners:t}))}var os=null,Ks=null;function No(e){w0(e,0)}function as(e){var t=di(e);if(Gl(t))return e}function ao(e,t){if(e==="change")return t}var qo=!1;if(vn){var Ur;if(vn){var Rs="oninput"in document;if(!Rs){var Jo=document.createElement("div");Jo.setAttribute("oninput","return;"),Rs=typeof Jo.oninput=="function"}Ur=Rs}else Ur=!1;qo=Ur&&(!document.documentMode||9<document.documentMode)}function Zs(){os&&(os.detachEvent("onpropertychange",Ea),Ks=os=null)}function Ea(e){if(e.propertyName==="value"&&as(Ks)){var t=[];Pa(t,Ks,e,Ba(e)),Oa(No,t)}}function Kl(e,t,a){e==="focusin"?(Zs(),os=t,Ks=a,os.attachEvent("onpropertychange",Ea)):e==="focusout"&&Zs()}function ei(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return as(Ks)}function Ss(e,t){if(e==="click")return as(t)}function Bi(e,t){if(e==="input"||e==="change")return as(t)}function Qo(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Vo=typeof Object.is=="function"?Object.is:Qo;function ga(e,t){if(Vo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),u=Object.keys(t);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++){var h=a[u];if(!ht.call(t,h)||!Vo(e[h],t[h]))return!1}return!0}function Rc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Js(e,t){var a=Rc(e);e=0;for(var u;a;){if(a.nodeType===3){if(u=e+a.textContent.length,e<=t&&u>=t)return{node:a,offset:t-e};e=u}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Rc(a)}}function Sl(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Sl(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function jl(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=po(e.document);t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=po(e.document)}return t}function go(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Tl=vn&&"documentMode"in document&&11>=document.documentMode,Ho=null,qa=null,rr=null,ss=!1;function Ri(e,t,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;ss||Ho==null||Ho!==po(u)||(u=Ho,"selectionStart"in u&&go(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),rr&&ga(rr,u)||(rr=u,u=kp(qa,"onSelect"),0<u.length&&(t=new ri("onSelect","select",null,t,a),e.push({event:t,listeners:u}),t.target=Ho)))}function Oi(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var or={animationend:Oi("Animation","AnimationEnd"),animationiteration:Oi("Animation","AnimationIteration"),animationstart:Oi("Animation","AnimationStart"),transitionrun:Oi("Transition","TransitionRun"),transitionstart:Oi("Transition","TransitionStart"),transitioncancel:Oi("Transition","TransitionCancel"),transitionend:Oi("Transition","TransitionEnd")},yo={},ls={};vn&&(ls=document.createElement("div").style,"AnimationEvent"in window||(delete or.animationend.animation,delete or.animationiteration.animation,delete or.animationstart.animation),"TransitionEvent"in window||delete or.transitionend.transition);function Qs(e){if(yo[e])return yo[e];if(!or[e])return e;var t=or[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in ls)return yo[e]=t[a];return e}var xc=Qs("animationend"),Qc=Qs("animationiteration"),qu=Qs("animationstart"),Va=Qs("transitionrun"),so=Qs("transitionstart"),Cl=Qs("transitioncancel"),ko=Qs("transitionend"),Ls=new Map,xo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xo.push("scrollEnd");function Ao(e,t){Ls.set(e,t),Uo(t,[e])}var Xr=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},ya=[],Zi=0,oi=0;function kr(){for(var e=Zi,t=oi=Zi=0;t<e;){var a=ya[t];ya[t++]=null;var u=ya[t];ya[t++]=null;var h=ya[t];ya[t++]=null;var w=ya[t];if(ya[t++]=null,u!==null&&h!==null){var O=u.pending;O===null?h.next=h:(h.next=O.next,O.next=h),u.pending=h}w!==0&&Ha(a,h,w)}}function Kr(e,t,a,u){ya[Zi++]=e,ya[Zi++]=t,ya[Zi++]=a,ya[Zi++]=u,oi|=u,e.lanes|=u,e=e.alternate,e!==null&&(e.lanes|=u)}function zo(e,t,a,u){return Kr(e,t,a,u),ea(e)}function al(e,t){return Kr(e,null,null,t),ea(e)}function Ha(e,t,a){e.lanes|=a;var u=e.alternate;u!==null&&(u.lanes|=a);for(var h=!1,w=e.return;w!==null;)w.childLanes|=a,u=w.alternate,u!==null&&(u.childLanes|=a),w.tag===22&&(e=w.stateNode,e===null||e._visibility&1||(h=!0)),e=w,w=w.return;return e.tag===3?(w=e.stateNode,h&&t!==null&&(h=31-tn(a),e=w.hiddenUpdates,u=e[h],u===null?e[h]=[t]:u.push(t),t.lane=a|536870912),w):null}function ea(e){if(50<Hn)throw Hn=0,Kn=null,Error(s(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Fr={};function zi(e,t,a,u){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ci(e,t,a,u){return new zi(e,t,a,u)}function Lc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function lr(e,t){var a=e.alternate;return a===null?(a=Ci(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&65011712,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Zr(e,t){e.flags&=65011714;var a=e.alternate;return a===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function sl(e,t,a,u,h,w){var O=0;if(u=e,typeof e=="function")Lc(e)&&(O=1);else if(typeof e=="string")O=Cm(e,a,W.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case U:return e=Ci(31,a,t,h),e.elementType=U,e.lanes=w,e;case _:return Jr(a.children,h,w,t);case N:O=8,h|=24;break;case g:return e=Ci(12,a,t,h|2),e.elementType=g,e.lanes=w,e;case re:return e=Ci(13,a,t,h),e.elementType=re,e.lanes=w,e;case J:return e=Ci(19,a,t,h),e.elementType=J,e.lanes=w,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case E:O=10;break e;case ae:O=9;break e;case q:O=11;break e;case Y:O=14;break e;case ee:O=16,u=null;break e}O=29,a=Error(s(130,e===null?"null":typeof e,"")),u=null}return t=Ci(O,a,t,h),t.elementType=e,t.type=u,t.lanes=w,t}function Jr(e,t,a,u){return e=Ci(7,e,u,t),e.lanes=a,e}function cs(e,t,a){return e=Ci(6,e,null,t),e.lanes=a,e}function ta(e){var t=Ci(18,null,null,0);return t.stateNode=e,t}function ll(e,t,a){return t=Ci(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var eu=new WeakMap;function js(e,t){if(typeof e=="object"&&e!==null){var a=eu.get(e);return a!==void 0?a:(t={value:e,source:t,stack:Et(t)},eu.set(e,t),t)}return{value:e,source:t,stack:Et(t)}}var us=[],cl=0,Ic=null,Nl=0,Ts=[],na=0,Wa=null,mo=1,Po="";function _a(e,t){us[cl++]=Nl,us[cl++]=Ic,Ic=e,Nl=t}function tu(e,t,a){Ts[na++]=mo,Ts[na++]=Po,Ts[na++]=Wa,Wa=e;var u=mo;e=Po;var h=32-tn(u)-1;u&=~(1<<h),a+=1;var w=32-tn(t)+h;if(30<w){var O=h-h%5;w=(u&(1<<O)-1).toString(32),u>>=O,h-=O,mo=1<<32-tn(t)+h|a<<h|u,Po=w+e}else mo=1<<w|a<<h|u,Po=e}function kl(e){e.return!==null&&(_a(e,1),tu(e,1,0))}function Cs(e){for(;e===Ic;)Ic=us[--cl],us[cl]=null,Nl=us[--cl],us[cl]=null;for(;e===Wa;)Wa=Ts[--na],Ts[na]=null,Po=Ts[--na],Ts[na]=null,mo=Ts[--na],Ts[na]=null}function Vu(e,t){Ts[na++]=mo,Ts[na++]=Po,Ts[na++]=Wa,mo=t.id,Po=t.overflow,Wa=e}var cr=null,Ar=null,Vn=!1,ia=null,Qr=!1,xa=Error(s(519));function ma(e){var t=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Bc(js(t,e)),xa}function Mc(e){var t=e.stateNode,a=e.type,u=e.memoizedProps;switch(t[yn]=e,t[$n]=u,a){case"dialog":Ei("cancel",t),Ei("close",t);break;case"iframe":case"object":case"embed":Ei("load",t);break;case"video":case"audio":for(a=0;a<kf.length;a++)Ei(kf[a],t);break;case"source":Ei("error",t);break;case"img":case"image":case"link":Ei("error",t),Ei("load",t);break;case"details":Ei("toggle",t);break;case"input":Ei("invalid",t),Yl(t,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ei("invalid",t);break;case"textarea":Ei("invalid",t),Or(t,u.value,u.defaultValue,u.children)}a=u.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||t.textContent===""+a||u.suppressHydrationWarning===!0||C0(t.textContent,a)?(u.popover!=null&&(Ei("beforetoggle",t),Ei("toggle",t)),u.onScroll!=null&&Ei("scroll",t),u.onScrollEnd!=null&&Ei("scrollend",t),u.onClick!=null&&(t.onclick=pr),t=!0):t=!1,t||ma(e,!0)}function ba(e){for(cr=e.return;cr;)switch(cr.tag){case 5:case 31:case 13:Qr=!1;return;case 27:case 3:Qr=!0;return;default:cr=cr.return}}function _r(e){if(e!==cr)return!1;if(!Vn)return ba(e),Vn=!0,!1;var t=e.tag,a;if((a=t!==3&&t!==27)&&((a=t===5)&&(a=e.type,a=!(a!=="form"&&a!=="button")||Mh(e.type,e.memoizedProps)),a=!a),a&&Ar&&ma(e),ba(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Ar=L0(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(317));Ar=L0(e)}else t===27?(t=Ar,_u(e.type)?(e=Eh,Eh=null,Ar=e):Ar=t):Ar=cr?dc(e.stateNode.nextSibling):null;return!0}function mc(){Ar=cr=null,Vn=!1}function yu(){var e=ia;return e!==null&&(pt===null?pt=e:pt.push.apply(pt,e),ia=null),e}function Bc(e){ia===null?ia=[e]:ia.push(e)}var xu=k(null),ul=null,el=null;function Al(e,t,a){V(xu,t._currentValue),t._currentValue=a}function Ns(e){e._currentValue=xu.current,A(xu)}function ks(e,t,a){for(;e!==null;){var u=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,u!==null&&(u.childLanes|=t)):u!==null&&(u.childLanes&t)!==t&&(u.childLanes|=t),e===a)break;e=e.return}}function Er(e,t,a,u){var h=e.child;for(h!==null&&(h.return=e);h!==null;){var w=h.dependencies;if(w!==null){var O=h.child;w=w.firstContext;e:for(;w!==null;){var ue=w;w=h;for(var Fe=0;Fe<t.length;Fe++)if(ue.context===t[Fe]){w.lanes|=a,ue=w.alternate,ue!==null&&(ue.lanes|=a),ks(w.return,a,e),u||(O=null);break e}w=ue.next}}else if(h.tag===18){if(O=h.return,O===null)throw Error(s(341));O.lanes|=a,w=O.alternate,w!==null&&(w.lanes|=a),ks(O,a,e),O=null}else O=h.child;if(O!==null)O.return=h;else for(O=h;O!==null;){if(O===e){O=null;break}if(h=O.sibling,h!==null){h.return=O.return,O=h;break}O=O.return}h=O}}function $a(e,t,a,u){e=null;for(var h=t,w=!1;h!==null;){if(!w){if((h.flags&524288)!==0)w=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var O=h.alternate;if(O===null)throw Error(s(387));if(O=O.memoizedProps,O!==null){var ue=h.type;Vo(h.pendingProps.value,O.value)||(e!==null?e.push(ue):e=[ue])}}else if(h===le.current){if(O=h.alternate,O===null)throw Error(s(387));O.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(e!==null?e.push(Df):e=[Df])}h=h.return}e!==null&&Er(t,e,a,u),t.flags|=262144}function bo(e){for(e=e.firstContext;e!==null;){if(!Vo(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Zl(e){ul=e,el=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ra(e){return Ga(ul,e)}function vo(e,t){return ul===null&&Zl(e),Ga(e,t)}function Ga(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},el===null){if(e===null)throw Error(s(308));el=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else el=el.next=t;return a}var Da=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(a,u){e.push(u)}};this.abort=function(){t.aborted=!0,e.forEach(function(a){return a()})}},ds=n.unstable_scheduleCallback,Ra=n.unstable_NormalPriority,Li={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function _o(){return{controller:new Da,data:new Map,refCount:0}}function oa(e){e.refCount--,e.refCount===0&&ds(Ra,function(){e.controller.abort()})}var Wo=null,va=0,f=0,y=null;function C(e,t){if(Wo===null){var a=Wo=[];va=0,f=kh(),y={status:"pending",value:void 0,then:function(u){a.push(u)}}}return va++,t.then(L,L),t}function L(){if(--va===0&&Wo!==null){y!==null&&(y.status="fulfilled");var e=Wo;Wo=null,f=0,y=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function X(e,t){var a=[],u={status:"pending",value:null,reason:null,then:function(h){a.push(h)}};return e.then(function(){u.status="fulfilled",u.value=t;for(var h=0;h<a.length;h++)(0,a[h])(t)},function(h){for(u.status="rejected",u.reason=h,h=0;h<a.length;h++)(0,a[h])(void 0)}),u}var ie=te.S;te.S=function(e,t){dt=kn(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&C(e,t),ie!==null&&ie(e,t)};var oe=k(null);function ce(){var e=oe.current;return e!==null?e:B.pooledCache}function he(e,t){t===null?V(oe,oe.current):V(oe,t.pool)}function je(){var e=ce();return e===null?null:{parent:Li._currentValue,pool:e}}var Pe=Error(s(460)),Ee=Error(s(474)),ke=Error(s(542)),He={then:function(){}};function Je(e){return e=e.status,e==="fulfilled"||e==="rejected"}function bt(e,t,a){switch(a=e[a],a===void 0?e.push(t):a!==t&&(t.then(pr,pr),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,It(e),e;default:if(typeof t.status=="string")t.then(pr,pr);else{if(e=B,e!==null&&100<e.shellSuspendCounter)throw Error(s(482));e=t,e.status="pending",e.then(function(u){if(t.status==="pending"){var h=t;h.status="fulfilled",h.value=u}},function(u){if(t.status==="pending"){var h=t;h.status="rejected",h.reason=u}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,It(e),e}throw yt=t,Pe}}function et(e){try{var t=e._init;return t(e._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(yt=a,Pe):a}}var yt=null;function wt(){if(yt===null)throw Error(s(459));var e=yt;return yt=null,e}function It(e){if(e===Pe||e===ke)throw Error(s(483))}var zt=null,wn=0;function un(e){var t=wn;return wn+=1,zt===null&&(zt=[]),bt(zt,e,t)}function Sn(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function en(e,t){throw t.$$typeof===M?Error(s(525)):(e=Object.prototype.toString.call(t),Error(s(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function hi(e){function t(Ke,We){if(e){var nt=Ke.deletions;nt===null?(Ke.deletions=[We],Ke.flags|=16):nt.push(We)}}function a(Ke,We){if(!e)return null;for(;We!==null;)t(Ke,We),We=We.sibling;return null}function u(Ke){for(var We=new Map;Ke!==null;)Ke.key!==null?We.set(Ke.key,Ke):We.set(Ke.index,Ke),Ke=Ke.sibling;return We}function h(Ke,We){return Ke=lr(Ke,We),Ke.index=0,Ke.sibling=null,Ke}function w(Ke,We,nt){return Ke.index=nt,e?(nt=Ke.alternate,nt!==null?(nt=nt.index,nt<We?(Ke.flags|=67108866,We):nt):(Ke.flags|=67108866,We)):(Ke.flags|=1048576,We)}function O(Ke){return e&&Ke.alternate===null&&(Ke.flags|=67108866),Ke}function ue(Ke,We,nt,Nt){return We===null||We.tag!==6?(We=cs(nt,Ke.mode,Nt),We.return=Ke,We):(We=h(We,nt),We.return=Ke,We)}function Fe(Ke,We,nt,Nt){var Yn=nt.type;return Yn===_?St(Ke,We,nt.props.children,Nt,nt.key):We!==null&&(We.elementType===Yn||typeof Yn=="object"&&Yn!==null&&Yn.$$typeof===ee&&et(Yn)===We.type)?(We=h(We,nt.props),Sn(We,nt),We.return=Ke,We):(We=sl(nt.type,nt.key,nt.props,null,Ke.mode,Nt),Sn(We,nt),We.return=Ke,We)}function rt(Ke,We,nt,Nt){return We===null||We.tag!==4||We.stateNode.containerInfo!==nt.containerInfo||We.stateNode.implementation!==nt.implementation?(We=ll(nt,Ke.mode,Nt),We.return=Ke,We):(We=h(We,nt.children||[]),We.return=Ke,We)}function St(Ke,We,nt,Nt,Yn){return We===null||We.tag!==7?(We=Jr(nt,Ke.mode,Nt,Yn),We.return=Ke,We):(We=h(We,nt),We.return=Ke,We)}function Pt(Ke,We,nt){if(typeof We=="string"&&We!==""||typeof We=="number"||typeof We=="bigint")return We=cs(""+We,Ke.mode,nt),We.return=Ke,We;if(typeof We=="object"&&We!==null){switch(We.$$typeof){case S:return nt=sl(We.type,We.key,We.props,null,Ke.mode,nt),Sn(nt,We),nt.return=Ke,nt;case F:return We=ll(We,Ke.mode,nt),We.return=Ke,We;case ee:return We=et(We),Pt(Ke,We,nt)}if(we(We)||R(We))return We=Jr(We,Ke.mode,nt,null),We.return=Ke,We;if(typeof We.then=="function")return Pt(Ke,un(We),nt);if(We.$$typeof===E)return Pt(Ke,vo(Ke,We),nt);en(Ke,We)}return null}function ot(Ke,We,nt,Nt){var Yn=We!==null?We.key:null;if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return Yn!==null?null:ue(Ke,We,""+nt,Nt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case S:return nt.key===Yn?Fe(Ke,We,nt,Nt):null;case F:return nt.key===Yn?rt(Ke,We,nt,Nt):null;case ee:return nt=et(nt),ot(Ke,We,nt,Nt)}if(we(nt)||R(nt))return Yn!==null?null:St(Ke,We,nt,Nt,null);if(typeof nt.then=="function")return ot(Ke,We,un(nt),Nt);if(nt.$$typeof===E)return ot(Ke,We,vo(Ke,nt),Nt);en(Ke,nt)}return null}function ft(Ke,We,nt,Nt,Yn){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return Ke=Ke.get(nt)||null,ue(We,Ke,""+Nt,Yn);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case S:return Ke=Ke.get(Nt.key===null?nt:Nt.key)||null,Fe(We,Ke,Nt,Yn);case F:return Ke=Ke.get(Nt.key===null?nt:Nt.key)||null,rt(We,Ke,Nt,Yn);case ee:return Nt=et(Nt),ft(Ke,We,nt,Nt,Yn)}if(we(Nt)||R(Nt))return Ke=Ke.get(nt)||null,St(We,Ke,Nt,Yn,null);if(typeof Nt.then=="function")return ft(Ke,We,nt,un(Nt),Yn);if(Nt.$$typeof===E)return ft(Ke,We,nt,vo(We,Nt),Yn);en(We,Nt)}return null}function Cn(Ke,We,nt,Nt){for(var Yn=null,yr=null,Rn=We,Pi=We=0,Xi=null;Rn!==null&&Pi<nt.length;Pi++){Rn.index>Pi?(Xi=Rn,Rn=null):Xi=Rn.sibling;var xr=ot(Ke,Rn,nt[Pi],Nt);if(xr===null){Rn===null&&(Rn=Xi);break}e&&Rn&&xr.alternate===null&&t(Ke,Rn),We=w(xr,We,Pi),yr===null?Yn=xr:yr.sibling=xr,yr=xr,Rn=Xi}if(Pi===nt.length)return a(Ke,Rn),Vn&&_a(Ke,Pi),Yn;if(Rn===null){for(;Pi<nt.length;Pi++)Rn=Pt(Ke,nt[Pi],Nt),Rn!==null&&(We=w(Rn,We,Pi),yr===null?Yn=Rn:yr.sibling=Rn,yr=Rn);return Vn&&_a(Ke,Pi),Yn}for(Rn=u(Rn);Pi<nt.length;Pi++)Xi=ft(Rn,Ke,Pi,nt[Pi],Nt),Xi!==null&&(e&&Xi.alternate!==null&&Rn.delete(Xi.key===null?Pi:Xi.key),We=w(Xi,We,Pi),yr===null?Yn=Xi:yr.sibling=Xi,yr=Xi);return e&&Rn.forEach(function(Mu){return t(Ke,Mu)}),Vn&&_a(Ke,Pi),Yn}function ni(Ke,We,nt,Nt){if(nt==null)throw Error(s(151));for(var Yn=null,yr=null,Rn=We,Pi=We=0,Xi=null,xr=nt.next();Rn!==null&&!xr.done;Pi++,xr=nt.next()){Rn.index>Pi?(Xi=Rn,Rn=null):Xi=Rn.sibling;var Mu=ot(Ke,Rn,xr.value,Nt);if(Mu===null){Rn===null&&(Rn=Xi);break}e&&Rn&&Mu.alternate===null&&t(Ke,Rn),We=w(Mu,We,Pi),yr===null?Yn=Mu:yr.sibling=Mu,yr=Mu,Rn=Xi}if(xr.done)return a(Ke,Rn),Vn&&_a(Ke,Pi),Yn;if(Rn===null){for(;!xr.done;Pi++,xr=nt.next())xr=Pt(Ke,xr.value,Nt),xr!==null&&(We=w(xr,We,Pi),yr===null?Yn=xr:yr.sibling=xr,yr=xr);return Vn&&_a(Ke,Pi),Yn}for(Rn=u(Rn);!xr.done;Pi++,xr=nt.next())xr=ft(Rn,Ke,Pi,xr.value,Nt),xr!==null&&(e&&xr.alternate!==null&&Rn.delete(xr.key===null?Pi:xr.key),We=w(xr,We,Pi),yr===null?Yn=xr:yr.sibling=xr,yr=xr);return e&&Rn.forEach(function(Mm){return t(Ke,Mm)}),Vn&&_a(Ke,Pi),Yn}function Wr(Ke,We,nt,Nt){if(typeof nt=="object"&&nt!==null&&nt.type===_&&nt.key===null&&(nt=nt.props.children),typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case S:e:{for(var Yn=nt.key;We!==null;){if(We.key===Yn){if(Yn=nt.type,Yn===_){if(We.tag===7){a(Ke,We.sibling),Nt=h(We,nt.props.children),Nt.return=Ke,Ke=Nt;break e}}else if(We.elementType===Yn||typeof Yn=="object"&&Yn!==null&&Yn.$$typeof===ee&&et(Yn)===We.type){a(Ke,We.sibling),Nt=h(We,nt.props),Sn(Nt,nt),Nt.return=Ke,Ke=Nt;break e}a(Ke,We);break}else t(Ke,We);We=We.sibling}nt.type===_?(Nt=Jr(nt.props.children,Ke.mode,Nt,nt.key),Nt.return=Ke,Ke=Nt):(Nt=sl(nt.type,nt.key,nt.props,null,Ke.mode,Nt),Sn(Nt,nt),Nt.return=Ke,Ke=Nt)}return O(Ke);case F:e:{for(Yn=nt.key;We!==null;){if(We.key===Yn)if(We.tag===4&&We.stateNode.containerInfo===nt.containerInfo&&We.stateNode.implementation===nt.implementation){a(Ke,We.sibling),Nt=h(We,nt.children||[]),Nt.return=Ke,Ke=Nt;break e}else{a(Ke,We);break}else t(Ke,We);We=We.sibling}Nt=ll(nt,Ke.mode,Nt),Nt.return=Ke,Ke=Nt}return O(Ke);case ee:return nt=et(nt),Wr(Ke,We,nt,Nt)}if(we(nt))return Cn(Ke,We,nt,Nt);if(R(nt)){if(Yn=R(nt),typeof Yn!="function")throw Error(s(150));return nt=Yn.call(nt),ni(Ke,We,nt,Nt)}if(typeof nt.then=="function")return Wr(Ke,We,un(nt),Nt);if(nt.$$typeof===E)return Wr(Ke,We,vo(Ke,nt),Nt);en(Ke,nt)}return typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint"?(nt=""+nt,We!==null&&We.tag===6?(a(Ke,We.sibling),Nt=h(We,nt),Nt.return=Ke,Ke=Nt):(a(Ke,We),Nt=cs(nt,Ke.mode,Nt),Nt.return=Ke,Ke=Nt),O(Ke)):a(Ke,We)}return function(Ke,We,nt,Nt){try{wn=0;var Yn=Wr(Ke,We,nt,Nt);return zt=null,Yn}catch(Rn){if(Rn===Pe||Rn===ke)throw Rn;var yr=Ci(29,Rn,null,Ke.mode);return yr.lanes=Nt,yr.return=Ke,yr}finally{}}}var zr=hi(!0),Pn=hi(!1),Ut=!1;function Kt(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ar(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Xn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function gi(e,t,a){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,(z&2)!==0){var h=u.pending;return h===null?t.next=t:(t.next=h.next,h.next=t),u.pending=t,t=ea(e),Ha(e,null,a),t}return Kr(e,u,t,a),ea(e)}function Ji(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194048)!==0)){var u=t.lanes;u&=e.pendingLanes,a|=u,t.lanes=a,Ln(e,a)}}function _i(e,t){var a=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var h=null,w=null;if(a=a.firstBaseUpdate,a!==null){do{var O={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};w===null?h=w=O:w=w.next=O,a=a.next}while(a!==null);w===null?h=w=t:w=w.next=t}else h=w=t;a={baseState:u.baseState,firstBaseUpdate:h,lastBaseUpdate:w,shared:u.shared,callbacks:u.callbacks},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var ur=!1;function $i(){if(ur){var e=y;if(e!==null)throw e}}function Dr(e,t,a,u){ur=!1;var h=e.updateQueue;Ut=!1;var w=h.firstBaseUpdate,O=h.lastBaseUpdate,ue=h.shared.pending;if(ue!==null){h.shared.pending=null;var Fe=ue,rt=Fe.next;Fe.next=null,O===null?w=rt:O.next=rt,O=Fe;var St=e.alternate;St!==null&&(St=St.updateQueue,ue=St.lastBaseUpdate,ue!==O&&(ue===null?St.firstBaseUpdate=rt:ue.next=rt,St.lastBaseUpdate=Fe))}if(w!==null){var Pt=h.baseState;O=0,St=rt=Fe=null,ue=w;do{var ot=ue.lane&-536870913,ft=ot!==ue.lane;if(ft?(ne&ot)===ot:(u&ot)===ot){ot!==0&&ot===f&&(ur=!0),St!==null&&(St=St.next={lane:0,tag:ue.tag,payload:ue.payload,callback:null,next:null});e:{var Cn=e,ni=ue;ot=t;var Wr=a;switch(ni.tag){case 1:if(Cn=ni.payload,typeof Cn=="function"){Pt=Cn.call(Wr,Pt,ot);break e}Pt=Cn;break e;case 3:Cn.flags=Cn.flags&-65537|128;case 0:if(Cn=ni.payload,ot=typeof Cn=="function"?Cn.call(Wr,Pt,ot):Cn,ot==null)break e;Pt=D({},Pt,ot);break e;case 2:Ut=!0}}ot=ue.callback,ot!==null&&(e.flags|=64,ft&&(e.flags|=8192),ft=h.callbacks,ft===null?h.callbacks=[ot]:ft.push(ot))}else ft={lane:ot,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},St===null?(rt=St=ft,Fe=Pt):St=St.next=ft,O|=ot;if(ue=ue.next,ue===null){if(ue=h.shared.pending,ue===null)break;ft=ue,ue=ft.next,ft.next=null,h.lastBaseUpdate=ft,h.shared.pending=null}}while(!0);St===null&&(Fe=Pt),h.baseState=Fe,h.firstBaseUpdate=rt,h.lastBaseUpdate=St,w===null&&(h.shared.lanes=0),me|=O,e.lanes=O,e.memoizedState=Pt}}function eo(e,t){if(typeof e!="function")throw Error(s(191,e));e.call(t)}function Sr(e,t){var a=e.callbacks;if(a!==null)for(e.callbacks=null,e=0;e<a.length;e++)eo(a[e],t)}var ii=k(null),Gi=k(0);function hr(e,t){e=Ae,V(Gi,e),V(ii,t),Ae=e|t.baseLanes}function ai(){V(Gi,Ae),V(ii,ii.current)}function Qi(){Ae=Gi.current,A(ii),A(Gi)}var ji=k(null),yi=null;function Yi(e){var t=e.alternate;V(si,si.current&1),V(ji,e),yi===null&&(t===null||ii.current!==null||t.memoizedState!==null)&&(yi=e)}function Ui(e){V(si,si.current),V(ji,e),yi===null&&(yi=e)}function Rr(e){e.tag===22?(V(si,si.current),V(ji,e),yi===null&&(yi=e)):lo()}function lo(){V(si,si.current),V(ji,ji.current)}function jr(e){A(ji),yi===e&&(yi=null),A(si)}var si=k(0);function Do(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Uh(a)||Fh(a)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qr=0,Bn=null,In=null,Fi=null,La=!1,co=!1,Ro=!1,to=0,dl=0,zl=null,bc=0;function Tr(){throw Error(s(321))}function vc(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!Vo(e[a],t[a]))return!1;return!0}function fl(e,t,a,u,h,w){return qr=w,Bn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,te.H=e===null||e.memoizedState===null?ju:ou,Ro=!1,w=a(u,h),Ro=!1,co&&(w=Ya(t,a,u,h)),Oc(e),w}function Oc(e){te.H=Sc;var t=In!==null&&In.next!==null;if(qr=0,Fi=In=Bn=null,La=!1,dl=0,zl=null,t)throw Error(s(300));e===null||aa||(e=e.dependencies,e!==null&&bo(e)&&(aa=!0))}function Ya(e,t,a,u){Bn=e;var h=0;do{if(co&&(zl=null),dl=0,co=!1,25<=h)throw Error(s(301));if(h+=1,Fi=In=null,e.updateQueue!=null){var w=e.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}te.H=Yu,w=t(a,u)}while(co);return w}function Hu(){var e=te.H,t=e.useState()[0];return t=typeof t.then=="function"?hl(t):t,e=e.useState()[0],(In!==null?In.memoizedState:null)!==e&&(Bn.flags|=1024),t}function pl(){var e=to!==0;return to=0,e}function Jl(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function Ql(e){if(La){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}La=!1}qr=0,Fi=In=Bn=null,co=!1,dl=to=0,zl=null}function Lo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fi===null?Bn.memoizedState=Fi=e:Fi=Fi.next=e,Fi}function Vr(){if(In===null){var e=Bn.alternate;e=e!==null?e.memoizedState:null}else e=In.next;var t=Fi===null?Bn.memoizedState:Fi.next;if(t!==null)Fi=t,In=e;else{if(e===null)throw Bn.alternate===null?Error(s(467)):Error(s(310));In=e,e={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},Fi===null?Bn.memoizedState=Fi=e:Fi=Fi.next=e}return Fi}function ec(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function hl(e){var t=dl;return dl+=1,zl===null&&(zl=[]),e=bt(zl,e,t),t=Bn,(Fi===null?t.memoizedState:Fi.next)===null&&(t=t.alternate,te.H=t===null||t.memoizedState===null?ju:ou),e}function tc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return hl(e);if(e.$$typeof===E)return ra(e)}throw Error(s(438,String(e)))}function nc(e){var t=null,a=Bn.updateQueue;if(a!==null&&(t=a.memoCache),t==null){var u=Bn.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(t={data:u.data.map(function(h){return h.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),a===null&&(a=ec(),Bn.updateQueue=a),a.memoCache=t,a=t.data[t.index],a===void 0)for(a=t.data[t.index]=Array(e),u=0;u<e;u++)a[u]=$;return t.index++,a}function Xa(e,t){return typeof t=="function"?t(e):t}function ic(e){var t=Vr();return rc(t,In,e)}function rc(e,t,a){var u=e.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=a;var h=e.baseQueue,w=u.pending;if(w!==null){if(h!==null){var O=h.next;h.next=w.next,w.next=O}t.baseQueue=h=w,u.pending=null}if(w=e.baseState,h===null)e.memoizedState=w;else{t=h.next;var ue=O=null,Fe=null,rt=t,St=!1;do{var Pt=rt.lane&-536870913;if(Pt!==rt.lane?(ne&Pt)===Pt:(qr&Pt)===Pt){var ot=rt.revertLane;if(ot===0)Fe!==null&&(Fe=Fe.next={lane:0,revertLane:0,gesture:null,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null}),Pt===f&&(St=!0);else if((qr&ot)===ot){rt=rt.next,ot===f&&(St=!0);continue}else Pt={lane:0,revertLane:rt.revertLane,gesture:null,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null},Fe===null?(ue=Fe=Pt,O=w):Fe=Fe.next=Pt,Bn.lanes|=ot,me|=ot;Pt=rt.action,Ro&&a(w,Pt),w=rt.hasEagerState?rt.eagerState:a(w,Pt)}else ot={lane:Pt,revertLane:rt.revertLane,gesture:rt.gesture,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null},Fe===null?(ue=Fe=ot,O=w):Fe=Fe.next=ot,Bn.lanes|=Pt,me|=Pt;rt=rt.next}while(rt!==null&&rt!==t);if(Fe===null?O=w:Fe.next=ue,!Vo(w,e.memoizedState)&&(aa=!0,St&&(a=y,a!==null)))throw a;e.memoizedState=w,e.baseState=O,e.baseQueue=Fe,u.lastRenderedState=w}return h===null&&(u.lanes=0),[e.memoizedState,u.dispatch]}function Uc(e){var t=Vr(),a=t.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=e;var u=a.dispatch,h=a.pending,w=t.memoizedState;if(h!==null){a.pending=null;var O=h=h.next;do w=e(w,O.action),O=O.next;while(O!==h);Vo(w,t.memoizedState)||(aa=!0),t.memoizedState=w,t.baseQueue===null&&(t.baseState=w),a.lastRenderedState=w}return[w,u]}function wc(e,t,a){var u=Bn,h=Vr(),w=Vn;if(w){if(a===void 0)throw Error(s(407));a=a()}else a=t();var O=!Vo((In||h).memoizedState,a);if(O&&(h.memoizedState=a,aa=!0),h=h.queue,yl(gl.bind(null,u,h,e),[e]),h.getSnapshot!==t||O||Fi!==null&&Fi.memoizedState.tag&1){if(u.flags|=2048,Ms(9,{destroy:void 0},Wu.bind(null,u,h,a,t),null),B===null)throw Error(s(349));w||(qr&127)!==0||tl(u,t,a)}return a}function tl(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=Bn.updateQueue,t===null?(t=ec(),Bn.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function Wu(e,t,a,u){t.value=a,t.getSnapshot=u,mu(t)&&oc(e)}function gl(e,t,a){return a(function(){mu(t)&&oc(e)})}function mu(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!Vo(e,a)}catch{return!0}}function oc(e){var t=al(e,2);t!==null&&Dt(t,e,2)}function Pl(e){var t=Lo();if(typeof e=="function"){var a=e;if(e=a(),Ro){Ft(!0);try{a()}finally{Ft(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:e},t}function $u(e,t,a,u){return e.baseState=a,rc(e,In,typeof u=="function"?u:Xa)}function nu(e,t,a,u,h){if(ru(e))throw Error(s(485));if(e=t.action,e!==null){var w={payload:h,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){w.listeners.push(O)}};te.T!==null?a(!0):w.isTransition=!1,u(w),a=t.pending,a===null?(w.next=t.pending=w,Gu(t,w)):(w.next=a.next,t.pending=a.next=w)}}function Gu(e,t){var a=t.action,u=t.payload,h=e.state;if(t.isTransition){var w=te.T,O={};te.T=O;try{var ue=a(h,u),Fe=te.S;Fe!==null&&Fe(O,ue),ac(e,t,ue)}catch(rt){sc(e,t,rt)}finally{w!==null&&O.types!==null&&(w.types=O.types),te.T=w}}else try{w=a(h,u),ac(e,t,w)}catch(rt){sc(e,t,rt)}}function ac(e,t,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(u){bu(e,t,u)},function(u){return sc(e,t,u)}):bu(e,t,a)}function bu(e,t,a){t.status="fulfilled",t.value=a,iu(t),e.state=a,t=e.pending,t!==null&&(a=t.next,a===t?e.pending=null:(a=a.next,t.next=a,Gu(e,a)))}function sc(e,t,a){var u=e.pending;if(e.pending=null,u!==null){u=u.next;do t.status="rejected",t.reason=a,iu(t),t=t.next;while(t!==u)}e.action=null}function iu(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function lc(e,t){return t}function As(e,t){if(Vn){var a=B.formState;if(a!==null){e:{var u=Bn;if(Vn){if(Ar){t:{for(var h=Ar,w=Qr;h.nodeType!==8;){if(!w){h=null;break t}if(h=dc(h.nextSibling),h===null){h=null;break t}}w=h.data,h=w==="F!"||w==="F"?h:null}if(h){Ar=dc(h.nextSibling),u=h.data==="F!";break e}}ma(u)}u=!1}u&&(t=a[0])}}return a=Lo(),a.memoizedState=a.baseState=t,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lc,lastRenderedState:t},a.queue=u,a=wu.bind(null,Bn,u),u.dispatch=a,u=Pl(!1),w=Fc.bind(null,Bn,!1,u.queue),u=Lo(),h={state:t,dispatch:null,action:e,pending:null},u.queue=h,a=nu.bind(null,Bn,h,w,a),h.dispatch=a,u.memoizedState=e,[t,a,!1]}function fs(e){var t=Vr();return Is(t,In,e)}function Is(e,t,a){if(t=rc(e,t,lc)[0],e=ic(Xa)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var u=hl(t)}catch(O){throw O===Pe?ke:O}else u=t;t=Vr();var h=t.queue,w=h.dispatch;return a!==t.memoizedState&&(Bn.flags|=2048,Ms(9,{destroy:void 0},cc.bind(null,h,a),null)),[u,w,e]}function cc(e,t){e.action=t}function vu(e){var t=Vr(),a=In;if(a!==null)return Is(t,a,e);Vr(),t=t.memoizedState,a=Vr();var u=a.queue.dispatch;return a.memoizedState=e,[t,u,!1]}function Ms(e,t,a,u){return e={tag:e,create:a,deps:u,inst:t,next:null},t=Bn.updateQueue,t===null&&(t=ec(),Bn.updateQueue=t),a=t.lastEffect,a===null?t.lastEffect=e.next=e:(u=a.next,a.next=e,e.next=u,t.lastEffect=e),e}function vd(){return Vr().memoizedState}function Bs(e,t,a,u){var h=Lo();Bn.flags|=e,h.memoizedState=Ms(1|t,{destroy:void 0},a,u===void 0?null:u)}function Ka(e,t,a,u){var h=Vr();u=u===void 0?null:u;var w=h.memoizedState.inst;In!==null&&u!==null&&vc(u,In.memoizedState.deps)?h.memoizedState=Ms(t,w,a,u):(Bn.flags|=e,h.memoizedState=Ms(1|t,w,a,u))}function _l(e,t){Bs(8390656,8,e,t)}function yl(e,t){Ka(2048,8,e,t)}function mh(e){Bn.flags|=4;var t=Bn.updateQueue;if(t===null)t=ec(),Bn.updateQueue=t,t.events=[e];else{var a=t.events;a===null?t.events=[e]:a.push(e)}}function Zf(e){var t=Vr().memoizedState;return mh({ref:t,nextImpl:e}),function(){if((z&2)!==0)throw Error(s(440));return t.impl.apply(void 0,arguments)}}function Jf(e,t){return Ka(4,2,e,t)}function Qf(e,t){return Ka(4,4,e,t)}function ep(e,t){if(typeof t=="function"){e=e();var a=t(e);return function(){typeof a=="function"?a():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function tp(e,t,a){a=a!=null?a.concat([e]):null,Ka(4,4,ep.bind(null,t,e),a)}function wd(){}function rf(e,t){var a=Vr();t=t===void 0?null:t;var u=a.memoizedState;return t!==null&&vc(t,u[1])?u[0]:(a.memoizedState=[e,t],e)}function Dl(e,t){var a=Vr();t=t===void 0?null:t;var u=a.memoizedState;if(t!==null&&vc(t,u[1]))return u[0];if(u=e(),Ro){Ft(!0);try{e()}finally{Ft(!1)}}return a.memoizedState=[u,t],u}function Sd(e,t,a){return a===void 0||(qr&1073741824)!==0&&(ne&261930)===0?e.memoizedState=t:(e.memoizedState=a,e=On(),Bn.lanes|=e,me|=e,a)}function np(e,t,a,u){return Vo(a,t)?a:ii.current!==null?(e=Sd(e,a,u),Vo(e,t)||(aa=!0),e):(qr&42)===0||(qr&1073741824)!==0&&(ne&261930)===0?(aa=!0,e.memoizedState=a):(e=On(),Bn.lanes|=e,me|=e,t)}function ip(e,t,a,u,h){var w=de.p;de.p=w!==0&&8>w?w:8;var O=te.T,ue={};te.T=ue,Fc(e,!1,t,a);try{var Fe=h(),rt=te.S;if(rt!==null&&rt(ue,Fe),Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var St=X(Fe,u);Rl(e,t,St,Zn(e))}else Rl(e,t,u,Zn(e))}catch(Pt){Rl(e,t,{then:function(){},status:"rejected",reason:Pt},Zn())}finally{de.p=w,O!==null&&ue.types!==null&&(O.types=ue.types),te.T=O}}function bh(){}function of(e,t,a,u){if(e.tag!==5)throw Error(s(476));var h=rp(e).queue;ip(e,h,t,Ce,a===null?bh:function(){return op(e),a(u)})}function rp(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Ce,baseState:Ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:Ce},next:null};var a={};return t.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xa,lastRenderedState:a},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function op(e){var t=rp(e);t.next===null&&(t=e.alternate.memoizedState),Rl(e,t.next.queue,{},Zn())}function af(){return ra(Df)}function ap(){return Vr().memoizedState}function sp(){return Vr().memoizedState}function vh(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var a=Zn();e=Xn(a);var u=gi(t,e,a);u!==null&&(Dt(u,t,a),Ji(u,t,a)),t={cache:_o()},e.payload=t;return}t=t.return}}function wh(e,t,a){var u=Zn();a={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},ru(e)?Su(t,a):(a=zo(e,t,a,u),a!==null&&(Dt(a,e,u),jd(a,t,u)))}function wu(e,t,a){var u=Zn();Rl(e,t,a,u)}function Rl(e,t,a,u){var h={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(ru(e))Su(t,h);else{var w=e.alternate;if(e.lanes===0&&(w===null||w.lanes===0)&&(w=t.lastRenderedReducer,w!==null))try{var O=t.lastRenderedState,ue=w(O,a);if(h.hasEagerState=!0,h.eagerState=ue,Vo(ue,O))return Kr(e,t,h,0),B===null&&kr(),!1}catch{}finally{}if(a=zo(e,t,h,u),a!==null)return Dt(a,e,u),jd(a,t,u),!0}return!1}function Fc(e,t,a,u){if(u={lane:2,revertLane:kh(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ru(e)){if(t)throw Error(s(479))}else t=zo(e,a,u,2),t!==null&&Dt(t,e,2)}function ru(e){var t=e.alternate;return e===Bn||t!==null&&t===Bn}function Su(e,t){co=La=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function jd(e,t,a){if((a&4194048)!==0){var u=t.lanes;u&=e.pendingLanes,a|=u,t.lanes=a,Ln(e,a)}}var Sc={readContext:ra,use:tc,useCallback:Tr,useContext:Tr,useEffect:Tr,useImperativeHandle:Tr,useLayoutEffect:Tr,useInsertionEffect:Tr,useMemo:Tr,useReducer:Tr,useRef:Tr,useState:Tr,useDebugValue:Tr,useDeferredValue:Tr,useTransition:Tr,useSyncExternalStore:Tr,useId:Tr,useHostTransitionStatus:Tr,useFormState:Tr,useActionState:Tr,useOptimistic:Tr,useMemoCache:Tr,useCacheRefresh:Tr};Sc.useEffectEvent=Tr;var ju={readContext:ra,use:tc,useCallback:function(e,t){return Lo().memoizedState=[e,t===void 0?null:t],e},useContext:ra,useEffect:_l,useImperativeHandle:function(e,t,a){a=a!=null?a.concat([e]):null,Bs(4194308,4,ep.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Bs(4194308,4,e,t)},useInsertionEffect:function(e,t){Bs(4,2,e,t)},useMemo:function(e,t){var a=Lo();t=t===void 0?null:t;var u=e();if(Ro){Ft(!0);try{e()}finally{Ft(!1)}}return a.memoizedState=[u,t],u},useReducer:function(e,t,a){var u=Lo();if(a!==void 0){var h=a(t);if(Ro){Ft(!0);try{a(t)}finally{Ft(!1)}}}else h=t;return u.memoizedState=u.baseState=h,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:h},u.queue=e,e=e.dispatch=wh.bind(null,Bn,e),[u.memoizedState,e]},useRef:function(e){var t=Lo();return e={current:e},t.memoizedState=e},useState:function(e){e=Pl(e);var t=e.queue,a=wu.bind(null,Bn,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:wd,useDeferredValue:function(e,t){var a=Lo();return Sd(a,e,t)},useTransition:function(){var e=Pl(!1);return e=ip.bind(null,Bn,e.queue,!0,!1),Lo().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var u=Bn,h=Lo();if(Vn){if(a===void 0)throw Error(s(407));a=a()}else{if(a=t(),B===null)throw Error(s(349));(ne&127)!==0||tl(u,t,a)}h.memoizedState=a;var w={value:a,getSnapshot:t};return h.queue=w,_l(gl.bind(null,u,w,e),[e]),u.flags|=2048,Ms(9,{destroy:void 0},Wu.bind(null,u,w,a,t),null),a},useId:function(){var e=Lo(),t=B.identifierPrefix;if(Vn){var a=Po,u=mo;a=(u&~(1<<32-tn(u)-1)).toString(32)+a,t="_"+t+"R_"+a,a=to++,0<a&&(t+="H"+a.toString(32)),t+="_"}else a=bc++,t="_"+t+"r_"+a.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:af,useFormState:As,useActionState:As,useOptimistic:function(e){var t=Lo();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=Fc.bind(null,Bn,!0,a),a.dispatch=t,[e,t]},useMemoCache:nc,useCacheRefresh:function(){return Lo().memoizedState=vh.bind(null,Bn)},useEffectEvent:function(e){var t=Lo(),a={impl:e};return t.memoizedState=a,function(){if((z&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},ou={readContext:ra,use:tc,useCallback:rf,useContext:ra,useEffect:yl,useImperativeHandle:tp,useInsertionEffect:Jf,useLayoutEffect:Qf,useMemo:Dl,useReducer:ic,useRef:vd,useState:function(){return ic(Xa)},useDebugValue:wd,useDeferredValue:function(e,t){var a=Vr();return np(a,In.memoizedState,e,t)},useTransition:function(){var e=ic(Xa)[0],t=Vr().memoizedState;return[typeof e=="boolean"?e:hl(e),t]},useSyncExternalStore:wc,useId:ap,useHostTransitionStatus:af,useFormState:fs,useActionState:fs,useOptimistic:function(e,t){var a=Vr();return $u(a,In,e,t)},useMemoCache:nc,useCacheRefresh:sp};ou.useEffectEvent=Zf;var Yu={readContext:ra,use:tc,useCallback:rf,useContext:ra,useEffect:yl,useImperativeHandle:tp,useInsertionEffect:Jf,useLayoutEffect:Qf,useMemo:Dl,useReducer:Uc,useRef:vd,useState:function(){return Uc(Xa)},useDebugValue:wd,useDeferredValue:function(e,t){var a=Vr();return In===null?Sd(a,e,t):np(a,In.memoizedState,e,t)},useTransition:function(){var e=Uc(Xa)[0],t=Vr().memoizedState;return[typeof e=="boolean"?e:hl(e),t]},useSyncExternalStore:wc,useId:ap,useHostTransitionStatus:af,useFormState:vu,useActionState:vu,useOptimistic:function(e,t){var a=Vr();return In!==null?$u(a,In,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:nc,useCacheRefresh:sp};Yu.useEffectEvent=Zf;function Tu(e,t,a,u){t=e.memoizedState,a=a(u,t),a=a==null?t:D({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var sf={enqueueSetState:function(e,t,a){e=e._reactInternals;var u=Zn(),h=Xn(u);h.payload=t,a!=null&&(h.callback=a),t=gi(e,h,u),t!==null&&(Dt(t,e,u),Ji(t,e,u))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var u=Zn(),h=Xn(u);h.tag=1,h.payload=t,a!=null&&(h.callback=a),t=gi(e,h,u),t!==null&&(Dt(t,e,u),Ji(t,e,u))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=Zn(),u=Xn(a);u.tag=2,t!=null&&(u.callback=t),t=gi(e,u,a),t!==null&&(Dt(t,e,a),Ji(t,e,a))}};function Td(e,t,a,u,h,w,O){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,w,O):t.prototype&&t.prototype.isPureReactComponent?!ga(a,u)||!ga(h,w):!0}function Ll(e,t,a,u){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,u),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,u),t.state!==e&&sf.enqueueReplaceState(t,t.state,null)}function jc(e,t){var a=t;if("ref"in t){a={};for(var u in t)u!=="ref"&&(a[u]=t[u])}if(e=e.defaultProps){a===t&&(a=D({},a));for(var h in e)a[h]===void 0&&(a[h]=e[h])}return a}function lp(e){Xr(e)}function cp(e){console.error(e)}function Tc(e){Xr(e)}function Cd(e,t){try{var a=e.onUncaughtError;a(t.value,{componentStack:t.stack})}catch(u){setTimeout(function(){throw u})}}function Nd(e,t,a){try{var u=e.onCaughtError;u(a.value,{componentStack:a.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function kd(e,t,a){return a=Xn(a),a.tag=3,a.payload={element:null},a.callback=function(){Cd(e,t)},a}function Ad(e){return e=Xn(e),e.tag=3,e}function Xu(e,t,a,u){var h=a.type.getDerivedStateFromError;if(typeof h=="function"){var w=u.value;e.payload=function(){return h(w)},e.callback=function(){Nd(t,a,u)}}var O=a.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(e.callback=function(){Nd(t,a,u),typeof h!="function"&&(Ye===null?Ye=new Set([this]):Ye.add(this));var ue=u.stack;this.componentDidCatch(u.value,{componentStack:ue!==null?ue:""})})}function zd(e,t,a,u,h){if(a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(t=a.alternate,t!==null&&$a(t,a,h,!0),a=ji.current,a!==null){switch(a.tag){case 31:case 13:return yi===null?wp():a.alternate===null&&ge===0&&(ge=3),a.flags&=-257,a.flags|=65536,a.lanes=h,u===He?a.flags|=16384:(t=a.updateQueue,t===null?a.updateQueue=new Set([u]):t.add(u),Th(e,u,h)),!1;case 22:return a.flags|=65536,u===He?a.flags|=16384:(t=a.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([u])},a.updateQueue=t):(a=t.retryQueue,a===null?t.retryQueue=new Set([u]):a.add(u)),Th(e,u,h)),!1}throw Error(s(435,a.tag))}return Th(e,u,h),wp(),!1}if(Vn)return t=ji.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=h,u!==xa&&(e=Error(s(422),{cause:u}),Bc(js(e,a)))):(u!==xa&&(t=Error(s(423),{cause:u}),Bc(js(t,a))),e=e.current.alternate,e.flags|=65536,h&=-h,e.lanes|=h,u=js(u,a),h=kd(e.stateNode,u,h),_i(e,h),ge!==4&&(ge=2)),!1;var w=Error(s(520),{cause:u});if(w=js(w,a),Ze===null?Ze=[w]:Ze.push(w),ge!==4&&(ge=2),t===null)return!0;u=js(u,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=h&-h,a.lanes|=e,e=kd(a.stateNode,u,e),_i(a,e),!1;case 1:if(t=a.type,w=a.stateNode,(a.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ye===null||!Ye.has(w))))return a.flags|=65536,h&=-h,a.lanes|=h,h=Ad(h),Xu(h,e,a,u),_i(a,h),!1}a=a.return}while(a!==null);return!1}var Cu=Error(s(461)),aa=!1;function wa(e,t,a,u){t.child=e===null?Pn(t,null,a,u):zr(t,e.child,a,u)}function Pd(e,t,a,u,h){a=a.render;var w=t.ref;if("ref"in u){var O={};for(var ue in u)ue!=="ref"&&(O[ue]=u[ue])}else O=u;return Zl(t),u=fl(e,t,a,O,w,h),ue=pl(),e!==null&&!aa?(Jl(e,t,h),Bl(e,t,h)):(Vn&&ue&&kl(t),t.flags|=1,wa(e,t,u,h),t.child)}function up(e,t,a,u,h){if(e===null){var w=a.type;return typeof w=="function"&&!Lc(w)&&w.defaultProps===void 0&&a.compare===null?(t.tag=15,t.type=w,dp(e,t,w,u,h)):(e=sl(a.type,null,u,t,t.mode,h),e.ref=t.ref,e.return=t,t.child=e)}if(w=e.child,!td(e,h)){var O=w.memoizedProps;if(a=a.compare,a=a!==null?a:ga,a(O,u)&&e.ref===t.ref)return Bl(e,t,h)}return t.flags|=1,e=lr(w,u),e.ref=t.ref,e.return=t,t.child=e}function dp(e,t,a,u,h){if(e!==null){var w=e.memoizedProps;if(ga(w,u)&&e.ref===t.ref)if(aa=!1,t.pendingProps=u=w,td(e,h))(e.flags&131072)!==0&&(aa=!0);else return t.lanes=e.lanes,Bl(e,t,h)}return Ju(e,t,a,u,h)}function Os(e,t,a,u){var h=u.children,w=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((t.flags&128)!==0){if(w=w!==null?w.baseLanes|a:a,e!==null){for(u=t.child=e.child,h=0;u!==null;)h=h|u.lanes|u.childLanes,u=u.sibling;u=h&~w}else u=0,t.child=null;return Il(e,t,w,a,u)}if((a&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&he(t,w!==null?w.cachePool:null),w!==null?hr(t,w):ai(),Rr(t);else return u=t.lanes=536870912,Il(e,t,w!==null?w.baseLanes|a:a,a,u)}else w!==null?(he(t,w.cachePool),hr(t,w),lo(),t.memoizedState=null):(e!==null&&he(t,null),ai(),lo());return wa(e,t,h,a),t.child}function Ku(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Il(e,t,a,u,h){var w=ce();return w=w===null?null:{parent:Li._currentValue,pool:w},t.memoizedState={baseLanes:a,cachePool:w},e!==null&&he(t,null),ai(),Rr(t),e!==null&&$a(e,t,u,!0),t.childLanes=h,null}function Zu(e,t){return t=Qu({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function au(e,t,a){return zr(t,e.child,null,a),e=Zu(t,t.pendingProps),e.flags|=2,jr(t),t.memoizedState=null,e}function fp(e,t,a){var u=t.pendingProps,h=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Vn){if(u.mode==="hidden")return e=Zu(t,u),t.lanes=536870912,Ku(null,e);if(Ui(t),(e=Ar)?(e=R0(e,Qr),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Wa!==null?{id:mo,overflow:Po}:null,retryLane:536870912,hydrationErrors:null},a=ta(e),a.return=t,t.child=a,cr=t,Ar=null)):e=null,e===null)throw ma(t);return t.lanes=536870912,null}return Zu(t,u)}var w=e.memoizedState;if(w!==null){var O=w.dehydrated;if(Ui(t),h)if(t.flags&256)t.flags&=-257,t=au(e,t,a);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(s(558));else if(aa||$a(e,t,a,!1),h=(a&e.childLanes)!==0,aa||h){if(u=B,u!==null&&(O=Rt(u,a),O!==0&&O!==w.retryLane))throw w.retryLane=O,al(e,O),Dt(u,e,O),Cu;wp(),t=au(e,t,a)}else e=w.treeContext,Ar=dc(O.nextSibling),cr=t,Vn=!0,ia=null,Qr=!1,e!==null&&Vu(t,e),t=Zu(t,u),t.flags|=4096;return t}return e=lr(e.child,{mode:u.mode,children:u.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Ml(e,t){var a=t.ref;if(a===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(e===null||e.ref!==a)&&(t.flags|=4194816)}}function Ju(e,t,a,u,h){return Zl(t),a=fl(e,t,a,u,void 0,h),u=pl(),e!==null&&!aa?(Jl(e,t,h),Bl(e,t,h)):(Vn&&u&&kl(t),t.flags|=1,wa(e,t,a,h),t.child)}function lf(e,t,a,u,h,w){return Zl(t),t.updateQueue=null,a=Ya(t,u,a,h),Oc(e),u=pl(),e!==null&&!aa?(Jl(e,t,w),Bl(e,t,w)):(Vn&&u&&kl(t),t.flags|=1,wa(e,t,a,w),t.child)}function cf(e,t,a,u,h){if(Zl(t),t.stateNode===null){var w=Fr,O=a.contextType;typeof O=="object"&&O!==null&&(w=ra(O)),w=new a(u,w),t.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=sf,t.stateNode=w,w._reactInternals=t,w=t.stateNode,w.props=u,w.state=t.memoizedState,w.refs={},Kt(t),O=a.contextType,w.context=typeof O=="object"&&O!==null?ra(O):Fr,w.state=t.memoizedState,O=a.getDerivedStateFromProps,typeof O=="function"&&(Tu(t,a,O,u),w.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(O=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),O!==w.state&&sf.enqueueReplaceState(w,w.state,null),Dr(t,u,w,h),$i(),w.state=t.memoizedState),typeof w.componentDidMount=="function"&&(t.flags|=4194308),u=!0}else if(e===null){w=t.stateNode;var ue=t.memoizedProps,Fe=jc(a,ue);w.props=Fe;var rt=w.context,St=a.contextType;O=Fr,typeof St=="object"&&St!==null&&(O=ra(St));var Pt=a.getDerivedStateFromProps;St=typeof Pt=="function"||typeof w.getSnapshotBeforeUpdate=="function",ue=t.pendingProps!==ue,St||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(ue||rt!==O)&&Ll(t,w,u,O),Ut=!1;var ot=t.memoizedState;w.state=ot,Dr(t,u,w,h),$i(),rt=t.memoizedState,ue||ot!==rt||Ut?(typeof Pt=="function"&&(Tu(t,a,Pt,u),rt=t.memoizedState),(Fe=Ut||Td(t,a,Fe,u,ot,rt,O))?(St||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(t.flags|=4194308)):(typeof w.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=u,t.memoizedState=rt),w.props=u,w.state=rt,w.context=O,u=Fe):(typeof w.componentDidMount=="function"&&(t.flags|=4194308),u=!1)}else{w=t.stateNode,ar(e,t),O=t.memoizedProps,St=jc(a,O),w.props=St,Pt=t.pendingProps,ot=w.context,rt=a.contextType,Fe=Fr,typeof rt=="object"&&rt!==null&&(Fe=ra(rt)),ue=a.getDerivedStateFromProps,(rt=typeof ue=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(O!==Pt||ot!==Fe)&&Ll(t,w,u,Fe),Ut=!1,ot=t.memoizedState,w.state=ot,Dr(t,u,w,h),$i();var ft=t.memoizedState;O!==Pt||ot!==ft||Ut||e!==null&&e.dependencies!==null&&bo(e.dependencies)?(typeof ue=="function"&&(Tu(t,a,ue,u),ft=t.memoizedState),(St=Ut||Td(t,a,St,u,ot,ft,Fe)||e!==null&&e.dependencies!==null&&bo(e.dependencies))?(rt||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(u,ft,Fe),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(u,ft,Fe)),typeof w.componentDidUpdate=="function"&&(t.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof w.componentDidUpdate!="function"||O===e.memoizedProps&&ot===e.memoizedState||(t.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||O===e.memoizedProps&&ot===e.memoizedState||(t.flags|=1024),t.memoizedProps=u,t.memoizedState=ft),w.props=u,w.state=ft,w.context=Fe,u=St):(typeof w.componentDidUpdate!="function"||O===e.memoizedProps&&ot===e.memoizedState||(t.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||O===e.memoizedProps&&ot===e.memoizedState||(t.flags|=1024),u=!1)}return w=u,Ml(e,t),u=(t.flags&128)!==0,w||u?(w=t.stateNode,a=u&&typeof a.getDerivedStateFromError!="function"?null:w.render(),t.flags|=1,e!==null&&u?(t.child=zr(t,e.child,null,h),t.child=zr(t,null,a,h)):wa(e,t,a,h),t.memoizedState=w.state,e=t.child):e=Bl(e,t,h),e}function pp(e,t,a,u){return mc(),t.flags|=256,wa(e,t,a,u),t.child}var uf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function df(e){return{baseLanes:e,cachePool:je()}}function Nu(e,t,a){return e=e!==null?e.childLanes&~a:0,t&&(e|=Oe),e}function ff(e,t,a){var u=t.pendingProps,h=!1,w=(t.flags&128)!==0,O;if((O=w)||(O=e!==null&&e.memoizedState===null?!1:(si.current&2)!==0),O&&(h=!0,t.flags&=-129),O=(t.flags&32)!==0,t.flags&=-33,e===null){if(Vn){if(h?Yi(t):lo(),(e=Ar)?(e=R0(e,Qr),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Wa!==null?{id:mo,overflow:Po}:null,retryLane:536870912,hydrationErrors:null},a=ta(e),a.return=t,t.child=a,cr=t,Ar=null)):e=null,e===null)throw ma(t);return Fh(e)?t.lanes=32:t.lanes=536870912,null}var ue=u.children;return u=u.fallback,h?(lo(),h=t.mode,ue=Qu({mode:"hidden",children:ue},h),u=Jr(u,h,a,null),ue.return=t,u.return=t,ue.sibling=u,t.child=ue,u=t.child,u.memoizedState=df(a),u.childLanes=Nu(e,O,a),t.memoizedState=uf,Ku(null,u)):(Yi(t),pf(t,ue))}var Fe=e.memoizedState;if(Fe!==null&&(ue=Fe.dehydrated,ue!==null)){if(w)t.flags&256?(Yi(t),t.flags&=-257,t=su(e,t,a)):t.memoizedState!==null?(lo(),t.child=e.child,t.flags|=128,t=null):(lo(),ue=u.fallback,h=t.mode,u=Qu({mode:"visible",children:u.children},h),ue=Jr(ue,h,a,null),ue.flags|=2,u.return=t,ue.return=t,u.sibling=ue,t.child=u,zr(t,e.child,null,a),u=t.child,u.memoizedState=df(a),u.childLanes=Nu(e,O,a),t.memoizedState=uf,t=Ku(null,u));else if(Yi(t),Fh(ue)){if(O=ue.nextSibling&&ue.nextSibling.dataset,O)var rt=O.dgst;O=rt,u=Error(s(419)),u.stack="",u.digest=O,Bc({value:u,source:null,stack:null}),t=su(e,t,a)}else if(aa||$a(e,t,a,!1),O=(a&e.childLanes)!==0,aa||O){if(O=B,O!==null&&(u=Rt(O,a),u!==0&&u!==Fe.retryLane))throw Fe.retryLane=u,al(e,u),Dt(O,e,u),Cu;Uh(ue)||wp(),t=su(e,t,a)}else Uh(ue)?(t.flags|=192,t.child=e.child,t=null):(e=Fe.treeContext,Ar=dc(ue.nextSibling),cr=t,Vn=!0,ia=null,Qr=!1,e!==null&&Vu(t,e),t=pf(t,u.children),t.flags|=4096);return t}return h?(lo(),ue=u.fallback,h=t.mode,Fe=e.child,rt=Fe.sibling,u=lr(Fe,{mode:"hidden",children:u.children}),u.subtreeFlags=Fe.subtreeFlags&65011712,rt!==null?ue=lr(rt,ue):(ue=Jr(ue,h,a,null),ue.flags|=2),ue.return=t,u.return=t,u.sibling=ue,t.child=u,Ku(null,u),u=t.child,ue=e.child.memoizedState,ue===null?ue=df(a):(h=ue.cachePool,h!==null?(Fe=Li._currentValue,h=h.parent!==Fe?{parent:Fe,pool:Fe}:h):h=je(),ue={baseLanes:ue.baseLanes|a,cachePool:h}),u.memoizedState=ue,u.childLanes=Nu(e,O,a),t.memoizedState=uf,Ku(e.child,u)):(Yi(t),a=e.child,e=a.sibling,a=lr(a,{mode:"visible",children:u.children}),a.return=t,a.sibling=null,e!==null&&(O=t.deletions,O===null?(t.deletions=[e],t.flags|=16):O.push(e)),t.child=a,t.memoizedState=null,a)}function pf(e,t){return t=Qu({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Qu(e,t){return e=Ci(22,e,null,t),e.lanes=0,e}function su(e,t,a){return zr(t,e.child,null,a),e=pf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function hp(e,t,a){e.lanes|=t;var u=e.alternate;u!==null&&(u.lanes|=t),ks(e.return,t,a)}function ed(e,t,a,u,h,w){var O=e.memoizedState;O===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:h,treeForkCount:w}:(O.isBackwards=t,O.rendering=null,O.renderingStartTime=0,O.last=u,O.tail=a,O.tailMode=h,O.treeForkCount=w)}function hf(e,t,a){var u=t.pendingProps,h=u.revealOrder,w=u.tail;u=u.children;var O=si.current,ue=(O&2)!==0;if(ue?(O=O&1|2,t.flags|=128):O&=1,V(si,O),wa(e,t,u,a),u=Vn?Nl:0,!ue&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&hp(e,a,t);else if(e.tag===19)hp(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(h){case"forwards":for(a=t.child,h=null;a!==null;)e=a.alternate,e!==null&&Do(e)===null&&(h=a),a=a.sibling;a=h,a===null?(h=t.child,t.child=null):(h=a.sibling,a.sibling=null),ed(t,!1,h,a,w,u);break;case"backwards":case"unstable_legacy-backwards":for(a=null,h=t.child,t.child=null;h!==null;){if(e=h.alternate,e!==null&&Do(e)===null){t.child=h;break}e=h.sibling,h.sibling=a,a=h,h=e}ed(t,!0,a,null,w,u);break;case"together":ed(t,!1,null,null,void 0,u);break;default:t.memoizedState=null}return t.child}function Bl(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),me|=t.lanes,(a&t.childLanes)===0)if(e!==null){if($a(e,t,a,!1),(a&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(s(153));if(t.child!==null){for(e=t.child,a=lr(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=lr(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function td(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&bo(e)))}function Sh(e,t,a){switch(t.tag){case 3:_e(t,t.stateNode.containerInfo),Al(t,Li,e.memoizedState.cache),mc();break;case 27:case 5:De(t);break;case 4:_e(t,t.stateNode.containerInfo);break;case 10:Al(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Ui(t),null;break;case 13:var u=t.memoizedState;if(u!==null)return u.dehydrated!==null?(Yi(t),t.flags|=128,null):(a&t.child.childLanes)!==0?ff(e,t,a):(Yi(t),e=Bl(e,t,a),e!==null?e.sibling:null);Yi(t);break;case 19:var h=(e.flags&128)!==0;if(u=(a&t.childLanes)!==0,u||($a(e,t,a,!1),u=(a&t.childLanes)!==0),h){if(u)return hf(e,t,a);t.flags|=128}if(h=t.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),V(si,si.current),u)break;return null;case 22:return t.lanes=0,Os(e,t,a,t.pendingProps);case 24:Al(t,Li,e.memoizedState.cache)}return Bl(e,t,a)}function gp(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps)aa=!0;else{if(!td(e,a)&&(t.flags&128)===0)return aa=!1,Sh(e,t,a);aa=(e.flags&131072)!==0}else aa=!1,Vn&&(t.flags&1048576)!==0&&tu(t,Nl,t.index);switch(t.lanes=0,t.tag){case 16:e:{var u=t.pendingProps;if(e=et(t.elementType),t.type=e,typeof e=="function")Lc(e)?(u=jc(e,u),t.tag=1,t=cf(null,t,e,u,a)):(t.tag=0,t=Ju(null,t,e,u,a));else{if(e!=null){var h=e.$$typeof;if(h===q){t.tag=11,t=Pd(null,t,e,u,a);break e}else if(h===Y){t.tag=14,t=up(null,t,e,u,a);break e}}throw t=G(e)||e,Error(s(306,t,""))}}return t;case 0:return Ju(e,t,t.type,t.pendingProps,a);case 1:return u=t.type,h=jc(u,t.pendingProps),cf(e,t,u,h,a);case 3:e:{if(_e(t,t.stateNode.containerInfo),e===null)throw Error(s(387));u=t.pendingProps;var w=t.memoizedState;h=w.element,ar(e,t),Dr(t,u,null,a);var O=t.memoizedState;if(u=O.cache,Al(t,Li,u),u!==w.cache&&Er(t,[Li],a,!0),$i(),u=O.element,w.isDehydrated)if(w={element:u,isDehydrated:!1,cache:O.cache},t.updateQueue.baseState=w,t.memoizedState=w,t.flags&256){t=pp(e,t,u,a);break e}else if(u!==h){h=js(Error(s(424)),t),Bc(h),t=pp(e,t,u,a);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Ar=dc(e.firstChild),cr=t,Vn=!0,ia=null,Qr=!0,a=Pn(t,null,u,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(mc(),u===h){t=Bl(e,t,a);break e}wa(e,t,u,a)}t=t.child}return t;case 26:return Ml(e,t),e===null?(a=U0(t.type,null,t.pendingProps,null))?t.memoizedState=a:Vn||(a=t.type,e=t.pendingProps,u=Ap(Te.current).createElement(a),u[yn]=t,u[$n]=e,zs(u,a,e),Gn(u),t.stateNode=u):t.memoizedState=U0(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return De(t),e===null&&Vn&&(u=t.stateNode=M0(t.type,t.pendingProps,Te.current),cr=t,Qr=!0,h=Ar,_u(t.type)?(Eh=h,Ar=dc(u.firstChild)):Ar=h),wa(e,t,t.pendingProps.children,a),Ml(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Vn&&((h=u=Ar)&&(u=fm(u,t.type,t.pendingProps,Qr),u!==null?(t.stateNode=u,cr=t,Ar=dc(u.firstChild),Qr=!1,h=!0):h=!1),h||ma(t)),De(t),h=t.type,w=t.pendingProps,O=e!==null?e.memoizedProps:null,u=w.children,Mh(h,w)?u=null:O!==null&&Mh(h,O)&&(t.flags|=32),t.memoizedState!==null&&(h=fl(e,t,Hu,null,null,a),Df._currentValue=h),Ml(e,t),wa(e,t,u,a),t.child;case 6:return e===null&&Vn&&((e=a=Ar)&&(a=pm(a,t.pendingProps,Qr),a!==null?(t.stateNode=a,cr=t,Ar=null,e=!0):e=!1),e||ma(t)),null;case 13:return ff(e,t,a);case 4:return _e(t,t.stateNode.containerInfo),u=t.pendingProps,e===null?t.child=zr(t,null,u,a):wa(e,t,u,a),t.child;case 11:return Pd(e,t,t.type,t.pendingProps,a);case 7:return wa(e,t,t.pendingProps,a),t.child;case 8:return wa(e,t,t.pendingProps.children,a),t.child;case 12:return wa(e,t,t.pendingProps.children,a),t.child;case 10:return u=t.pendingProps,Al(t,t.type,u.value),wa(e,t,u.children,a),t.child;case 9:return h=t.type._context,u=t.pendingProps.children,Zl(t),h=ra(h),u=u(h),t.flags|=1,wa(e,t,u,a),t.child;case 14:return up(e,t,t.type,t.pendingProps,a);case 15:return dp(e,t,t.type,t.pendingProps,a);case 19:return hf(e,t,a);case 31:return fp(e,t,a);case 22:return Os(e,t,a,t.pendingProps);case 24:return Zl(t),u=ra(Li),e===null?(h=ce(),h===null&&(h=B,w=_o(),h.pooledCache=w,w.refCount++,w!==null&&(h.pooledCacheLanes|=a),h=w),t.memoizedState={parent:u,cache:h},Kt(t),Al(t,Li,h)):((e.lanes&a)!==0&&(ar(e,t),Dr(t,null,null,a),$i()),h=e.memoizedState,w=t.memoizedState,h.parent!==u?(h={parent:u,cache:u},t.memoizedState=h,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=h),Al(t,Li,u)):(u=w.cache,Al(t,Li,u),u!==h.cache&&Er(t,[Li],a,!0))),wa(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function Ol(e){e.flags|=4}function lu(e,t,a,u,h){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(h&335544128)===h)if(e.stateNode.complete)e.flags|=8192;else if(nl())e.flags|=8192;else throw yt=He,Ee}else e.flags&=-16777217}function _d(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!H0(t))if(nl())e.flags|=8192;else throw yt=He,Ee}function uc(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Cr():536870912,e.lanes|=t,Ue|=t)}function nd(e,t){if(!Vn)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function er(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,u=0;if(t)for(var h=e.child;h!==null;)a|=h.lanes|h.childLanes,u|=h.subtreeFlags&65011712,u|=h.flags&65011712,h.return=e,h=h.sibling;else for(h=e.child;h!==null;)a|=h.lanes|h.childLanes,u|=h.subtreeFlags,u|=h.flags,h.return=e,h=h.sibling;return e.subtreeFlags|=u,e.childLanes=a,t}function id(e,t,a){var u=t.pendingProps;switch(Cs(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return er(t),null;case 1:return er(t),null;case 3:return a=t.stateNode,u=null,e!==null&&(u=e.memoizedState.cache),t.memoizedState.cache!==u&&(t.flags|=2048),Ns(Li),ve(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(_r(t)?Ol(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,yu())),er(t),null;case 26:var h=t.type,w=t.memoizedState;return e===null?(Ol(t),w!==null?(er(t),_d(t,w)):(er(t),lu(t,h,null,u,a))):w?w!==e.memoizedState?(Ol(t),er(t),_d(t,w)):(er(t),t.flags&=-16777217):(e=e.memoizedProps,e!==u&&Ol(t),er(t),lu(t,h,e,u,a)),null;case 27:if(Xe(t),a=Te.current,h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==u&&Ol(t);else{if(!u){if(t.stateNode===null)throw Error(s(166));return er(t),null}e=W.current,_r(t)?Mc(t):(e=M0(h,u,a),t.stateNode=e,Ol(t))}return er(t),null;case 5:if(Xe(t),h=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==u&&Ol(t);else{if(!u){if(t.stateNode===null)throw Error(s(166));return er(t),null}if(w=W.current,_r(t))Mc(t);else{var O=Ap(Te.current);switch(w){case 1:w=O.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:w=O.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":w=O.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":w=O.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":w=O.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof u.is=="string"?O.createElement("select",{is:u.is}):O.createElement("select"),u.multiple?w.multiple=!0:u.size&&(w.size=u.size);break;default:w=typeof u.is=="string"?O.createElement(h,{is:u.is}):O.createElement(h)}}w[yn]=t,w[$n]=u;e:for(O=t.child;O!==null;){if(O.tag===5||O.tag===6)w.appendChild(O.stateNode);else if(O.tag!==4&&O.tag!==27&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===t)break e;for(;O.sibling===null;){if(O.return===null||O.return===t)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}t.stateNode=w;e:switch(zs(w,h,u),h){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Ol(t)}}return er(t),lu(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,a),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==u&&Ol(t);else{if(typeof u!="string"&&t.stateNode===null)throw Error(s(166));if(e=Te.current,_r(t)){if(e=t.stateNode,a=t.memoizedProps,u=null,h=cr,h!==null)switch(h.tag){case 27:case 5:u=h.memoizedProps}e[yn]=t,e=!!(e.nodeValue===a||u!==null&&u.suppressHydrationWarning===!0||C0(e.nodeValue,a)),e||ma(t,!0)}else e=Ap(e).createTextNode(u),e[yn]=t,t.stateNode=e}return er(t),null;case 31:if(a=t.memoizedState,e===null||e.memoizedState!==null){if(u=_r(t),a!==null){if(e===null){if(!u)throw Error(s(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(s(557));e[yn]=t}else mc(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;er(t),e=!1}else a=yu(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return t.flags&256?(jr(t),t):(jr(t),null);if((t.flags&128)!==0)throw Error(s(558))}return er(t),null;case 13:if(u=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(h=_r(t),u!==null&&u.dehydrated!==null){if(e===null){if(!h)throw Error(s(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));h[yn]=t}else mc(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;er(t),h=!1}else h=yu(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=h),h=!0;if(!h)return t.flags&256?(jr(t),t):(jr(t),null)}return jr(t),(t.flags&128)!==0?(t.lanes=a,t):(a=u!==null,e=e!==null&&e.memoizedState!==null,a&&(u=t.child,h=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(h=u.alternate.memoizedState.cachePool.pool),w=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(w=u.memoizedState.cachePool.pool),w!==h&&(u.flags|=2048)),a!==e&&a&&(t.child.flags|=8192),uc(t,t.updateQueue),er(t),null);case 4:return ve(),e===null&&_h(t.stateNode.containerInfo),er(t),null;case 10:return Ns(t.type),er(t),null;case 19:if(A(si),u=t.memoizedState,u===null)return er(t),null;if(h=(t.flags&128)!==0,w=u.rendering,w===null)if(h)nd(u,!1);else{if(ge!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(w=Do(e),w!==null){for(t.flags|=128,nd(u,!1),e=w.updateQueue,t.updateQueue=e,uc(t,e),t.subtreeFlags=0,e=a,a=t.child;a!==null;)Zr(a,e),a=a.sibling;return V(si,si.current&1|2),Vn&&_a(t,u.treeForkCount),t.child}e=e.sibling}u.tail!==null&&kn()>sn&&(t.flags|=128,h=!0,nd(u,!1),t.lanes=4194304)}else{if(!h)if(e=Do(w),e!==null){if(t.flags|=128,h=!0,e=e.updateQueue,t.updateQueue=e,uc(t,e),nd(u,!0),u.tail===null&&u.tailMode==="hidden"&&!w.alternate&&!Vn)return er(t),null}else 2*kn()-u.renderingStartTime>sn&&a!==536870912&&(t.flags|=128,h=!0,nd(u,!1),t.lanes=4194304);u.isBackwards?(w.sibling=t.child,t.child=w):(e=u.last,e!==null?e.sibling=w:t.child=w,u.last=w)}return u.tail!==null?(e=u.tail,u.rendering=e,u.tail=e.sibling,u.renderingStartTime=kn(),e.sibling=null,a=si.current,V(si,h?a&1|2:a&1),Vn&&_a(t,u.treeForkCount),e):(er(t),null);case 22:case 23:return jr(t),Qi(),u=t.memoizedState!==null,e!==null?e.memoizedState!==null!==u&&(t.flags|=8192):u&&(t.flags|=8192),u?(a&536870912)!==0&&(t.flags&128)===0&&(er(t),t.subtreeFlags&6&&(t.flags|=8192)):er(t),a=t.updateQueue,a!==null&&uc(t,a.retryQueue),a=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),u=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(u=t.memoizedState.cachePool.pool),u!==a&&(t.flags|=2048),e!==null&&A(oe),null;case 24:return a=null,e!==null&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Ns(Li),er(t),null;case 25:return null;case 30:return null}throw Error(s(156,t.tag))}function gf(e,t){switch(Cs(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ns(Li),ve(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Xe(t),null;case 31:if(t.memoizedState!==null){if(jr(t),t.alternate===null)throw Error(s(340));mc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(jr(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(s(340));mc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return A(si),null;case 4:return ve(),null;case 10:return Ns(t.type),null;case 22:case 23:return jr(t),Qi(),e!==null&&A(oe),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ns(Li),null;case 25:return null;default:return null}}function Dd(e,t){switch(Cs(t),t.tag){case 3:Ns(Li),ve();break;case 26:case 27:case 5:Xe(t);break;case 4:ve();break;case 31:t.memoizedState!==null&&jr(t);break;case 13:jr(t);break;case 19:A(si);break;case 10:Ns(t.type);break;case 22:case 23:jr(t),Qi(),e!==null&&A(oe);break;case 24:Ns(Li)}}function cu(e,t){try{var a=t.updateQueue,u=a!==null?a.lastEffect:null;if(u!==null){var h=u.next;a=h;do{if((a.tag&e)===e){u=void 0;var w=a.create,O=a.inst;u=w(),O.destroy=u}a=a.next}while(a!==h)}}catch(ue){Lr(t,t.return,ue)}}function Io(e,t,a){try{var u=t.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var w=h.next;u=w;do{if((u.tag&e)===e){var O=u.inst,ue=O.destroy;if(ue!==void 0){O.destroy=void 0,h=t;var Fe=a,rt=ue;try{rt()}catch(St){Lr(h,Fe,St)}}}u=u.next}while(u!==w)}}catch(St){Lr(t,t.return,St)}}function yf(e){var t=e.updateQueue;if(t!==null){var a=e.stateNode;try{Sr(t,a)}catch(u){Lr(e,e.return,u)}}}function xf(e,t,a){a.props=jc(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(u){Lr(e,t,u)}}function rd(e,t){try{var a=e.ref;if(a!==null){switch(e.tag){case 26:case 27:case 5:var u=e.stateNode;break;case 30:u=e.stateNode;break;default:u=e.stateNode}typeof a=="function"?e.refCleanup=a(u):a.current=u}}catch(h){Lr(e,t,h)}}function Ul(e,t){var a=e.ref,u=e.refCleanup;if(a!==null)if(typeof u=="function")try{u()}catch(h){Lr(e,t,h)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(h){Lr(e,t,h)}else a.current=null}function yp(e){var t=e.type,a=e.memoizedProps,u=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&u.focus();break e;case"img":a.src?u.src=a.src:a.srcSet&&(u.srcset=a.srcSet)}}catch(h){Lr(e,e.return,h)}}function Rd(e,t,a){try{var u=e.stateNode;am(u,e.type,a,t),u[$n]=t}catch(h){Lr(e,e.return,h)}}function mf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&_u(e.type)||e.tag===4}function ku(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||mf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&_u(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fl(e,t,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(e,t):(t=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,t.appendChild(e),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=pr));else if(u!==4&&(u===27&&_u(e.type)&&(a=e.stateNode,t=null),e=e.child,e!==null))for(Fl(e,t,a),e=e.sibling;e!==null;)Fl(e,t,a),e=e.sibling}function Au(e,t,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(u!==4&&(u===27&&_u(e.type)&&(a=e.stateNode),e=e.child,e!==null))for(Au(e,t,a),e=e.sibling;e!==null;)Au(e,t,a),e=e.sibling}function xp(e){var t=e.stateNode,a=e.memoizedProps;try{for(var u=e.type,h=t.attributes;h.length;)t.removeAttributeNode(h[0]);zs(t,u,a),t[yn]=e,t[$n]=a}catch(w){Lr(e,e.return,w)}}var Cc=!1,sa=!1,Ld=!1,od=typeof WeakSet=="function"?WeakSet:Set,wo=null;function bf(e,t){if(e=e.containerInfo,Lh=Ip,e=jl(e),go(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var u=a.getSelection&&a.getSelection();if(u&&u.rangeCount!==0){a=u.anchorNode;var h=u.anchorOffset,w=u.focusNode;u=u.focusOffset;try{a.nodeType,w.nodeType}catch{a=null;break e}var O=0,ue=-1,Fe=-1,rt=0,St=0,Pt=e,ot=null;t:for(;;){for(var ft;Pt!==a||h!==0&&Pt.nodeType!==3||(ue=O+h),Pt!==w||u!==0&&Pt.nodeType!==3||(Fe=O+u),Pt.nodeType===3&&(O+=Pt.nodeValue.length),(ft=Pt.firstChild)!==null;)ot=Pt,Pt=ft;for(;;){if(Pt===e)break t;if(ot===a&&++rt===h&&(ue=O),ot===w&&++St===u&&(Fe=O),(ft=Pt.nextSibling)!==null)break;Pt=ot,ot=Pt.parentNode}Pt=ft}a=ue===-1||Fe===-1?null:{start:ue,end:Fe}}else a=null}a=a||{start:0,end:0}}else a=null;for(Ih={focusedElem:e,selectionRange:a},Ip=!1,wo=t;wo!==null;)if(t=wo,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,wo=e;else for(;wo!==null;){switch(t=wo,w=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(a=0;a<e.length;a++)h=e[a],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&w!==null){e=void 0,a=t,h=w.memoizedProps,w=w.memoizedState,u=a.stateNode;try{var Cn=jc(a.type,h);e=u.getSnapshotBeforeUpdate(Cn,w),u.__reactInternalSnapshotBeforeUpdate=e}catch(ni){Lr(a,a.return,ni)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,a=e.nodeType,a===9)Oh(e);else if(a===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Oh(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(s(163))}if(e=t.sibling,e!==null){e.return=t.return,wo=e;break}wo=t.return}}function Ec(e,t,a){var u=a.flags;switch(a.tag){case 0:case 11:case 15:El(e,a),u&4&&cu(5,a);break;case 1:if(El(e,a),u&4)if(e=a.stateNode,t===null)try{e.componentDidMount()}catch(O){Lr(a,a.return,O)}else{var h=jc(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(h,t,e.__reactInternalSnapshotBeforeUpdate)}catch(O){Lr(a,a.return,O)}}u&64&&yf(a),u&512&&rd(a,a.return);break;case 3:if(El(e,a),u&64&&(e=a.updateQueue,e!==null)){if(t=null,a.child!==null)switch(a.child.tag){case 27:case 5:t=a.child.stateNode;break;case 1:t=a.child.stateNode}try{Sr(e,t)}catch(O){Lr(a,a.return,O)}}break;case 27:t===null&&u&4&&xp(a);case 26:case 5:El(e,a),t===null&&u&4&&yp(a),u&512&&rd(a,a.return);break;case 12:El(e,a);break;case 31:El(e,a),u&4&&mp(e,a);break;case 13:El(e,a),u&4&&bp(e,a),u&64&&(e=a.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(a=Yx.bind(null,a),hm(e,a))));break;case 22:if(u=a.memoizedState!==null||Cc,!u){t=t!==null&&t.memoizedState!==null||sa,h=Cc;var w=sa;Cc=u,(sa=t)&&!w?kc(e,a,(a.subtreeFlags&8772)!==0):El(e,a),Cc=h,sa=w}break;case 30:break;default:El(e,a)}}function vf(e){var t=e.alternate;t!==null&&(e.alternate=null,vf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Ia(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var uo=null,Us=!1;function xl(e,t,a){for(a=a.child;a!==null;)ad(e,t,a),a=a.sibling}function ad(e,t,a){if(jt&&typeof jt.onCommitFiberUnmount=="function")try{jt.onCommitFiberUnmount(Vt,a)}catch{}switch(a.tag){case 26:sa||Ul(a,t),xl(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:sa||Ul(a,t);var u=uo,h=Us;_u(a.type)&&(uo=a.stateNode,Us=!1),xl(e,t,a),zf(a.stateNode),uo=u,Us=h;break;case 5:sa||Ul(a,t);case 6:if(u=uo,h=Us,uo=null,xl(e,t,a),uo=u,Us=h,uo!==null)if(Us)try{(uo.nodeType===9?uo.body:uo.nodeName==="HTML"?uo.ownerDocument.body:uo).removeChild(a.stateNode)}catch(w){Lr(a,t,w)}else try{uo.removeChild(a.stateNode)}catch(w){Lr(a,t,w)}break;case 18:uo!==null&&(Us?(e=uo,_0(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,a.stateNode),qd(e)):_0(uo,a.stateNode));break;case 4:u=uo,h=Us,uo=a.stateNode.containerInfo,Us=!0,xl(e,t,a),uo=u,Us=h;break;case 0:case 11:case 14:case 15:Io(2,a,t),sa||Io(4,a,t),xl(e,t,a);break;case 1:sa||(Ul(a,t),u=a.stateNode,typeof u.componentWillUnmount=="function"&&xf(a,t,u)),xl(e,t,a);break;case 21:xl(e,t,a);break;case 22:sa=(u=sa)||a.memoizedState!==null,xl(e,t,a),sa=u;break;default:xl(e,t,a)}}function mp(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{qd(e)}catch(a){Lr(t,t.return,a)}}}function bp(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{qd(e)}catch(a){Lr(t,t.return,a)}}function sd(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new od),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new od),t;default:throw Error(s(435,e.tag))}}function qc(e,t){var a=sd(e);t.forEach(function(u){if(!a.has(u)){a.add(u);var h=Xx.bind(null,e,u);u.then(h,h)}})}function Fs(e,t){var a=t.deletions;if(a!==null)for(var u=0;u<a.length;u++){var h=a[u],w=e,O=t,ue=O;e:for(;ue!==null;){switch(ue.tag){case 27:if(_u(ue.type)){uo=ue.stateNode,Us=!1;break e}break;case 5:uo=ue.stateNode,Us=!1;break e;case 3:case 4:uo=ue.stateNode.containerInfo,Us=!0;break e}ue=ue.return}if(uo===null)throw Error(s(160));ad(w,O,h),uo=null,Us=!1,w=h.alternate,w!==null&&(w.return=null),h.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Id(t,e),t=t.sibling}var ml=null;function Id(e,t){var a=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Fs(t,e),Es(e),u&4&&(Io(3,e,e.return),cu(3,e),Io(5,e,e.return));break;case 1:Fs(t,e),Es(e),u&512&&(sa||a===null||Ul(a,a.return)),u&64&&Cc&&(e=e.updateQueue,e!==null&&(u=e.callbacks,u!==null&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=a===null?u:a.concat(u))));break;case 26:var h=ml;if(Fs(t,e),Es(e),u&512&&(sa||a===null||Ul(a,a.return)),u&4){var w=a!==null?a.memoizedState:null;if(u=e.memoizedState,a===null)if(u===null)if(e.stateNode===null){e:{u=e.type,a=e.memoizedProps,h=h.ownerDocument||h;t:switch(u){case"title":w=h.getElementsByTagName("title")[0],(!w||w[Qa]||w[yn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=h.createElement(u),h.head.insertBefore(w,h.querySelector("head > title"))),zs(w,u,a),w[yn]=e,Gn(w),u=w;break e;case"link":var O=q0("link","href",h).get(u+(a.href||""));if(O){for(var ue=0;ue<O.length;ue++)if(w=O[ue],w.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&w.getAttribute("rel")===(a.rel==null?null:a.rel)&&w.getAttribute("title")===(a.title==null?null:a.title)&&w.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){O.splice(ue,1);break t}}w=h.createElement(u),zs(w,u,a),h.head.appendChild(w);break;case"meta":if(O=q0("meta","content",h).get(u+(a.content||""))){for(ue=0;ue<O.length;ue++)if(w=O[ue],w.getAttribute("content")===(a.content==null?null:""+a.content)&&w.getAttribute("name")===(a.name==null?null:a.name)&&w.getAttribute("property")===(a.property==null?null:a.property)&&w.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&w.getAttribute("charset")===(a.charSet==null?null:a.charSet)){O.splice(ue,1);break t}}w=h.createElement(u),zs(w,u,a),h.head.appendChild(w);break;default:throw Error(s(468,u))}w[yn]=e,Gn(w),u=w}e.stateNode=u}else V0(h,e.type,e.stateNode);else e.stateNode=E0(h,u,e.memoizedProps);else w!==u?(w===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):w.count--,u===null?V0(h,e.type,e.stateNode):E0(h,u,e.memoizedProps)):u===null&&e.stateNode!==null&&Rd(e,e.memoizedProps,a.memoizedProps)}break;case 27:Fs(t,e),Es(e),u&512&&(sa||a===null||Ul(a,a.return)),a!==null&&u&4&&Rd(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Fs(t,e),Es(e),u&512&&(sa||a===null||Ul(a,a.return)),e.flags&32){h=e.stateNode;try{ki(h,"")}catch(Cn){Lr(e,e.return,Cn)}}u&4&&e.stateNode!=null&&(h=e.memoizedProps,Rd(e,h,a!==null?a.memoizedProps:h)),u&1024&&(Ld=!0);break;case 6:if(Fs(t,e),Es(e),u&4){if(e.stateNode===null)throw Error(s(162));u=e.memoizedProps,a=e.stateNode;try{a.nodeValue=u}catch(Cn){Lr(e,e.return,Cn)}}break;case 3:if(_p=null,h=ml,ml=zp(t.containerInfo),Fs(t,e),ml=h,Es(e),u&4&&a!==null&&a.memoizedState.isDehydrated)try{qd(t.containerInfo)}catch(Cn){Lr(e,e.return,Cn)}Ld&&(Ld=!1,wf(e));break;case 4:u=ml,ml=zp(e.stateNode.containerInfo),Fs(t,e),Es(e),ml=u;break;case 12:Fs(t,e),Es(e);break;case 31:Fs(t,e),Es(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,qc(e,u)));break;case 13:Fs(t,e),Es(e),e.child.flags&8192&&e.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(Lt=kn()),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,qc(e,u)));break;case 22:h=e.memoizedState!==null;var Fe=a!==null&&a.memoizedState!==null,rt=Cc,St=sa;if(Cc=rt||h,sa=St||Fe,Fs(t,e),sa=St,Cc=rt,Es(e),u&8192)e:for(t=e.stateNode,t._visibility=h?t._visibility&-2:t._visibility|1,h&&(a===null||Fe||Cc||sa||Nc(e)),a=null,t=e;;){if(t.tag===5||t.tag===26){if(a===null){Fe=a=t;try{if(w=Fe.stateNode,h)O=w.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{ue=Fe.stateNode;var Pt=Fe.memoizedProps.style,ot=Pt!=null&&Pt.hasOwnProperty("display")?Pt.display:null;ue.style.display=ot==null||typeof ot=="boolean"?"":(""+ot).trim()}}catch(Cn){Lr(Fe,Fe.return,Cn)}}}else if(t.tag===6){if(a===null){Fe=t;try{Fe.stateNode.nodeValue=h?"":Fe.memoizedProps}catch(Cn){Lr(Fe,Fe.return,Cn)}}}else if(t.tag===18){if(a===null){Fe=t;try{var ft=Fe.stateNode;h?D0(ft,!0):D0(Fe.stateNode,!1)}catch(Cn){Lr(Fe,Fe.return,Cn)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}u&4&&(u=e.updateQueue,u!==null&&(a=u.retryQueue,a!==null&&(u.retryQueue=null,qc(e,a))));break;case 19:Fs(t,e),Es(e),u&4&&(u=e.updateQueue,u!==null&&(e.updateQueue=null,qc(e,u)));break;case 30:break;case 21:break;default:Fs(t,e),Es(e)}}function Es(e){var t=e.flags;if(t&2){try{for(var a,u=e.return;u!==null;){if(mf(u)){a=u;break}u=u.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var h=a.stateNode,w=ku(e);Au(e,w,h);break;case 5:var O=a.stateNode;a.flags&32&&(ki(O,""),a.flags&=-33);var ue=ku(e);Au(e,ue,O);break;case 3:case 4:var Fe=a.stateNode.containerInfo,rt=ku(e);Fl(e,rt,Fe);break;default:throw Error(s(161))}}catch(St){Lr(e,e.return,St)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function wf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;wf(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function El(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Ec(e,t.alternate,t),t=t.sibling}function Nc(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Io(4,t,t.return),Nc(t);break;case 1:Ul(t,t.return);var a=t.stateNode;typeof a.componentWillUnmount=="function"&&xf(t,t.return,a),Nc(t);break;case 27:zf(t.stateNode);case 26:case 5:Ul(t,t.return),Nc(t);break;case 22:t.memoizedState===null&&Nc(t);break;case 30:Nc(t);break;default:Nc(t)}e=e.sibling}}function kc(e,t,a){for(a=a&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var u=t.alternate,h=e,w=t,O=w.flags;switch(w.tag){case 0:case 11:case 15:kc(h,w,a),cu(4,w);break;case 1:if(kc(h,w,a),u=w,h=u.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(rt){Lr(u,u.return,rt)}if(u=w,h=u.updateQueue,h!==null){var ue=u.stateNode;try{var Fe=h.shared.hiddenCallbacks;if(Fe!==null)for(h.shared.hiddenCallbacks=null,h=0;h<Fe.length;h++)eo(Fe[h],ue)}catch(rt){Lr(u,u.return,rt)}}a&&O&64&&yf(w),rd(w,w.return);break;case 27:xp(w);case 26:case 5:kc(h,w,a),a&&u===null&&O&4&&yp(w),rd(w,w.return);break;case 12:kc(h,w,a);break;case 31:kc(h,w,a),a&&O&4&&mp(h,w);break;case 13:kc(h,w,a),a&&O&4&&bp(h,w);break;case 22:w.memoizedState===null&&kc(h,w,a),rd(w,w.return);break;case 30:break;default:kc(h,w,a)}t=t.sibling}}function Sf(e,t){var a=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(a=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==a&&(e!=null&&e.refCount++,a!=null&&oa(a))}function ql(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&oa(e))}function ps(e,t,a,u){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ld(e,t,a,u),t=t.sibling}function ld(e,t,a,u){var h=t.flags;switch(t.tag){case 0:case 11:case 15:ps(e,t,a,u),h&2048&&cu(9,t);break;case 1:ps(e,t,a,u);break;case 3:ps(e,t,a,u),h&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&oa(e)));break;case 12:if(h&2048){ps(e,t,a,u),e=t.stateNode;try{var w=t.memoizedProps,O=w.id,ue=w.onPostCommit;typeof ue=="function"&&ue(O,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(Fe){Lr(t,t.return,Fe)}}else ps(e,t,a,u);break;case 31:ps(e,t,a,u);break;case 13:ps(e,t,a,u);break;case 23:break;case 22:w=t.stateNode,O=t.alternate,t.memoizedState!==null?w._visibility&2?ps(e,t,a,u):cd(e,t):w._visibility&2?ps(e,t,a,u):(w._visibility|=2,zu(e,t,a,u,(t.subtreeFlags&10256)!==0||!1)),h&2048&&Sf(O,t);break;case 24:ps(e,t,a,u),h&2048&&ql(t.alternate,t);break;default:ps(e,t,a,u)}}function zu(e,t,a,u,h){for(h=h&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var w=e,O=t,ue=a,Fe=u,rt=O.flags;switch(O.tag){case 0:case 11:case 15:zu(w,O,ue,Fe,h),cu(8,O);break;case 23:break;case 22:var St=O.stateNode;O.memoizedState!==null?St._visibility&2?zu(w,O,ue,Fe,h):cd(w,O):(St._visibility|=2,zu(w,O,ue,Fe,h)),h&&rt&2048&&Sf(O.alternate,O);break;case 24:zu(w,O,ue,Fe,h),h&&rt&2048&&ql(O.alternate,O);break;default:zu(w,O,ue,Fe,h)}t=t.sibling}}function cd(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var a=e,u=t,h=u.flags;switch(u.tag){case 22:cd(a,u),h&2048&&Sf(u.alternate,u);break;case 24:cd(a,u),h&2048&&ql(u.alternate,u);break;default:cd(a,u)}t=t.sibling}}var uu=8192;function Vc(e,t,a){if(e.subtreeFlags&uu)for(e=e.child;e!==null;)jf(e,t,a),e=e.sibling}function jf(e,t,a){switch(e.tag){case 26:Vc(e,t,a),e.flags&uu&&e.memoizedState!==null&&Nm(a,ml,e.memoizedState,e.memoizedProps);break;case 5:Vc(e,t,a);break;case 3:case 4:var u=ml;ml=zp(e.stateNode.containerInfo),Vc(e,t,a),ml=u;break;case 22:e.memoizedState===null&&(u=e.alternate,u!==null&&u.memoizedState!==null?(u=uu,uu=16777216,Vc(e,t,a),uu=u):Vc(e,t,a));break;default:Vc(e,t,a)}}function Tf(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function nn(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var u=t[a];wo=u,vp(u,e)}Tf(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Cf(e),e=e.sibling}function Cf(e){switch(e.tag){case 0:case 11:case 15:nn(e),e.flags&2048&&Io(9,e,e.return);break;case 3:nn(e);break;case 12:nn(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Md(e)):nn(e);break;default:nn(e)}}function Md(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var a=0;a<t.length;a++){var u=t[a];wo=u,vp(u,e)}Tf(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Io(8,t,t.return),Md(t);break;case 22:a=t.stateNode,a._visibility&2&&(a._visibility&=-3,Md(t));break;default:Md(t)}e=e.sibling}}function vp(e,t){for(;wo!==null;){var a=wo;switch(a.tag){case 0:case 11:case 15:Io(8,a,t);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var u=a.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:oa(a.memoizedState.cache)}if(u=a.child,u!==null)u.return=a,wo=u;else e:for(a=e;wo!==null;){u=wo;var h=u.sibling,w=u.return;if(vf(u),u===a){wo=null;break e}if(h!==null){h.return=w,wo=h;break e}wo=w}}}var c={getCacheForType:function(e){var t=ra(Li),a=t.data.get(e);return a===void 0&&(a=e(),t.data.set(e,a)),a},cacheSignal:function(){return ra(Li).controller.signal}},x=typeof WeakMap=="function"?WeakMap:Map,z=0,B=null,K=null,ne=0,P=0,Ne=null,be=!1,Le=!1,Ie=!1,Ae=0,ge=0,me=0,Se=0,ze=0,Oe=0,Ue=0,Ze=null,pt=null,Ct=!1,Lt=0,dt=0,sn=1/0,Ge=null,Ye=null,Ve=0,ct=null,gt=null,Mt=0,an=0,_n=null,ti=null,Hn=0,Kn=null;function Zn(){return(z&2)!==0&&ne!==0?ne&-ne:te.T!==null?kh():Bt()}function On(){if(Oe===0)if((ne&536870912)===0||Vn){var e=Yt;Yt<<=1,(Yt&3932160)===0&&(Yt=262144),Oe=e}else Oe=536870912;return e=ji.current,e!==null&&(e.flags|=32),Oe}function Dt(e,t,a){(e===B&&(P===2||P===9)||e.cancelPendingCommit!==null)&&(Jn(e,0),tr(e,ne,Oe,!1)),Xt(e,a),((z&2)===0||e!==B)&&(e===B&&((z&2)===0&&(Se|=a),ge===4&&tr(e,ne,Oe,!1)),Hc(e))}function Mn(e,t,a){if((z&6)!==0)throw Error(s(327));var u=!a&&(t&127)===0&&(t&e.expiredLanes)===0||ir(e,t),h=u?Wx(e,t):jh(e,t,!0),w=u;do{if(h===0){Le&&!u&&tr(e,t,0,!1);break}else{if(a=e.current.alternate,w&&!fo(a)){h=jh(e,t,!1),w=!1;continue}if(h===2){if(w=t,e.errorRecoveryDisabledLanes&w)var O=0;else O=e.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){t=O;e:{var ue=e;h=Ze;var Fe=ue.current.memoizedState.isDehydrated;if(Fe&&(Jn(ue,O).flags|=256),O=jh(ue,O,!1),O!==2){if(Ie&&!Fe){ue.errorRecoveryDisabledLanes|=w,Se|=w,h=4;break e}w=pt,pt=h,w!==null&&(pt===null?pt=w:pt.push.apply(pt,w))}h=O}if(w=!1,h!==2)continue}}if(h===1){Jn(e,0),tr(e,t,0,!0);break}e:{switch(u=e,w=h,w){case 0:case 1:throw Error(s(345));case 4:if((t&4194048)!==t)break;case 6:tr(u,t,Oe,!be);break e;case 2:pt=null;break;case 3:case 5:break;default:throw Error(s(329))}if((t&62914560)===t&&(h=Lt+300-kn(),10<h)){if(tr(u,t,Oe,!be),bn(u,0,!0)!==0)break e;Mt=t,u.timeoutHandle=z0(gr.bind(null,u,a,pt,Ge,Ct,t,Oe,Se,Ue,be,w,"Throttled",-0,0),h);break e}gr(u,a,pt,Ge,Ct,t,Oe,Se,Ue,be,w,null,-0,0)}}break}while(!0);Hc(e)}function gr(e,t,a,u,h,w,O,ue,Fe,rt,St,Pt,ot,ft){if(e.timeoutHandle=-1,Pt=t.subtreeFlags,Pt&8192||(Pt&16785408)===16785408){Pt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:pr},jf(t,w,Pt);var Cn=(w&62914560)===w?Lt-kn():(w&4194048)===w?dt-kn():0;if(Cn=km(Pt,Cn),Cn!==null){Mt=w,e.cancelPendingCommit=Cn(s0.bind(null,e,t,w,a,u,h,O,ue,Fe,St,Pt,null,ot,ft)),tr(e,w,O,!rt);return}}s0(e,t,w,a,u,h,O,ue,Fe)}function fo(e){for(var t=e;;){var a=t.tag;if((a===0||a===11||a===15)&&t.flags&16384&&(a=t.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var u=0;u<a.length;u++){var h=a[u],w=h.getSnapshot;h=h.value;try{if(!Vo(w(),h))return!1}catch{return!1}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function tr(e,t,a,u){t&=~ze,t&=~Se,e.suspendedLanes|=t,e.pingedLanes&=~t,u&&(e.warmLanes|=t),u=e.expirationTimes;for(var h=t;0<h;){var w=31-tn(h),O=1<<w;u[w]=-1,h&=~O}a!==0&&Ti(e,a,t)}function So(){return(z&6)===0?(Nf(0),!1):!0}function Mo(){if(K!==null){if(P===0)var e=K.return;else e=K,el=ul=null,Ql(e),zt=null,wn=0,e=K;for(;e!==null;)Dd(e.alternate,e),e=e.return;K=null}}function Jn(e,t){var a=e.timeoutHandle;a!==-1&&(e.timeoutHandle=-1,cm(a)),a=e.cancelPendingCommit,a!==null&&(e.cancelPendingCommit=null,a()),Mt=0,Mo(),B=e,K=a=lr(e.current,null),ne=t,P=0,Ne=null,be=!1,Le=ir(e,t),Ie=!1,Ue=Oe=ze=Se=me=ge=0,pt=Ze=null,Ct=!1,(t&8)!==0&&(t|=t&32);var u=e.entangledLanes;if(u!==0)for(e=e.entanglements,u&=t;0<u;){var h=31-tn(u),w=1<<h;t|=e[h],u&=~w}return Ae=t,kr(),a}function bl(e,t){Bn=null,te.H=Sc,t===Pe||t===ke?(t=wt(),P=3):t===Ee?(t=wt(),P=4):P=t===Cu?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ne=t,K===null&&(ge=1,Cd(e,js(t,e.current)))}function nl(){var e=ji.current;return e===null?!0:(ne&4194048)===ne?yi===null:(ne&62914560)===ne||(ne&536870912)!==0?e===yi:!1}function n0(){var e=te.H;return te.H=Sc,e===null?Sc:e}function i0(){var e=te.A;return te.A=c,e}function wp(){ge=4,be||(ne&4194048)!==ne&&ji.current!==null||(Le=!0),(me&134217727)===0&&(Se&134217727)===0||B===null||tr(B,ne,Oe,!1)}function jh(e,t,a){var u=z;z|=2;var h=n0(),w=i0();(B!==e||ne!==t)&&(Ge=null,Jn(e,t)),t=!1;var O=ge;e:do try{if(P!==0&&K!==null){var ue=K,Fe=Ne;switch(P){case 8:Mo(),O=6;break e;case 3:case 2:case 9:case 6:ji.current===null&&(t=!0);var rt=P;if(P=0,Ne=null,Bd(e,ue,Fe,rt),a&&Le){O=0;break e}break;default:rt=P,P=0,Ne=null,Bd(e,ue,Fe,rt)}}Hx(),O=ge;break}catch(St){bl(e,St)}while(!0);return t&&e.shellSuspendCounter++,el=ul=null,z=u,te.H=h,te.A=w,K===null&&(B=null,ne=0,kr()),O}function Hx(){for(;K!==null;)r0(K)}function Wx(e,t){var a=z;z|=2;var u=n0(),h=i0();B!==e||ne!==t?(Ge=null,sn=kn()+500,Jn(e,t)):Le=ir(e,t);e:do try{if(P!==0&&K!==null){t=K;var w=Ne;t:switch(P){case 1:P=0,Ne=null,Bd(e,t,w,1);break;case 2:case 9:if(Je(w)){P=0,Ne=null,o0(t);break}t=function(){P!==2&&P!==9||B!==e||(P=7),Hc(e)},w.then(t,t);break e;case 3:P=7;break e;case 4:P=5;break e;case 7:Je(w)?(P=0,Ne=null,o0(t)):(P=0,Ne=null,Bd(e,t,w,7));break;case 5:var O=null;switch(K.tag){case 26:O=K.memoizedState;case 5:case 27:var ue=K;if(O?H0(O):ue.stateNode.complete){P=0,Ne=null;var Fe=ue.sibling;if(Fe!==null)K=Fe;else{var rt=ue.return;rt!==null?(K=rt,Sp(rt)):K=null}break t}}P=0,Ne=null,Bd(e,t,w,5);break;case 6:P=0,Ne=null,Bd(e,t,w,6);break;case 8:Mo(),ge=6;break e;default:throw Error(s(462))}}$x();break}catch(St){bl(e,St)}while(!0);return el=ul=null,te.H=u,te.A=h,z=a,K!==null?0:(B=null,ne=0,kr(),ge)}function $x(){for(;K!==null&&!dn();)r0(K)}function r0(e){var t=gp(e.alternate,e,Ae);e.memoizedProps=e.pendingProps,t===null?Sp(e):K=t}function o0(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=lf(a,t,t.pendingProps,t.type,void 0,ne);break;case 11:t=lf(a,t,t.pendingProps,t.type.render,t.ref,ne);break;case 5:Ql(t);default:Dd(a,t),t=K=Zr(t,Ae),t=gp(a,t,Ae)}e.memoizedProps=e.pendingProps,t===null?Sp(e):K=t}function Bd(e,t,a,u){el=ul=null,Ql(t),zt=null,wn=0;var h=t.return;try{if(zd(e,h,t,a,ne)){ge=1,Cd(e,js(a,e.current)),K=null;return}}catch(w){if(h!==null)throw K=h,w;ge=1,Cd(e,js(a,e.current)),K=null;return}t.flags&32768?(Vn||u===1?e=!0:Le||(ne&536870912)!==0?e=!1:(be=e=!0,(u===2||u===9||u===3||u===6)&&(u=ji.current,u!==null&&u.tag===13&&(u.flags|=16384))),a0(t,e)):Sp(t)}function Sp(e){var t=e;do{if((t.flags&32768)!==0){a0(t,be);return}e=t.return;var a=id(t.alternate,t,Ae);if(a!==null){K=a;return}if(t=t.sibling,t!==null){K=t;return}K=t=e}while(t!==null);ge===0&&(ge=5)}function a0(e,t){do{var a=gf(e.alternate,e);if(a!==null){a.flags&=32767,K=a;return}if(a=e.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&(e=e.sibling,e!==null)){K=e;return}K=e=a}while(e!==null);ge=6,K=null}function s0(e,t,a,u,h,w,O,ue,Fe){e.cancelPendingCommit=null;do jp();while(Ve!==0);if((z&6)!==0)throw Error(s(327));if(t!==null){if(t===e.current)throw Error(s(177));if(w=t.lanes|t.childLanes,w|=oi,mr(e,a,w,O,ue,Fe),e===B&&(K=B=null,ne=0),gt=t,ct=e,Mt=a,an=w,_n=h,ti=u,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Kx(lt,function(){return f0(),null})):(e.callbackNode=null,e.callbackPriority=0),u=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||u){u=te.T,te.T=null,h=de.p,de.p=2,O=z,z|=4;try{bf(e,t,a)}finally{z=O,de.p=h,te.T=u}}Ve=1,l0(),c0(),u0()}}function l0(){if(Ve===1){Ve=0;var e=ct,t=gt,a=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||a){a=te.T,te.T=null;var u=de.p;de.p=2;var h=z;z|=4;try{Id(t,e);var w=Ih,O=jl(e.containerInfo),ue=w.focusedElem,Fe=w.selectionRange;if(O!==ue&&ue&&ue.ownerDocument&&Sl(ue.ownerDocument.documentElement,ue)){if(Fe!==null&&go(ue)){var rt=Fe.start,St=Fe.end;if(St===void 0&&(St=rt),"selectionStart"in ue)ue.selectionStart=rt,ue.selectionEnd=Math.min(St,ue.value.length);else{var Pt=ue.ownerDocument||document,ot=Pt&&Pt.defaultView||window;if(ot.getSelection){var ft=ot.getSelection(),Cn=ue.textContent.length,ni=Math.min(Fe.start,Cn),Wr=Fe.end===void 0?ni:Math.min(Fe.end,Cn);!ft.extend&&ni>Wr&&(O=Wr,Wr=ni,ni=O);var Ke=Js(ue,ni),We=Js(ue,Wr);if(Ke&&We&&(ft.rangeCount!==1||ft.anchorNode!==Ke.node||ft.anchorOffset!==Ke.offset||ft.focusNode!==We.node||ft.focusOffset!==We.offset)){var nt=Pt.createRange();nt.setStart(Ke.node,Ke.offset),ft.removeAllRanges(),ni>Wr?(ft.addRange(nt),ft.extend(We.node,We.offset)):(nt.setEnd(We.node,We.offset),ft.addRange(nt))}}}}for(Pt=[],ft=ue;ft=ft.parentNode;)ft.nodeType===1&&Pt.push({element:ft,left:ft.scrollLeft,top:ft.scrollTop});for(typeof ue.focus=="function"&&ue.focus(),ue=0;ue<Pt.length;ue++){var Nt=Pt[ue];Nt.element.scrollLeft=Nt.left,Nt.element.scrollTop=Nt.top}}Ip=!!Lh,Ih=Lh=null}finally{z=h,de.p=u,te.T=a}}e.current=t,Ve=2}}function c0(){if(Ve===2){Ve=0;var e=ct,t=gt,a=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||a){a=te.T,te.T=null;var u=de.p;de.p=2;var h=z;z|=4;try{Ec(e,t.alternate,t)}finally{z=h,de.p=u,te.T=a}}Ve=3}}function u0(){if(Ve===4||Ve===3){Ve=0,rn();var e=ct,t=gt,a=Mt,u=ti;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ve=5:(Ve=0,gt=ct=null,d0(e,e.pendingLanes));var h=e.pendingLanes;if(h===0&&(Ye=null),tt(a),t=t.stateNode,jt&&typeof jt.onCommitFiberRoot=="function")try{jt.onCommitFiberRoot(Vt,t,void 0,(t.current.flags&128)===128)}catch{}if(u!==null){t=te.T,h=de.p,de.p=2,te.T=null;try{for(var w=e.onRecoverableError,O=0;O<u.length;O++){var ue=u[O];w(ue.value,{componentStack:ue.stack})}}finally{te.T=t,de.p=h}}(Mt&3)!==0&&jp(),Hc(e),h=e.pendingLanes,(a&261930)!==0&&(h&42)!==0?e===Kn?Hn++:(Hn=0,Kn=e):Hn=0,Nf(0)}}function d0(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,oa(t)))}function jp(){return l0(),c0(),u0(),f0()}function f0(){if(Ve!==5)return!1;var e=ct,t=an;an=0;var a=tt(Mt),u=te.T,h=de.p;try{de.p=32>a?32:a,te.T=null,a=_n,_n=null;var w=ct,O=Mt;if(Ve=0,gt=ct=null,Mt=0,(z&6)!==0)throw Error(s(331));var ue=z;if(z|=4,Cf(w.current),ld(w,w.current,O,a),z=ue,Nf(0,!1),jt&&typeof jt.onPostCommitFiberRoot=="function")try{jt.onPostCommitFiberRoot(Vt,w)}catch{}return!0}finally{de.p=h,te.T=u,d0(e,t)}}function p0(e,t,a){t=js(a,t),t=kd(e.stateNode,t,2),e=gi(e,t,2),e!==null&&(Xt(e,2),Hc(e))}function Lr(e,t,a){if(e.tag===3)p0(e,e,a);else for(;t!==null;){if(t.tag===3){p0(t,e,a);break}else if(t.tag===1){var u=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ye===null||!Ye.has(u))){e=js(a,e),a=Ad(2),u=gi(t,a,2),u!==null&&(Xu(a,u,t,e),Xt(u,2),Hc(u));break}}t=t.return}}function Th(e,t,a){var u=e.pingCache;if(u===null){u=e.pingCache=new x;var h=new Set;u.set(t,h)}else h=u.get(t),h===void 0&&(h=new Set,u.set(t,h));h.has(a)||(Ie=!0,h.add(a),e=Gx.bind(null,e,t,a),t.then(e,e))}function Gx(e,t,a){var u=e.pingCache;u!==null&&u.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,B===e&&(ne&a)===a&&(ge===4||ge===3&&(ne&62914560)===ne&&300>kn()-Lt?(z&2)===0&&Jn(e,0):ze|=a,Ue===ne&&(Ue=0)),Hc(e)}function h0(e,t){t===0&&(t=Cr()),e=al(e,t),e!==null&&(Xt(e,t),Hc(e))}function Yx(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),h0(e,a)}function Xx(e,t){var a=0;switch(e.tag){case 31:case 13:var u=e.stateNode,h=e.memoizedState;h!==null&&(a=h.retryLane);break;case 19:u=e.stateNode;break;case 22:u=e.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(t),h0(e,a)}function Kx(e,t){return Qe(e,t)}var Tp=null,Od=null,Ch=!1,Cp=!1,Nh=!1,Pu=0;function Hc(e){e!==Od&&e.next===null&&(Od===null?Tp=Od=e:Od=Od.next=e),Cp=!0,Ch||(Ch=!0,Jx())}function Nf(e,t){if(!Nh&&Cp){Nh=!0;do for(var a=!1,u=Tp;u!==null;){if(e!==0){var h=u.pendingLanes;if(h===0)var w=0;else{var O=u.suspendedLanes,ue=u.pingedLanes;w=(1<<31-tn(42|e)+1)-1,w&=h&~(O&~ue),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(a=!0,m0(u,w))}else w=ne,w=bn(u,u===B?w:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(w&3)===0||ir(u,w)||(a=!0,m0(u,w));u=u.next}while(a);Nh=!1}}function Zx(){g0()}function g0(){Cp=Ch=!1;var e=0;Pu!==0&&lm()&&(e=Pu);for(var t=kn(),a=null,u=Tp;u!==null;){var h=u.next,w=y0(u,t);w===0?(u.next=null,a===null?Tp=h:a.next=h,h===null&&(Od=a)):(a=u,(e!==0||(w&3)!==0)&&(Cp=!0)),u=h}Ve!==0&&Ve!==5||Nf(e),Pu!==0&&(Pu=0)}function y0(e,t){for(var a=e.suspendedLanes,u=e.pingedLanes,h=e.expirationTimes,w=e.pendingLanes&-62914561;0<w;){var O=31-tn(w),ue=1<<O,Fe=h[O];Fe===-1?((ue&a)===0||(ue&u)!==0)&&(h[O]=Dn(ue,t)):Fe<=t&&(e.expiredLanes|=ue),w&=~ue}if(t=B,a=ne,a=bn(e,e===t?a:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u=e.callbackNode,a===0||e===t&&(P===2||P===9)||e.cancelPendingCommit!==null)return u!==null&&u!==null&&$t(u),e.callbackNode=null,e.callbackPriority=0;if((a&3)===0||ir(e,a)){if(t=a&-a,t===e.callbackPriority)return t;switch(u!==null&&$t(u),tt(a)){case 2:case 8:a=fe;break;case 32:a=lt;break;case 268435456:a=$e;break;default:a=lt}return u=x0.bind(null,e),a=Qe(a,u),e.callbackPriority=t,e.callbackNode=a,t}return u!==null&&u!==null&&$t(u),e.callbackPriority=2,e.callbackNode=null,2}function x0(e,t){if(Ve!==0&&Ve!==5)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(jp()&&e.callbackNode!==a)return null;var u=ne;return u=bn(e,e===B?u:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),u===0?null:(Mn(e,u,t),y0(e,kn()),e.callbackNode!=null&&e.callbackNode===a?x0.bind(null,e):null)}function m0(e,t){if(jp())return null;Mn(e,t,!0)}function Jx(){um(function(){(z&6)!==0?Qe(Be,Zx):g0()})}function kh(){if(Pu===0){var e=f;e===0&&(e=_t,_t<<=1,(_t&261888)===0&&(_t=256)),Pu=e}return Pu}function b0(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:$r(""+e)}function v0(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function Qx(e,t,a,u,h){if(t==="submit"&&a&&a.stateNode===h){var w=b0((h[$n]||null).action),O=u.submitter;O&&(t=(t=O[$n]||null)?b0(t.formAction):O.getAttribute("formAction"),t!==null&&(w=t,O=null));var ue=new ri("action","action",null,u,h);e.push({event:ue,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Pu!==0){var Fe=O?v0(h,O):new FormData(h);of(a,{pending:!0,data:Fe,method:h.method,action:w},null,Fe)}}else typeof w=="function"&&(ue.preventDefault(),Fe=O?v0(h,O):new FormData(h),of(a,{pending:!0,data:Fe,method:h.method,action:w},w,Fe))},currentTarget:h}]})}}for(var Ah=0;Ah<xo.length;Ah++){var zh=xo[Ah],em=zh.toLowerCase(),tm=zh[0].toUpperCase()+zh.slice(1);Ao(em,"on"+tm)}Ao(xc,"onAnimationEnd"),Ao(Qc,"onAnimationIteration"),Ao(qu,"onAnimationStart"),Ao("dblclick","onDoubleClick"),Ao("focusin","onFocus"),Ao("focusout","onBlur"),Ao(Va,"onTransitionRun"),Ao(so,"onTransitionStart"),Ao(Cl,"onTransitionCancel"),Ao(ko,"onTransitionEnd"),Di("onMouseEnter",["mouseout","mouseover"]),Di("onMouseLeave",["mouseout","mouseover"]),Di("onPointerEnter",["pointerout","pointerover"]),Di("onPointerLeave",["pointerout","pointerover"]),Uo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Uo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Uo("onBeforeInput",["compositionend","keypress","textInput","paste"]),Uo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Uo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Uo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kf));function w0(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var u=e[a],h=u.event;u=u.listeners;e:{var w=void 0;if(t)for(var O=u.length-1;0<=O;O--){var ue=u[O],Fe=ue.instance,rt=ue.currentTarget;if(ue=ue.listener,Fe!==w&&h.isPropagationStopped())break e;w=ue,h.currentTarget=rt;try{w(h)}catch(St){Xr(St)}h.currentTarget=null,w=Fe}else for(O=0;O<u.length;O++){if(ue=u[O],Fe=ue.instance,rt=ue.currentTarget,ue=ue.listener,Fe!==w&&h.isPropagationStopped())break e;w=ue,h.currentTarget=rt;try{w(h)}catch(St){Xr(St)}h.currentTarget=null,w=Fe}}}}function Ei(e,t){var a=t[vi];a===void 0&&(a=t[vi]=new Set);var u=e+"__bubble";a.has(u)||(S0(t,e,2,!1),a.add(u))}function Ph(e,t,a){var u=0;t&&(u|=4),S0(a,e,u,t)}var Np="_reactListening"+Math.random().toString(36).slice(2);function _h(e){if(!e[Np]){e[Np]=!0,gs.forEach(function(a){a!=="selectionchange"&&(nm.has(a)||Ph(a,!1,e),Ph(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Np]||(t[Np]=!0,Ph("selectionchange",!1,t))}}function S0(e,t,a,u){switch(Z0(t)){case 2:var h=Pm;break;case 8:h=_m;break;default:h=$h}a=h.bind(null,t,a,e),h=void 0,!jn||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(h=!0),u?h!==void 0?e.addEventListener(t,a,{capture:!0,passive:h}):e.addEventListener(t,a,!0):h!==void 0?e.addEventListener(t,a,{passive:h}):e.addEventListener(t,a,!1)}function Dh(e,t,a,u,h){var w=u;if((t&1)===0&&(t&2)===0&&u!==null)e:for(;;){if(u===null)return;var O=u.tag;if(O===3||O===4){var ue=u.stateNode.containerInfo;if(ue===h)break;if(O===4)for(O=u.return;O!==null;){var Fe=O.tag;if((Fe===3||Fe===4)&&O.stateNode.containerInfo===h)return;O=O.return}for(;ue!==null;){if(O=Go(ue),O===null)return;if(Fe=O.tag,Fe===5||Fe===6||Fe===26||Fe===27){u=w=O;continue e}ue=ue.parentNode}}u=u.return}Oa(function(){var rt=w,St=Ba(a),Pt=[];e:{var ot=Ls.get(e);if(ot!==void 0){var ft=ri,Cn=e;switch(e){case"keypress":if(xn(a)===0)break e;case"keydown":case"keyup":ft=ci;break;case"focusin":Cn="focus",ft=vs;break;case"focusout":Cn="blur",ft=vs;break;case"beforeblur":case"afterblur":ft=vs;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ft=bs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ft=Xs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ft=wr;break;case xc:case Qc:case qu:ft=j;break;case ko:ft=Ki;break;case"scroll":case"scrollend":ft=Si;break;case"wheel":ft=Nr;break;case"copy":case"cut":case"paste":ft=pe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ft=Mi;break;case"toggle":case"beforetoggle":ft=pa}var ni=(t&4)!==0,Wr=!ni&&(e==="scroll"||e==="scrollend"),Ke=ni?ot!==null?ot+"Capture":null:ot;ni=[];for(var We=rt,nt;We!==null;){var Nt=We;if(nt=Nt.stateNode,Nt=Nt.tag,Nt!==5&&Nt!==26&&Nt!==27||nt===null||Ke===null||(Nt=ua(We,Ke),Nt!=null&&ni.push(Af(We,Nt,nt))),Wr)break;We=We.return}0<ni.length&&(ot=new ft(ot,Cn,null,a,St),Pt.push({event:ot,listeners:ni}))}}if((t&7)===0){e:{if(ot=e==="mouseover"||e==="pointerover",ft=e==="mouseout"||e==="pointerout",ot&&a!==ms&&(Cn=a.relatedTarget||a.fromElement)&&(Go(Cn)||Cn[li]))break e;if((ft||ot)&&(ot=St.window===St?St:(ot=St.ownerDocument)?ot.defaultView||ot.parentWindow:window,ft?(Cn=a.relatedTarget||a.toElement,ft=rt,Cn=Cn?Go(Cn):null,Cn!==null&&(Wr=d(Cn),ni=Cn.tag,Cn!==Wr||ni!==5&&ni!==27&&ni!==6)&&(Cn=null)):(ft=null,Cn=rt),ft!==Cn)){if(ni=bs,Nt="onMouseLeave",Ke="onMouseEnter",We="mouse",(e==="pointerout"||e==="pointerover")&&(ni=Mi,Nt="onPointerLeave",Ke="onPointerEnter",We="pointer"),Wr=ft==null?ot:di(ft),nt=Cn==null?ot:di(Cn),ot=new ni(Nt,We+"leave",ft,a,St),ot.target=Wr,ot.relatedTarget=nt,Nt=null,Go(St)===rt&&(ni=new ni(Ke,We+"enter",Cn,a,St),ni.target=nt,ni.relatedTarget=Wr,Nt=ni),Wr=Nt,ft&&Cn)t:{for(ni=im,Ke=ft,We=Cn,nt=0,Nt=Ke;Nt;Nt=ni(Nt))nt++;Nt=0;for(var Yn=We;Yn;Yn=ni(Yn))Nt++;for(;0<nt-Nt;)Ke=ni(Ke),nt--;for(;0<Nt-nt;)We=ni(We),Nt--;for(;nt--;){if(Ke===We||We!==null&&Ke===We.alternate){ni=Ke;break t}Ke=ni(Ke),We=ni(We)}ni=null}else ni=null;ft!==null&&j0(Pt,ot,ft,ni,!1),Cn!==null&&Wr!==null&&j0(Pt,Wr,Cn,ni,!0)}}e:{if(ot=rt?di(rt):window,ft=ot.nodeName&&ot.nodeName.toLowerCase(),ft==="select"||ft==="input"&&ot.type==="file")var yr=ao;else if(Ds(ot))if(qo)yr=Bi;else{yr=ei;var Rn=Kl}else ft=ot.nodeName,!ft||ft.toLowerCase()!=="input"||ot.type!=="checkbox"&&ot.type!=="radio"?rt&&xs(rt.elementType)&&(yr=ao):yr=Ss;if(yr&&(yr=yr(e,rt))){Pa(Pt,yr,a,St);break e}Rn&&Rn(e,ot,rt),e==="focusout"&&rt&&ot.type==="number"&&rt.memoizedProps.value!=null&&ca(ot,"number",ot.value)}switch(Rn=rt?di(rt):window,e){case"focusin":(Ds(Rn)||Rn.contentEditable==="true")&&(Ho=Rn,qa=rt,rr=null);break;case"focusout":rr=qa=Ho=null;break;case"mousedown":ss=!0;break;case"contextmenu":case"mouseup":case"dragend":ss=!1,Ri(Pt,a,St);break;case"selectionchange":if(Tl)break;case"keydown":case"keyup":Ri(Pt,a,St)}var Pi;if(Zo)e:{switch(e){case"compositionstart":var Xi="onCompositionStart";break e;case"compositionend":Xi="onCompositionEnd";break e;case"compositionupdate":Xi="onCompositionUpdate";break e}Xi=void 0}else Wi?ho(e,a)&&(Xi="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Xi="onCompositionStart");Xi&&(ha&&a.locale!=="ko"&&(Wi||Xi!=="onCompositionStart"?Xi==="onCompositionEnd"&&Wi&&(Pi=Ai()):(Eo=St,En="value"in Eo?Eo.value:Eo.textContent,Wi=!0)),Rn=kp(rt,Xi),0<Rn.length&&(Xi=new qe(Xi,e,null,a,St),Pt.push({event:Xi,listeners:Rn}),Pi?Xi.data=Pi:(Pi=rs(a),Pi!==null&&(Xi.data=Pi)))),(Pi=oo?Yr(e,a):wl(e,a))&&(Xi=kp(rt,"onBeforeInput"),0<Xi.length&&(Rn=new qe("onBeforeInput","beforeinput",null,a,St),Pt.push({event:Rn,listeners:Xi}),Rn.data=Pi)),Qx(Pt,e,rt,a,St)}w0(Pt,t)})}function Af(e,t,a){return{instance:e,listener:t,currentTarget:a}}function kp(e,t){for(var a=t+"Capture",u=[];e!==null;){var h=e,w=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||w===null||(h=ua(e,a),h!=null&&u.unshift(Af(e,h,w)),h=ua(e,t),h!=null&&u.push(Af(e,h,w))),e.tag===3)return u;e=e.return}return[]}function im(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function j0(e,t,a,u,h){for(var w=t._reactName,O=[];a!==null&&a!==u;){var ue=a,Fe=ue.alternate,rt=ue.stateNode;if(ue=ue.tag,Fe!==null&&Fe===u)break;ue!==5&&ue!==26&&ue!==27||rt===null||(Fe=rt,h?(rt=ua(a,w),rt!=null&&O.unshift(Af(a,rt,Fe))):h||(rt=ua(a,w),rt!=null&&O.push(Af(a,rt,Fe)))),a=a.return}O.length!==0&&e.push({event:t,listeners:O})}var rm=/\r\n?/g,om=/\u0000|\uFFFD/g;function T0(e){return(typeof e=="string"?e:""+e).replace(rm,`
`).replace(om,"")}function C0(e,t){return t=T0(t),T0(e)===t}function Hr(e,t,a,u,h,w){switch(a){case"children":typeof u=="string"?t==="body"||t==="textarea"&&u===""||ki(e,u):(typeof u=="number"||typeof u=="bigint")&&t!=="body"&&ki(e,""+u);break;case"className":Gs(e,"class",u);break;case"tabIndex":Gs(e,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Gs(e,a,u);break;case"style":Fo(e,u,w);break;case"data":if(t!=="object"){Gs(e,"data",u);break}case"src":case"href":if(u===""&&(t!=="a"||a!=="href")){e.removeAttribute(a);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(a);break}u=$r(""+u),e.setAttribute(a,u);break;case"action":case"formAction":if(typeof u=="function"){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(a==="formAction"?(t!=="input"&&Hr(e,t,"name",h.name,h,null),Hr(e,t,"formEncType",h.formEncType,h,null),Hr(e,t,"formMethod",h.formMethod,h,null),Hr(e,t,"formTarget",h.formTarget,h,null)):(Hr(e,t,"encType",h.encType,h,null),Hr(e,t,"method",h.method,h,null),Hr(e,t,"target",h.target,h,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){e.removeAttribute(a);break}u=$r(""+u),e.setAttribute(a,u);break;case"onClick":u!=null&&(e.onclick=pr);break;case"onScroll":u!=null&&Ei("scroll",e);break;case"onScrollEnd":u!=null&&Ei("scrollend",e);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(h.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"multiple":e.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":e.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){e.removeAttribute("xlink:href");break}a=$r(""+u),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,""+u):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":u===!0?e.setAttribute(a,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?e.setAttribute(a,u):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?e.setAttribute(a,u):e.removeAttribute(a);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?e.removeAttribute(a):e.setAttribute(a,u);break;case"popover":Ei("beforetoggle",e),Ei("toggle",e),Pr(e,"popover",u);break;case"xlinkActuate":br(e,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":br(e,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":br(e,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":br(e,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":br(e,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":br(e,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":br(e,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":br(e,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":br(e,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Pr(e,"is",u);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=Na.get(a)||a,Pr(e,a,u))}}function Rh(e,t,a,u,h,w){switch(a){case"style":Fo(e,u,w);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(h.children!=null)throw Error(s(60));e.innerHTML=a}}break;case"children":typeof u=="string"?ki(e,u):(typeof u=="number"||typeof u=="bigint")&&ki(e,""+u);break;case"onScroll":u!=null&&Ei("scroll",e);break;case"onScrollEnd":u!=null&&Ei("scrollend",e);break;case"onClick":u!=null&&(e.onclick=pr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!fi.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(h=a.endsWith("Capture"),t=a.slice(2,h?a.length-7:void 0),w=e[$n]||null,w=w!=null?w[a]:null,typeof w=="function"&&e.removeEventListener(t,w,h),typeof u=="function")){typeof w!="function"&&w!==null&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,u,h);break e}a in e?e[a]=u:u===!0?e.setAttribute(a,""):Pr(e,a,u)}}}function zs(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ei("error",e),Ei("load",e);var u=!1,h=!1,w;for(w in a)if(a.hasOwnProperty(w)){var O=a[w];if(O!=null)switch(w){case"src":u=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Hr(e,t,w,O,a,null)}}h&&Hr(e,t,"srcSet",a.srcSet,a,null),u&&Hr(e,t,"src",a.src,a,null);return;case"input":Ei("invalid",e);var ue=w=O=h=null,Fe=null,rt=null;for(u in a)if(a.hasOwnProperty(u)){var St=a[u];if(St!=null)switch(u){case"name":h=St;break;case"type":O=St;break;case"checked":Fe=St;break;case"defaultChecked":rt=St;break;case"value":w=St;break;case"defaultValue":ue=St;break;case"children":case"dangerouslySetInnerHTML":if(St!=null)throw Error(s(137,t));break;default:Hr(e,t,u,St,a,null)}}Yl(e,w,ue,Fe,rt,O,h,!1);return;case"select":Ei("invalid",e),u=O=w=null;for(h in a)if(a.hasOwnProperty(h)&&(ue=a[h],ue!=null))switch(h){case"value":w=ue;break;case"defaultValue":O=ue;break;case"multiple":u=ue;default:Hr(e,t,h,ue,a,null)}t=w,a=O,e.multiple=!!u,t!=null?fr(e,!!u,t,!1):a!=null&&fr(e,!!u,a,!0);return;case"textarea":Ei("invalid",e),w=h=u=null;for(O in a)if(a.hasOwnProperty(O)&&(ue=a[O],ue!=null))switch(O){case"value":u=ue;break;case"defaultValue":h=ue;break;case"children":w=ue;break;case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(91));break;default:Hr(e,t,O,ue,a,null)}Or(e,u,h,w);return;case"option":for(Fe in a)if(a.hasOwnProperty(Fe)&&(u=a[Fe],u!=null))switch(Fe){case"selected":e.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Hr(e,t,Fe,u,a,null)}return;case"dialog":Ei("beforetoggle",e),Ei("toggle",e),Ei("cancel",e),Ei("close",e);break;case"iframe":case"object":Ei("load",e);break;case"video":case"audio":for(u=0;u<kf.length;u++)Ei(kf[u],e);break;case"image":Ei("error",e),Ei("load",e);break;case"details":Ei("toggle",e);break;case"embed":case"source":case"link":Ei("error",e),Ei("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(rt in a)if(a.hasOwnProperty(rt)&&(u=a[rt],u!=null))switch(rt){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Hr(e,t,rt,u,a,null)}return;default:if(xs(t)){for(St in a)a.hasOwnProperty(St)&&(u=a[St],u!==void 0&&Rh(e,t,St,u,a,void 0));return}}for(ue in a)a.hasOwnProperty(ue)&&(u=a[ue],u!=null&&Hr(e,t,ue,u,a,null))}function am(e,t,a,u){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,w=null,O=null,ue=null,Fe=null,rt=null,St=null;for(ft in a){var Pt=a[ft];if(a.hasOwnProperty(ft)&&Pt!=null)switch(ft){case"checked":break;case"value":break;case"defaultValue":Fe=Pt;default:u.hasOwnProperty(ft)||Hr(e,t,ft,null,u,Pt)}}for(var ot in u){var ft=u[ot];if(Pt=a[ot],u.hasOwnProperty(ot)&&(ft!=null||Pt!=null))switch(ot){case"type":w=ft;break;case"name":h=ft;break;case"checked":rt=ft;break;case"defaultChecked":St=ft;break;case"value":O=ft;break;case"defaultValue":ue=ft;break;case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(s(137,t));break;default:ft!==Pt&&Hr(e,t,ot,ft,u,Pt)}}Yo(e,O,ue,Fe,rt,St,w,h);return;case"select":ft=O=ue=ot=null;for(w in a)if(Fe=a[w],a.hasOwnProperty(w)&&Fe!=null)switch(w){case"value":break;case"multiple":ft=Fe;default:u.hasOwnProperty(w)||Hr(e,t,w,null,u,Fe)}for(h in u)if(w=u[h],Fe=a[h],u.hasOwnProperty(h)&&(w!=null||Fe!=null))switch(h){case"value":ot=w;break;case"defaultValue":ue=w;break;case"multiple":O=w;default:w!==Fe&&Hr(e,t,h,w,u,Fe)}t=ue,a=O,u=ft,ot!=null?fr(e,!!a,ot,!1):!!u!=!!a&&(t!=null?fr(e,!!a,t,!0):fr(e,!!a,a?[]:"",!1));return;case"textarea":ft=ot=null;for(ue in a)if(h=a[ue],a.hasOwnProperty(ue)&&h!=null&&!u.hasOwnProperty(ue))switch(ue){case"value":break;case"children":break;default:Hr(e,t,ue,null,u,h)}for(O in u)if(h=u[O],w=a[O],u.hasOwnProperty(O)&&(h!=null||w!=null))switch(O){case"value":ot=h;break;case"defaultValue":ft=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(s(91));break;default:h!==w&&Hr(e,t,O,h,u,w)}Xl(e,ot,ft);return;case"option":for(var Cn in a)if(ot=a[Cn],a.hasOwnProperty(Cn)&&ot!=null&&!u.hasOwnProperty(Cn))switch(Cn){case"selected":e.selected=!1;break;default:Hr(e,t,Cn,null,u,ot)}for(Fe in u)if(ot=u[Fe],ft=a[Fe],u.hasOwnProperty(Fe)&&ot!==ft&&(ot!=null||ft!=null))switch(Fe){case"selected":e.selected=ot&&typeof ot!="function"&&typeof ot!="symbol";break;default:Hr(e,t,Fe,ot,u,ft)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ni in a)ot=a[ni],a.hasOwnProperty(ni)&&ot!=null&&!u.hasOwnProperty(ni)&&Hr(e,t,ni,null,u,ot);for(rt in u)if(ot=u[rt],ft=a[rt],u.hasOwnProperty(rt)&&ot!==ft&&(ot!=null||ft!=null))switch(rt){case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(s(137,t));break;default:Hr(e,t,rt,ot,u,ft)}return;default:if(xs(t)){for(var Wr in a)ot=a[Wr],a.hasOwnProperty(Wr)&&ot!==void 0&&!u.hasOwnProperty(Wr)&&Rh(e,t,Wr,void 0,u,ot);for(St in u)ot=u[St],ft=a[St],!u.hasOwnProperty(St)||ot===ft||ot===void 0&&ft===void 0||Rh(e,t,St,ot,u,ft);return}}for(var Ke in a)ot=a[Ke],a.hasOwnProperty(Ke)&&ot!=null&&!u.hasOwnProperty(Ke)&&Hr(e,t,Ke,null,u,ot);for(Pt in u)ot=u[Pt],ft=a[Pt],!u.hasOwnProperty(Pt)||ot===ft||ot==null&&ft==null||Hr(e,t,Pt,ot,u,ft)}function N0(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function sm(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,a=performance.getEntriesByType("resource"),u=0;u<a.length;u++){var h=a[u],w=h.transferSize,O=h.initiatorType,ue=h.duration;if(w&&ue&&N0(O)){for(O=0,ue=h.responseEnd,u+=1;u<a.length;u++){var Fe=a[u],rt=Fe.startTime;if(rt>ue)break;var St=Fe.transferSize,Pt=Fe.initiatorType;St&&N0(Pt)&&(Fe=Fe.responseEnd,O+=St*(Fe<ue?1:(ue-rt)/(Fe-rt)))}if(--u,t+=8*(w+O)/(h.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Lh=null,Ih=null;function Ap(e){return e.nodeType===9?e:e.ownerDocument}function k0(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function A0(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Mh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bh=null;function lm(){var e=window.event;return e&&e.type==="popstate"?e===Bh?!1:(Bh=e,!0):(Bh=null,!1)}var z0=typeof setTimeout=="function"?setTimeout:void 0,cm=typeof clearTimeout=="function"?clearTimeout:void 0,P0=typeof Promise=="function"?Promise:void 0,um=typeof queueMicrotask=="function"?queueMicrotask:typeof P0<"u"?function(e){return P0.resolve(null).then(e).catch(dm)}:z0;function dm(e){setTimeout(function(){throw e})}function _u(e){return e==="head"}function _0(e,t){var a=t,u=0;do{var h=a.nextSibling;if(e.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"||a==="/&"){if(u===0){e.removeChild(h),qd(t);return}u--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")u++;else if(a==="html")zf(e.ownerDocument.documentElement);else if(a==="head"){a=e.ownerDocument.head,zf(a);for(var w=a.firstChild;w;){var O=w.nextSibling,ue=w.nodeName;w[Qa]||ue==="SCRIPT"||ue==="STYLE"||ue==="LINK"&&w.rel.toLowerCase()==="stylesheet"||a.removeChild(w),w=O}}else a==="body"&&zf(e.ownerDocument.body);a=h}while(a);qd(t)}function D0(e,t){var a=e;e=0;do{var u=a.nextSibling;if(a.nodeType===1?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),u&&u.nodeType===8)if(a=u.data,a==="/$"){if(e===0)break;e--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||e++;a=u}while(a)}function Oh(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Oh(a),Ia(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}e.removeChild(a)}}function fm(e,t,a,u){for(;e.nodeType===1;){var h=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!u&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(u){if(!e[Qa])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(w=e.getAttribute("rel"),w==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(w!==h.rel||e.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||e.getAttribute("title")!==(h.title==null?null:h.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(w=e.getAttribute("src"),(w!==(h.src==null?null:h.src)||e.getAttribute("type")!==(h.type==null?null:h.type)||e.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&w&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var w=h.name==null?null:""+h.name;if(h.type==="hidden"&&e.getAttribute("name")===w)return e}else return e;if(e=dc(e.nextSibling),e===null)break}return null}function pm(e,t,a){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!a||(e=dc(e.nextSibling),e===null))return null;return e}function R0(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=dc(e.nextSibling),e===null))return null;return e}function Uh(e){return e.data==="$?"||e.data==="$~"}function Fh(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function hm(e,t){var a=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||a.readyState!=="loading")t();else{var u=function(){t(),a.removeEventListener("DOMContentLoaded",u)};a.addEventListener("DOMContentLoaded",u),e._reactRetry=u}}function dc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Eh=null;function L0(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"||a==="/&"){if(t===0)return dc(e.nextSibling);t--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||t++}e=e.nextSibling}return null}function I0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(t===0)return e;t--}else a!=="/$"&&a!=="/&"||t++}e=e.previousSibling}return null}function M0(e,t,a){switch(t=Ap(a),e){case"html":if(e=t.documentElement,!e)throw Error(s(452));return e;case"head":if(e=t.head,!e)throw Error(s(453));return e;case"body":if(e=t.body,!e)throw Error(s(454));return e;default:throw Error(s(451))}}function zf(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ia(e)}var fc=new Map,B0=new Set;function zp(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var du=de.d;de.d={f:gm,r:ym,D:xm,C:mm,L:bm,m:vm,X:Sm,S:wm,M:jm};function gm(){var e=du.f(),t=So();return e||t}function ym(e){var t=Ca(e);t!==null&&t.tag===5&&t.type==="form"?op(t):du.r(e)}var Ud=typeof document>"u"?null:document;function O0(e,t,a){var u=Ud;if(u&&typeof t=="string"&&t){var h=Vi(t);h='link[rel="'+e+'"][href="'+h+'"]',typeof a=="string"&&(h+='[crossorigin="'+a+'"]'),B0.has(h)||(B0.add(h),e={rel:e,crossOrigin:a,href:t},u.querySelector(h)===null&&(t=u.createElement("link"),zs(t,"link",e),Gn(t),u.head.appendChild(t)))}}function xm(e){du.D(e),O0("dns-prefetch",e,null)}function mm(e,t){du.C(e,t),O0("preconnect",e,t)}function bm(e,t,a){du.L(e,t,a);var u=Ud;if(u&&e&&t){var h='link[rel="preload"][as="'+Vi(t)+'"]';t==="image"&&a&&a.imageSrcSet?(h+='[imagesrcset="'+Vi(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(h+='[imagesizes="'+Vi(a.imageSizes)+'"]')):h+='[href="'+Vi(e)+'"]';var w=h;switch(t){case"style":w=Fd(e);break;case"script":w=Ed(e)}fc.has(w)||(e=D({rel:"preload",href:t==="image"&&a&&a.imageSrcSet?void 0:e,as:t},a),fc.set(w,e),u.querySelector(h)!==null||t==="style"&&u.querySelector(Pf(w))||t==="script"&&u.querySelector(_f(w))||(t=u.createElement("link"),zs(t,"link",e),Gn(t),u.head.appendChild(t)))}}function vm(e,t){du.m(e,t);var a=Ud;if(a&&e){var u=t&&typeof t.as=="string"?t.as:"script",h='link[rel="modulepreload"][as="'+Vi(u)+'"][href="'+Vi(e)+'"]',w=h;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Ed(e)}if(!fc.has(w)&&(e=D({rel:"modulepreload",href:e},t),fc.set(w,e),a.querySelector(h)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(_f(w)))return}u=a.createElement("link"),zs(u,"link",e),Gn(u),a.head.appendChild(u)}}}function wm(e,t,a){du.S(e,t,a);var u=Ud;if(u&&e){var h=To(u).hoistableStyles,w=Fd(e);t=t||"default";var O=h.get(w);if(!O){var ue={loading:0,preload:null};if(O=u.querySelector(Pf(w)))ue.loading=5;else{e=D({rel:"stylesheet",href:e,"data-precedence":t},a),(a=fc.get(w))&&qh(e,a);var Fe=O=u.createElement("link");Gn(Fe),zs(Fe,"link",e),Fe._p=new Promise(function(rt,St){Fe.onload=rt,Fe.onerror=St}),Fe.addEventListener("load",function(){ue.loading|=1}),Fe.addEventListener("error",function(){ue.loading|=2}),ue.loading|=4,Pp(O,t,u)}O={type:"stylesheet",instance:O,count:1,state:ue},h.set(w,O)}}}function Sm(e,t){du.X(e,t);var a=Ud;if(a&&e){var u=To(a).hoistableScripts,h=Ed(e),w=u.get(h);w||(w=a.querySelector(_f(h)),w||(e=D({src:e,async:!0},t),(t=fc.get(h))&&Vh(e,t),w=a.createElement("script"),Gn(w),zs(w,"link",e),a.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},u.set(h,w))}}function jm(e,t){du.M(e,t);var a=Ud;if(a&&e){var u=To(a).hoistableScripts,h=Ed(e),w=u.get(h);w||(w=a.querySelector(_f(h)),w||(e=D({src:e,async:!0,type:"module"},t),(t=fc.get(h))&&Vh(e,t),w=a.createElement("script"),Gn(w),zs(w,"link",e),a.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},u.set(h,w))}}function U0(e,t,a,u){var h=(h=Te.current)?zp(h):null;if(!h)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(t=Fd(a.href),a=To(h).hoistableStyles,u=a.get(t),u||(u={type:"style",instance:null,count:0,state:null},a.set(t,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){e=Fd(a.href);var w=To(h).hoistableStyles,O=w.get(e);if(O||(h=h.ownerDocument||h,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(e,O),(w=h.querySelector(Pf(e)))&&!w._p&&(O.instance=w,O.state.loading=5),fc.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},fc.set(e,a),w||Tm(h,e,a,O.state))),t&&u===null)throw Error(s(528,""));return O}if(t&&u!==null)throw Error(s(529,""));return null;case"script":return t=a.async,a=a.src,typeof a=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ed(a),a=To(h).hoistableScripts,u=a.get(t),u||(u={type:"script",instance:null,count:0,state:null},a.set(t,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Fd(e){return'href="'+Vi(e)+'"'}function Pf(e){return'link[rel="stylesheet"]['+e+"]"}function F0(e){return D({},e,{"data-precedence":e.precedence,precedence:null})}function Tm(e,t,a,u){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?u.loading=1:(t=e.createElement("link"),u.preload=t,t.addEventListener("load",function(){return u.loading|=1}),t.addEventListener("error",function(){return u.loading|=2}),zs(t,"link",a),Gn(t),e.head.appendChild(t))}function Ed(e){return'[src="'+Vi(e)+'"]'}function _f(e){return"script[async]"+e}function E0(e,t,a){if(t.count++,t.instance===null)switch(t.type){case"style":var u=e.querySelector('style[data-href~="'+Vi(a.href)+'"]');if(u)return t.instance=u,Gn(u),u;var h=D({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return u=(e.ownerDocument||e).createElement("style"),Gn(u),zs(u,"style",h),Pp(u,a.precedence,e),t.instance=u;case"stylesheet":h=Fd(a.href);var w=e.querySelector(Pf(h));if(w)return t.state.loading|=4,t.instance=w,Gn(w),w;u=F0(a),(h=fc.get(h))&&qh(u,h),w=(e.ownerDocument||e).createElement("link"),Gn(w);var O=w;return O._p=new Promise(function(ue,Fe){O.onload=ue,O.onerror=Fe}),zs(w,"link",u),t.state.loading|=4,Pp(w,a.precedence,e),t.instance=w;case"script":return w=Ed(a.src),(h=e.querySelector(_f(w)))?(t.instance=h,Gn(h),h):(u=a,(h=fc.get(w))&&(u=D({},a),Vh(u,h)),e=e.ownerDocument||e,h=e.createElement("script"),Gn(h),zs(h,"link",u),e.head.appendChild(h),t.instance=h);case"void":return null;default:throw Error(s(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(u=t.instance,t.state.loading|=4,Pp(u,a.precedence,e));return t.instance}function Pp(e,t,a){for(var u=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=u.length?u[u.length-1]:null,w=h,O=0;O<u.length;O++){var ue=u[O];if(ue.dataset.precedence===t)w=ue;else if(w!==h)break}w?w.parentNode.insertBefore(e,w.nextSibling):(t=a.nodeType===9?a.head:a,t.insertBefore(e,t.firstChild))}function qh(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Vh(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var _p=null;function q0(e,t,a){if(_p===null){var u=new Map,h=_p=new Map;h.set(a,u)}else h=_p,u=h.get(a),u||(u=new Map,h.set(a,u));if(u.has(e))return u;for(u.set(e,null),a=a.getElementsByTagName(e),h=0;h<a.length;h++){var w=a[h];if(!(w[Qa]||w[yn]||e==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var O=w.getAttribute(t)||"";O=e+O;var ue=u.get(O);ue?ue.push(w):u.set(O,[w])}}return u}function V0(e,t,a){e=e.ownerDocument||e,e.head.insertBefore(a,t==="title"?e.querySelector("head > title"):null)}function Cm(e,t,a){if(a===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function H0(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Nm(e,t,a,u){if(a.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var h=Fd(u.href),w=t.querySelector(Pf(h));if(w){t=w._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Dp.bind(e),t.then(e,e)),a.state.loading|=4,a.instance=w,Gn(w);return}w=t.ownerDocument||t,u=F0(u),(h=fc.get(h))&&qh(u,h),w=w.createElement("link"),Gn(w);var O=w;O._p=new Promise(function(ue,Fe){O.onload=ue,O.onerror=Fe}),zs(w,"link",u),a.instance=w}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(a,t),(t=a.state.preload)&&(a.state.loading&3)===0&&(e.count++,a=Dp.bind(e),t.addEventListener("load",a),t.addEventListener("error",a))}}var Hh=0;function km(e,t){return e.stylesheets&&e.count===0&&Lp(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var u=setTimeout(function(){if(e.stylesheets&&Lp(e,e.stylesheets),e.unsuspend){var w=e.unsuspend;e.unsuspend=null,w()}},6e4+t);0<e.imgBytes&&Hh===0&&(Hh=62500*sm());var h=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Lp(e,e.stylesheets),e.unsuspend)){var w=e.unsuspend;e.unsuspend=null,w()}},(e.imgBytes>Hh?50:800)+t);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(u),clearTimeout(h)}}:null}function Dp(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Lp(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Rp=null;function Lp(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Rp=new Map,t.forEach(Am,e),Rp=null,Dp.call(e))}function Am(e,t){if(!(t.state.loading&4)){var a=Rp.get(e);if(a)var u=a.get(null);else{a=new Map,Rp.set(e,a);for(var h=e.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<h.length;w++){var O=h[w];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(a.set(O.dataset.precedence,O),u=O)}u&&a.set(null,u)}h=t.instance,O=h.getAttribute("data-precedence"),w=a.get(O)||u,w===u&&a.set(null,h),a.set(O,h),this.count++,u=Dp.bind(this),h.addEventListener("load",u),h.addEventListener("error",u),w?w.parentNode.insertBefore(h,w.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(h,e.firstChild)),t.state.loading|=4}}var Df={$$typeof:E,Provider:null,Consumer:null,_currentValue:Ce,_currentValue2:Ce,_threadCount:0};function zm(e,t,a,u,h,w,O,ue,Fe){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Mr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mr(0),this.hiddenUpdates=Mr(null),this.identifierPrefix=u,this.onUncaughtError=h,this.onCaughtError=w,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Fe,this.incompleteTransitions=new Map}function W0(e,t,a,u,h,w,O,ue,Fe,rt,St,Pt){return e=new zm(e,t,a,O,Fe,rt,St,Pt,ue),t=1,w===!0&&(t|=24),w=Ci(3,null,null,t),e.current=w,w.stateNode=e,t=_o(),t.refCount++,e.pooledCache=t,t.refCount++,w.memoizedState={element:u,isDehydrated:a,cache:t},Kt(w),e}function $0(e){return e?(e=Fr,e):Fr}function G0(e,t,a,u,h,w){h=$0(h),u.context===null?u.context=h:u.pendingContext=h,u=Xn(t),u.payload={element:a},w=w===void 0?null:w,w!==null&&(u.callback=w),a=gi(e,u,t),a!==null&&(Dt(a,e,t),Ji(a,e,t))}function Y0(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function Wh(e,t){Y0(e,t),(e=e.alternate)&&Y0(e,t)}function X0(e){if(e.tag===13||e.tag===31){var t=al(e,67108864);t!==null&&Dt(t,e,67108864),Wh(e,67108864)}}function K0(e){if(e.tag===13||e.tag===31){var t=Zn();t=Ht(t);var a=al(e,t);a!==null&&Dt(a,e,t),Wh(e,t)}}var Ip=!0;function Pm(e,t,a,u){var h=te.T;te.T=null;var w=de.p;try{de.p=2,$h(e,t,a,u)}finally{de.p=w,te.T=h}}function _m(e,t,a,u){var h=te.T;te.T=null;var w=de.p;try{de.p=8,$h(e,t,a,u)}finally{de.p=w,te.T=h}}function $h(e,t,a,u){if(Ip){var h=Gh(u);if(h===null)Dh(e,t,u,Mp,a),J0(e,u);else if(Rm(h,e,t,a,u))u.stopPropagation();else if(J0(e,u),t&4&&-1<Dm.indexOf(e)){for(;h!==null;){var w=Ca(h);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var O=fn(w.pendingLanes);if(O!==0){var ue=w;for(ue.pendingLanes|=2,ue.entangledLanes|=2;O;){var Fe=1<<31-tn(O);ue.entanglements[1]|=Fe,O&=~Fe}Hc(w),(z&6)===0&&(sn=kn()+500,Nf(0))}}break;case 31:case 13:ue=al(w,2),ue!==null&&Dt(ue,w,2),So(),Wh(w,2)}if(w=Gh(u),w===null&&Dh(e,t,u,Mp,a),w===h)break;h=w}h!==null&&u.stopPropagation()}else Dh(e,t,u,null,a)}}function Gh(e){return e=Ba(e),Yh(e)}var Mp=null;function Yh(e){if(Mp=null,e=Go(e),e!==null){var t=d(e);if(t===null)e=null;else{var a=t.tag;if(a===13){if(e=v(t),e!==null)return e;e=null}else if(a===31){if(e=p(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Mp=e,null}function Z0(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Fn()){case Be:return 2;case fe:return 8;case lt:case it:return 32;case $e:return 268435456;default:return 32}default:return 32}}var Xh=!1,Du=null,Ru=null,Lu=null,Rf=new Map,Lf=new Map,Iu=[],Dm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function J0(e,t){switch(e){case"focusin":case"focusout":Du=null;break;case"dragenter":case"dragleave":Ru=null;break;case"mouseover":case"mouseout":Lu=null;break;case"pointerover":case"pointerout":Rf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lf.delete(t.pointerId)}}function If(e,t,a,u,h,w){return e===null||e.nativeEvent!==w?(e={blockedOn:t,domEventName:a,eventSystemFlags:u,nativeEvent:w,targetContainers:[h]},t!==null&&(t=Ca(t),t!==null&&X0(t)),e):(e.eventSystemFlags|=u,t=e.targetContainers,h!==null&&t.indexOf(h)===-1&&t.push(h),e)}function Rm(e,t,a,u,h){switch(t){case"focusin":return Du=If(Du,e,t,a,u,h),!0;case"dragenter":return Ru=If(Ru,e,t,a,u,h),!0;case"mouseover":return Lu=If(Lu,e,t,a,u,h),!0;case"pointerover":var w=h.pointerId;return Rf.set(w,If(Rf.get(w)||null,e,t,a,u,h)),!0;case"gotpointercapture":return w=h.pointerId,Lf.set(w,If(Lf.get(w)||null,e,t,a,u,h)),!0}return!1}function Q0(e){var t=Go(e.target);if(t!==null){var a=d(t);if(a!==null){if(t=a.tag,t===13){if(t=v(a),t!==null){e.blockedOn=t,pn(e.priority,function(){K0(a)});return}}else if(t===31){if(t=p(a),t!==null){e.blockedOn=t,pn(e.priority,function(){K0(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Bp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=Gh(e.nativeEvent);if(a===null){a=e.nativeEvent;var u=new a.constructor(a.type,a);ms=u,a.target.dispatchEvent(u),ms=null}else return t=Ca(a),t!==null&&X0(t),e.blockedOn=a,!1;t.shift()}return!0}function e1(e,t,a){Bp(e)&&a.delete(t)}function Lm(){Xh=!1,Du!==null&&Bp(Du)&&(Du=null),Ru!==null&&Bp(Ru)&&(Ru=null),Lu!==null&&Bp(Lu)&&(Lu=null),Rf.forEach(e1),Lf.forEach(e1)}function Op(e,t){e.blockedOn===t&&(e.blockedOn=null,Xh||(Xh=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Lm)))}var Up=null;function t1(e){Up!==e&&(Up=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Up===e&&(Up=null);for(var t=0;t<e.length;t+=3){var a=e[t],u=e[t+1],h=e[t+2];if(typeof u!="function"){if(Yh(u||a)===null)continue;break}var w=Ca(a);w!==null&&(e.splice(t,3),t-=3,of(w,{pending:!0,data:h,method:a.method,action:u},u,h))}}))}function qd(e){function t(Fe){return Op(Fe,e)}Du!==null&&Op(Du,e),Ru!==null&&Op(Ru,e),Lu!==null&&Op(Lu,e),Rf.forEach(t),Lf.forEach(t);for(var a=0;a<Iu.length;a++){var u=Iu[a];u.blockedOn===e&&(u.blockedOn=null)}for(;0<Iu.length&&(a=Iu[0],a.blockedOn===null);)Q0(a),a.blockedOn===null&&Iu.shift();if(a=(e.ownerDocument||e).$$reactFormReplay,a!=null)for(u=0;u<a.length;u+=3){var h=a[u],w=a[u+1],O=h[$n]||null;if(typeof w=="function")O||t1(a);else if(O){var ue=null;if(w&&w.hasAttribute("formAction")){if(h=w,O=w[$n]||null)ue=O.formAction;else if(Yh(h)!==null)continue}else ue=O.action;typeof ue=="function"?a[u+1]=ue:(a.splice(u,3),u-=3),t1(a)}}}function n1(){function e(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(O){return h=O})},focusReset:"manual",scroll:"manual"})}function t(){h!==null&&(h(),h=null),u||setTimeout(a,20)}function a(){if(!u&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,h=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){u=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),h!==null&&(h(),h=null)}}}function Kh(e){this._internalRoot=e}Fp.prototype.render=Kh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(s(409));var a=t.current,u=Zn();G0(a,u,e,t,null,null)},Fp.prototype.unmount=Kh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;G0(e.current,2,null,e,null,null),So(),t[li]=null}};function Fp(e){this._internalRoot=e}Fp.prototype.unstable_scheduleHydration=function(e){if(e){var t=Bt();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Iu.length&&t!==0&&t<Iu[a].priority;a++);Iu.splice(a,0,e),a===0&&Q0(e)}};var i1=r.version;if(i1!=="19.2.0")throw Error(s(527,i1,"19.2.0"));de.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(s(188)):(e=Object.keys(e).join(","),Error(s(268,e)));return e=m(t),e=e!==null?T(e):null,e=e===null?null:e.stateNode,e};var Im={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ep=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ep.isDisabled&&Ep.supportsFiber)try{Vt=Ep.inject(Im),jt=Ep}catch{}}return Bf.createRoot=function(e,t){if(!l(e))throw Error(s(299));var a=!1,u="",h=lp,w=cp,O=Tc;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(u=t.identifierPrefix),t.onUncaughtError!==void 0&&(h=t.onUncaughtError),t.onCaughtError!==void 0&&(w=t.onCaughtError),t.onRecoverableError!==void 0&&(O=t.onRecoverableError)),t=W0(e,1,!1,null,null,a,u,null,h,w,O,n1),e[li]=t.current,_h(e),new Kh(t)},Bf.hydrateRoot=function(e,t,a){if(!l(e))throw Error(s(299));var u=!1,h="",w=lp,O=cp,ue=Tc,Fe=null;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(w=a.onUncaughtError),a.onCaughtError!==void 0&&(O=a.onCaughtError),a.onRecoverableError!==void 0&&(ue=a.onRecoverableError),a.formState!==void 0&&(Fe=a.formState)),t=W0(e,1,!0,t,a??null,u,h,Fe,w,O,ue,n1),t.context=$0(null),a=t.current,u=Zn(),u=Ht(u),h=Xn(u),h.callback=null,gi(a,h,u),a=u,t.current.lanes=a,Xt(t,a),Hc(t),e[li]=t.current,_h(e),new Fp(t)},Bf.version="19.2.0",Bf}var p1;function $m(){if(p1)return Qh.exports;p1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(r){console.error(r)}}return n(),Qh.exports=Wm(),Qh.exports}var Gm=$m();/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Xm=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,o,s)=>s?s.toUpperCase():o.toLowerCase()),h1=n=>{const r=Xm(n);return r.charAt(0).toUpperCase()+r.slice(1)},Uy=(...n)=>n.filter((r,o,s)=>!!r&&r.trim()!==""&&s.indexOf(r)===o).join(" ").trim(),Km=n=>{for(const r in n)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Zm={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=I.forwardRef(({color:n="currentColor",size:r=24,strokeWidth:o=2,absoluteStrokeWidth:s,className:l="",children:d,iconNode:v,...p},b)=>I.createElement("svg",{ref:b,...Zm,width:r,height:r,stroke:n,strokeWidth:s?Number(o)*24/Number(r):o,className:Uy("lucide",l),...!d&&!Km(p)&&{"aria-hidden":"true"},...p},[...v.map(([m,T])=>I.createElement(m,T)),...Array.isArray(d)?d:[d]]));/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fy=(n,r)=>{const o=I.forwardRef(({className:s,...l},d)=>I.createElement(Jm,{ref:d,iconNode:r,className:Uy(`lucide-${Ym(h1(n))}`,`lucide-${n}`,s),...l}));return o.displayName=h1(n),o};/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],e2=Fy("mouse-pointer",Qm);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t2=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],n2=Fy("pen-line",t2),i2=JSON.parse('[{"category":"Capacitors","subcategory":"General","type":"Capacitor","displayName":"Capacitor","description":"General purpose capacitor","searchText":"capacitor general","designator":"C","defaultPins":2,"properties":{"capacitorType":"General"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"dielectric","label":"Dielectric","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Electrolytic","type":"Capacitor","displayName":"Electrolytic","description":"Electrolytic capacitor","searchText":"electrolytic capacitor","designator":"CE","defaultPins":2,"properties":{"capacitorType":"Electrolytic","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"20%","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"temperature","label":"Temperature Range","type":"string","required":false},{"name":"ripple","label":"Ripple Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Film","type":"Capacitor","displayName":"Film","description":"Film capacitor","searchText":"film capacitor","designator":"CF","defaultPins":2,"properties":{"capacitorType":"Film"},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"nF","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"10%","required":false},{"name":"filmType","label":"Film Type","type":"enum","enumValues":["Polyester","Polypropylene","Polyethylene","Polystyrene","Teflon"],"defaultValue":"Polyester","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Capacitors","subcategory":"Tantalum","type":"Capacitor","displayName":"Tantalum","description":"Tantalum capacitor","searchText":"tantalum capacitor","designator":"C","defaultPins":2,"properties":{"capacitorType":"Tantalum","dielectric":"Tantalum","polarized":true},"fields":[{"name":"capacitance","label":"Capacitance","type":"number","units":["pF","nF","F","mF","F"],"defaultUnit":"F","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"esr","label":"ESR","type":"number","units":["m",""],"defaultUnit":"","required":false},{"name":"leakageCurrent","label":"Leakage Current","type":"number","units":["A","mA"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Diodes","subcategory":"Standard","type":"Diode","displayName":"Diode","description":"Standard diode","searchText":"diode standard","designator":"D","defaultPins":2,"subtype":"Standard","properties":{"diodeType":"Standard","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Zener","type":"Diode","displayName":"Zener","description":"Zener diode","searchText":"zener diode","designator":"Z","defaultPins":2,"subtype":"Zener","properties":{"diodeType":"Zener","polarized":true},"fields":[{"name":"voltage","label":"Zener Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"mA","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"LED","type":"Diode","displayName":"LED","description":"LED diode","searchText":"led diode","designator":"LED","defaultPins":2,"subtype":"LED","properties":{"diodeType":"LED","polarized":true},"fields":[{"name":"voltage","label":"Forward Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Forward Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"ledColor","label":"Color","type":"string","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Schottky","type":"Diode","displayName":"Schottky","description":"Schottky diode","searchText":"schottky diode","designator":"D","defaultPins":2,"subtype":"Schottky","properties":{"diodeType":"Schottky","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Infrared","type":"Diode","displayName":"Infrared","description":"Infrared diode","searchText":"infrared diode","designator":"IR","defaultPins":2,"subtype":"Infrared","properties":{"diodeType":"Infrared","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["mA","A"],"defaultUnit":"mA","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Diodes","subcategory":"Photodiode","type":"Diode","displayName":"Photodiode","description":"Photodiode","searchText":"photodiode diode","designator":"PD","defaultPins":2,"subtype":"Photodiode","properties":{"diodeType":"Photodiode","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"wavelength","label":"Wavelength","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Standard","type":"Resistor","displayName":"Resistor","description":"Standard resistor","searchText":"resistor standard","designator":"R","defaultPins":2,"properties":{"resistorType":"Standard"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"tolerance","label":"Tolerance","type":"string","defaultValue":"5%","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Network","type":"Resistor","displayName":"Resistor Network","description":"Resistor network","searchText":"resistor network","designator":"RN","defaultPins":8,"properties":{"resistorType":"Network"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"configuration","label":"Configuration","type":"enum","enumValues":["Isolated","Bussed","Dual Terminator"],"defaultValue":"Isolated","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Thermistor","type":"Resistor","displayName":"Thermistor","description":"Thermistor resistor","searchText":"thermistor resistor","designator":"RT","defaultPins":2,"properties":{"resistorType":"Thermistor"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"thermistorType","label":"Thermistor Type","type":"enum","enumValues":["NTC","PTC"],"defaultValue":"NTC","required":false},{"name":"beta","label":"Beta Value","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Resistors","subcategory":"Variable","type":"Resistor","displayName":"Variable Resistor","description":"Variable resistor","searchText":"variable resistor","designator":"VR","defaultPins":3,"subtype":"Potentiometer","properties":{"resistorType":"Variable","vrType":"Potentiometer"},"fields":[{"name":"resistance","label":"Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"taper","label":"Taper","type":"enum","enumValues":["Linear","Logarithmic"],"defaultValue":"Linear","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Resistors","subcategory":"Varistor","type":"Resistor","displayName":"Varistor","description":"Varistor resistor","searchText":"varistor resistor","designator":"RV","defaultPins":3,"subtype":"Varistor","properties":{"resistorType":"Variable","vrType":"Varistor"},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"BJT","type":"Semiconductor","displayName":"Transistor, BJT NPN","description":"Bipolar Junction Transistor NPN (Collector, Base, Emitter)","searchText":"bjt transistor bipolar junction base emitter collector npn","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"BJT","pinNames":["Collector","Base","Emitter"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"BJT PNP","type":"Semiconductor","displayName":"Transistor, BJT PNP","description":"Bipolar Junction Transistor PNP (Emitter, Base, Collector)","searchText":"bjt transistor bipolar junction base emitter collector pnp","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"BJT","pinNames":["Emitter","Base","Collector"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"MOSFET","type":"Semiconductor","displayName":"Transistor, MOSFET, N-Channel","description":"Metal-Oxide-Semiconductor Field-Effect Transistor N-Channel (Source, Gate, Drain)","searchText":"mosfet transistor metal oxide semiconductor field effect source gate drain n-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"MOSFET","pinNames":["Source","Drain","Gate"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"MOSFET P-Channel","type":"Semiconductor","displayName":"Transistor, MOSFET, P-Channel","description":"Metal-Oxide-Semiconductor Field-Effect Transistor P-Channel (Source, Gate, Drain)","searchText":"mosfet transistor metal oxide semiconductor field effect source gate drain p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"MOSFET","pinNames":["Source","Drain","Gate"]},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"JFET","type":"Semiconductor","displayName":"Transistor, JFET","description":"Junction Field-Effect Transistor (Source, Gate, Drain)","searchText":"jfet transistor junction field effect source gate drain n-channel p-channel","designator":"Q","defaultPins":3,"properties":{"semiconductorType":"Transistor","transistorType":"JFET","pinNames":["Source","Gate","Drain"]},"fields":[{"name":"polarity","label":"Polarity","type":"enum","enumValues":["N-Channel","P-Channel"],"defaultValue":"N-Channel","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Single Op Amp","type":"Semiconductor","displayName":"Op Amp, Single","description":"Single operational amplifier","searchText":"single op amp operational amplifier opamp","designator":"U","defaultPins":5,"properties":{"semiconductorType":"OpAmp","pinNames":["V+","V-","input+","input-","output"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["SOT-23-5","SC70-5","Other"],"defaultValue":"SOT-23-5","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Dual Op Amp","type":"Semiconductor","displayName":"Op Amp, Dual","description":"Dual operational amplifier","searchText":"dual op amp operational amplifier opamp","designator":"U","defaultPins":8,"properties":{"semiconductorType":"OpAmp","pinNames":["Output 1","Input 1-","Input 1+","VEE / GND","Input 2+","Input 2-","Output 2","VCC / V+"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP-8","SOIC-8","DIP-14","SOIC-14","SOT-23-5","Other"],"defaultValue":"DIP-8","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Quad Op Amp","type":"Semiconductor","displayName":"Op Amp, Quad","description":"Quad operational amplifier","searchText":"quad op amp operational amplifier opamp","designator":"U","defaultPins":14,"properties":{"semiconductorType":"OpAmp","pinNames":["1OUT","1IN-","1IN+","VCC+","2IN+","2IN-","2OUT","3OUT","3IN-","3IN+","VCC-","4IN+","4IN-","4OUT"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP-14","SOIC-14","TSSOP-14","Other"],"defaultValue":"DIP-14","required":false},{"name":"voltage","label":"Supply Voltage","type":"number","units":["V","mV"],"defaultUnit":"V","required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false}]},{"category":"Semiconductors","subcategory":"Integrated Circuit","type":"Semiconductor","displayName":"Integrated Circuit","description":"Integrated circuit","searchText":"integrated circuit semiconductor ic","designator":"U","defaultPins":8,"fixedPinCount":false,"properties":{"semiconductorType":"IntegratedCircuit","pinNames":["CHIP_DEPENDENT"]},"fields":[{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"icType","label":"IC Type","type":"string","required":false},{"name":"packageType","label":"Package Type","type":"enum","enumValues":["DIP","SOIC","QFP","LQFP","TQFP","BGA","SSOP","TSOP","Various","Other"],"required":false},{"name":"description","label":"Description","type":"string","required":false},{"name":"datasheet","label":"Datasheet URL","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Passive Components","subcategory":"Inductor","type":"Inductor","displayName":"Inductor","description":"Inductor","searchText":"inductor","designator":"L","defaultPins":2,"properties":{"passiveType":"Inductor"},"fields":[{"name":"inductance","label":"Inductance","type":"number","units":["nH","H","mH","H"],"defaultUnit":"H","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"resistance","label":"DC Resistance","type":"number","units":["","m","k","M"],"defaultUnit":"","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Ferrite Bead","type":"FerriteBead","displayName":"Ferrite Bead","description":"Ferrite bead","searchText":"ferrite bead passive","designator":"FB","defaultPins":2,"properties":{"passiveType":"FerriteBead"},"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Passive Components","subcategory":"Crystal","type":"Crystal","displayName":"Crystal","description":"Crystal oscillator","searchText":"crystal oscillator passive","designator":"X","defaultPins":2,"properties":{"passiveType":"Crystal"},"fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"loadCapacitance","label":"Load Capacitance","type":"string","required":false},{"name":"tolerance","label":"Tolerance","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Battery","type":"PowerEnergy","displayName":"Battery","description":"Battery or battery holder","searchText":"battery power energy","designator":"B","defaultPins":2,"properties":{"powerType":"Battery","polarized":true},"fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"capacity","label":"Capacity","type":"number","units":["mAh","Ah"],"defaultUnit":"mAh","required":false},{"name":"chemistry","label":"Chemistry","type":"enum","enumValues":["Li-ion","Alkaline","NiMH","NiCd","Lead-acid"],"required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Power Supply","type":"PowerEnergy","displayName":"Power Supply","description":"Power supply","searchText":"power supply energy","designator":"PS","defaultPins":4,"properties":{"powerType":"PowerSupply"},"fields":[{"name":"inputVoltage","label":"Input Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"outputVoltage","label":"Output Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"efficiency","label":"Efficiency","type":"number","required":false},{"name":"ripple","label":"Ripple","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Power & Energy","subcategory":"Fuse","type":"PowerEnergy","displayName":"Fuse","description":"Fuse","searchText":"fuse power energy","designator":"F","defaultPins":2,"properties":{"powerType":"Fuse"},"fields":[{"name":"current","label":"Current Rating","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage Rating","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"fuseType","label":"Fuse Type","type":"enum","enumValues":["Fast-blow","Slow-blow","Time-delay"],"defaultValue":"Fast-blow","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"operatingTemperature","label":"Operating Temp","type":"string","required":false}]},{"category":"Connectors & Switches","subcategory":"Connector","type":"Connector","displayName":"Connector","description":"Connector","searchText":"connector","designator":"J","defaultPins":2,"properties":{"connectorType":"Connector"},"fields":[{"name":"connectorType","label":"Connector Type","type":"string","required":false},{"name":"gender","label":"Gender","type":"enum","enumValues":["Male","Female","N/A"],"defaultValue":"N/A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Jumper","type":"Jumper","displayName":"Jumper","description":"Jumper link","searchText":"jumper link","designator":"JP","defaultPins":2,"properties":{"connectorType":"Jumper"},"fields":[{"name":"positions","label":"Positions","type":"number","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Switch","type":"Switch","displayName":"Switch","description":"Switch","searchText":"switch","designator":"S","defaultPins":2,"properties":{"switchType":"Switch"},"fields":[{"name":"switchType","label":"Switch Type","type":"string","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Connectors & Switches","subcategory":"Relay","type":"Relay","displayName":"Relay","description":"Relay or contactor","searchText":"relay contactor","designator":"K","defaultPins":2,"properties":{"switchType":"Relay"},"fields":[{"name":"coilVoltage","label":"Coil Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"contactType","label":"Contact Type","type":"string","required":false},{"name":"current","label":"Contact Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false},{"name":"mountingType","label":"Mounting Type","type":"enum","enumValues":["Through-hole","SMD","Surface mount"],"required":false}]},{"category":"Other","subcategory":"Transformer","type":"Transformer","displayName":"Transformer","description":"Transformer","searchText":"transformer","designator":"TR","defaultPins":4,"fields":[{"name":"primaryVoltage","label":"Primary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"secondaryVoltage","label":"Secondary Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"turns","label":"Turns Ratio","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Speaker","type":"Speaker","displayName":"Speaker","description":"Loudspeaker or buzzer","searchText":"speaker loudspeaker buzzer","designator":"LS","defaultPins":2,"fields":[{"name":"impedance","label":"Impedance","type":"number","units":["","m","k"],"defaultUnit":"","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Motor","type":"Motor","displayName":"Motor","description":"Motor","searchText":"motor","designator":"M","defaultPins":2,"fields":[{"name":"motorType","label":"Motor Type","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Test Point","type":"TestPoint","displayName":"Test Point","description":"Test point","searchText":"test point","designator":"TP","defaultPins":1,"fields":[{"name":"signal","label":"Signal","type":"string","required":false}]},{"category":"Other","subcategory":"Vacuum Tube","type":"VacuumTube","displayName":"Vacuum Tube","description":"Vacuum tube","searchText":"vacuum tube","designator":"V","defaultPins":5,"fields":[{"name":"tubeType","label":"Tube Type","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Attenuator","type":"GenericComponent","displayName":"Attenuator","description":"Attenuator or isolator","searchText":"attenuator isolator component","designator":"AT","defaultPins":2,"subtype":"Attenuator","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Circuit Breaker","type":"GenericComponent","displayName":"Circuit Breaker","description":"Circuit breaker","searchText":"circuit breaker component","designator":"CB","defaultPins":2,"subtype":"CircuitBreaker","fields":[{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"current","label":"Current","type":"number","units":["A","mA","A"],"defaultUnit":"A","required":false},{"name":"power","label":"Power","type":"number","units":["W","mW","kW"],"defaultUnit":"W","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Thermocouple","type":"GenericComponent","displayName":"Thermocouple","description":"Thermocouple","searchText":"thermocouple component","designator":"TC","defaultPins":2,"subtype":"Thermocouple","fields":[{"name":"model","label":"Model","type":"string","required":false},{"name":"voltage","label":"Voltage","type":"number","units":["mV","V","kV"],"defaultUnit":"V","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]},{"category":"Other","subcategory":"Tuner","type":"GenericComponent","displayName":"Tuner","description":"Tuner","searchText":"tuner component","designator":"TUN","defaultPins":2,"subtype":"Tuner","fields":[{"name":"frequency","label":"Frequency","type":"string","required":false},{"name":"partNumber","label":"Part Number","type":"string","required":false},{"name":"manufacturer","label":"Manufacturer","type":"string","required":false}]}]'),dh={components:i2},r2=["#FFFFFF","#BFBFBF","#7F7F7F","#3C3C3C","#000000","#A6CEE3","#56B4E9","#17BECF","#00BFC4","#1F77B4","#0072B2","#332288","#B2DF8A","#B3DE69","#2CA02C","#009E73","#FFED6F","#F0E442","#BCBD22","#E69F00","#FF7F0E","#FB9A99","#F781BF","#E15759","#D62728","#CAB2D6","#CC79A7","#AA4499","#6A3D9A","#9467BD","#9C755F","#8C564B"],ig="#2CA02C",o2="#F0E442",a2="#00BFC4",rg="#000000",s2="#00008b",og="#FF0000",Xg={DEFAULT_SIZE:18},Vf={};dh.components.forEach(n=>{const r=n.type,o=n.designator;if(!Vf[r])Vf[r]={prefix:[o],defaultPins:n.defaultPins};else{const s=Vf[r],l=[...new Set([...s.prefix,o])];Vf[r]={prefix:l,defaultPins:s.defaultPins}}});const Kg=Vf,Vd={};dh.components.forEach(n=>{if(Vd[n.category]||(Vd[n.category]={}),!Vd[n.category][n.subcategory])Vd[n.category][n.subcategory]=[n.type];else{const r=Vd[n.category][n.subcategory];r.includes(n.type)||(Vd[n.category][n.subcategory]=[...r,n.type])}});const ag={DEFAULT_SIZE:18},Ey={resistance:{validUnits:["","m","k","M"],defaultUnit:""},capacitance:{validUnits:["pF","nF","F","mF","F"],defaultUnit:"F"},voltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},current:{validUnits:["A","mA","A"],defaultUnit:"A"},power:{validUnits:["W","mW","kW"],defaultUnit:"W"},inductance:{validUnits:["nH","H","mH","H"],defaultUnit:"H"},impedance:{validUnits:["","m","k"],defaultUnit:""},capacity:{validUnits:["mAh","Ah"],defaultUnit:"mAh"},inputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},outputVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},coilVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},primaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},secondaryVoltage:{validUnits:["mV","V","kV"],defaultUnit:"V"},esr:{validUnits:["m",""],defaultUnit:""}};function nr(n){return Ey[n]?.validUnits||[]}function hn(n){return Ey[n]?.defaultUnit||""}function Wl(n){return n.includes(" ")?n:n.replace(/([a-z])([A-Z])/g,"$1 $2")}const Za=Math.PI*2;function qy(n){return(n%360+360)%360}function gu(n){return n*Math.PI/180}function l2(n){return n*180/Math.PI}function Lg(n,r){return qy(n+r)}function ah(n){return Math.tan(n)}function c2(n){return Math.cos(n)}function u2(n){return Math.sin(n)}function d2(n,r){return Math.atan2(n,r)}function f2(n,r){return l2(d2(r,n))}function Ig(n,r){const{x:o,y:s,rotation:l=0,scale:d=1,flipX:v=!1,flipY:p=!1,skewX:b=0,skewY:m=0}=r;if(n.translate(o,s),l!==0&&n.rotate(gu(l)),b!==0||m!==0){const M=ah(b),S=ah(m);n.transform(1,S,M,1,0,0)}const T=d*(v?-1:1),D=d*(p?-1:1);(T!==1||D!==1)&&n.scale(T,D)}function g1(n,r,o,s=0,l=!1,d=!1){Ig(n,{x:r,y:o,rotation:s,flipX:l,flipY:d})}function Vy(n,r,o){const s=gu(o),l=c2(s),d=u2(s);return{x:n*l-r*d,y:n*d+r*l}}function p2(n,r=0,o=!1){o&&n.scale(-1,1),r!==0&&n.rotate(gu(r))}function h2(n,r=0,o=!1){const s=qy(r),l=s===90||s===270;o&&n.scale(-1,1),r!==0&&n.rotate(gu(-r)),o&&l&&n.rotate(gu(180))}function y1(n,r,o,s=0,l=!1){let d=n/o,v=r/o;if(s!==0){const p=Vy(d,v,-s);d=p.x,v=p.y}return l&&(d=-d),{x:d,y:v}}function Of(n,r,o,s,l=0,d=!1){let v=n-o.x,p=r-o.y;if(v=v/s,p=p/s,d&&(v=-v),l!==0){const b=Vy(v,p,-l);v=b.x,p=b.y}return{x:v,y:p}}function g2(n,r=.4){if(n.startsWith("#")){const s=n.slice(1),l=parseInt(s.slice(0,2),16),d=parseInt(s.slice(2,4),16),v=parseInt(s.slice(4,6),16),p=Math.max(0,Math.floor(l*(1-r))),b=Math.max(0,Math.floor(d*(1-r))),m=Math.max(0,Math.floor(v*(1-r)));return`#${p.toString(16).padStart(2,"0")}${b.toString(16).padStart(2,"0")}${m.toString(16).padStart(2,"0")}`}const o=n.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*[\d.]+)?\)/);if(o){const s=parseInt(o[1],10),l=parseInt(o[2],10),d=parseInt(o[3],10),v=o[4]?o[4].trim():"",p=Math.max(0,Math.floor(s*(1-r))),b=Math.max(0,Math.floor(l*(1-r))),m=Math.max(0,Math.floor(d*(1-r)));return n.includes("rgba")?`rgba(${p}, ${b}, ${m}${v?`, ${v}`:", 1"})`:`rgb(${p}, ${b}, ${m})`}return n}let il=1;const gc=new Set;function pc(){const n=il;if(il++,gc.has(n)){for(console.error(`CRITICAL ERROR: Duplicate Node ID ${n} would be allocated!`),console.error(`Current counter: ${il}, Allocated IDs count: ${gc.size}`);gc.has(il);)il++;const r=il;return il++,gc.add(r),console.error(`Recovered by allocating ID ${r} instead`),r}return gc.add(n),n}function qp(n){n<1&&(console.warn(`setPointIdCounter called with invalid value ${n}, using 1`),n=1),il=n,gc.clear()}function sg(){return il}function Hf(){il=1,gc.clear()}function lg(n){n>0&&(gc.add(n),n>=il&&(il=n+1))}function Vp(n){if(n>0&&gc.has(n))if(gc.delete(n),gc.size>0){const r=Math.max(...Array.from(gc));r<il&&(il=Math.max(1,r+1))}else il=1}function Hy(n="id"){return`${n}-${Date.now()}-${Math.random().toString(36).slice(2,11)}`}function x1(n){return Math.round(n*1e4)/1e4}function sr(n){return{x:x1(n.x),y:x1(n.y)}}const Fu=dh.components;Fu.map(n=>({designator:n.designator,componentType:n.description}));function Hl(n){if(!n)return;const r=n.componentDefinitionKey;if(r){const s=Fu.find(l=>`${l.category}:${l.subcategory}:${l.type}`===r);if(s)return s}if(typeof n.designator=="string"&&n.designator.trim()!==""){const s=n.designator.trim().match(/^[A-Za-z]+/),l=s?s[0]:null;if(l){const d=Fu.find(v=>Array.isArray(v.designators)&&v.designators.includes(l));if(d)return d}}const o=n.componentType==="Electrolytic Capacitor"||n.componentType==="Film Capacitor"?"Capacitor":n.componentType;return Fu.find(s=>{if(s.type!==o)return!1;if(s.category==="Capacitors"){const l=n.capacitorType||n.dielectric;return!!(l&&s.properties?.capacitorType===l||!l)}if(s.category==="Diodes"){const l=n.diodeType;return!!(l&&s.properties?.diodeType===l||!s.properties?.diodeType)}if(s.category==="Resistors"){const l=n.resistorType,d=n.vrType;return!!(l&&s.properties?.resistorType===l||d&&s.properties?.vrType===d||!s.properties?.resistorType&&!s.properties?.vrType)}if(s.category==="Semiconductors"){const l=n.semiconductorType;return!!(l&&s.properties?.semiconductorType===l||!s.properties?.semiconductorType)}if(s.category==="Passive Components"){const l=n.passiveType;return!!(l&&s.properties?.passiveType===l||!s.properties?.passiveType)}if(s.category==="Power & Energy"){const l=n.powerType;return!!(l&&s.properties?.powerType===l||!s.properties?.powerType)}if(s.category==="Connectors & Switches"){const l=n.connectorType,d=n.switchType;return!!(l&&s.properties?.connectorType===l||d&&s.properties?.switchType===d||!s.properties?.connectorType&&!s.properties?.switchType)}if(n.componentType==="GenericComponent"){const l=n.genericType;return!!(l&&s.subtype===l)}return!0})}function cg(n){return(Kg[n]?.prefix||["?"])[0]}function Xf(n){return Hl(n)?.properties?.polarized===!0}function Mg(n,r,o){if(!Xf(n)||n.pinCount!==2||!(r.length===2&&r[0]&&r[0].trim()!==""&&r[1]&&r[1].trim()!==""))return null;const l=T=>{const D=parseInt(T,10);if(isNaN(D))return null;for(const M of o)if((M.type==="via"||M.type==="pad")&&M.points.length>0){const S=M.points[0];if(S.id===D)return{x:S.x,y:S.y}}return null},d=l(r[0]),v=l(r[1]);if(!d||!v)return null;const p=Math.hypot(n.x-d.x,n.y-d.y),b=Math.hypot(n.x-v.x,n.y-v.y),m=["",""];return p<b?(m[0]="-",m[1]="+"):(m[0]="+",m[1]="-"),m}function Uf(){return{}}function y2(n){}function x2(n,r,o){let s=0;for(const d of r)if(d.designator){const v=d.designator.match(new RegExp(`^${n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\d+)$`));if(v){const p=parseInt(v[1],10);p>s&&(s=p)}}const l=o[n]||0;return Math.max(s,l)+1}function m1(n,r,o){const s={...o};return s[n]=Math.max(s[n]||0,r),s}function m2(n){if(n.designator&&n.designator.trim()!=="")return n.designator.trim();switch(n.baseType){case"Capacitor":return"C";case"Diode":return"D";case"Resistor":return"R";case"Semiconductor":return"Q";case"Passive":return"L";case"PowerEnergy":return"PS";case"Connector":return"J";case"Switch":return"S";case"Transformer":return"T";case"Other":default:return"?"}}function b2(n,r,o){let s=0;for(const v of r){if(!v.designator||!v.designator.startsWith(n))continue;const p=parseInt(v.designator.slice(n.length),10);!isNaN(p)&&p>s&&(s=p)}const d=(o[n]??s)+1;return o[n]=d,d}function v2(n,r,o){const s=m2(n),l=b2(s,r,o);return`${s}${l}`}function w2(n){const{definition:r,layer:o,x:s,y:l,color:d,size:v,designator:p,existingComponents:b=[],counters:m={}}=n,T=v&&v>0?v:Xg.DEFAULT_SIZE,D=p||v2(r,b,m),M={id:Hy("comp"),componentType:r.type,designator:D,layer:o,x:s,y:l,color:d,size:T,pinCount:r.defaultPins,pinConnections:new Array(r.defaultPins).fill(""),pinPolarities:void 0,notes:null,orientation:0,flipX:!1,flipY:!1,description:r.description};if(M.componentDefinitionKey=r.key,r.properties&&Object.assign(M,r.properties),r.properties?.pinNames&&Array.isArray(r.properties.pinNames)){const S=r.properties.pinNames;S.includes("CHIP_DEPENDENT")?M.pinNames=new Array(M.pinCount).fill(""):M.pinNames=new Array(M.pinCount).fill("").map((_,N)=>N<S.length?S[N]:"")}return r.fields&&r.fields.length>0&&r.fields.forEach(S=>{S.defaultValue!==void 0&&S.defaultValue!==""&&(M[S.name]=S.defaultValue),S.units&&S.defaultUnit&&(M[`${S.name}Unit`]=S.defaultUnit)}),M}function S2(){const n=document.createElement("canvas"),r=24;n.width=r,n.height=r;const o=n.getContext("2d");o.strokeStyle="#000",o.lineWidth=3,o.lineCap="round";const s=r/2,l=8;return o.beginPath(),o.moveTo(s,s-l),o.lineTo(s,s-2),o.moveTo(s,s+2),o.lineTo(s,s+l),o.moveTo(s-l,s),o.lineTo(s-2,s),o.moveTo(s+2,s),o.lineTo(s+l,s),o.stroke(),`url(${n.toDataURL()}) ${s} ${s}, crosshair`}function j2(n){const r=document.createElement("canvas"),o=Math.max(12,Math.min(n,32)),l=o+4*2;r.width=l,r.height=l;const d=r.getContext("2d"),v=l/2,p=l/2,b=o/2;return d.fillStyle="#FFFF00",d.strokeStyle="#000000",d.lineWidth=2,d.beginPath(),d.moveTo(v,p-b),d.lineTo(v+b,p),d.lineTo(v,p+b),d.lineTo(v-b,p),d.closePath(),d.fill(),d.stroke(),`url(${r.toDataURL()}) ${v} ${p}, crosshair`}function b1(){const n=new Date,r=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0"),l=String(n.getHours()).padStart(2,"0"),d=String(n.getMinutes()).padStart(2,"0"),v=String(n.getSeconds()).padStart(2,"0");return`${r}_${o}_${s}-${l}-${d}-${v}`}function hd(n){let r=n.replace(/\.json$/i,""),o="";for(;o!==r;)o=r,r=r.replace(/_\d{4}_\d{2}_\d{2}-\d{2}-\d{2}-\d{2}$/,""),r=r.replace(/_\d{4}_\d{2}_\d{2}_\d{2}_\d{2}_\d{2}$/,"");return r}function mi(n,r,o,s){if(r==="power"){const d=n[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(n[r]!==void 0||n[o]!==void 0)return{value:n[r]!==void 0?String(n[r]):"",unit:n[o]!==void 0?String(n[o]):s};const l=n[r]||"";return typeof l=="string"&&l.trim()!==""?Wy(l):{value:"",unit:s}}function Wy(n){if(!n||n.trim()==="")return{value:"",unit:""};const r=n.trim(),o=r.match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(o)return{value:o[1],unit:o[2]||""};const s=r.match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return s?{value:s[1],unit:s[2]||""}:{value:r,unit:""}}function ud(n,r){return!n||n.trim()===""?"":!r||r.trim()===""?n.trim():`${n.trim()}${r.trim()}`}function T2(){const[n,r]=I.useState([]),[o,s]=I.useState([]),[l,d]=I.useState(null),[v,p]=I.useState(null),[b,m]=I.useState(null),[T,D]=I.useState(!1),[M,S]=I.useState(null),F=I.useCallback((E,q)=>{q==="top"?r(re=>[...re,E]):s(re=>[...re,E])},[]),_=I.useCallback((E,q,re)=>{re==="top"?r(J=>J.map(Y=>Y.id===E?{...Y,...q}:Y)):s(J=>J.map(Y=>Y.id===E?{...Y,...q}:Y))},[]),N=I.useCallback((E,q)=>{q==="top"?r(re=>re.filter(J=>J.id!==E)):s(re=>re.filter(J=>J.id!==E))},[]),g=I.useCallback((E,q)=>{if(!E){console.error("[openComponentEditor] Component is null or undefined");return}if(!E.id||typeof E.id!="string"){console.error("[openComponentEditor] Component missing valid id property:",{component:E});return}const re=E.id;if(!E.componentType||typeof E.componentType!="string"){console.error("[openComponentEditor] Component missing valid componentType property:",{componentId:re,component:E});return}const J=E.componentType;if(typeof E.pinCount!="number"||E.pinCount<0){console.error("[openComponentEditor] Component missing valid pinCount property:",{componentId:re,componentType:J,pinCount:E.pinCount,component:E});return}if(q!=="top"&&q!=="bottom"){console.error("[openComponentEditor] Invalid layer parameter:",{layer:q,componentId:E.id});return}const Y=E.designator||"",ee=E.abbreviation||(Y.length>0?Y.charAt(0).toUpperCase():""),U=E.componentType,$={visible:!0,layer:q,id:E.id,designator:Y,abbreviation:ee,manufacturer:"manufacturer"in E&&E.manufacturer||"",partNumber:"partNumber"in E&&E.partNumber||"",pinCount:E.pinCount,x:E.x,y:E.y,orientation:E.orientation??0,description:E.description||"",datasheet:E.datasheet||"",componentDefinitionKey:E.componentDefinitionKey||""};if(U==="Resistor"){const R=E;console.log("[openComponentEditor] Resistor - component values:",{resistance:R.resistance,resistanceUnit:R.resistanceUnit,resistanceType:typeof R.resistance});const Z=mi(R,"resistance","resistanceUnit",hn("resistance"));console.log("[openComponentEditor] Resistor - readValueAndUnit result:",Z),$.resistance=Z.value,$.resistanceUnit=Z.unit;const G=mi(R,"power","powerUnit","W");$.power=G.value||"1/4",$.tolerance=R.tolerance||"5%"}else if(U==="Capacitor"){const R=E;console.log("[openComponentEditor] Capacitor - component values:",{capacitance:R.capacitance,capacitanceUnit:R.capacitanceUnit,capacitanceType:typeof R.capacitance});const Z=mi(R,"capacitance","capacitanceUnit",hn("capacitance"));console.log("[openComponentEditor] Capacitor - readValueAndUnit result:",Z),$.capacitance=Z.value,$.capacitanceUnit=Z.unit;const G=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=G.value,$.voltageUnit=G.unit,$.tolerance=R.tolerance||"10%",$.dielectric=R.dielectric||"Ceramic"}else if(U==="Electrolytic Capacitor"){const R=E,Z=mi(R,"capacitance","capacitanceUnit",hn("capacitance"));$.capacitance=Z.value,$.capacitanceUnit=Z.unit;const G=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=G.value,$.voltageUnit=G.unit,$.tolerance=R.tolerance||"20%",$.polarized=R.polarized!==void 0?R.polarized:!0;const we=mi(R,"esr","esrUnit",hn("esr"));$.esr=we.value,$.esrUnit=we.unit,$.temperature=R.temperature||""}else if(U==="Film Capacitor"){const R=E,Z=mi(R,"capacitance","capacitanceUnit",hn("capacitance"));$.capacitance=Z.value,$.capacitanceUnit=Z.unit;const G=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=G.value,$.voltageUnit=G.unit,$.tolerance=R.tolerance||"10%",$.filmType=R.filmType||"Polyester"}else if(U==="Diode"){const R=E;$.diodeType=R.diodeType||"Standard";const Z=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const G=mi(R,"current","currentUnit",hn("current"));$.current=G.value,$.currentUnit=G.unit,$.ledColor=R.ledColor||""}else if(U==="Battery"){const R=E,Z=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const G=mi(R,"capacity","capacityUnit",hn("capacity"));$.capacity=G.value,$.capacityUnit=G.unit,$.chemistry=R.chemistry||"Li-ion"}else if(U==="Fuse"){const R=E,Z=mi(R,"current","currentUnit",hn("current"));$.current=Z.value,$.currentUnit=Z.unit;const G=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=G.value,$.voltageUnit=G.unit,$.fuseType=R.fuseType||"Fast-blow"}else if(U==="FerriteBead"){const R=E,Z=mi(R,"impedance","impedanceUnit",hn("impedance"));$.impedance=Z.value,$.impedanceUnit=Z.unit;const G=mi(R,"current","currentUnit",hn("current"));$.current=G.value,$.currentUnit=G.unit}else if(U==="Connector"){const R=E;$.connectorType=R.connectorType||"",$.gender=R.gender||"N/A"}else if(U==="Jumper"){const R=E;$.positions=R.positions||3}else if(U==="Relay"){const R=E,Z=mi(R,"coilVoltage","coilVoltageUnit",hn("coilVoltage"));$.coilVoltage=Z.value,$.coilVoltageUnit=Z.unit,$.contactType=R.contactType||"SPST";const G=mi(R,"current","currentUnit",hn("current"));$.current=G.value,$.currentUnit=G.unit}else if(U==="Inductor"){const R=E,Z=mi(R,"inductance","inductanceUnit",hn("inductance"));$.inductance=Z.value,$.inductanceUnit=Z.unit;const G=mi(R,"current","currentUnit",hn("current"));$.current=G.value,$.currentUnit=G.unit;const we=mi(R,"resistance","resistanceUnit",hn("resistance"));$.resistance=we.value,$.resistanceUnit=we.unit}else if(U==="Speaker"){const R=E,Z=mi(R,"impedance","impedanceUnit",hn("impedance"));$.impedance=Z.value,$.impedanceUnit=Z.unit;const G=mi(R,"power","powerUnit","W");$.power=G.value||"1"}else if(U==="Motor"){const R=E;$.motorType=R.motorType||"DC";const Z=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const G=mi(R,"current","currentUnit",hn("current"));$.current=G.value,$.currentUnit=G.unit}else if(U==="PowerSupply"){const R=E,Z=mi(R,"inputVoltage","inputVoltageUnit",hn("inputVoltage"));$.inputVoltage=Z.value,$.inputVoltageUnit=Z.unit;const G=mi(R,"outputVoltage","outputVoltageUnit",hn("outputVoltage"));$.outputVoltage=G.value,$.outputVoltageUnit=G.unit;const we=mi(R,"current","currentUnit",hn("current"));$.current=we.value,$.currentUnit=we.unit}else if(U==="Transistor"){const R=E;$.transistorType=R.transistorType||"BJT",$.polarity=R.polarity||"NPN";const Z=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const G=mi(R,"current","currentUnit",hn("current"));$.current=G.value,$.currentUnit=G.unit}else if(U==="ResistorNetwork"){const R=E,Z=mi(R,"resistance","resistanceUnit",hn("resistance"));$.resistance=Z.value,$.resistanceUnit=Z.unit,$.configuration=R.configuration||""}else if(U==="Thermistor"){const R=E,Z=mi(R,"resistance","resistanceUnit",hn("resistance"));$.resistance=Z.value,$.resistanceUnit=Z.unit,$.thermistorType=R.thermistorType||"NTC",$.beta=R.beta||""}else if(U==="Switch"){const R=E;$.switchType=R.switchType||"Toggle";const Z=mi(R,"current","currentUnit",hn("current"));$.current=Z.value,$.currentUnit=Z.unit;const G=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=G.value,$.voltageUnit=G.unit}else if(U==="Transformer"){const R=E,Z=mi(R,"primaryVoltage","primaryVoltageUnit",hn("primaryVoltage"));$.primaryVoltage=Z.value,$.primaryVoltageUnit=Z.unit;const G=mi(R,"secondaryVoltage","secondaryVoltageUnit",hn("secondaryVoltage"));$.secondaryVoltage=G.value,$.secondaryVoltageUnit=G.unit;const we=mi(R,"power","powerUnit",hn("power"));$.power=we.value||"1",$.turns=R.turns||""}else if(U==="TestPoint"){const R=E;$.signal=R.signal||""}else if(U==="IntegratedCircuit"||U==="Semiconductor"){const R=E;$.description=R.description||E.designator||"",$.datasheet=R.datasheet||"",$.datasheetFileName=R.datasheetFileName||void 0,$.manufacturer=R.manufacturer||"",$.partNumber=R.partNumber||"",$.operatingTemperature=R.operatingTemperature||"",$.packageType=R.packageType||"",console.log("[useComponents] Loading IC component - datasheet from component:",R.datasheet,"editor datasheet:",$.datasheet,"datasheetFileName:",R.datasheetFileName),$.icType=R.icType||"Op-Amp"}else if(U==="VacuumTube"){const R=E;$.tubeType=R.tubeType||""}else if(U==="VariableResistor"){const R=E;$.vrType=R.vrType||"Potentiometer";const Z=mi(R,"resistance","resistanceUnit",hn("resistance"));$.resistance=Z.value,$.resistanceUnit=Z.unit;const G=mi(R,"power","powerUnit",hn("power"));$.power=G.value||"1/4",$.taper=R.taper||""}else if(U==="Crystal"){const R=E;$.frequency=R.frequency||"",$.loadCapacitance=R.loadCapacitance||"",$.tolerance=R.tolerance||""}else if(U==="Diode"){const R=E;$.diodeType=R.diodeType||"Standard";const Z=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const G=mi(R,"current","currentUnit",hn("current"));$.current=G.value,$.currentUnit=G.unit,$.ledColor=R.ledColor||""}else if(U==="GenericComponent"){const R=E;$.genericType=R.genericType||"Attenuator";const Z=mi(R,"voltage","voltageUnit",hn("voltage"));$.voltage=Z.value,$.voltageUnit=Z.unit;const G=mi(R,"current","currentUnit",hn("current"));$.current=G.value,$.currentUnit=G.unit,$.power=R.power||"",$.frequency=R.frequency||"",$.model=R.model||""}const H=E.componentDefinitionKey;if(H){const R=Fu.find(Z=>`${Z.category}:${Z.subcategory}:${Z.type}`===H);R&&($.componentDefinition=R,$.componentDefinitionKey=H)}d($)},[]),ae=I.useCallback(()=>{d(null),p(null)},[]);return{componentsTop:n,setComponentsTop:r,componentsBottom:o,setComponentsBottom:s,componentEditor:l,setComponentEditor:d,connectingPin:v,setConnectingPin:p,componentDialogPosition:b,setComponentDialogPosition:m,isDraggingDialog:T,setIsDraggingDialog:D,dialogDragOffset:M,setDialogDragOffset:S,addComponent:F,updateComponent:_,removeComponent:N,openComponentEditor:g,closeComponentEditor:ae}}class C2{parent=new Map;rank=new Map;find(r){return this.parent.has(r)?(this.parent.get(r)!==r&&this.parent.set(r,this.find(this.parent.get(r))),this.parent.get(r)):(this.parent.set(r,r),this.rank.set(r,0),r)}union(r,o){const s=this.find(r),l=this.find(o);if(s===l)return;const d=this.rank.get(s)||0,v=this.rank.get(l)||0;d<v?this.parent.set(s,l):d>v?this.parent.set(l,s):(this.parent.set(l,s),this.rank.set(s,d+1))}getGroups(){const r=new Map;for(const o of this.parent.keys()){const s=this.find(o);r.has(s)||r.set(s,[]),r.get(s).push(o)}return r}}function N2(n,r){const o=n.pinCount,s=n.size||24,l=s*.8,d=s*.6,v=s*.15,p=d/4,b=Math.ceil(o/2),m=r<b;let T,D;if(m)T=n.x-l/2-v,D=n.y-d/2+d/4+r*p;else{const M=r-b;T=n.x+l/2+v,D=n.y-d/2+d/4+M*p}return{x:Math.round(T),y:Math.round(D)}}function fh(n,r,o,s,l){const d=new Map,v=new Map;let p=1;const b=6,m=(N,g)=>{const ae=Math.round(N*Math.pow(10,b))/Math.pow(10,b),E=Math.round(g*Math.pow(10,b))/Math.pow(10,b);return`${ae},${E}`},T=(N,g,ae,E)=>{const q=m(N,g);if(d.has(q)){const J=d.get(q);if(E){E.componentId&&E.pinIndex!==void 0&&(J.componentId=E.componentId,J.pinIndex=E.pinIndex),E.voltage!==void 0&&(J.voltage=E.voltage),E.powerBusId!==void 0&&(J.powerBusId=E.powerBusId),E.groundBusId!==void 0&&(J.groundBusId=E.groundBusId);for(const Y in E)Y!=="componentId"&&Y!=="pinIndex"&&Y!=="voltage"&&Y!=="powerBusId"&&Y!=="groundBusId"&&(J[Y]=E[Y]);E.type==="component_pin"||J.type==="component_pin"?J.type="component_pin":E.type&&!J.type&&(J.type=E.type)}return J}const re={id:p++,type:ae,x:N,y:g,...E};return d.set(q,re),re};let D=0;for(const N of n)if(N.type==="via"&&N.points.length>0){const g=N.points[0];T(g.x,g.y,"via");const ae=m(g.x,g.y);g.id!==void 0&&v.set(g.id,ae),D++}console.log(`[Connectivity] Added ${D} vias to coordinate graph`);let M=0;for(const N of n)if(N.type==="trace")for(const g of N.points){T(g.x,g.y,"trace_point");const ae=m(g.x,g.y);g.id!==void 0&&v.set(g.id,ae),M++}console.log(`[Connectivity] Added ${M} trace points to coordinate graph`);for(const N of o){const g=l.find(ae=>ae.id===N.powerBusId);if(T(N.x,N.y,"power",{voltage:g?.voltage||N.type||"UNKNOWN",powerBusId:N.powerBusId}),N.pointId!==void 0){const ae=m(N.x,N.y);v.set(N.pointId,ae)}}for(const N of s){const g=N;if(T(N.x,N.y,"ground",{groundBusId:g.groundBusId}),g.pointId!==void 0){const ae=m(N.x,N.y);v.set(g.pointId,ae)}}const S=new Set;for(const[N]of d)S.add(N);const F=[];let _=0;for(const N of r){const g=N.abbreviation?.trim()||N.designator?.trim()||"UNKNOWN";for(let ae=0;ae<N.pinCount;ae++){const E=N.pinConnections?.[ae];if(E&&E.trim()!==""){const q=parseInt(E.trim(),10);if(!isNaN(q)&&q>0){const re=v.get(q);if(re){const[J,Y]=re.split(",").map(Number);T(J,Y,"component_pin",{componentId:N.id,pinIndex:ae}),_++,console.log(`[Connectivity] Component ${g} pin ${ae+1}: Connected to point ID ${q} at coord(${J},${Y})`)}else{const J=N2(N,ae);T(J.x,J.y,"component_pin",{componentId:N.id,pinIndex:ae});const Y=m(J.x,J.y);v.set(q,Y),_++,console.warn(`[Connectivity] Component ${g} pin ${ae+1}: Point ID ${q} not in pointIdToCoord, but adding pin at calculated position (${J.x},${J.y}) - may be connected to power/ground`)}}else F.push({compId:N.id,designator:g,pinIndex:ae,pointId:E.trim()}),console.warn(`[Connectivity] Component ${g} pin ${ae+1}: Invalid point ID "${E}" - pin is NOT connected`)}}}if(console.log(`[Connectivity] Added ${_} connected component pins to coordinate graph`),F.length>0){console.warn(`[Connectivity] Found ${F.length} component pins with invalid or missing connections (not added to graph):`);for(const N of F.slice(0,10))console.warn(`  - ${N.designator} pin ${N.pinIndex+1}: point ID "${N.pointId}" not found`)}return d}function ph(n,r){const o=[],l=(d,v)=>{const p=Math.round(d*Math.pow(10,6))/Math.pow(10,6),b=Math.round(v*Math.pow(10,6))/Math.pow(10,6);return`${p},${b}`};for(const d of n)if(d.type==="trace"&&d.points.length>=2)for(let v=0;v<d.points.length-1;v++){const p=d.points[v],b=d.points[v+1];if(p&&b){const m=l(p.x,p.y),T=l(b.x,b.y);m!==T&&o.push([m,T])}}return o}function k2(n){let r=n.trim();r=r.replace(/\s*(VDC|VAC)\s*$/i,""),r=r.replace(/\s*(DC|AC)\s*$/i,""),r=r.replace(/\s*V\s*$/i,"");const o=r.match(/^([+-])?/),s=o&&o[1]||"+",l=r.match(/(\d+\.?\d*)/);if(!l)return n.trim();let d=l[1];if(d.includes(".")){const v=d.split("."),p=v[0],m=(v[1]||"0").replace(/0+$/,"")||"0";d=`${p}V${m}`}return`${s}${d}V`}function hh(n,r,o=[],s=[]){const l=new C2,d=new Map;let v=1;const p=S=>(d.has(S)||d.set(S,v++),d.get(S));for(const[S,F]of r){const _=p(S),N=p(F);l.union(_,N)}const b=new Map;for(const[S,F]of n)if(F.type==="ground"){const _=F.groundBusId||"default";b.has(_)||b.set(_,[]),b.get(_).push(S),p(S)}for(const[S,F]of b)if(F.length>0){const N=s.find(g=>g.id===S)?.name||(S==="default"?"GND":S);if(F.length>1){const g=p(F[0]);for(let ae=1;ae<F.length;ae++){const E=p(F[ae]);l.union(g,E)}console.log(`[Connectivity] Unified ${F.length} ground nodes with bus "${N}" into a single net (common ground bus)`)}else console.log(`[Connectivity] Found 1 ground node with bus "${N}" (common ground bus)`)}const m=new Map;for(const[S,F]of n)if(F.type==="power"&&F.powerBusId){const _=F.powerBusId;m.has(_)||m.set(_,[]),m.get(_).push(S),p(S)}for(const[S,F]of m)if(F.length>0){const N=o.find(g=>g.id===S)?.name||S;if(F.length>1){const g=p(F[0]);for(let ae=1;ae<F.length;ae++){const E=p(F[ae]);l.union(g,E)}console.log(`[Connectivity] Unified ${F.length} power nodes with bus "${N}" into a single net (common power bus)`)}else console.log(`[Connectivity] Found 1 power node with bus "${N}" (common power bus)`)}for(const S of n.keys())p(S);const T=l.getGroups(),D=new Map,M=new Map;for(const[S,F]of d)M.set(F,S);for(const[S,F]of T){const _=M.get(S);if(!_)continue;const N=F.map(g=>M.get(g)).filter(g=>g!==void 0).map(g=>n.get(g)).filter(g=>g!==void 0);D.set(_,N)}return D}function gh(n,r){const o=new Map;let s=1;for(const[l,d]of n){if(d.some(b=>b.type==="ground")){o.set(l,"GND");continue}const p=d.filter(b=>b.type==="power");if(p.length>0){const b=p[0].voltage||"UNKNOWN",m=k2(b);o.set(l,m);continue}o.set(l,`N$${s++}`)}return o}function Gc(n,r,o,s){if(r==="power"){const d=n[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(n[r]!==void 0||n[o]!==void 0)return{value:n[r]||"",unit:n[o]||s};const l=n[r]||"";if(typeof l=="string"&&l.trim()!==""){const d=l.trim().match(/^([\d]+\/[\d]+)\s*([a-zA-ZuW]+)?$/);if(d)return{value:d[1],unit:d[2]||""};const v=l.trim().match(/^([\d.]+)\s*([a-zA-ZuW]+)?$/);return v?{value:v[1],unit:v[2]||""}:{value:l.trim(),unit:""}}return{value:"",unit:s}}function Yc(n,r){return!n||n.trim()===""?"":!r||r.trim()===""?n.trim():`${n.trim()}${r.trim()}`}function Ps(n){return{resistance:"",capacitance:"F",inductance:"H",voltage:"V",current:"A",power:"W",impedance:"",capacity:"mAh",esr:"",coilVoltage:"V",inputVoltage:"V",outputVoltage:"V"}[n]||""}function $y(n){if(n.componentType==="Resistor"&&"resistance"in n){const{value:s,unit:l}=Gc(n,"resistance","resistanceUnit",Ps("resistance"));if(s&&s.trim()!=="")return Yc(s,l)}if(n.componentType==="Capacitor"&&"capacitance"in n){const{value:s,unit:l}=Gc(n,"capacitance","capacitanceUnit",Ps("capacitance"));if(s&&s.trim()!=="")return Yc(s,l)}if(n.componentType==="Electrolytic Capacitor"&&"capacitance"in n){const{value:s,unit:l}=Gc(n,"capacitance","capacitanceUnit",Ps("capacitance"));if(s&&s.trim()!=="")return Yc(s,l)}if(n.componentType==="Inductor"&&"inductance"in n){const{value:s,unit:l}=Gc(n,"inductance","inductanceUnit",Ps("inductance"));if(s&&s.trim()!=="")return Yc(s,l)}const r=n.partName?.trim();if(r&&r!=="")return r;const o=n.partNumber?.trim();return o&&o!==""?o:n.componentType}function Gy(n){return n.packageType?n.packageType:{Resistor:"R_0805",Capacitor:"C_0805",Inductor:"L_0805",Diode:"D_SOD-123",Transistor:"TO-92",IntegratedCircuit:"DIP-8"}[n.componentType]||"Unknown"}function A2(n,r,o,s,l){const d=fh(r,n,o,s,l),v=ph(r),p=hh(d,v),b=gh(p),m=new Map;for(const F of n){const _=F.abbreviation?.trim()||F.designator?.trim();_&&m.set(_,F)}const T=[];let D=1;for(const[F,_]of p){const N=b.get(F)||`N$${D}`,g=[];for(const ae of _)if(ae.type==="component_pin"&&ae.componentId&&ae.pinIndex!==void 0){const E=n.find(q=>q.id===ae.componentId);if(E){const q=E.abbreviation?.trim()||E.designator?.trim();q&&g.push({designator:q,pin:(ae.pinIndex||0)+1})}}g.length>0&&T.push({name:N,code:D++,componentPins:g})}T.sort((F,_)=>F.name==="GND"?-1:_.name==="GND"?1:F.name.startsWith("+")||F.name.startsWith("-")?-1:_.name.startsWith("+")||_.name.startsWith("-")?1:F.code-_.code);let M=`(
`;M+=`  (components
`;const S=Array.from(m.keys()).sort();for(const F of S){const _=m.get(F),N=$y(_),g=Gy(_);M+=`    (comp (ref ${F})
`,M+=`      (value ${N})
`,M+=`      (footprint ${g})
`,M+=`    )
`}M+=`  )
`,M+=`  (nets
`;for(const F of T){M+=`    (net (code ${F.code}) (name ${F.name})
`;for(const _ of F.componentPins)M+=`      (node (ref ${_.designator}) (pin ${_.pin}))
`;M+=`    )
`}return M+=`  )
`,M+=`)
`,M}function z2(n,r,o,s,l){const d=fh(r,n,o,s,l),v=ph(r),p=hh(d,v),b=gh(p),m=new Map;for(const F of n){const _=F.abbreviation?.trim()||F.designator?.trim();_&&m.set(_,F)}const T=new Set;for(const[,F]of p)for(const _ of F)if(_.type==="component_pin"&&_.componentId&&_.pinIndex!==void 0){const N=n.find(g=>g.id===_.componentId);if(N){const g=N.abbreviation?.trim()||N.designator?.trim();g&&T.add(g)}}let D="";D+="[";const M=Array.from(T).sort();for(const F of M){const _=m.get(F);if(!_)continue;const N=_.packageType||Gy(_),g=$y(_);D+=`[${F}
`,D+=`${N}
`,D+=`${g}
`,D+=`



`,D+="]"}D+=`]
`,D+=`(
`;let S=1;for(const[F,_]of p){const N=b.get(F)||`N$${S}`,g=[];for(const ae of _)if(ae.type==="component_pin"&&ae.componentId&&ae.pinIndex!==void 0){const E=n.find(q=>q.id===ae.componentId);if(E){const q=E.abbreviation?.trim()||E.designator?.trim();q&&g.push({designator:q,pin:(ae.pinIndex||0)+1})}}if(g.length>0){D+=`(${N}
`;for(const ae of g)D+=`  (${ae.designator}-${ae.pin})
`;D+=`)
`}S++}return D+=`)
`,D}function P2(n,r,o,s,l){const d=fh(r,n,o,s,l),v=ph(r),p=hh(d,v),b=gh(p),m=new Map;for(const E of n){const q=E.abbreviation?.trim()||E.designator?.trim();q&&m.set(q,E)}const T=E=>{switch(E.componentType){case"Resistor":return"R";case"Capacitor":return"C";case"Electrolytic Capacitor":return"C";case"Film Capacitor":return"C";case"Inductor":return"L";case"Diode":return"D";case"Transistor":return"Q";case"IntegratedCircuit":return"X";case"Switch":return"S";case"Battery":return"V";case"Fuse":return"R";case"Jumper":return"R";default:return"X"}},D=E=>{const re=(E.abbreviation?.trim()||E.designator?.trim()||"").match(/\d+/);return re?re[0]:E.id.substring(0,8)},M=E=>{if(E.componentType==="Resistor"&&"resistance"in E){const{value:J,unit:Y}=Gc(E,"resistance","resistanceUnit",Ps("resistance"));if(J&&J.trim()!=="")return Yc(J,Y)}if((E.componentType==="Capacitor"||E.componentType==="Electrolytic Capacitor")&&"capacitance"in E){const{value:J,unit:Y}=Gc(E,"capacitance","capacitanceUnit",Ps("capacitance"));if(J&&J.trim()!=="")return Yc(J,Y)}if(E.componentType==="Inductor"&&"inductance"in E){const{value:J,unit:Y}=Gc(E,"inductance","inductanceUnit",Ps("inductance"));if(J&&J.trim()!=="")return Yc(J,Y)}const q=E.partName?.trim();if(q&&q!=="")return q;const re=E.partNumber?.trim();return re&&re!==""?re:E.componentType},S=new Map;let F=1;for(const[E]of p){const q=b.get(E);if(!q)continue;let re;q==="GND"?re="0":q.startsWith("+")||q.startsWith("-")?re=q.replace(/\s+/g,"").replace(/[^a-zA-Z0-9_+-]/g,"_"):re=`N${F++}`,S.set(E,re)}const _=new Map;for(const[E,q]of S.entries()){const re=b.get(E);re&&(re.startsWith("+")||re.startsWith("-"))&&_.set(re,q)}let N=`* SPICE Netlist
`;N+=`* Generated from PCB Reverse Engineering Tool
*

`;const g=Array.from(m.keys()).sort();for(const E of g){const q=m.get(E),re=T(q),J=M(q),Y=[];for(const[U,$]of p){const H=S.get(U);if(H)for(const R of $)R.type==="component_pin"&&R.componentId===q.id&&R.pinIndex!==void 0&&Y.push({pinIndex:R.pinIndex,nodeName:H})}Y.sort((U,$)=>U.pinIndex-$.pinIndex);const ee=D(q);if(q.componentType==="Switch")Y.length>=2&&(N+=`* Switch ${E}: ${q.componentType} - needs manual modeling
`,N+=`* S${ee} ${Y[0].nodeName} ${Y[1].nodeName} 0 0 SW_MODEL
`);else if(q.componentType==="IntegratedCircuit"){const U=q.partNumber?.trim()||q.partName?.trim()||q.componentType;if(Y.length>0){N+=`X${ee}`;for(const $ of Y)N+=` ${$.nodeName}`;N+=` ${U}
`,N+=`* Note: Subcircuit definition for ${U} must be provided
`}}else if(q.componentType==="Battery"){const U=M(q);Y.length>=2&&(N+=`V${ee} ${Y[0].nodeName} ${Y[1].nodeName} DC ${U||"5"}
`)}else if(Y.length>0){N+=`${re}${ee}`;for(const U of Y)N+=` ${U.nodeName}`;J&&J.trim()!==""&&(q.componentType==="Resistor"||q.componentType==="Capacitor"||q.componentType==="Electrolytic Capacitor"||q.componentType==="Film Capacitor"||q.componentType==="Inductor"||q.componentType==="Diode")&&(N+=` ${J}`),N+=`
`}else{const U=q.pinCount||2;N+=`${re}${ee}`;for(let $=0;$<U;$++)N+=` NC${$+1}`;J&&J.trim()!==""&&(N+=` ${J}`),N+=`
`}}const ae=new Set;for(const[E]of p){const q=b.get(E);q&&(q.startsWith("+")||q.startsWith("-"))&&ae.add(q)}if(ae.size>0){N+=`
* Power sources (user should define these)
`;let E=1;for(const q of Array.from(ae).sort()){const re=_.get(q)||q.replace(/\s+/g,"").replace(/[^a-zA-Z0-9_+-]/g,"_"),J=q.match(/[+-]?[\d.]+/),Y=J?J[0]:"5";N+=`* V${E++} ${re} 0 DC ${Y}
`}}return N+=`
* Simulation commands (uncomment and modify as needed):
`,N+=`* .op                    ; DC operating point
`,N+=`* .tran 1ms 10ms         ; Transient analysis
`,N+=`* .ac dec 10 1 1k        ; AC analysis
`,N+=`
.end
`,N}function _2(n,r,o,s,l,d,v){const p=fh(r,n,o,s,l),b=ph(r),m=hh(p,b,l,d),T=gh(m),D=new Map,M=J=>J.componentType==="Jumper"||J.componentType==="Connector"||J.componentType==="Switch",S=new Map;for(const[J,Y]of p)if(Y.componentId&&Y.pinIndex!==void 0){const ee=`${Y.componentId}:${Y.pinIndex}`;S.set(ee,J)}const F=new Map;for(const[J]of p.keys())F.set(J,new Set);for(const[J,Y]of b)F.has(J)&&F.get(J).add(Y),F.has(Y)&&F.get(Y).add(J);const _=(J,Y,ee)=>{if(ee.has(J))return;ee.add(J);const U=p.get(J);if(!U)return;if(U.componentId&&U.pinIndex!==void 0){const H=`${U.componentId}:${U.pinIndex}`;D.has(H)||D.set(H,new Set),D.get(H).add(Y);const R=n.find(Z=>Z.id===U.componentId);if(R&&M(R))for(let Z=0;Z<R.pinCount;Z++){const G=`${R.id}:${Z}`;D.has(G)||D.set(G,new Set),D.get(G).add(Y);const we=S.get(G);we&&!ee.has(we)&&_(we,Y,ee)}}const $=F.get(J);if($)for(const H of $)_(H,Y,ee)};for(const J of l){const Y=J.name,ee=new Set;for(const[U,$]of p)$.type==="power"&&$.powerBusId===J.id&&_(U,Y,ee)}for(const J of d){const Y=J.name,ee=new Set;for(const[U,$]of p)$.type==="ground"&&$.groundBusId===J.id&&_(U,Y,ee)}const N=new Map;for(const J of n){const Y=J.designator?.trim()||J.abbreviation?.trim();Y&&N.set(Y,J)}const g=J=>{if(!J||J.trim()==="")return"unknown";const Y=J.toUpperCase().trim();return Y==="VCC"||Y==="VDD"||Y.startsWith("VCC")||Y.startsWith("VDD")||Y==="V+"||Y.startsWith("V+")||Y==="VP"||Y==="VPOS"?"power":Y==="GND"||Y==="VSS"||Y==="V-"||Y.startsWith("V-")||Y==="VN"||Y==="VNEG"||Y==="GROUND"?"ground":Y.startsWith("IN")||Y.startsWith("INPUT")||Y.includes("IN+")||Y.includes("IN-")||Y==="A"||Y==="B"||Y.startsWith("CLK")||Y.startsWith("EN")||Y.startsWith("CS")||Y.startsWith("CE")?"input":Y.startsWith("OUT")||Y.startsWith("OUTPUT")||Y.includes("OUT+")||Y.includes("OUT-")||Y==="Y"||Y==="Q"||Y.startsWith("DO")?"output":"unknown"},ae=[],E=Array.from(N.keys()).sort();for(const J of E){const Y=N.get(J),ee=Y.partNumber?.trim()||"";let U="";if(Y.componentType==="Resistor"&&"resistance"in Y){const{value:te,unit:de}=Gc(Y,"resistance","resistanceUnit",Ps("resistance"));U=te&&te.trim()!==""?Yc(te,de):""}else if((Y.componentType==="Capacitor"||Y.componentType==="Electrolytic Capacitor"||Y.componentType==="Film Capacitor")&&"capacitance"in Y){const{value:te,unit:de}=Gc(Y,"capacitance","capacitanceUnit",Ps("capacitance"));U=te&&te.trim()!==""?Yc(te,de):""}else if(Y.componentType==="Inductor"&&"inductance"in Y){const{value:te,unit:de}=Gc(Y,"inductance","inductanceUnit",Ps("inductance"));U=te&&te.trim()!==""?Yc(te,de):""}else ee||(U=Y.partName?.trim()||Y.componentType);const $=Y.packageType?.trim()||Y.package?.trim()||Y.footprint?.trim()||"",H=Y.pinData,R=Y.pinNames,Z=Y.pinCount||0,G=[];for(let te=0;te<Z;te++){const de=String(te+1);let Ce=de;H&&te<H.length&&H[te]?.name?.trim()?Ce=H[te].name.trim():R&&te<R.length&&R[te]?.trim()&&(Ce=R[te].trim());let Re;const xe=H?.[te]?.type?.trim();xe&&xe!==""?Re=xe:Re=g(Ce),G.push({number:de,name:Ce,type:Re})}const we={designator:J,package:$,pins:G};ee&&(we.part_number=ee),U&&(we.value=U),ae.push(we)}const q=[];for(const[J,Y]of m){const ee=T.get(J);if(!ee)continue;const U=[];let $,H;for(const G of Y)if(G.type==="power"&&G.powerBusId){const we=l.find(te=>te.id===G.powerBusId);we&&($=we.name)}else if(G.type==="ground"&&G.groundBusId){const we=d.find(te=>te.id===G.groundBusId);we&&(H=we.name)}for(const G of Y)if(G.componentId&&G.pinIndex!==void 0){const we=n.find(te=>te.id===G.componentId);if(we){const te=we.designator?.trim()||we.abbreviation?.trim();if(te){const de=String(G.pinIndex+1),Ce=we.pinData,Re=we.pinNames;let xe=de;Ce&&G.pinIndex<Ce.length&&Ce[G.pinIndex]?.name?.trim()?xe=Ce[G.pinIndex].name.trim():Re&&G.pinIndex<Re.length&&Re[G.pinIndex]?.trim()&&(xe=Re[G.pinIndex].trim());let k;const A=Ce?.[G.pinIndex]?.type?.trim();A&&A!==""&&(k=A);const V={component:te,pin_number:de,pin_name:xe};k&&(V.pin_type=k);const W=`${we.id}:${G.pinIndex}`,se=D.get(W);if(se&&se.size>0)for(const Te of se){const le=l.find(ve=>ve.name===Te),_e=d.find(ve=>ve.name===Te);le&&!V.power_bus?V.power_bus=Te:_e&&!V.ground_bus&&(V.ground_bus=Te)}if(!V.power_bus&&G.powerBusId){const Te=l.find(le=>le.id===G.powerBusId);Te&&(V.power_bus=Te.name)}if(!V.ground_bus&&G.groundBusId){const Te=d.find(le=>le.id===G.groundBusId);Te&&(V.ground_bus=Te.name)}!V.power_bus&&$&&(V.power_bus=$),!V.ground_bus&&H&&(V.ground_bus=H),U.push(V)}}}const R=ee.startsWith("+")||ee.startsWith("-"),Z=ee==="GND"||ee.toUpperCase().includes("GROUND");(U.length>0||R||Z)&&q.push({name:ee,connections:U})}q.sort((J,Y)=>{if(J.name==="GND")return-1;if(Y.name==="GND")return 1;const ee=J.name.startsWith("+")||J.name.startsWith("-"),U=Y.name.startsWith("+")||Y.name.startsWith("-");if(ee&&!U)return-1;if(!ee&&U)return 1;if(ee&&U){const $=parseFloat(J.name.replace(/[^0-9.-]/g,""))||0,H=parseFloat(Y.name.replace(/[^0-9.-]/g,""))||0;if(H!==$)return H-$}return J.name.localeCompare(Y.name)});const re={design_info:{name:v||"reversed_pcb",date:new Date().toISOString().split("T")[0]},components:ae,nets:q};return JSON.stringify(re,null,2)}function dd(n,r,o,s){if(r==="power"){const d=n[r]||"";return typeof d=="string"&&d.trim()!==""?{value:d.replace(/W$/i,"").trim(),unit:"W"}:{value:"",unit:"W"}}if(n[r]!==void 0||n[o]!==void 0)return{value:n[r]||"",unit:n[o]||s};const l=n[r]||"";return typeof l=="string"&&l.trim()!==""?Wy(l):{value:"",unit:s}}function D2(n){if((n.componentType==="Resistor"||n.componentType==="ResistorNetwork"||n.componentType==="Thermistor"||n.componentType==="VariableResistor")&&"resistance"in n){const{value:s,unit:l}=dd(n,"resistance","resistanceUnit",Ps("resistance"));if(s&&s.trim()!=="")return ud(s,l)}if((n.componentType==="Capacitor"||n.componentType==="Electrolytic Capacitor"||n.componentType==="Film Capacitor")&&"capacitance"in n){const{value:s,unit:l}=dd(n,"capacitance","capacitanceUnit",Ps("capacitance"));if(s&&s.trim()!=="")return ud(s,l)}if(n.componentType==="Inductor"&&"inductance"in n){const{value:s,unit:l}=dd(n,"inductance","inductanceUnit",Ps("inductance"));if(s&&s.trim()!=="")return ud(s,l)}if(n.componentType==="Fuse"&&"current"in n){const{value:s,unit:l}=dd(n,"current","currentUnit",Ps("current"));if(s&&s.trim()!=="")return ud(s,l)}if(n.componentType==="Battery"){const{value:s,unit:l}=dd(n,"capacity","capacityUnit",Ps("capacity"));if(s&&s.trim()!=="")return ud(s,l);const{value:d,unit:v}=dd(n,"voltage","voltageUnit",Ps("voltage"));if(d&&d.trim()!=="")return ud(d,v)}if(n.componentType==="PowerSupply"){const{value:s,unit:l}=dd(n,"outputVoltage","outputVoltageUnit",Ps("voltage"));if(s&&s.trim()!=="")return ud(s,l)}const r=n.partName?.trim();if(r&&r!=="")return r;const o=n.partNumber?.trim();return o&&o!==""?o:Wl(n.componentType)}function R2(n,r,o){const s=[...n,...r],l=s.length,d=new Map;for(const p of s){const b=Wl(p.componentType),m=D2(p),T=`${b}|${m}`;if(!d.has(T)){const M=n.some(_=>_.id===p.id),S=r.some(_=>_.id===p.id),F=M&&S?"both":M?"top":"bottom";d.set(T,{componentType:b,value:m,quantity:0,designators:[],packageType:p.packageType,manufacturer:p.manufacturer,partNumber:p.partNumber,description:p.description,notes:p.notes,datasheet:p.datasheet,layer:F})}const D=d.get(T);D.quantity++,p.designator&&p.designator.trim()!==""&&D.designators.push(p.designator.trim())}const v=Array.from(d.values()).sort((p,b)=>p.componentType!==b.componentType?p.componentType.localeCompare(b.componentType):p.value.localeCompare(b.value));return{version:"1.0",exportedAt:new Date().toISOString(),projectName:o,totalComponents:l,uniqueComponents:v.length,items:v}}const v1={via:{color:"#2CA02C",size:18},padTop:{color:"#0072B2",size:18},padBottom:{color:"#56B4E9",size:18},testPointTop:{color:"#FFFF00",size:18},testPointBottom:{color:"#FFFF00",size:18},traceTop:{color:"#AA4499",size:6},traceBottom:{color:"#F781BF",size:6},componentTop:{color:"#6A3D9A",size:18},componentBottom:{color:"#9467BD",size:18},power:{color:"#ff0000",size:18},ground:{color:"#000000",size:18}},Ff={via:"Via",padTop:"Pad (Top)",padBottom:"Pad (Bottom)",testPointTop:"Test Point (Top)",testPointBottom:"Test Point (Bottom)",traceTop:"Trace (Top)",traceBottom:"Trace (Bottom)",componentTop:"Component (Top)",componentBottom:"Component (Bottom)",power:"Power",ground:"Ground"};class L2{instances=new Map;listeners=new Map;initialize(){for(const r of Object.keys(v1)){const o=v1[r];this.instances.set(r,{id:r,name:Ff[r],color:o.color,size:o.size}),this.listeners.set(r,new Set)}}initializeFromProject(r){if(this.initialize(),r?.toolInstances)for(const[o,s]of Object.entries(r.toolInstances))this.instances.has(o)&&this.instances.set(o,s)}get(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);return o}getColor(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);const s=Ff[r];return console.log(`${s}, returning color value=${o.color}`),o.color}getSize(r){const o=this.instances.get(r);if(!o)throw new Error(`Tool instance ${r} not found`);const s=Ff[r];return console.log(`${s}, returning size value=${o.size}`),o.size}setColor(r,o){const s=this.instances.get(r);if(s){const l=Ff[r];console.log(`${l}, setting color value=${o}`),s.color=o,this.notifyListeners(r)}}setSize(r,o){const s=this.instances.get(r);if(s){const l=Ff[r];console.log(`${l}, setting size value=${o}`),s.size=o,this.notifyListeners(r)}}getAll(){const r={};for(const[o,s]of this.instances.entries())r[o]=s;return r}subscribe(r,o){const s=this.listeners.get(r);return s?(s.add(o),()=>{s.delete(o)}):()=>{}}notifyListeners(r){const o=this.listeners.get(r);o&&o.forEach(s=>s())}}const Un=new L2;Un.initialize();function Hp(n,r){switch(n){case"via":return"via";case"pad":return r==="bottom"?"padBottom":"padTop";case"testPoint":return r==="bottom"?"testPointBottom":"testPointTop";case"trace":return r==="bottom"?"traceBottom":"traceTop";case"component":return r==="bottom"?"componentBottom":"componentTop";case"power":return"power";case"ground":return"ground";default:throw new Error(`Unknown tool: ${n}`)}}function I2(n){return()=>{console.log("closeProject: Starting comprehensive state clearing..."),n.setProjectDirHandle(null),n.setAutoSaveDirHandle(null),n.projectDirHandleRef&&(n.projectDirHandleRef.current=null),n.autoSaveDirHandleRef&&(n.autoSaveDirHandleRef.current=null),n.setCurrentProjectFilePath(""),n.setProjectName(""),n.setAutoSaveEnabled(!1),n.setAutoSaveInterval(null),n.setAutoSaveBaseName(""),n.setAutoSaveFileHistory([]),n.setCurrentFileIndex(-1),n.autoSaveBaseNameRef&&(n.autoSaveBaseNameRef.current=""),n.hasChangesSinceLastAutoSaveRef.current=!1,n.setHasUnsavedChangesState(!1),n.setIsBottomView(!1),n.setOriginalTopFlipX(null),n.setOriginalBottomFlipX(null),n.autoSaveIntervalRef.current&&(clearInterval(n.autoSaveIntervalRef.current),n.autoSaveIntervalRef.current=null),n.setTopImage(null),n.setBottomImage(null),n.clearSnapshot(),n.setDrawingStrokes([]),n.setVias([]),n.setPads([]),n.setTracesTop([]),n.setTracesBottom([]),n.setCurrentStroke([]),n.currentStrokeRef.current=[],n.setComponentsTop([]),n.setComponentsBottom([]),n.setComponentEditor(null),n.setConnectingPin(null),n.setPowerSymbols([]),n.setGroundSymbols([]),n.setPowerEditor(null),n.setPowerBuses([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),n.setGroundBuses([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),n.setSelectedIds(new Set),n.setSelectedComponentIds(new Set),n.setSelectedPowerIds(new Set),n.setSelectedGroundIds(new Set),n.setIsSelecting(!1),n.setProjectNotes([]),n.setProjectMetadata({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),n.setCurrentView("overlay"),n.setViewScale(1),n.setCameraCenter(0,0),n.setShowBothLayers(!0),n.setSelectedDrawingLayer("top"),n.setHomeViews({}),n.setIsWaitingForHomeViewKey(!1),n.homeViewTimeoutRef.current&&(clearTimeout(n.homeViewTimeoutRef.current),n.homeViewTimeoutRef.current=null),n.setSelectedImageForTransform(null),n.setIsTransforming(!1),n.setTransformStartPos(null),n.setTransformMode("nudge"),n.setIsGrayscale(!1),n.setTransparency(50),n.setIsTransparencyCycling(!1),n.setTransparencyCycleSpeed(2e3),n.setAreImagesLocked(!1),n.setAreViasLocked(!1),n.setArePadsLocked(!1),n.setAreTestPointsLocked(!1),n.setAreTracesLocked(!1),n.setAreComponentsLocked(!1),n.setAreGroundNodesLocked(!1),n.setArePowerNodesLocked(!1),n.setShowTopImage(!0),n.setShowBottomImage(!0),n.setShowViasLayer(!0),n.setShowTopTracesLayer(!0),n.setShowBottomTracesLayer(!0),n.setShowTopPadsLayer(!0),n.setShowBottomPadsLayer(!0),n.setShowTopTestPointsLayer(!0),n.setShowBottomTestPointsLayer(!0),n.setShowTopComponents(!0),n.setShowBottomComponents(!0),n.setShowPowerLayer(!0),n.setShowGroundLayer(!0),n.setShowConnectionsLayer(!0),n.setShowTraceCornerDots(!0),n.setCurrentTool("select"),n.setDrawingMode("trace"),n.setTraceToolLayer("top"),n.setPadToolLayer("top"),n.setTestPointToolLayer("top"),n.setComponentToolLayer("top"),n.traceToolLayerRef.current="top",n.padToolLayerRef.current="top",n.testPointToolLayerRef.current="top",n.componentToolLayerRef.current="top",n.sessionDesignatorCountersRef.current={},n.setAutoAssignDesignators(!0),n.setUseGlobalDesignatorCounters(!1),Hf(),Un.initialize(),n.setOpenMenu(null),n.setDebugDialog({visible:!1,text:""}),n.setErrorDialog({visible:!1,title:"",message:""}),n.setNewProjectDialog({visible:!1}),n.setOpenProjectDialog({visible:!1}),n.setNewProjectSetupDialog({visible:!1,projectName:"",locationPath:"",locationHandle:null}),n.setSaveAsDialog({visible:!1,filename:"",locationPath:"",locationHandle:null}),n.setAutoSaveDialog({visible:!1,interval:null}),n.setAutoSavePromptDialog({visible:!1,source:"new",interval:5}),n.setShowColorPicker(!1),n.setShowPowerBusManager(!1),n.setShowGroundBusManager(!1),n.setShowDesignatorManager(!1),n.setShowBoardDimensionsDialog(!1),n.setNotesDialogVisible(!1),n.setProjectNotesDialogVisible(!1),n.setTransformImagesDialogVisible(!1),n.setTransformAllDialogVisible(!1),n.setBoardDimensions(null),n.setHoverComponent(null),n.setHoverTestPoint(null),n.setIsPanning(!1),n.panStartRef.current=null,n.panClientStartRef.current=null,n.setIsDrawing(!1),n.setTracePreviewMousePos(null),n.lastTraceClickTimeRef.current=0,n.isDoubleClickingTraceRef.current=!1,console.log("closeProject: All state cleared and browser permissions released")}}async function M2(n){console.log("Ensuring project isolation: Starting comprehensive cleanup..."),n(),await new Promise(r=>setTimeout(r,150)),Un.initialize(),Hf(),await new Promise(r=>setTimeout(r,50)),console.log("Project isolation complete: All state cleared, safe to proceed with new project")}async function B2(n,r,o,s,l,d,v,p,b,m,T,D,M){const S=n.trim().replace(/[^a-zA-Z0-9_-]/g,"_");if(!S)return{success:!1,error:"Please enter a valid project name."};await o();let F;try{F=await r.getDirectoryHandle(S,{create:!0})}catch(_){return console.error("Failed to create project folder:",_),{success:!1,error:`Failed to create project folder "${S}". See console for details.`}}try{const _=F;if(_.queryPermission&&await _.queryPermission({mode:"readwrite"})!=="granted"&&await _.requestPermission({mode:"readwrite"})!=="granted")return{success:!1,error:"Full access to the project directory is required to create and manage project files."}}catch(_){console.warn("Permission check failed (may not be supported in this browser):",_)}try{await F.getDirectoryHandle("history",{create:!0}),await F.getDirectoryHandle("images",{create:!0}),await F.getDirectoryHandle("datasheets",{create:!0}),await F.getDirectoryHandle("BOM",{create:!0}),await F.getDirectoryHandle("netlists",{create:!0}),console.log("Created project subdirectories: history, images, datasheets, BOM, netlists")}catch(_){console.error("Failed to create project subdirectories:",_)}s(S),l(F),v.current=F,b(),m(),T(!1),D(0);try{const{project:_,timestamp:N}=p(),g=`${S}_${N}.json`,ae=JSON.stringify(_,null,2),E=new Blob([ae],{type:"application/json"}),re=await(await F.getFileHandle(g,{create:!0})).createWritable();return await re.write(E),await re.close(),d(g),console.log(`New project created: ${S}/${g}`),await M(5,S,F,!0),{success:!0,projectDirHandle:F,projectFileName:g,projectName:S}}catch(_){return console.error("Failed to save new project:",_),{success:!1,error:"Failed to save new project file. See console for details."}}}async function w1(n,r,o,s,l,d,v,p,b){const m=window;let T;if(b)T=b;else{if(typeof m.showDirectoryPicker!="function")return{success:!1,error:"Directory picker is not supported in this browser."};try{T=await m.showDirectoryPicker({mode:"readwrite"})}catch(D){if(D?.name==="AbortError")return{success:!1,error:"User cancelled directory selection."};throw D}}try{try{const g=T;if(g.queryPermission&&await g.queryPermission({mode:"readwrite"})!=="granted"&&await g.requestPermission({mode:"readwrite"})!=="granted")return{success:!1,error:"Full access to the project directory is required to open and manage project files."}}catch(g){console.warn("Permission check failed (may not be supported in this browser):",g)}d.current=!0,await n();const D=T.name;let M=null,S=null,F="";try{const g=[],ae=T;for await(const[J,Y]of ae.entries())if(Y.kind==="file"&&J.toLowerCase().endsWith(".json")&&J.replace(/\.json$/i,"").toLowerCase().startsWith(D.toLowerCase()))try{const U=await Y.getFile();g.push({name:J,handle:Y,lastModified:U.lastModified})}catch(U){console.warn(`Failed to read file ${J}:`,U)}if(g.length===0)return{success:!1,error:`No project file found in the selected directory that starts with "${D}". Please ensure the project file name starts with the directory name.`};g.sort((J,Y)=>Y.lastModified-J.lastModified);const E=g[0];M=E.handle,F=E.name;const re=await(await M.getFile()).text();S=JSON.parse(re),o(F),g.length>1?console.log(`Found ${g.length} project files starting with "${D}". Selected most recent: ${F}`):console.log(`Found project file: ${F}`)}catch(g){return console.error("Failed to find or open project file:",g),{success:!1,error:`Failed to open project file: ${g instanceof Error?g.message:String(g)}. See console for details.`}}r(T),l.current=T;try{await T.getDirectoryHandle("history",{create:!0}),await T.getDirectoryHandle("images",{create:!0}),await T.getDirectoryHandle("datasheets",{create:!0}),await T.getDirectoryHandle("BOM",{create:!0}),await T.getDirectoryHandle("netlists",{create:!0}),console.log("Created/verified project subdirectories: history, images, datasheets, BOM, netlists")}catch(g){console.error("Failed to create/verify project subdirectories:",g)}setTimeout(()=>{d.current=!1},1e3),await v(S,T);let _;if(S.projectInfo?.name)_=S.projectInfo.name;else if(_=hd(D).replace(/[^a-zA-Z0-9_-]/g,"_"),!_){const ae=F.replace(/\.json$/i,"");_=hd(ae).replace(/[^a-zA-Z0-9_-]/g,"_")}return _?(s(_),S.autoSave?.enabled===!0&&S.autoSave?.interval?await p(S.autoSave.interval,_,T,!1):await p(5,_,T,!1),{success:!0,projectDirHandle:T,projectFileName:F,projectName:_}):{success:!1,error:"Warning: Could not determine project name. Please ensure the project file or directory has a valid name."}}catch(D){return D?.name==="AbortError"?{success:!1,error:"User cancelled directory selection."}:(console.error("Failed to open project:",D),{success:!1,error:`Failed to open project: ${D instanceof Error?D.message:String(D)}. See console for details.`})}}async function O2(n,r,o,s,l,d,v,p,b,m,T,D,M,S,F){if(console.log("Auto save: performAutoSave called"),!n||!r){console.warn(`Auto save: Missing project directory handle (${!n}) or base name (${!r}). Please create a new project or open an existing project first.`),S(!1),F.current&&(clearInterval(F.current),F.current=null);return}if(!o.current){console.log("Auto save: Skipping - no changes since last save");return}const _=s.current,N=_.filter(Y=>Y.type==="trace"&&Y.points.length<2);if(N.length>0){console.log(`Auto save: Cleaning up ${N.length} single-point trace(s) before save`),N.forEach(ee=>console.log(`  - Removing single-point trace ${ee.id}`));const Y=_.filter(ee=>!(ee.type==="trace"&&ee.points.length<2));l(Y),s.current=Y}console.log("Auto save: Starting save...");const{project:g,timestamp:ae}=d(),q=`${hd(r)}_${ae}.json`,re=JSON.stringify(g,null,2),J=new Blob([re],{type:"application/json"});try{let Y;try{Y=await n.getDirectoryHandle("history",{create:!0})}catch(R){console.error("Failed to get/create history directory:",R);return}try{const R=[],Z=p.current;for await(const G of n.keys())try{if(G==="history"||G==="images"||G==="datasheets"||G==="BOM"||G==="netlists"||G===q)continue;const te=await(await n.getFileHandle(G)).getFile();if(!G.endsWith(".json"))continue;const de=await te.text();try{const Ce=JSON.parse(de);if(Ce.version){R.push(G);const Re=Ce.fileType?"auto-saved":"manually saved/opened";console.log(`Auto save: Found PCB project file in root: ${G} (${Re}${G===Z?" - this is the opened file":""})`)}}catch{continue}}catch{continue}for(const G of R)try{const de=await(await(await n.getFileHandle(G)).getFile()).text(),Re=await(await Y.getFileHandle(G,{create:!0})).createWritable();await Re.write(new Blob([de],{type:"application/json"})),await Re.close(),await n.removeEntry(G),console.log(`Auto save: Moved ${G} from root to history/`)}catch(we){console.warn(`Auto save: Failed to move ${G} to history:`,we)}}catch(R){console.warn("Auto save: Error checking for old files in root:",R)}const U=await(await n.getFileHandle(q,{create:!0})).createWritable();await U.write(J),await U.close(),console.log(`Auto save: Successfully saved ${q} to root directory`),v(q),p.current=q;const $=m.current,H=[q,...$.filter(R=>R!==q)].sort((R,Z)=>Z.localeCompare(R));b(H),m.current=H,T(0),D.current=0,o.current=!1,M(!1)}catch(Y){console.error("Auto save failed:",Y)}}async function Hd(n,r,o,s,l,d,v,p,b,m,T,D,M,S,F,_=!1){if(n===null){s(!1),l(null),m.current&&(clearInterval(m.current),m.current=null),D({visible:!1,interval:5}),_&&M({visible:!1,source:null,interval:5}),console.log("Auto save: Disabled");return}if(!r){console.warn("Auto save: No project name available. Please create a new project or open an existing project first.");return}let N=o;if(!N){const re=window;if(typeof re.showDirectoryPicker=="function")try{N=await re.showDirectoryPicker(),S(N)}catch(J){J?.name!=="AbortError"&&console.error("Failed to get directory:",J);return}else{console.warn("Directory picker is not supported in this browser. Auto-save requires a directory handle.");return}}d(N);const g=r.replace(/\.json$/i,""),E=hd(g).replace(/[^a-zA-Z0-9_-]/g,"_");v(E),p.current=N,b.current=E,m.current&&(clearInterval(m.current),m.current=null),l(n),s(!0),T.current=!0,D({visible:!1,interval:5}),_&&M({visible:!1,source:null,interval:5});const q=n*60*1e3;m.current=setInterval(()=>{F.current&&F.current()},q),setTimeout(()=>{console.log(`Auto save: Enabled with interval ${n} minutes`),F.current&&F.current()},200)}const U2="modulepreload",F2=function(n){return"/PCB_Reverse_Engineering_Tool/"+n},S1={},ug=function(r,o,s){let l=Promise.resolve();if(o&&o.length>0){let b=function(m){return Promise.all(m.map(T=>Promise.resolve(T).then(D=>({status:"fulfilled",value:D}),D=>({status:"rejected",reason:D}))))};document.getElementsByTagName("link");const v=document.querySelector("meta[property=csp-nonce]"),p=v?.nonce||v?.getAttribute("nonce");l=b(o.map(m=>{if(m=F2(m),m in S1)return;S1[m]=!0;const T=m.endsWith(".css"),D=T?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${D}`))return;const M=document.createElement("link");if(M.rel=T?"stylesheet":U2,T||(M.as="script"),M.crossOrigin="",M.href=m,p&&M.setAttribute("nonce",p),document.head.appendChild(M),T)return new Promise((S,F)=>{M.addEventListener("load",S),M.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${m}`)))})}))}function d(v){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=v,window.dispatchEvent(p),!p.defaultPrevented)throw v}return l.then(v=>{for(const p of v||[])p.status==="rejected"&&d(p.reason);return r().catch(d)})};function Ir(n){"@babel/helpers - typeof";return Ir=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ir(n)}var zc=Uint8Array,$l=Uint16Array,Zg=Int32Array,Jg=new zc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Qg=new zc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),j1=new zc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Yy=function(n,r){for(var o=new $l(31),s=0;s<31;++s)o[s]=r+=1<<n[s-1];for(var l=new Zg(o[30]),s=1;s<30;++s)for(var d=o[s];d<o[s+1];++d)l[d]=d-o[s]<<5|s;return{b:o,r:l}},Xy=Yy(Jg,2),E2=Xy.b,Bg=Xy.r;E2[28]=258,Bg[258]=28;var q2=Yy(Qg,0),T1=q2.r,Og=new $l(32768);for(var jo=0;jo<32768;++jo){var Bu=(jo&43690)>>1|(jo&21845)<<1;Bu=(Bu&52428)>>2|(Bu&13107)<<2,Bu=(Bu&61680)>>4|(Bu&3855)<<4,Og[jo]=((Bu&65280)>>8|(Bu&255)<<8)>>1}var Wf=(function(n,r,o){for(var s=n.length,l=0,d=new $l(r);l<s;++l)n[l]&&++d[n[l]-1];var v=new $l(r);for(l=1;l<r;++l)v[l]=v[l-1]+d[l-1]<<1;var p;if(o){p=new $l(1<<r);var b=15-r;for(l=0;l<s;++l)if(n[l])for(var m=l<<4|n[l],T=r-n[l],D=v[n[l]-1]++<<T,M=D|(1<<T)-1;D<=M;++D)p[Og[D]>>b]=m}else for(p=new $l(s),l=0;l<s;++l)n[l]&&(p[l]=Og[v[n[l]-1]++]>>15-n[l]);return p}),yd=new zc(288);for(var jo=0;jo<144;++jo)yd[jo]=8;for(var jo=144;jo<256;++jo)yd[jo]=9;for(var jo=256;jo<280;++jo)yd[jo]=7;for(var jo=280;jo<288;++jo)yd[jo]=8;var sh=new zc(32);for(var jo=0;jo<32;++jo)sh[jo]=5;var V2=Wf(yd,9,0),H2=Wf(sh,5,0),Ky=function(n){return(n+7)/8|0},W2=function(n,r,o){return(o==null||o>n.length)&&(o=n.length),new zc(n.subarray(r,o))},fu=function(n,r,o){o<<=r&7;var s=r/8|0;n[s]|=o,n[s+1]|=o>>8},Ef=function(n,r,o){o<<=r&7;var s=r/8|0;n[s]|=o,n[s+1]|=o>>8,n[s+2]|=o>>16},dg=function(n,r){for(var o=[],s=0;s<n.length;++s)n[s]&&o.push({s,f:n[s]});var l=o.length,d=o.slice();if(!l)return{t:Jy,l:0};if(l==1){var v=new zc(o[0].s+1);return v[o[0].s]=1,{t:v,l:1}}o.sort(function(re,J){return re.f-J.f}),o.push({s:-1,f:25001});var p=o[0],b=o[1],m=0,T=1,D=2;for(o[0]={s:-1,f:p.f+b.f,l:p,r:b};T!=l-1;)p=o[o[m].f<o[D].f?m++:D++],b=o[m!=T&&o[m].f<o[D].f?m++:D++],o[T++]={s:-1,f:p.f+b.f,l:p,r:b};for(var M=d[0].s,s=1;s<l;++s)d[s].s>M&&(M=d[s].s);var S=new $l(M+1),F=Ug(o[T-1],S,0);if(F>r){var s=0,_=0,N=F-r,g=1<<N;for(d.sort(function(J,Y){return S[Y.s]-S[J.s]||J.f-Y.f});s<l;++s){var ae=d[s].s;if(S[ae]>r)_+=g-(1<<F-S[ae]),S[ae]=r;else break}for(_>>=N;_>0;){var E=d[s].s;S[E]<r?_-=1<<r-S[E]++-1:++s}for(;s>=0&&_;--s){var q=d[s].s;S[q]==r&&(--S[q],++_)}F=r}return{t:new zc(S),l:F}},Ug=function(n,r,o){return n.s==-1?Math.max(Ug(n.l,r,o+1),Ug(n.r,r,o+1)):r[n.s]=o},C1=function(n){for(var r=n.length;r&&!n[--r];);for(var o=new $l(++r),s=0,l=n[0],d=1,v=function(b){o[s++]=b},p=1;p<=r;++p)if(n[p]==l&&p!=r)++d;else{if(!l&&d>2){for(;d>138;d-=138)v(32754);d>2&&(v(d>10?d-11<<5|28690:d-3<<5|12305),d=0)}else if(d>3){for(v(l),--d;d>6;d-=6)v(8304);d>2&&(v(d-3<<5|8208),d=0)}for(;d--;)v(l);d=1,l=n[p]}return{c:o.subarray(0,s),n:r}},qf=function(n,r){for(var o=0,s=0;s<r.length;++s)o+=n[s]*r[s];return o},Zy=function(n,r,o){var s=o.length,l=Ky(r+2);n[l]=s&255,n[l+1]=s>>8,n[l+2]=n[l]^255,n[l+3]=n[l+1]^255;for(var d=0;d<s;++d)n[l+d+4]=o[d];return(l+4+s)*8},N1=function(n,r,o,s,l,d,v,p,b,m,T){fu(r,T++,o),++l[256];for(var D=dg(l,15),M=D.t,S=D.l,F=dg(d,15),_=F.t,N=F.l,g=C1(M),ae=g.c,E=g.n,q=C1(_),re=q.c,J=q.n,Y=new $l(19),ee=0;ee<ae.length;++ee)++Y[ae[ee]&31];for(var ee=0;ee<re.length;++ee)++Y[re[ee]&31];for(var U=dg(Y,7),$=U.t,H=U.l,R=19;R>4&&!$[j1[R-1]];--R);var Z=m+5<<3,G=qf(l,yd)+qf(d,sh)+v,we=qf(l,M)+qf(d,_)+v+14+3*R+qf(Y,$)+2*Y[16]+3*Y[17]+7*Y[18];if(b>=0&&Z<=G&&Z<=we)return Zy(r,T,n.subarray(b,b+m));var te,de,Ce,Re;if(fu(r,T,1+(we<G)),T+=2,we<G){te=Wf(M,S,0),de=M,Ce=Wf(_,N,0),Re=_;var xe=Wf($,H,0);fu(r,T,E-257),fu(r,T+5,J-1),fu(r,T+10,R-4),T+=14;for(var ee=0;ee<R;++ee)fu(r,T+3*ee,$[j1[ee]]);T+=3*R;for(var k=[ae,re],A=0;A<2;++A)for(var V=k[A],ee=0;ee<V.length;++ee){var W=V[ee]&31;fu(r,T,xe[W]),T+=$[W],W>15&&(fu(r,T,V[ee]>>5&127),T+=V[ee]>>12)}}else te=V2,de=yd,Ce=H2,Re=sh;for(var ee=0;ee<p;++ee){var se=s[ee];if(se>255){var W=se>>18&31;Ef(r,T,te[W+257]),T+=de[W+257],W>7&&(fu(r,T,se>>23&31),T+=Jg[W]);var Te=se&31;Ef(r,T,Ce[Te]),T+=Re[Te],Te>3&&(Ef(r,T,se>>5&8191),T+=Qg[Te])}else Ef(r,T,te[se]),T+=de[se]}return Ef(r,T,te[256]),T+de[256]},$2=new Zg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Jy=new zc(0),G2=function(n,r,o,s,l,d){var v=d.z||n.length,p=new zc(s+v+5*(1+Math.ceil(v/7e3))+l),b=p.subarray(s,p.length-l),m=d.l,T=(d.r||0)&7;if(r){T&&(b[0]=d.r>>3);for(var D=$2[r-1],M=D>>13,S=D&8191,F=(1<<o)-1,_=d.p||new $l(32768),N=d.h||new $l(F+1),g=Math.ceil(o/3),ae=2*g,E=function(qt){return(n[qt]^n[qt+1]<<g^n[qt+2]<<ae)&F},q=new Zg(25e3),re=new $l(288),J=new $l(32),Y=0,ee=0,U=d.i||0,$=0,H=d.w||0,R=0;U+2<v;++U){var Z=E(U),G=U&32767,we=N[Z];if(_[G]=we,N[Z]=G,H<=U){var te=v-U;if((Y>7e3||$>24576)&&(te>423||!m)){T=N1(n,b,0,q,re,J,ee,$,R,U-R,T),$=Y=ee=0,R=U;for(var de=0;de<286;++de)re[de]=0;for(var de=0;de<30;++de)J[de]=0}var Ce=2,Re=0,xe=S,k=G-we&32767;if(te>2&&Z==E(U-k))for(var A=Math.min(M,te)-1,V=Math.min(32767,U),W=Math.min(258,te);k<=V&&--xe&&G!=we;){if(n[U+Ce]==n[U+Ce-k]){for(var se=0;se<W&&n[U+se]==n[U+se-k];++se);if(se>Ce){if(Ce=se,Re=k,se>A)break;for(var Te=Math.min(k,se-2),le=0,de=0;de<Te;++de){var _e=U-k+de&32767,ve=_[_e],De=_e-ve&32767;De>le&&(le=De,we=_e)}}}G=we,we=_[G],k+=G-we&32767}if(Re){q[$++]=268435456|Bg[Ce]<<18|T1[Re];var Xe=Bg[Ce]&31,st=T1[Re]&31;ee+=Jg[Xe]+Qg[st],++re[257+Xe],++J[st],H=U+Ce,++Y}else q[$++]=n[U],++re[n[U]]}}for(U=Math.max(U,H);U<v;++U)q[$++]=n[U],++re[n[U]];T=N1(n,b,m,q,re,J,ee,$,R,U-R,T),m||(d.r=T&7|b[T/8|0]<<3,T-=7,d.h=N,d.p=_,d.i=U,d.w=H)}else{for(var U=d.w||0;U<v+m;U+=65535){var kt=U+65535;kt>=v&&(b[T/8|0]=m,kt=v),T=Zy(b,T+1,n.subarray(U,kt))}d.i=v}return W2(p,0,s+Ky(T)+l)},Qy=function(){var n=1,r=0;return{p:function(o){for(var s=n,l=r,d=o.length|0,v=0;v!=d;){for(var p=Math.min(v+2655,d);v<p;++v)l+=s+=o[v];s=(s&65535)+15*(s>>16),l=(l&65535)+15*(l>>16)}n=s,r=l},d:function(){return n%=65521,r%=65521,(n&255)<<24|(n&65280)<<8|(r&255)<<8|r>>8}}},Y2=function(n,r,o,s,l){if(!l&&(l={l:1},r.dictionary)){var d=r.dictionary.subarray(-32768),v=new zc(d.length+n.length);v.set(d),v.set(n,d.length),n=v,l.w=d.length}return G2(n,r.level==null?6:r.level,r.mem==null?l.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+r.mem,o,s,l)},ex=function(n,r,o){for(;o;++r)n[r]=o,o>>>=8},X2=function(n,r){var o=r.level,s=o==0?0:o<6?1:o==9?3:2;if(n[0]=120,n[1]=s<<6|(r.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,r.dictionary){var l=Qy();l.p(r.dictionary),ex(n,2,l.d())}};function Fg(n,r){r||(r={});var o=Qy();o.p(n);var s=Y2(n,r,r.dictionary?6:2,4);return X2(s,r),ex(s,s.length-4,o.d()),s}var K2=typeof TextDecoder<"u"&&new TextDecoder,Z2=0;try{K2.decode(Jy,{stream:!0}),Z2=1}catch{}function J2(n){if(Array.isArray(n))return n}function Q2(n,r){var o=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(o!=null){var s,l,d,v,p=[],b=!0,m=!1;try{if(d=(o=o.call(n)).next,r!==0)for(;!(b=(s=d.call(o)).done)&&(p.push(s.value),p.length!==r);b=!0);}catch(T){m=!0,l=T}finally{try{if(!b&&o.return!=null&&(v=o.return(),Object(v)!==v))return}finally{if(m)throw l}}return p}}function k1(n,r){(r==null||r>n.length)&&(r=n.length);for(var o=0,s=Array(r);o<r;o++)s[o]=n[o];return s}function eb(n,r){if(n){if(typeof n=="string")return k1(n,r);var o={}.toString.call(n).slice(8,-1);return o==="Object"&&n.constructor&&(o=n.constructor.name),o==="Map"||o==="Set"?Array.from(n):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?k1(n,r):void 0}}function tb(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A1(n,r){return J2(n)||Q2(n,r)||eb(n,r)||tb()}function z1(n,r="utf8"){return new TextDecoder(r).decode(n)}const nb=new TextEncoder;function ib(n){return nb.encode(n)}const rb=1024*8,ob=(()=>{const n=new Uint8Array(4),r=new Uint32Array(n.buffer);return!((r[0]=1)&n[0])})(),fg={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class e0{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(r=rb,o={}){let s=!1;typeof r=="number"?r=new ArrayBuffer(r):(s=!0,this.lastWrittenByte=r.byteLength);const l=o.offset?o.offset>>>0:0,d=r.byteLength-l;let v=l;(ArrayBuffer.isView(r)||r instanceof e0)&&(r.byteLength!==r.buffer.byteLength&&(v=r.byteOffset+l),r=r.buffer),s?this.lastWrittenByte=d:this.lastWrittenByte=0,this.buffer=r,this.length=d,this.byteLength=d,this.byteOffset=v,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,v,d),this._mark=0,this._marks=[]}available(r=1){return this.offset+r<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(r=1){return this.offset+=r,this}back(r=1){return this.offset-=r,this}seek(r){return this.offset=r,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const r=this._marks.pop();if(r===void 0)throw new Error("Mark stack empty");return this.seek(r),this}rewind(){return this.offset=0,this}ensureAvailable(r=1){if(!this.available(r)){const s=(this.offset+r)*2,l=new Uint8Array(s);l.set(new Uint8Array(this.buffer)),this.buffer=l.buffer,this.length=s,this.byteLength=s,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(r=1){return this.readArray(r,"uint8")}readArray(r,o){const s=fg[o].BYTES_PER_ELEMENT*r,l=this.byteOffset+this.offset,d=this.buffer.slice(l,l+s);if(this.littleEndian===ob&&o!=="uint8"&&o!=="int8"){const p=new Uint8Array(this.buffer.slice(l,l+s));p.reverse();const b=new fg[o](p.buffer);return this.offset+=s,b.reverse(),b}const v=new fg[o](d);return this.offset+=s,v}readInt16(){const r=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,r}readUint16(){const r=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,r}readInt32(){const r=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,r}readUint32(){const r=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat32(){const r=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,r}readFloat64(){const r=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,r}readBigInt64(){const r=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,r}readBigUint64(){const r=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,r}readChar(){return String.fromCharCode(this.readInt8())}readChars(r=1){let o="";for(let s=0;s<r;s++)o+=this.readChar();return o}readUtf8(r=1){return z1(this.readBytes(r))}decodeText(r=1,o="utf8"){return z1(this.readBytes(r),o)}writeBoolean(r){return this.writeUint8(r?255:0),this}writeInt8(r){return this.ensureAvailable(1),this._data.setInt8(this.offset++,r),this._updateLastWrittenByte(),this}writeUint8(r){return this.ensureAvailable(1),this._data.setUint8(this.offset++,r),this._updateLastWrittenByte(),this}writeByte(r){return this.writeUint8(r)}writeBytes(r){this.ensureAvailable(r.length);for(let o=0;o<r.length;o++)this._data.setUint8(this.offset++,r[o]);return this._updateLastWrittenByte(),this}writeInt16(r){return this.ensureAvailable(2),this._data.setInt16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(r){return this.ensureAvailable(2),this._data.setUint16(this.offset,r,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(r){return this.ensureAvailable(4),this._data.setInt32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(r){return this.ensureAvailable(4),this._data.setUint32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(r){return this.ensureAvailable(4),this._data.setFloat32(this.offset,r,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(r){return this.ensureAvailable(8),this._data.setFloat64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(r){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(r){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,r,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(r){return this.writeUint8(r.charCodeAt(0))}writeChars(r){for(let o=0;o<r.length;o++)this.writeUint8(r.charCodeAt(o));return this}writeUtf8(r){return this.writeBytes(ib(r))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function nf(n){let r=n.length;for(;--r>=0;)n[r]=0}const ab=3,sb=258,tx=29,lb=256,cb=lb+1+tx,nx=30,ub=512,db=new Array((cb+2)*2);nf(db);const fb=new Array(nx*2);nf(fb);const pb=new Array(ub);nf(pb);const hb=new Array(sb-ab+1);nf(hb);const gb=new Array(tx);nf(gb);const yb=new Array(nx);nf(yb);const xb=(n,r,o,s)=>{let l=n&65535|0,d=n>>>16&65535|0,v=0;for(;o!==0;){v=o>2e3?2e3:o,o-=v;do l=l+r[s++]|0,d=d+l|0;while(--v);l%=65521,d%=65521}return l|d<<16|0};var Eg=xb;const mb=()=>{let n,r=[];for(var o=0;o<256;o++){n=o;for(var s=0;s<8;s++)n=n&1?3988292384^n>>>1:n>>>1;r[o]=n}return r},bb=new Uint32Array(mb()),vb=(n,r,o,s)=>{const l=bb,d=s+o;n^=-1;for(let v=s;v<d;v++)n=n>>>8^l[(n^r[v])&255];return n^-1};var Wc=vb,qg={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ix={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const wb=(n,r)=>Object.prototype.hasOwnProperty.call(n,r);var Sb=function(n){const r=Array.prototype.slice.call(arguments,1);for(;r.length;){const o=r.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(const s in o)wb(o,s)&&(n[s]=o[s])}}return n},jb=n=>{let r=0;for(let s=0,l=n.length;s<l;s++)r+=n[s].length;const o=new Uint8Array(r);for(let s=0,l=0,d=n.length;s<d;s++){let v=n[s];o.set(v,l),l+=v.length}return o},rx={assign:Sb,flattenChunks:jb};let ox=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{ox=!1}const Gf=new Uint8Array(256);for(let n=0;n<256;n++)Gf[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Gf[254]=Gf[254]=1;var Tb=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let r,o,s,l,d,v=n.length,p=0;for(l=0;l<v;l++)o=n.charCodeAt(l),(o&64512)===55296&&l+1<v&&(s=n.charCodeAt(l+1),(s&64512)===56320&&(o=65536+(o-55296<<10)+(s-56320),l++)),p+=o<128?1:o<2048?2:o<65536?3:4;for(r=new Uint8Array(p),d=0,l=0;d<p;l++)o=n.charCodeAt(l),(o&64512)===55296&&l+1<v&&(s=n.charCodeAt(l+1),(s&64512)===56320&&(o=65536+(o-55296<<10)+(s-56320),l++)),o<128?r[d++]=o:o<2048?(r[d++]=192|o>>>6,r[d++]=128|o&63):o<65536?(r[d++]=224|o>>>12,r[d++]=128|o>>>6&63,r[d++]=128|o&63):(r[d++]=240|o>>>18,r[d++]=128|o>>>12&63,r[d++]=128|o>>>6&63,r[d++]=128|o&63);return r};const Cb=(n,r)=>{if(r<65534&&n.subarray&&ox)return String.fromCharCode.apply(null,n.length===r?n:n.subarray(0,r));let o="";for(let s=0;s<r;s++)o+=String.fromCharCode(n[s]);return o};var Nb=(n,r)=>{const o=r||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,r));let s,l;const d=new Array(o*2);for(l=0,s=0;s<o;){let v=n[s++];if(v<128){d[l++]=v;continue}let p=Gf[v];if(p>4){d[l++]=65533,s+=p-1;continue}for(v&=p===2?31:p===3?15:7;p>1&&s<o;)v=v<<6|n[s++]&63,p--;if(p>1){d[l++]=65533;continue}v<65536?d[l++]=v:(v-=65536,d[l++]=55296|v>>10&1023,d[l++]=56320|v&1023)}return Cb(d,l)},kb=(n,r)=>{r=r||n.length,r>n.length&&(r=n.length);let o=r-1;for(;o>=0&&(n[o]&192)===128;)o--;return o<0||o===0?r:o+Gf[n[o]]>r?o:r},Vg={string2buf:Tb,buf2string:Nb,utf8border:kb};function Ab(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zb=Ab;const Wp=16209,Pb=16191;var _b=function(r,o){let s,l,d,v,p,b,m,T,D,M,S,F,_,N,g,ae,E,q,re,J,Y,ee,U,$;const H=r.state;s=r.next_in,U=r.input,l=s+(r.avail_in-5),d=r.next_out,$=r.output,v=d-(o-r.avail_out),p=d+(r.avail_out-257),b=H.dmax,m=H.wsize,T=H.whave,D=H.wnext,M=H.window,S=H.hold,F=H.bits,_=H.lencode,N=H.distcode,g=(1<<H.lenbits)-1,ae=(1<<H.distbits)-1;e:do{F<15&&(S+=U[s++]<<F,F+=8,S+=U[s++]<<F,F+=8),E=_[S&g];t:for(;;){if(q=E>>>24,S>>>=q,F-=q,q=E>>>16&255,q===0)$[d++]=E&65535;else if(q&16){re=E&65535,q&=15,q&&(F<q&&(S+=U[s++]<<F,F+=8),re+=S&(1<<q)-1,S>>>=q,F-=q),F<15&&(S+=U[s++]<<F,F+=8,S+=U[s++]<<F,F+=8),E=N[S&ae];n:for(;;){if(q=E>>>24,S>>>=q,F-=q,q=E>>>16&255,q&16){if(J=E&65535,q&=15,F<q&&(S+=U[s++]<<F,F+=8,F<q&&(S+=U[s++]<<F,F+=8)),J+=S&(1<<q)-1,J>b){r.msg="invalid distance too far back",H.mode=Wp;break e}if(S>>>=q,F-=q,q=d-v,J>q){if(q=J-q,q>T&&H.sane){r.msg="invalid distance too far back",H.mode=Wp;break e}if(Y=0,ee=M,D===0){if(Y+=m-q,q<re){re-=q;do $[d++]=M[Y++];while(--q);Y=d-J,ee=$}}else if(D<q){if(Y+=m+D-q,q-=D,q<re){re-=q;do $[d++]=M[Y++];while(--q);if(Y=0,D<re){q=D,re-=q;do $[d++]=M[Y++];while(--q);Y=d-J,ee=$}}}else if(Y+=D-q,q<re){re-=q;do $[d++]=M[Y++];while(--q);Y=d-J,ee=$}for(;re>2;)$[d++]=ee[Y++],$[d++]=ee[Y++],$[d++]=ee[Y++],re-=3;re&&($[d++]=ee[Y++],re>1&&($[d++]=ee[Y++]))}else{Y=d-J;do $[d++]=$[Y++],$[d++]=$[Y++],$[d++]=$[Y++],re-=3;while(re>2);re&&($[d++]=$[Y++],re>1&&($[d++]=$[Y++]))}}else if((q&64)===0){E=N[(E&65535)+(S&(1<<q)-1)];continue n}else{r.msg="invalid distance code",H.mode=Wp;break e}break}}else if((q&64)===0){E=_[(E&65535)+(S&(1<<q)-1)];continue t}else if(q&32){H.mode=Pb;break e}else{r.msg="invalid literal/length code",H.mode=Wp;break e}break}}while(s<l&&d<p);re=F>>3,s-=re,F-=re<<3,S&=(1<<F)-1,r.next_in=s,r.next_out=d,r.avail_in=s<l?5+(l-s):5-(s-l),r.avail_out=d<p?257+(p-d):257-(d-p),H.hold=S,H.bits=F};const Wd=15,P1=852,_1=592,D1=0,pg=1,R1=2,Db=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Rb=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Lb=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ib=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Mb=(n,r,o,s,l,d,v,p)=>{const b=p.bits;let m=0,T=0,D=0,M=0,S=0,F=0,_=0,N=0,g=0,ae=0,E,q,re,J,Y,ee=null,U;const $=new Uint16Array(Wd+1),H=new Uint16Array(Wd+1);let R=null,Z,G,we;for(m=0;m<=Wd;m++)$[m]=0;for(T=0;T<s;T++)$[r[o+T]]++;for(S=b,M=Wd;M>=1&&$[M]===0;M--);if(S>M&&(S=M),M===0)return l[d++]=1<<24|64<<16|0,l[d++]=1<<24|64<<16|0,p.bits=1,0;for(D=1;D<M&&$[D]===0;D++);for(S<D&&(S=D),N=1,m=1;m<=Wd;m++)if(N<<=1,N-=$[m],N<0)return-1;if(N>0&&(n===D1||M!==1))return-1;for(H[1]=0,m=1;m<Wd;m++)H[m+1]=H[m]+$[m];for(T=0;T<s;T++)r[o+T]!==0&&(v[H[r[o+T]]++]=T);if(n===D1?(ee=R=v,U=20):n===pg?(ee=Db,R=Rb,U=257):(ee=Lb,R=Ib,U=0),ae=0,T=0,m=D,Y=d,F=S,_=0,re=-1,g=1<<S,J=g-1,n===pg&&g>P1||n===R1&&g>_1)return 1;for(;;){Z=m-_,v[T]+1<U?(G=0,we=v[T]):v[T]>=U?(G=R[v[T]-U],we=ee[v[T]-U]):(G=96,we=0),E=1<<m-_,q=1<<F,D=q;do q-=E,l[Y+(ae>>_)+q]=Z<<24|G<<16|we|0;while(q!==0);for(E=1<<m-1;ae&E;)E>>=1;if(E!==0?(ae&=E-1,ae+=E):ae=0,T++,--$[m]===0){if(m===M)break;m=r[o+v[T]]}if(m>S&&(ae&J)!==re){for(_===0&&(_=S),Y+=D,F=m-_,N=1<<F;F+_<M&&(N-=$[F+_],!(N<=0));)F++,N<<=1;if(g+=1<<F,n===pg&&g>P1||n===R1&&g>_1)return 1;re=ae&J,l[re]=S<<24|F<<16|Y-d|0}}return ae!==0&&(l[Y+ae]=m-_<<24|64<<16|0),p.bits=S,0};var $f=Mb;const Bb=0,ax=1,sx=2,{Z_FINISH:L1,Z_BLOCK:Ob,Z_TREES:$p,Z_OK:xd,Z_STREAM_END:Ub,Z_NEED_DICT:Fb,Z_STREAM_ERROR:yc,Z_DATA_ERROR:lx,Z_MEM_ERROR:cx,Z_BUF_ERROR:Eb,Z_DEFLATED:I1}=ix,yh=16180,M1=16181,B1=16182,O1=16183,U1=16184,F1=16185,E1=16186,q1=16187,V1=16188,H1=16189,lh=16190,pu=16191,hg=16192,W1=16193,gg=16194,$1=16195,G1=16196,Y1=16197,X1=16198,Gp=16199,Yp=16200,K1=16201,Z1=16202,J1=16203,Q1=16204,ey=16205,yg=16206,ty=16207,ny=16208,Bo=16209,ux=16210,dx=16211,qb=852,Vb=592,Hb=15,Wb=Hb,iy=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function $b(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const md=n=>{if(!n)return 1;const r=n.state;return!r||r.strm!==n||r.mode<yh||r.mode>dx?1:0},fx=n=>{if(md(n))return yc;const r=n.state;return n.total_in=n.total_out=r.total=0,n.msg="",r.wrap&&(n.adler=r.wrap&1),r.mode=yh,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(qb),r.distcode=r.distdyn=new Int32Array(Vb),r.sane=1,r.back=-1,xd},px=n=>{if(md(n))return yc;const r=n.state;return r.wsize=0,r.whave=0,r.wnext=0,fx(n)},hx=(n,r)=>{let o;if(md(n))return yc;const s=n.state;return r<0?(o=0,r=-r):(o=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?yc:(s.window!==null&&s.wbits!==r&&(s.window=null),s.wrap=o,s.wbits=r,px(n))},gx=(n,r)=>{if(!n)return yc;const o=new $b;n.state=o,o.strm=n,o.window=null,o.mode=yh;const s=hx(n,r);return s!==xd&&(n.state=null),s},Gb=n=>gx(n,Wb);let ry=!0,xg,mg;const Yb=n=>{if(ry){xg=new Int32Array(512),mg=new Int32Array(32);let r=0;for(;r<144;)n.lens[r++]=8;for(;r<256;)n.lens[r++]=9;for(;r<280;)n.lens[r++]=7;for(;r<288;)n.lens[r++]=8;for($f(ax,n.lens,0,288,xg,0,n.work,{bits:9}),r=0;r<32;)n.lens[r++]=5;$f(sx,n.lens,0,32,mg,0,n.work,{bits:5}),ry=!1}n.lencode=xg,n.lenbits=9,n.distcode=mg,n.distbits=5},yx=(n,r,o,s)=>{let l;const d=n.state;return d.window===null&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new Uint8Array(d.wsize)),s>=d.wsize?(d.window.set(r.subarray(o-d.wsize,o),0),d.wnext=0,d.whave=d.wsize):(l=d.wsize-d.wnext,l>s&&(l=s),d.window.set(r.subarray(o-s,o-s+l),d.wnext),s-=l,s?(d.window.set(r.subarray(o-s,o),0),d.wnext=s,d.whave=d.wsize):(d.wnext+=l,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=l))),0},Xb=(n,r)=>{let o,s,l,d,v,p,b,m,T,D,M,S,F,_,N=0,g,ae,E,q,re,J,Y,ee;const U=new Uint8Array(4);let $,H;const R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(md(n)||!n.output||!n.input&&n.avail_in!==0)return yc;o=n.state,o.mode===pu&&(o.mode=hg),v=n.next_out,l=n.output,b=n.avail_out,d=n.next_in,s=n.input,p=n.avail_in,m=o.hold,T=o.bits,D=p,M=b,ee=xd;e:for(;;)switch(o.mode){case yh:if(o.wrap===0){o.mode=hg;break}for(;T<16;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}if(o.wrap&2&&m===35615){o.wbits===0&&(o.wbits=15),o.check=0,U[0]=m&255,U[1]=m>>>8&255,o.check=Wc(o.check,U,2,0),m=0,T=0,o.mode=M1;break}if(o.head&&(o.head.done=!1),!(o.wrap&1)||(((m&255)<<8)+(m>>8))%31){n.msg="incorrect header check",o.mode=Bo;break}if((m&15)!==I1){n.msg="unknown compression method",o.mode=Bo;break}if(m>>>=4,T-=4,Y=(m&15)+8,o.wbits===0&&(o.wbits=Y),Y>15||Y>o.wbits){n.msg="invalid window size",o.mode=Bo;break}o.dmax=1<<o.wbits,o.flags=0,n.adler=o.check=1,o.mode=m&512?H1:pu,m=0,T=0;break;case M1:for(;T<16;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}if(o.flags=m,(o.flags&255)!==I1){n.msg="unknown compression method",o.mode=Bo;break}if(o.flags&57344){n.msg="unknown header flags set",o.mode=Bo;break}o.head&&(o.head.text=m>>8&1),o.flags&512&&o.wrap&4&&(U[0]=m&255,U[1]=m>>>8&255,o.check=Wc(o.check,U,2,0)),m=0,T=0,o.mode=B1;case B1:for(;T<32;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}o.head&&(o.head.time=m),o.flags&512&&o.wrap&4&&(U[0]=m&255,U[1]=m>>>8&255,U[2]=m>>>16&255,U[3]=m>>>24&255,o.check=Wc(o.check,U,4,0)),m=0,T=0,o.mode=O1;case O1:for(;T<16;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}o.head&&(o.head.xflags=m&255,o.head.os=m>>8),o.flags&512&&o.wrap&4&&(U[0]=m&255,U[1]=m>>>8&255,o.check=Wc(o.check,U,2,0)),m=0,T=0,o.mode=U1;case U1:if(o.flags&1024){for(;T<16;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}o.length=m,o.head&&(o.head.extra_len=m),o.flags&512&&o.wrap&4&&(U[0]=m&255,U[1]=m>>>8&255,o.check=Wc(o.check,U,2,0)),m=0,T=0}else o.head&&(o.head.extra=null);o.mode=F1;case F1:if(o.flags&1024&&(S=o.length,S>p&&(S=p),S&&(o.head&&(Y=o.head.extra_len-o.length,o.head.extra||(o.head.extra=new Uint8Array(o.head.extra_len)),o.head.extra.set(s.subarray(d,d+S),Y)),o.flags&512&&o.wrap&4&&(o.check=Wc(o.check,s,S,d)),p-=S,d+=S,o.length-=S),o.length))break e;o.length=0,o.mode=E1;case E1:if(o.flags&2048){if(p===0)break e;S=0;do Y=s[d+S++],o.head&&Y&&o.length<65536&&(o.head.name+=String.fromCharCode(Y));while(Y&&S<p);if(o.flags&512&&o.wrap&4&&(o.check=Wc(o.check,s,S,d)),p-=S,d+=S,Y)break e}else o.head&&(o.head.name=null);o.length=0,o.mode=q1;case q1:if(o.flags&4096){if(p===0)break e;S=0;do Y=s[d+S++],o.head&&Y&&o.length<65536&&(o.head.comment+=String.fromCharCode(Y));while(Y&&S<p);if(o.flags&512&&o.wrap&4&&(o.check=Wc(o.check,s,S,d)),p-=S,d+=S,Y)break e}else o.head&&(o.head.comment=null);o.mode=V1;case V1:if(o.flags&512){for(;T<16;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}if(o.wrap&4&&m!==(o.check&65535)){n.msg="header crc mismatch",o.mode=Bo;break}m=0,T=0}o.head&&(o.head.hcrc=o.flags>>9&1,o.head.done=!0),n.adler=o.check=0,o.mode=pu;break;case H1:for(;T<32;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}n.adler=o.check=iy(m),m=0,T=0,o.mode=lh;case lh:if(o.havedict===0)return n.next_out=v,n.avail_out=b,n.next_in=d,n.avail_in=p,o.hold=m,o.bits=T,Fb;n.adler=o.check=1,o.mode=pu;case pu:if(r===Ob||r===$p)break e;case hg:if(o.last){m>>>=T&7,T-=T&7,o.mode=yg;break}for(;T<3;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}switch(o.last=m&1,m>>>=1,T-=1,m&3){case 0:o.mode=W1;break;case 1:if(Yb(o),o.mode=Gp,r===$p){m>>>=2,T-=2;break e}break;case 2:o.mode=G1;break;case 3:n.msg="invalid block type",o.mode=Bo}m>>>=2,T-=2;break;case W1:for(m>>>=T&7,T-=T&7;T<32;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}if((m&65535)!==(m>>>16^65535)){n.msg="invalid stored block lengths",o.mode=Bo;break}if(o.length=m&65535,m=0,T=0,o.mode=gg,r===$p)break e;case gg:o.mode=$1;case $1:if(S=o.length,S){if(S>p&&(S=p),S>b&&(S=b),S===0)break e;l.set(s.subarray(d,d+S),v),p-=S,d+=S,b-=S,v+=S,o.length-=S;break}o.mode=pu;break;case G1:for(;T<14;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}if(o.nlen=(m&31)+257,m>>>=5,T-=5,o.ndist=(m&31)+1,m>>>=5,T-=5,o.ncode=(m&15)+4,m>>>=4,T-=4,o.nlen>286||o.ndist>30){n.msg="too many length or distance symbols",o.mode=Bo;break}o.have=0,o.mode=Y1;case Y1:for(;o.have<o.ncode;){for(;T<3;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}o.lens[R[o.have++]]=m&7,m>>>=3,T-=3}for(;o.have<19;)o.lens[R[o.have++]]=0;if(o.lencode=o.lendyn,o.lenbits=7,$={bits:o.lenbits},ee=$f(Bb,o.lens,0,19,o.lencode,0,o.work,$),o.lenbits=$.bits,ee){n.msg="invalid code lengths set",o.mode=Bo;break}o.have=0,o.mode=X1;case X1:for(;o.have<o.nlen+o.ndist;){for(;N=o.lencode[m&(1<<o.lenbits)-1],g=N>>>24,ae=N>>>16&255,E=N&65535,!(g<=T);){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}if(E<16)m>>>=g,T-=g,o.lens[o.have++]=E;else{if(E===16){for(H=g+2;T<H;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}if(m>>>=g,T-=g,o.have===0){n.msg="invalid bit length repeat",o.mode=Bo;break}Y=o.lens[o.have-1],S=3+(m&3),m>>>=2,T-=2}else if(E===17){for(H=g+3;T<H;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}m>>>=g,T-=g,Y=0,S=3+(m&7),m>>>=3,T-=3}else{for(H=g+7;T<H;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}m>>>=g,T-=g,Y=0,S=11+(m&127),m>>>=7,T-=7}if(o.have+S>o.nlen+o.ndist){n.msg="invalid bit length repeat",o.mode=Bo;break}for(;S--;)o.lens[o.have++]=Y}}if(o.mode===Bo)break;if(o.lens[256]===0){n.msg="invalid code -- missing end-of-block",o.mode=Bo;break}if(o.lenbits=9,$={bits:o.lenbits},ee=$f(ax,o.lens,0,o.nlen,o.lencode,0,o.work,$),o.lenbits=$.bits,ee){n.msg="invalid literal/lengths set",o.mode=Bo;break}if(o.distbits=6,o.distcode=o.distdyn,$={bits:o.distbits},ee=$f(sx,o.lens,o.nlen,o.ndist,o.distcode,0,o.work,$),o.distbits=$.bits,ee){n.msg="invalid distances set",o.mode=Bo;break}if(o.mode=Gp,r===$p)break e;case Gp:o.mode=Yp;case Yp:if(p>=6&&b>=258){n.next_out=v,n.avail_out=b,n.next_in=d,n.avail_in=p,o.hold=m,o.bits=T,_b(n,M),v=n.next_out,l=n.output,b=n.avail_out,d=n.next_in,s=n.input,p=n.avail_in,m=o.hold,T=o.bits,o.mode===pu&&(o.back=-1);break}for(o.back=0;N=o.lencode[m&(1<<o.lenbits)-1],g=N>>>24,ae=N>>>16&255,E=N&65535,!(g<=T);){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}if(ae&&(ae&240)===0){for(q=g,re=ae,J=E;N=o.lencode[J+((m&(1<<q+re)-1)>>q)],g=N>>>24,ae=N>>>16&255,E=N&65535,!(q+g<=T);){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}m>>>=q,T-=q,o.back+=q}if(m>>>=g,T-=g,o.back+=g,o.length=E,ae===0){o.mode=ey;break}if(ae&32){o.back=-1,o.mode=pu;break}if(ae&64){n.msg="invalid literal/length code",o.mode=Bo;break}o.extra=ae&15,o.mode=K1;case K1:if(o.extra){for(H=o.extra;T<H;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}o.length+=m&(1<<o.extra)-1,m>>>=o.extra,T-=o.extra,o.back+=o.extra}o.was=o.length,o.mode=Z1;case Z1:for(;N=o.distcode[m&(1<<o.distbits)-1],g=N>>>24,ae=N>>>16&255,E=N&65535,!(g<=T);){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}if((ae&240)===0){for(q=g,re=ae,J=E;N=o.distcode[J+((m&(1<<q+re)-1)>>q)],g=N>>>24,ae=N>>>16&255,E=N&65535,!(q+g<=T);){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}m>>>=q,T-=q,o.back+=q}if(m>>>=g,T-=g,o.back+=g,ae&64){n.msg="invalid distance code",o.mode=Bo;break}o.offset=E,o.extra=ae&15,o.mode=J1;case J1:if(o.extra){for(H=o.extra;T<H;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}o.offset+=m&(1<<o.extra)-1,m>>>=o.extra,T-=o.extra,o.back+=o.extra}if(o.offset>o.dmax){n.msg="invalid distance too far back",o.mode=Bo;break}o.mode=Q1;case Q1:if(b===0)break e;if(S=M-b,o.offset>S){if(S=o.offset-S,S>o.whave&&o.sane){n.msg="invalid distance too far back",o.mode=Bo;break}S>o.wnext?(S-=o.wnext,F=o.wsize-S):F=o.wnext-S,S>o.length&&(S=o.length),_=o.window}else _=l,F=v-o.offset,S=o.length;S>b&&(S=b),b-=S,o.length-=S;do l[v++]=_[F++];while(--S);o.length===0&&(o.mode=Yp);break;case ey:if(b===0)break e;l[v++]=o.length,b--,o.mode=Yp;break;case yg:if(o.wrap){for(;T<32;){if(p===0)break e;p--,m|=s[d++]<<T,T+=8}if(M-=b,n.total_out+=M,o.total+=M,o.wrap&4&&M&&(n.adler=o.check=o.flags?Wc(o.check,l,M,v-M):Eg(o.check,l,M,v-M)),M=b,o.wrap&4&&(o.flags?m:iy(m))!==o.check){n.msg="incorrect data check",o.mode=Bo;break}m=0,T=0}o.mode=ty;case ty:if(o.wrap&&o.flags){for(;T<32;){if(p===0)break e;p--,m+=s[d++]<<T,T+=8}if(o.wrap&4&&m!==(o.total&4294967295)){n.msg="incorrect length check",o.mode=Bo;break}m=0,T=0}o.mode=ny;case ny:ee=Ub;break e;case Bo:ee=lx;break e;case ux:return cx;case dx:default:return yc}return n.next_out=v,n.avail_out=b,n.next_in=d,n.avail_in=p,o.hold=m,o.bits=T,(o.wsize||M!==n.avail_out&&o.mode<Bo&&(o.mode<yg||r!==L1))&&yx(n,n.output,n.next_out,M-n.avail_out),D-=n.avail_in,M-=n.avail_out,n.total_in+=D,n.total_out+=M,o.total+=M,o.wrap&4&&M&&(n.adler=o.check=o.flags?Wc(o.check,l,M,n.next_out-M):Eg(o.check,l,M,n.next_out-M)),n.data_type=o.bits+(o.last?64:0)+(o.mode===pu?128:0)+(o.mode===Gp||o.mode===gg?256:0),(D===0&&M===0||r===L1)&&ee===xd&&(ee=Eb),ee},Kb=n=>{if(md(n))return yc;let r=n.state;return r.window&&(r.window=null),n.state=null,xd},Zb=(n,r)=>{if(md(n))return yc;const o=n.state;return(o.wrap&2)===0?yc:(o.head=r,r.done=!1,xd)},Jb=(n,r)=>{const o=r.length;let s,l,d;return md(n)||(s=n.state,s.wrap!==0&&s.mode!==lh)?yc:s.mode===lh&&(l=1,l=Eg(l,r,o,0),l!==s.check)?lx:(d=yx(n,r,o,o),d?(s.mode=ux,cx):(s.havedict=1,xd))};var Qb=px,ev=hx,tv=fx,nv=Gb,iv=gx,rv=Xb,ov=Kb,av=Zb,sv=Jb,lv="pako inflate (from Nodeca project)",hu={inflateReset:Qb,inflateReset2:ev,inflateResetKeep:tv,inflateInit:nv,inflateInit2:iv,inflate:rv,inflateEnd:ov,inflateGetHeader:av,inflateSetDictionary:sv,inflateInfo:lv};function cv(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var uv=cv;const xx=Object.prototype.toString,{Z_NO_FLUSH:dv,Z_FINISH:fv,Z_OK:Yf,Z_STREAM_END:bg,Z_NEED_DICT:vg,Z_STREAM_ERROR:pv,Z_DATA_ERROR:oy,Z_MEM_ERROR:hv}=ix;function Kf(n){this.options=rx.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(n&&n.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zb,this.strm.avail_out=0;let o=hu.inflateInit2(this.strm,r.windowBits);if(o!==Yf)throw new Error(qg[o]);if(this.header=new uv,hu.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=Vg.string2buf(r.dictionary):xx.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(o=hu.inflateSetDictionary(this.strm,r.dictionary),o!==Yf)))throw new Error(qg[o])}Kf.prototype.push=function(n,r){const o=this.strm,s=this.options.chunkSize,l=this.options.dictionary;let d,v,p;if(this.ended)return!1;for(r===~~r?v=r:v=r===!0?fv:dv,xx.call(n)==="[object ArrayBuffer]"?o.input=new Uint8Array(n):o.input=n,o.next_in=0,o.avail_in=o.input.length;;){for(o.avail_out===0&&(o.output=new Uint8Array(s),o.next_out=0,o.avail_out=s),d=hu.inflate(o,v),d===vg&&l&&(d=hu.inflateSetDictionary(o,l),d===Yf?d=hu.inflate(o,v):d===oy&&(d=vg));o.avail_in>0&&d===bg&&o.state.wrap>0&&n[o.next_in]!==0;)hu.inflateReset(o),d=hu.inflate(o,v);switch(d){case pv:case oy:case vg:case hv:return this.onEnd(d),this.ended=!0,!1}if(p=o.avail_out,o.next_out&&(o.avail_out===0||d===bg))if(this.options.to==="string"){let b=Vg.utf8border(o.output,o.next_out),m=o.next_out-b,T=Vg.buf2string(o.output,b);o.next_out=m,o.avail_out=s-m,m&&o.output.set(o.output.subarray(b,b+m),0),this.onData(T)}else this.onData(o.output.length===o.next_out?o.output:o.output.subarray(0,o.next_out));if(!(d===Yf&&p===0)){if(d===bg)return d=hu.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,!0;if(o.avail_in===0)break}}return!0};Kf.prototype.onData=function(n){this.chunks.push(n)};Kf.prototype.onEnd=function(n){n===Yf&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=rx.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function gv(n,r){const o=new Kf(r);if(o.push(n),o.err)throw o.msg||qg[o.err];return o.result}var yv=Kf,xv=gv,mv={Inflate:yv,inflate:xv};const{Inflate:bv,inflate:vv}=mv;var ay=bv,wv=vv;const mx=[];for(let n=0;n<256;n++){let r=n;for(let o=0;o<8;o++)r&1?r=3988292384^r>>>1:r=r>>>1;mx[n]=r}const sy=4294967295;function Sv(n,r,o){let s=n;for(let l=0;l<o;l++)s=mx[(s^r[l])&255]^s>>>8;return s}function jv(n,r){return(Sv(sy,n,r)^sy)>>>0}function ly(n,r,o){const s=n.readUint32(),l=jv(new Uint8Array(n.buffer,n.byteOffset+n.offset-r-4,r),r);if(l!==s)throw new Error(`CRC mismatch for chunk ${o}. Expected ${s}, found ${l}`)}function bx(n,r,o){for(let s=0;s<o;s++)r[s]=n[s]}function vx(n,r,o,s){let l=0;for(;l<s;l++)r[l]=n[l];for(;l<o;l++)r[l]=n[l]+r[l-s]&255}function wx(n,r,o,s){let l=0;if(o.length===0)for(;l<s;l++)r[l]=n[l];else for(;l<s;l++)r[l]=n[l]+o[l]&255}function Sx(n,r,o,s,l){let d=0;if(o.length===0){for(;d<l;d++)r[d]=n[d];for(;d<s;d++)r[d]=n[d]+(r[d-l]>>1)&255}else{for(;d<l;d++)r[d]=n[d]+(o[d]>>1)&255;for(;d<s;d++)r[d]=n[d]+(r[d-l]+o[d]>>1)&255}}function jx(n,r,o,s,l){let d=0;if(o.length===0){for(;d<l;d++)r[d]=n[d];for(;d<s;d++)r[d]=n[d]+r[d-l]&255}else{for(;d<l;d++)r[d]=n[d]+o[d]&255;for(;d<s;d++)r[d]=n[d]+Tv(r[d-l],o[d],o[d-l])&255}}function Tv(n,r,o){const s=n+r-o,l=Math.abs(s-n),d=Math.abs(s-r),v=Math.abs(s-o);return l<=d&&l<=v?n:d<=v?r:o}function Cv(n,r,o,s,l,d){switch(n){case 0:bx(r,o,l);break;case 1:vx(r,o,l,d);break;case 2:wx(r,o,s,l);break;case 3:Sx(r,o,s,l,d);break;case 4:jx(r,o,s,l,d);break;default:throw new Error(`Unsupported filter: ${n}`)}}const Nv=new Uint16Array([255]),kv=new Uint8Array(Nv.buffer),Av=kv[0]===255;function zv(n){const{data:r,width:o,height:s,channels:l,depth:d}=n,v=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],p=Math.ceil(d/8)*l,b=new Uint8Array(s*o*p);let m=0;for(let T=0;T<7;T++){const D=v[T],M=Math.ceil((o-D.x)/D.xStep),S=Math.ceil((s-D.y)/D.yStep);if(M<=0||S<=0)continue;const F=M*p,_=new Uint8Array(F);for(let N=0;N<S;N++){const g=r[m++],ae=r.subarray(m,m+F);m+=F;const E=new Uint8Array(F);Cv(g,ae,E,_,F,p),_.set(E);for(let q=0;q<M;q++){const re=D.x+q*D.xStep,J=D.y+N*D.yStep;if(!(re>=o||J>=s))for(let Y=0;Y<p;Y++)b[(J*o+re)*p+Y]=E[q*p+Y]}}}if(d===16){const T=new Uint16Array(b.buffer);if(Av)for(let D=0;D<T.length;D++)T[D]=Pv(T[D]);return T}else return b}function Pv(n){return(n&255)<<8|n>>8&255}const _v=new Uint16Array([255]),Dv=new Uint8Array(_v.buffer),Rv=Dv[0]===255,Lv=new Uint8Array(0);function cy(n){const{data:r,width:o,height:s,channels:l,depth:d}=n,v=Math.ceil(d/8)*l,p=Math.ceil(d/8*l*o),b=new Uint8Array(s*p);let m=Lv,T=0,D,M;for(let S=0;S<s;S++){switch(D=r.subarray(T+1,T+1+p),M=b.subarray(S*p,(S+1)*p),r[T]){case 0:bx(D,M,p);break;case 1:vx(D,M,p,v);break;case 2:wx(D,M,m,p);break;case 3:Sx(D,M,m,p,v);break;case 4:jx(D,M,m,p,v);break;default:throw new Error(`Unsupported filter: ${r[T]}`)}m=M,T+=p+1}if(d===16){const S=new Uint16Array(b.buffer);if(Rv)for(let F=0;F<S.length;F++)S[F]=Iv(S[F]);return S}else return b}function Iv(n){return(n&255)<<8|n>>8&255}const eh=Uint8Array.of(137,80,78,71,13,10,26,10);function uy(n){if(!Mv(n.readBytes(eh.length)))throw new Error("wrong PNG signature")}function Mv(n){if(n.length<eh.length)return!1;for(let r=0;r<eh.length;r++)if(n[r]!==eh[r])return!1;return!0}const Bv="tEXt",Ov=0,Tx=new TextDecoder("latin1");function Uv(n){if(Ev(n),n.length===0||n.length>79)throw new Error("keyword length must be between 1 and 79")}const Fv=/^[\u0000-\u00FF]*$/;function Ev(n){if(!Fv.test(n))throw new Error("invalid latin1 text")}function qv(n,r,o){const s=Cx(r);n[s]=Vv(r,o-s.length-1)}function Cx(n){for(n.mark();n.readByte()!==Ov;);const r=n.offset;n.reset();const o=Tx.decode(n.readBytes(r-n.offset-1));return n.skip(1),Uv(o),o}function Vv(n,r){return Tx.decode(n.readBytes(r))}const Vl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},wg={UNKNOWN:-1,DEFLATE:0},dy={UNKNOWN:-1,ADAPTIVE:0},Sg={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Xp={NONE:0,BACKGROUND:1,PREVIOUS:2},jg={SOURCE:0,OVER:1};class Hv extends e0{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(r,o={}){super(r);const{checkCrc:s=!1}=o;this._checkCrc=s,this._inflator=new ay,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=wg.UNKNOWN,this._filterMethod=dy.UNKNOWN,this._interlaceMethod=Sg.UNKNOWN,this._colorType=Vl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(uy(this);!this._end;){const r=this.readUint32(),o=this.readChars(4);this.decodeChunk(r,o)}return this.decodeImage(),this._png}decodeApng(){for(uy(this);!this._end;){const r=this.readUint32(),o=this.readChars(4);this.decodeApngChunk(r,o)}return this.decodeApngImage(),this._apng}decodeChunk(r,o){const s=this.offset;switch(o){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Bv:qv(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${o}`);this._checkCrc?ly(this,r+4,o):this.skip(4)}decodeApngChunk(r,o){const s=this.offset;switch(o!=="fdAT"&&o!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),o){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,o),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${o}`);this._checkCrc?ly(this,r+4,o):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=Wv(this.readUint8());const o=this.readUint8();this._colorType=o;let s;switch(o){case Vl.GREYSCALE:s=1;break;case Vl.TRUECOLOUR:s=3;break;case Vl.INDEXED_COLOUR:s=1;break;case Vl.GREYSCALE_ALPHA:s=2;break;case Vl.TRUECOLOUR_ALPHA:s=4;break;case Vl.UNKNOWN:default:throw new Error(`Unknown color type: ${o}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==wg.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const o=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let l=0;l<o;l++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const o=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,o)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let o=r,s=this.offset+this.byteOffset;if(s+=4,o-=4,this._inflator.push(new Uint8Array(this.buffer,s,o)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Vl.GREYSCALE:case Vl.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let o=0;o<r/2;o++)this._transparency[o]=this.readUint16();break}case Vl.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let o=0;for(;o<r;o++){const s=this.readByte();this._palette[o].push(s)}for(;o<this._palette.length;o++)this._palette[o].push(255);break}case Vl.UNKNOWN:case Vl.GREYSCALE_ALPHA:case Vl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const o=Cx(this),s=this.readUint8();if(s!==wg.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const l=this.readBytes(r-o.length-2);this._png.iccEmbeddedProfile={name:o,profile:wv(l)}}decodepHYs(){const r=this.readUint32(),o=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:o,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const o={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=cy({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)o.data=s.data;else{const l=this._apng.frames.at(r-1);this.disposeFrame(s,l,o),this.addFrameDataToCanvas(o,s)}this._apng.frames.push(o)}}return this._apng}disposeFrame(r,o,s){switch(r.disposeOp){case Xp.NONE:break;case Xp.BACKGROUND:for(let l=0;l<this._png.height;l++)for(let d=0;d<this._png.width;d++){const v=(l*r.width+d)*this._png.channels;for(let p=0;p<this._png.channels;p++)s.data[v+p]=0}break;case Xp.PREVIOUS:s.data.set(o.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,o){const s=1<<this._png.depth,l=(d,v)=>{const p=((d+o.yOffset)*this._png.width+o.xOffset+v)*this._png.channels,b=(d*o.width+v)*this._png.channels;return{index:p,frameIndex:b}};switch(o.blendOp){case jg.SOURCE:for(let d=0;d<o.height;d++)for(let v=0;v<o.width;v++){const{index:p,frameIndex:b}=l(d,v);for(let m=0;m<this._png.channels;m++)r.data[p+m]=o.data[b+m]}break;case jg.OVER:for(let d=0;d<o.height;d++)for(let v=0;v<o.width;v++){const{index:p,frameIndex:b}=l(d,v);for(let m=0;m<this._png.channels;m++){const T=o.data[b+this._png.channels-1]/s,D=m%(this._png.channels-1)===0?1:o.data[b+m],M=Math.floor(T*D+(1-T)*r.data[p+m]);r.data[p+m]+=M}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==dy.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Sg.NO_INTERLACE)this._png.data=cy({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Sg.ADAM7)this._png.data=zv({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,o=this._frames.at(-1);o?o.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Xp.NONE,blendOp:jg.SOURCE,data:r}),this._inflator=new ay,this._writingDataChunks=!1}}function Wv(n){if(n!==1&&n!==2&&n!==4&&n!==8&&n!==16)throw new Error(`invalid bit depth: ${n}`);return n}var fy;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.METRE=1]="METRE"})(fy||(fy={}));function $v(n,r){return new Hv(n,r).decode()}var ui=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Tg(){ui.console&&typeof ui.console.log=="function"&&ui.console.log.apply(ui.console,arguments)}var no={log:Tg,warn:function(n){ui.console&&(typeof ui.console.warn=="function"?ui.console.warn.apply(ui.console,arguments):Tg.call(null,arguments))},error:function(n){ui.console&&(typeof ui.console.error=="function"?ui.console.error.apply(ui.console,arguments):Tg(n))}};function Cg(n,r,o){var s=new XMLHttpRequest;s.open("GET",n),s.responseType="blob",s.onload=function(){fd(s.response,r,o)},s.onerror=function(){no.error("could not download file")},s.send()}function py(n){var r=new XMLHttpRequest;r.open("HEAD",n,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function Kp(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(r)}}var fd=ui.saveAs||((typeof window>"u"?"undefined":Ir(window))!=="object"||window!==ui?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,r,o){var s=ui.URL||ui.webkitURL,l=document.createElement("a");r=r||n.name||"download",l.download=r,l.rel="noopener",typeof n=="string"?(l.href=n,l.origin!==location.origin?py(l.href)?Cg(n,r,o):Kp(l,l.target="_blank"):Kp(l)):(l.href=s.createObjectURL(n),setTimeout(function(){s.revokeObjectURL(l.href)},4e4),setTimeout(function(){Kp(l)},0))}:"msSaveOrOpenBlob"in navigator?function(n,r,o){if(r=r||n.name||"download",typeof n=="string")if(py(n))Cg(n,r,o);else{var s=document.createElement("a");s.href=n,s.target="_blank",setTimeout(function(){Kp(s)})}else navigator.msSaveOrOpenBlob((function(l,d){return d===void 0?d={autoBom:!1}:Ir(d)!=="object"&&(no.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l})(n,o),r)}:function(n,r,o,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),typeof n=="string")return Cg(n,r,o);var l=n.type==="application/octet-stream",d=/constructor/i.test(ui.HTMLElement)||ui.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||l&&d)&&(typeof FileReader>"u"?"undefined":Ir(FileReader))==="object"){var p=new FileReader;p.onloadend=function(){var T=p.result;T=v?T:T.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=T:location=T,s=null},p.readAsDataURL(n)}else{var b=ui.URL||ui.webkitURL,m=b.createObjectURL(n);s?s.location=m:location.href=m,s=null,setTimeout(function(){b.revokeObjectURL(m)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Nx(n){var r;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var o=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(p){return[parseInt(p[1]),parseInt(p[2]),parseInt(p[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(p){return[parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(p){return[parseInt(p[1]+p[1],16),parseInt(p[2]+p[2],16),parseInt(p[3]+p[3],16)]}}],s=0;s<o.length;s++){var l=o[s].re,d=o[s].process,v=l.exec(n);v&&(r=d(v),this.r=r[0],this.g=r[1],this.b=r[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var p=this.r.toString(16),b=this.g.toString(16),m=this.b.toString(16);return p.length==1&&(p="0"+p),b.length==1&&(b="0"+b),m.length==1&&(m="0"+m),"#"+p+b+m}}var th=ui.atob.bind(ui),hy=ui.btoa.bind(ui);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Ng(n,r){var o=n[0],s=n[1],l=n[2],d=n[3];o=Vs(o,s,l,d,r[0],7,-680876936),d=Vs(d,o,s,l,r[1],12,-389564586),l=Vs(l,d,o,s,r[2],17,606105819),s=Vs(s,l,d,o,r[3],22,-1044525330),o=Vs(o,s,l,d,r[4],7,-176418897),d=Vs(d,o,s,l,r[5],12,1200080426),l=Vs(l,d,o,s,r[6],17,-1473231341),s=Vs(s,l,d,o,r[7],22,-45705983),o=Vs(o,s,l,d,r[8],7,1770035416),d=Vs(d,o,s,l,r[9],12,-1958414417),l=Vs(l,d,o,s,r[10],17,-42063),s=Vs(s,l,d,o,r[11],22,-1990404162),o=Vs(o,s,l,d,r[12],7,1804603682),d=Vs(d,o,s,l,r[13],12,-40341101),l=Vs(l,d,o,s,r[14],17,-1502002290),o=Hs(o,s=Vs(s,l,d,o,r[15],22,1236535329),l,d,r[1],5,-165796510),d=Hs(d,o,s,l,r[6],9,-1069501632),l=Hs(l,d,o,s,r[11],14,643717713),s=Hs(s,l,d,o,r[0],20,-373897302),o=Hs(o,s,l,d,r[5],5,-701558691),d=Hs(d,o,s,l,r[10],9,38016083),l=Hs(l,d,o,s,r[15],14,-660478335),s=Hs(s,l,d,o,r[4],20,-405537848),o=Hs(o,s,l,d,r[9],5,568446438),d=Hs(d,o,s,l,r[14],9,-1019803690),l=Hs(l,d,o,s,r[3],14,-187363961),s=Hs(s,l,d,o,r[8],20,1163531501),o=Hs(o,s,l,d,r[13],5,-1444681467),d=Hs(d,o,s,l,r[2],9,-51403784),l=Hs(l,d,o,s,r[7],14,1735328473),o=Ws(o,s=Hs(s,l,d,o,r[12],20,-1926607734),l,d,r[5],4,-378558),d=Ws(d,o,s,l,r[8],11,-2022574463),l=Ws(l,d,o,s,r[11],16,1839030562),s=Ws(s,l,d,o,r[14],23,-35309556),o=Ws(o,s,l,d,r[1],4,-1530992060),d=Ws(d,o,s,l,r[4],11,1272893353),l=Ws(l,d,o,s,r[7],16,-155497632),s=Ws(s,l,d,o,r[10],23,-1094730640),o=Ws(o,s,l,d,r[13],4,681279174),d=Ws(d,o,s,l,r[0],11,-358537222),l=Ws(l,d,o,s,r[3],16,-722521979),s=Ws(s,l,d,o,r[6],23,76029189),o=Ws(o,s,l,d,r[9],4,-640364487),d=Ws(d,o,s,l,r[12],11,-421815835),l=Ws(l,d,o,s,r[15],16,530742520),o=$s(o,s=Ws(s,l,d,o,r[2],23,-995338651),l,d,r[0],6,-198630844),d=$s(d,o,s,l,r[7],10,1126891415),l=$s(l,d,o,s,r[14],15,-1416354905),s=$s(s,l,d,o,r[5],21,-57434055),o=$s(o,s,l,d,r[12],6,1700485571),d=$s(d,o,s,l,r[3],10,-1894986606),l=$s(l,d,o,s,r[10],15,-1051523),s=$s(s,l,d,o,r[1],21,-2054922799),o=$s(o,s,l,d,r[8],6,1873313359),d=$s(d,o,s,l,r[15],10,-30611744),l=$s(l,d,o,s,r[6],15,-1560198380),s=$s(s,l,d,o,r[13],21,1309151649),o=$s(o,s,l,d,r[4],6,-145523070),d=$s(d,o,s,l,r[11],10,-1120210379),l=$s(l,d,o,s,r[2],15,718787259),s=$s(s,l,d,o,r[9],21,-343485551),n[0]=Uu(o,n[0]),n[1]=Uu(s,n[1]),n[2]=Uu(l,n[2]),n[3]=Uu(d,n[3])}function xh(n,r,o,s,l,d){return r=Uu(Uu(r,n),Uu(s,d)),Uu(r<<l|r>>>32-l,o)}function Vs(n,r,o,s,l,d,v){return xh(r&o|~r&s,n,r,l,d,v)}function Hs(n,r,o,s,l,d,v){return xh(r&s|o&~s,n,r,l,d,v)}function Ws(n,r,o,s,l,d,v){return xh(r^o^s,n,r,l,d,v)}function $s(n,r,o,s,l,d,v){return xh(o^(r|~s),n,r,l,d,v)}function kx(n){var r,o=n.length,s=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=n.length;r+=64)Ng(s,Gv(n.substring(r-64,r)));n=n.substring(r-64);var l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<n.length;r++)l[r>>2]|=n.charCodeAt(r)<<(r%4<<3);if(l[r>>2]|=128<<(r%4<<3),r>55)for(Ng(s,l),r=0;r<16;r++)l[r]=0;return l[14]=8*o,Ng(s,l),s}function Gv(n){var r,o=[];for(r=0;r<64;r+=4)o[r>>2]=n.charCodeAt(r)+(n.charCodeAt(r+1)<<8)+(n.charCodeAt(r+2)<<16)+(n.charCodeAt(r+3)<<24);return o}var gy="0123456789abcdef".split("");function Yv(n){for(var r="",o=0;o<4;o++)r+=gy[n>>8*o+4&15]+gy[n>>8*o&15];return r}function Xv(n){return String.fromCharCode(255&n,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function Hg(n){return kx(n).map(Xv).join("")}var Kv=(function(n){for(var r=0;r<n.length;r++)n[r]=Yv(n[r]);return n.join("")})(kx("hello"))!="5d41402abc4b2a76b9719d911017c592";function Uu(n,r){if(Kv){var o=(65535&n)+(65535&r);return(n>>16)+(r>>16)+(o>>16)<<16|65535&o}return n+r&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Wg(n,r){var o,s,l,d;if(n!==o){for(var v=(l=n,d=1+(256/n.length|0),new Array(d+1).join(l)),p=[],b=0;b<256;b++)p[b]=b;var m=0;for(b=0;b<256;b++){var T=p[b];m=(m+T+v.charCodeAt(b))%256,p[b]=p[m],p[m]=T}o=n,s=p}else p=s;var D=r.length,M=0,S=0,F="";for(b=0;b<D;b++)S=(S+(T=p[M=(M+1)%256]))%256,p[M]=p[S],p[S]=T,v=p[(p[M]+p[S])%256],F+=String.fromCharCode(r.charCodeAt(b)^v);return F}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var yy={print:4,modify:8,copy:16,"annot-forms":32};function Xd(n,r,o,s){this.v=1,this.r=2;var l=192;n.forEach(function(p){if(yy.perm!==void 0)throw new Error("Invalid permission: "+p);l+=yy[p]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var d=(r+this.padding).substr(0,32),v=(o+this.padding).substr(0,32);this.O=this.processOwnerPassword(d,v),this.P=-(1+(255^l)),this.encryptionKey=Hg(d+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(s)).substr(0,5),this.U=Wg(this.encryptionKey,this.padding)}function Kd(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var r="",o=n.length,s=0;s<o;s++){var l=n.charCodeAt(s);r+=l<33||l===35||l===37||l===40||l===41||l===47||l===60||l===62||l===91||l===93||l===123||l===125||l>126?"#"+("0"+l.toString(16)).slice(-2):n[s]}return r}function xy(n){if(Ir(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var r={};this.subscribe=function(o,s,l){if(l=l||!1,typeof o!="string"||typeof s!="function"||typeof l!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");r.hasOwnProperty(o)||(r[o]={});var d=Math.random().toString(35);return r[o][d]=[s,!!l],d},this.unsubscribe=function(o){for(var s in r)if(r[s][o])return delete r[s][o],Object.keys(r[s]).length===0&&delete r[s],!0;return!1},this.publish=function(o){if(r.hasOwnProperty(o)){var s=Array.prototype.slice.call(arguments,1),l=[];for(var d in r[o]){var v=r[o][d];try{v[0].apply(n,s)}catch(p){ui.console&&no.error("jsPDF PubSub Error",p.message,p)}v[1]&&l.push(d)}l.length&&l.forEach(this.unsubscribe)}},this.getTopics=function(){return r}}function ch(n){if(!(this instanceof ch))return new ch(n);var r="opacity,stroke-opacity".split(",");for(var o in n)n.hasOwnProperty(o)&&r.indexOf(o)>=0&&(this[o]=n[o]);this.id="",this.objectNumber=-1}function Ax(n,r){this.gState=n,this.matrix=r,this.id="",this.objectNumber=-1}function pd(n,r,o,s,l){if(!(this instanceof pd))return new pd(n,r,o,s,l);this.type=n==="axial"?2:3,this.coords=r,this.colors=o,Ax.call(this,s,l)}function Zd(n,r,o,s,l){if(!(this instanceof Zd))return new Zd(n,r,o,s,l);this.boundingBox=n,this.xStep=r,this.yStep=o,this.stream="",this.cloneIndex=0,Ax.call(this,s,l)}function Wn(n){var r,o=typeof arguments[0]=="string"?arguments[0]:"p",s=arguments[1],l=arguments[2],d=arguments[3],v=[],p=1,b=16,m="S",T=null;Ir(n=n||{})==="object"&&(o=n.orientation,s=n.unit||s,l=n.format||l,d=n.compress||n.compressPdf||d,(T=n.encryption||null)!==null&&(T.userPassword=T.userPassword||"",T.ownerPassword=T.ownerPassword||"",T.userPermissions=T.userPermissions||[]),p=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(r=n.precision),n.floatPrecision!==void 0&&(b=n.floatPrecision),m=n.defaultPathOperation||"S"),v=n.filters||(d===!0?["FlateEncode"]:v),s=s||"mm",o=(""+(o||"P")).toLowerCase();var D=n.putOnlyUsedFonts||!1,M={},S={internal:{},__private__:{}};S.__private__.PubSub=xy;var F="1.3",_=S.__private__.getPdfVersion=function(){return F};S.__private__.setPdfVersion=function(j){F=j};var N={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};S.__private__.getPageFormats=function(){return N};var g=S.__private__.getPageFormat=function(j){return N[j]};l=l||"a4";var ae="compat",E="advanced",q=ae;function re(){this.saveGraphicsState(),ye(new Xt($e,0,0,-$e,0,vs()*$e).toString()+" cm"),this.setFontSize(this.getFontSize()/$e),m="n",q=E}function J(){this.restoreGraphicsState(),m="S",q=ae}var Y=S.__private__.combineFontStyleAndFontWeight=function(j,Q){if(j=="bold"&&Q=="normal"||j=="bold"&&Q==400||j=="normal"&&Q=="italic"||j=="bold"&&Q=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Q&&(j=Q==400||Q==="normal"?j==="italic"?"italic":"normal":Q!=700&&Q!=="bold"||j!=="normal"?(Q==700?"bold":Q)+""+j:"bold"),j};S.advancedAPI=function(j){var Q=q===ae;return Q&&re.call(this),typeof j!="function"||(j(this),Q&&J.call(this)),this},S.compatAPI=function(j){var Q=q===E;return Q&&J.call(this),typeof j!="function"||(j(this),Q&&re.call(this)),this},S.isAdvancedAPI=function(){return q===E};var ee,U=function(j){if(q!==E)throw new Error(j+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},$=S.roundToPrecision=S.__private__.roundToPrecision=function(j,Q){var pe=r||Q;if(isNaN(j)||isNaN(pe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return j.toFixed(pe).replace(/0+$/,"")};ee=S.hpf=S.__private__.hpf=typeof b=="number"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return $(j,b)}:b==="smart"?function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return $(j,j>-1&&j<1?16:5)}:function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.hpf");return $(j,16)};var H=S.f2=S.__private__.f2=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f2");return $(j,2)},R=S.__private__.f3=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.f3");return $(j,3)},Z=S.scale=S.__private__.scale=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.scale");return q===ae?j*$e:q===E?j:void 0},G=function(j){return Z((function(Q){return q===ae?vs()-Q:q===E?Q:void 0})(j))};S.__private__.setPrecision=S.setPrecision=function(j){typeof parseInt(j,10)=="number"&&(r=parseInt(j,10))};var we,te="00000000000000000000000000000000",de=S.__private__.getFileId=function(){return te},Ce=S.__private__.setFileId=function(j){return te=j!==void 0&&/^[a-fA-F0-9]{32}$/.test(j)?j.toUpperCase():te.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),T!==null&&(io=new Xd(T.userPermissions,T.userPassword,T.ownerPassword,te)),te};S.setFileId=function(j){return Ce(j),this},S.getFileId=function(){return de()};var Re=S.__private__.convertDateToPDFDate=function(j){var Q=j.getTimezoneOffset(),pe=Q<0?"+":"-",Me=Math.floor(Math.abs(Q/60)),qe=Math.abs(Q%60),xt=[pe,W(Me),"'",W(qe),"'"].join("");return["D:",j.getFullYear(),W(j.getMonth()+1),W(j.getDate()),W(j.getHours()),W(j.getMinutes()),W(j.getSeconds()),xt].join("")},xe=S.__private__.convertPDFDateToDate=function(j){var Q=parseInt(j.substr(2,4),10),pe=parseInt(j.substr(6,2),10)-1,Me=parseInt(j.substr(8,2),10),qe=parseInt(j.substr(10,2),10),xt=parseInt(j.substr(12,2),10),vt=parseInt(j.substr(14,2),10);return new Date(Q,pe,Me,qe,xt,vt,0)},k=S.__private__.setCreationDate=function(j){var Q;if(j===void 0&&(j=new Date),j instanceof Date)Q=Re(j);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(j))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Q=j}return we=Q},A=S.__private__.getCreationDate=function(j){var Q=we;return j==="jsDate"&&(Q=xe(we)),Q};S.setCreationDate=function(j){return k(j),this},S.getCreationDate=function(j){return A(j)};var V,W=S.__private__.padd2=function(j){return("0"+parseInt(j)).slice(-2)},se=S.__private__.padd2Hex=function(j){return("00"+(j=j.toString())).substr(j.length)},Te=0,le=[],_e=[],ve=0,De=[],Xe=[],st=!1,kt=_e;S.__private__.setCustomOutputDestination=function(j){st=!0,kt=j};var qt=function(j){st||(kt=j)};S.__private__.resetCustomOutputDestination=function(){st=!1,kt=_e};var ye=S.__private__.out=function(j){return j=j.toString(),ve+=j.length+1,kt.push(j),kt},ut=S.__private__.write=function(j){return ye(arguments.length===1?j.toString():Array.prototype.join.call(arguments," "))},Gt=S.__private__.getArrayBuffer=function(j){for(var Q=j.length,pe=new ArrayBuffer(Q),Me=new Uint8Array(pe);Q--;)Me[Q]=j.charCodeAt(Q);return pe},Et=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];S.__private__.getStandardFonts=function(){return Et};var ht=n.fontSize||16;S.__private__.setFontSize=S.setFontSize=function(j){return ht=q===E?j/$e:j,this};var Qe,$t=S.__private__.getFontSize=S.getFontSize=function(){return q===ae?ht:ht*$e},dn=n.R2L||!1;S.__private__.setR2L=S.setR2L=function(j){return dn=j,this},S.__private__.getR2L=S.getR2L=function(){return dn};var rn,kn=S.__private__.setZoomMode=function(j){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(j))Qe=j;else if(isNaN(j)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(j)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+j+'" is not recognized.');Qe=j}else Qe=parseInt(j,10)};S.__private__.getZoomMode=function(){return Qe};var Fn,Be=S.__private__.setPageMode=function(j){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(j)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+j+'" is not recognized.');rn=j};S.__private__.getPageMode=function(){return rn};var fe=S.__private__.setLayoutMode=function(j){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(j)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+j+'" is not recognized.');Fn=j};S.__private__.getLayoutMode=function(){return Fn},S.__private__.setDisplayMode=S.setDisplayMode=function(j,Q,pe){return kn(j),fe(Q),Be(pe),this};var lt={title:"",subject:"",author:"",keywords:"",creator:""};S.__private__.getDocumentProperty=function(j){if(Object.keys(lt).indexOf(j)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return lt[j]},S.__private__.getDocumentProperties=function(){return lt},S.__private__.setDocumentProperties=S.setProperties=S.setDocumentProperties=function(j){for(var Q in lt)lt.hasOwnProperty(Q)&&j[Q]&&(lt[Q]=j[Q]);return this},S.__private__.setDocumentProperty=function(j,Q){if(Object.keys(lt).indexOf(j)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return lt[j]=Q};var it,$e,at,Ot,Vt,jt={},Ft={},tn=[],ln={},mt={},cn={},_t={},Yt=null,gn=0,fn=[],bn=new xy(S),ir=n.hotfixes||[],Dn={},Cr={},Mr=[],Xt=function j(Q,pe,Me,qe,xt,vt){if(!(this instanceof j))return new j(Q,pe,Me,qe,xt,vt);isNaN(Q)&&(Q=1),isNaN(pe)&&(pe=0),isNaN(Me)&&(Me=0),isNaN(qe)&&(qe=1),isNaN(xt)&&(xt=0),isNaN(vt)&&(vt=0),this._matrix=[Q,pe,Me,qe,xt,vt]};Object.defineProperty(Xt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(Xt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(Xt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(Xt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(Xt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(Xt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(Xt.prototype,"a",{get:function(){return this._matrix[0]},set:function(j){this._matrix[0]=j}}),Object.defineProperty(Xt.prototype,"b",{get:function(){return this._matrix[1]},set:function(j){this._matrix[1]=j}}),Object.defineProperty(Xt.prototype,"c",{get:function(){return this._matrix[2]},set:function(j){this._matrix[2]=j}}),Object.defineProperty(Xt.prototype,"d",{get:function(){return this._matrix[3]},set:function(j){this._matrix[3]=j}}),Object.defineProperty(Xt.prototype,"e",{get:function(){return this._matrix[4]},set:function(j){this._matrix[4]=j}}),Object.defineProperty(Xt.prototype,"f",{get:function(){return this._matrix[5]},set:function(j){this._matrix[5]=j}}),Object.defineProperty(Xt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Xt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Xt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Xt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Xt.prototype.join=function(j){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(ee).join(j)},Xt.prototype.multiply=function(j){var Q=j.sx*this.sx+j.shy*this.shx,pe=j.sx*this.shy+j.shy*this.sy,Me=j.shx*this.sx+j.sy*this.shx,qe=j.shx*this.shy+j.sy*this.sy,xt=j.tx*this.sx+j.ty*this.shx+this.tx,vt=j.tx*this.shy+j.ty*this.sy+this.ty;return new Xt(Q,pe,Me,qe,xt,vt)},Xt.prototype.decompose=function(){var j=this.sx,Q=this.shy,pe=this.shx,Me=this.sy,qe=this.tx,xt=this.ty,vt=Math.sqrt(j*j+Q*Q),Wt=(j/=vt)*pe+(Q/=vt)*Me;pe-=j*Wt,Me-=Q*Wt;var Zt=Math.sqrt(pe*pe+Me*Me);return Wt/=Zt,j*(Me/=Zt)<Q*(pe/=Zt)&&(j=-j,Q=-Q,Wt=-Wt,vt=-vt),{scale:new Xt(vt,0,0,Zt,0,0),translate:new Xt(1,0,0,1,qe,xt),rotate:new Xt(j,Q,-Q,j,0,0),skew:new Xt(1,0,Wt,1,0,0)}},Xt.prototype.toString=function(j){return this.join(" ")},Xt.prototype.inversed=function(){var j=this.sx,Q=this.shy,pe=this.shx,Me=this.sy,qe=this.tx,xt=this.ty,vt=1/(j*Me-Q*pe),Wt=Me*vt,Zt=-Q*vt,on=-pe*vt,qn=j*vt;return new Xt(Wt,Zt,on,qn,-Wt*qe-on*xt,-Zt*qe-qn*xt)},Xt.prototype.applyToPoint=function(j){var Q=j.x*this.sx+j.y*this.shx+this.tx,pe=j.x*this.shy+j.y*this.sy+this.ty;return new ri(Q,pe)},Xt.prototype.applyToRectangle=function(j){var Q=this.applyToPoint(j),pe=this.applyToPoint(new ri(j.x+j.w,j.y+j.h));return new Qt(Q.x,Q.y,pe.x-Q.x,pe.y-Q.y)},Xt.prototype.clone=function(){var j=this.sx,Q=this.shy,pe=this.shx,Me=this.sy,qe=this.tx,xt=this.ty;return new Xt(j,Q,pe,Me,qe,xt)},S.Matrix=Xt;var mr=S.matrixMult=function(j,Q){return Q.multiply(j)},Ti=new Xt(1,0,0,1,0,0);S.unitMatrix=S.identityMatrix=Ti;var Ln=function(j,Q){if(!mt[j]){var pe=(Q instanceof pd?"Sh":"P")+(Object.keys(ln).length+1).toString(10);Q.id=pe,mt[j]=pe,ln[pe]=Q,bn.publish("addPattern",Q)}};S.ShadingPattern=pd,S.TilingPattern=Zd,S.addShadingPattern=function(j,Q){return U("addShadingPattern()"),Ln(j,Q),this},S.beginTilingPattern=function(j){U("beginTilingPattern()"),Ua(j.boundingBox[0],j.boundingBox[1],j.boundingBox[2]-j.boundingBox[0],j.boundingBox[3]-j.boundingBox[1],j.matrix)},S.endTilingPattern=function(j,Q){U("endTilingPattern()"),Q.stream=Xe[V].join(`
`),Ln(j,Q),bn.publish("endTilingPattern",Q),Mr.pop().restore()};var Rt,Ht=S.__private__.newObject=function(){var j=tt();return Bt(j,!0),j},tt=S.__private__.newObjectDeferred=function(){return Te++,le[Te]=function(){return ve},Te},Bt=function(j,Q){return Q=typeof Q=="boolean"&&Q,le[j]=ve,Q&&ye(j+" 0 obj"),j},pn=S.__private__.newAdditionalObject=function(){var j={objId:tt(),content:""};return De.push(j),j},An=tt(),yn=tt(),$n=S.__private__.decodeColorString=function(j){var Q=j.split(" ");if(Q.length!==2||Q[1]!=="g"&&Q[1]!=="G")Q.length!==5||Q[4]!=="k"&&Q[4]!=="K"||(Q=[(1-Q[0])*(1-Q[3]),(1-Q[1])*(1-Q[3]),(1-Q[2])*(1-Q[3]),"r"]);else{var pe=parseFloat(Q[0]);Q=[pe,pe,pe,"r"]}for(var Me="#",qe=0;qe<3;qe++)Me+=("0"+Math.floor(255*parseFloat(Q[qe])).toString(16)).slice(-2);return Me},li=S.__private__.encodeColorString=function(j){var Q;typeof j=="string"&&(j={ch1:j});var pe=j.ch1,Me=j.ch2,qe=j.ch3,xt=j.ch4,vt=j.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof pe=="string"&&pe.charAt(0)!=="#"){var Wt=new Nx(pe);if(Wt.ok)pe=Wt.toHex();else if(!/^\d*\.?\d*$/.test(pe))throw new Error('Invalid color "'+pe+'" passed to jsPDF.encodeColorString.')}if(typeof pe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(pe)&&(pe="#"+pe[1]+pe[1]+pe[2]+pe[2]+pe[3]+pe[3]),typeof pe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(pe)){var Zt=parseInt(pe.substr(1),16);pe=Zt>>16&255,Me=Zt>>8&255,qe=255&Zt}if(Me===void 0||xt===void 0&&pe===Me&&Me===qe)Q=typeof pe=="string"?pe+" "+vt[0]:j.precision===2?H(pe/255)+" "+vt[0]:R(pe/255)+" "+vt[0];else if(xt===void 0||Ir(xt)==="object"){if(xt&&!isNaN(xt.a)&&xt.a===0)return["1.","1.","1.",vt[1]].join(" ");Q=typeof pe=="string"?[pe,Me,qe,vt[1]].join(" "):j.precision===2?[H(pe/255),H(Me/255),H(qe/255),vt[1]].join(" "):[R(pe/255),R(Me/255),R(qe/255),vt[1]].join(" ")}else Q=typeof pe=="string"?[pe,Me,qe,xt,vt[2]].join(" "):j.precision===2?[H(pe),H(Me),H(qe),H(xt),vt[2]].join(" "):[R(pe),R(Me),R(qe),R(xt),vt[2]].join(" ");return Q},vi=S.__private__.getFilters=function(){return v},qi=S.__private__.putStream=function(j){var Q=(j=j||{}).data||"",pe=j.filters||vi(),Me=j.alreadyAppliedFilters||[],qe=j.addLength1||!1,xt=Q.length,vt=j.objectId,Wt=function(wr){return wr};if(T!==null&&vt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");T!==null&&(Wt=io.encryptor(vt,0));var Zt={};pe===!0&&(pe=["FlateEncode"]);var on=j.additionalKeyValues||[],qn=(Zt=Wn.API.processDataByFilters!==void 0?Wn.API.processDataByFilters(Q,pe):{data:Q,reverseChain:[]}).reverseChain+(Array.isArray(Me)?Me.join(" "):Me.toString());if(Zt.data.length!==0&&(on.push({key:"Length",value:Zt.data.length}),qe===!0&&on.push({key:"Length1",value:xt})),qn.length!=0)if(qn.split("/").length-1==1)on.push({key:"Filter",value:qn});else{on.push({key:"Filter",value:"["+qn+"]"});for(var ci=0;ci<on.length;ci+=1)if(on[ci].key==="DecodeParms"){for(var Gr=[],Mi=0;Mi<Zt.reverseChain.split("/").length-1;Mi+=1)Gr.push("null");Gr.push(on[ci].value),on[ci].value="["+Gr.join(" ")+"]"}}ye("<<");for(var vr=0;vr<on.length;vr++)ye("/"+on[vr].key+" "+on[vr].value);ye(">>"),Zt.data.length!==0&&(ye("stream"),ye(Wt(Zt.data)),ye("endstream"))},Br=S.__private__.putPage=function(j){var Q=j.number,pe=j.data,Me=j.objId,qe=j.contentsObjId;Bt(Me,!0),ye("<</Type /Page"),ye("/Parent "+j.rootDictionaryObjId+" 0 R"),ye("/Resources "+j.resourceDictionaryObjId+" 0 R"),ye("/MediaBox ["+parseFloat(ee(j.mediaBox.bottomLeftX))+" "+parseFloat(ee(j.mediaBox.bottomLeftY))+" "+ee(j.mediaBox.topRightX)+" "+ee(j.mediaBox.topRightY)+"]"),j.cropBox!==null&&ye("/CropBox ["+ee(j.cropBox.bottomLeftX)+" "+ee(j.cropBox.bottomLeftY)+" "+ee(j.cropBox.topRightX)+" "+ee(j.cropBox.topRightY)+"]"),j.bleedBox!==null&&ye("/BleedBox ["+ee(j.bleedBox.bottomLeftX)+" "+ee(j.bleedBox.bottomLeftY)+" "+ee(j.bleedBox.topRightX)+" "+ee(j.bleedBox.topRightY)+"]"),j.trimBox!==null&&ye("/TrimBox ["+ee(j.trimBox.bottomLeftX)+" "+ee(j.trimBox.bottomLeftY)+" "+ee(j.trimBox.topRightX)+" "+ee(j.trimBox.topRightY)+"]"),j.artBox!==null&&ye("/ArtBox ["+ee(j.artBox.bottomLeftX)+" "+ee(j.artBox.bottomLeftY)+" "+ee(j.artBox.topRightX)+" "+ee(j.artBox.topRightY)+"]"),typeof j.userUnit=="number"&&j.userUnit!==1&&ye("/UserUnit "+j.userUnit),bn.publish("putPage",{objId:Me,pageContext:fn[Q],pageNumber:Q,page:pe}),ye("/Contents "+qe+" 0 R"),ye(">>"),ye("endobj");var xt=pe.join(`
`);return q===E&&(xt+=`
Q`),Bt(qe,!0),qi({data:xt,filters:vi(),objectId:qe}),ye("endobj"),Me},Ja=S.__private__.putPages=function(){var j,Q,pe=[];for(j=1;j<=gn;j++)fn[j].objId=tt(),fn[j].contentsObjId=tt();for(j=1;j<=gn;j++)pe.push(Br({number:j,data:Xe[j],objId:fn[j].objId,contentsObjId:fn[j].contentsObjId,mediaBox:fn[j].mediaBox,cropBox:fn[j].cropBox,bleedBox:fn[j].bleedBox,trimBox:fn[j].trimBox,artBox:fn[j].artBox,userUnit:fn[j].userUnit,rootDictionaryObjId:An,resourceDictionaryObjId:yn}));Bt(An,!0),ye("<</Type /Pages");var Me="/Kids [";for(Q=0;Q<gn;Q++)Me+=pe[Q]+" 0 R ";ye(Me+"]"),ye("/Count "+gn),ye(">>"),ye("endobj"),bn.publish("postPutPages")},Qa=function(j){bn.publish("putFont",{font:j,out:ye,newObject:Ht,putStream:qi}),j.isAlreadyPutted!==!0&&(j.objectNumber=Ht(),ye("<<"),ye("/Type /Font"),ye("/BaseFont /"+Kd(j.postScriptName)),ye("/Subtype /Type1"),typeof j.encoding=="string"&&ye("/Encoding /"+j.encoding),ye("/FirstChar 32"),ye("/LastChar 255"),ye(">>"),ye("endobj"))},Ia=function(j){j.objectNumber=Ht();var Q=[];Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Form"}),Q.push({key:"BBox",value:"["+[ee(j.x),ee(j.y),ee(j.x+j.width),ee(j.y+j.height)].join(" ")+"]"}),Q.push({key:"Matrix",value:"["+j.matrix.toString()+"]"});var pe=j.pages[1].join(`
`);qi({data:pe,additionalKeyValues:Q,objectId:j.objectNumber}),ye("endobj")},Go=function(j,Q){Q||(Q=21);var pe=Ht(),Me=(function(vt,Wt){var Zt,on=[],qn=1/(Wt-1);for(Zt=0;Zt<1;Zt+=qn)on.push(Zt);if(on.push(1),vt[0].offset!=0){var ci={offset:0,color:vt[0].color};vt.unshift(ci)}if(vt[vt.length-1].offset!=1){var Gr={offset:1,color:vt[vt.length-1].color};vt.push(Gr)}for(var Mi="",vr=0,wr=0;wr<on.length;wr++){for(Zt=on[wr];Zt>vt[vr+1].offset;)vr++;var Co=vt[vr].offset,Ki=(Zt-Co)/(vt[vr+1].offset-Co),da=vt[vr].color,Nr=vt[vr+1].color;Mi+=se(Math.round((1-Ki)*da[0]+Ki*Nr[0]).toString(16))+se(Math.round((1-Ki)*da[1]+Ki*Nr[1]).toString(16))+se(Math.round((1-Ki)*da[2]+Ki*Nr[2]).toString(16))}return Mi.trim()})(j.colors,Q),qe=[];qe.push({key:"FunctionType",value:"0"}),qe.push({key:"Domain",value:"[0.0 1.0]"}),qe.push({key:"Size",value:"["+Q+"]"}),qe.push({key:"BitsPerSample",value:"8"}),qe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qi({data:Me,additionalKeyValues:qe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:pe}),ye("endobj"),j.objectNumber=Ht(),ye("<< /ShadingType "+j.type),ye("/ColorSpace /DeviceRGB");var xt="/Coords ["+ee(parseFloat(j.coords[0]))+" "+ee(parseFloat(j.coords[1]))+" ";j.type===2?xt+=ee(parseFloat(j.coords[2]))+" "+ee(parseFloat(j.coords[3])):xt+=ee(parseFloat(j.coords[2]))+" "+ee(parseFloat(j.coords[3]))+" "+ee(parseFloat(j.coords[4]))+" "+ee(parseFloat(j.coords[5])),ye(xt+="]"),j.matrix&&ye("/Matrix ["+j.matrix.toString()+"]"),ye("/Function "+pe+" 0 R"),ye("/Extend [true true]"),ye(">>"),ye("endobj")},Ca=function(j,Q){var pe=tt(),Me=Ht();Q.push({resourcesOid:pe,objectOid:Me}),j.objectNumber=Me;var qe=[];qe.push({key:"Type",value:"/Pattern"}),qe.push({key:"PatternType",value:"1"}),qe.push({key:"PaintType",value:"1"}),qe.push({key:"TilingType",value:"1"}),qe.push({key:"BBox",value:"["+j.boundingBox.map(ee).join(" ")+"]"}),qe.push({key:"XStep",value:ee(j.xStep)}),qe.push({key:"YStep",value:ee(j.yStep)}),qe.push({key:"Resources",value:pe+" 0 R"}),j.matrix&&qe.push({key:"Matrix",value:"["+j.matrix.toString()+"]"}),qi({data:j.stream,additionalKeyValues:qe,objectId:j.objectNumber}),ye("endobj")},di=function(j){for(var Q in j.objectNumber=Ht(),ye("<<"),j)switch(Q){case"opacity":ye("/ca "+H(j[Q]));break;case"stroke-opacity":ye("/CA "+H(j[Q]))}ye(">>"),ye("endobj")},To=function(j){Bt(j.resourcesOid,!0),ye("<<"),ye("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Q in ye("/Font <<"),jt)jt.hasOwnProperty(Q)&&(D===!1||D===!0&&M.hasOwnProperty(Q))&&ye("/"+Q+" "+jt[Q].objectNumber+" 0 R");ye(">>")})(),(function(){if(Object.keys(ln).length>0){for(var Q in ye("/Shading <<"),ln)ln.hasOwnProperty(Q)&&ln[Q]instanceof pd&&ln[Q].objectNumber>=0&&ye("/"+Q+" "+ln[Q].objectNumber+" 0 R");bn.publish("putShadingPatternDict"),ye(">>")}})(),(function(Q){if(Object.keys(ln).length>0){for(var pe in ye("/Pattern <<"),ln)ln.hasOwnProperty(pe)&&ln[pe]instanceof S.TilingPattern&&ln[pe].objectNumber>=0&&ln[pe].objectNumber<Q&&ye("/"+pe+" "+ln[pe].objectNumber+" 0 R");bn.publish("putTilingPatternDict"),ye(">>")}})(j.objectOid),(function(){if(Object.keys(cn).length>0){var Q;for(Q in ye("/ExtGState <<"),cn)cn.hasOwnProperty(Q)&&cn[Q].objectNumber>=0&&ye("/"+Q+" "+cn[Q].objectNumber+" 0 R");bn.publish("putGStateDict"),ye(">>")}})(),(function(){for(var Q in ye("/XObject <<"),Dn)Dn.hasOwnProperty(Q)&&Dn[Q].objectNumber>=0&&ye("/"+Q+" "+Dn[Q].objectNumber+" 0 R");bn.publish("putXobjectDict"),ye(">>")})(),ye(">>"),ye("endobj")},Gn=function(j){Ft[j.fontName]=Ft[j.fontName]||{},Ft[j.fontName][j.fontStyle]=j.id},gs=function(j,Q,pe,Me,qe){var xt={id:"F"+(Object.keys(jt).length+1).toString(10),postScriptName:j,fontName:Q,fontStyle:pe,encoding:Me,isStandardFont:qe||!1,metadata:{}};return bn.publish("addFont",{font:xt,instance:this}),jt[xt.id]=xt,Gn(xt),xt.id},fi=S.__private__.pdfEscape=S.pdfEscape=function(j,Q){return(function(pe,Me){var qe,xt,vt,Wt,Zt,on,qn,ci,Gr;if(vt=(Me=Me||{}).sourceEncoding||"Unicode",Zt=Me.outputEncoding,(Me.autoencode||Zt)&&jt[it].metadata&&jt[it].metadata[vt]&&jt[it].metadata[vt].encoding&&(Wt=jt[it].metadata[vt].encoding,!Zt&&jt[it].encoding&&(Zt=jt[it].encoding),!Zt&&Wt.codePages&&(Zt=Wt.codePages[0]),typeof Zt=="string"&&(Zt=Wt[Zt]),Zt)){for(qn=!1,on=[],qe=0,xt=pe.length;qe<xt;qe++)(ci=Zt[pe.charCodeAt(qe)])?on.push(String.fromCharCode(ci)):on.push(pe[qe]),on[qe].charCodeAt(0)>>8&&(qn=!0);pe=on.join("")}for(qe=pe.length;qn===void 0&&qe!==0;)pe.charCodeAt(qe-1)>>8&&(qn=!0),qe--;if(!qn)return pe;for(on=Me.noBOM?[]:[254,255],qe=0,xt=pe.length;qe<xt;qe++){if((Gr=(ci=pe.charCodeAt(qe))>>8)>>8)throw new Error("Character at position "+qe+" of string '"+pe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");on.push(Gr),on.push(ci-(Gr<<8))}return String.fromCharCode.apply(void 0,on)})(j,Q).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Uo=S.__private__.beginPage=function(j){Xe[++gn]=[],fn[gn]={objId:0,contentsObjId:0,userUnit:Number(p),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(j[0]),topRightY:Number(j[1])}},es(gn),qt(Xe[V])},Di=function(j,Q){var pe,Me,qe;switch(o=Q||o,typeof j=="string"&&(pe=g(j.toLowerCase()),Array.isArray(pe)&&(Me=pe[0],qe=pe[1])),Array.isArray(j)&&(Me=j[0]*$e,qe=j[1]*$e),isNaN(Me)&&(Me=l[0],qe=l[1]),(Me>14400||qe>14400)&&(no.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Me=Math.min(14400,Me),qe=Math.min(14400,qe)),l=[Me,qe],o.substr(0,1)){case"l":qe>Me&&(l=[qe,Me]);break;case"p":Me>qe&&(l=[qe,Me])}Uo(l),zn(Ba),ye(Eo),Tn!==0&&ye(Tn+" J"),Ko!==0&&ye(Ko+" j"),bn.publish("addPage",{pageNumber:gn})},_s=function(j){j>0&&j<=gn&&(Xe.splice(j,1),fn.splice(j,1),gn--,V>gn&&(V=gn),this.setPage(V))},es=function(j){j>0&&j<=gn&&(V=j)},ts=S.__private__.getNumberOfPages=S.getNumberOfPages=function(){return Xe.length-1},ys=function(j,Q,pe){var Me,qe=void 0;return pe=pe||{},j=j!==void 0?j:jt[it].fontName,Q=Q!==void 0?Q:jt[it].fontStyle,Me=j.toLowerCase(),Ft[Me]!==void 0&&Ft[Me][Q]!==void 0?qe=Ft[Me][Q]:Ft[j]!==void 0&&Ft[j][Q]!==void 0?qe=Ft[j][Q]:pe.disableWarning===!1&&no.warn("Unable to look up font label for font '"+j+"', '"+Q+"'. Refer to getFontList() for available fonts."),qe||pe.noFallback||(qe=Ft.times[Q])==null&&(qe=Ft.times.normal),qe},Pr=S.__private__.putInfo=function(){var j=Ht(),Q=function(Me){return Me};for(var pe in T!==null&&(Q=io.encryptor(j,0)),ye("<<"),ye("/Producer ("+fi(Q("jsPDF "+Wn.version))+")"),lt)lt.hasOwnProperty(pe)&&lt[pe]&&ye("/"+pe.substr(0,1).toUpperCase()+pe.substr(1)+" ("+fi(Q(lt[pe]))+")");ye("/CreationDate ("+fi(Q(we))+")"),ye(">>"),ye("endobj")},Gs=S.__private__.putCatalog=function(j){var Q=(j=j||{}).rootDictionaryObjId||An;switch(Ht(),ye("<<"),ye("/Type /Catalog"),ye("/Pages "+Q+" 0 R"),Qe||(Qe="fullwidth"),Qe){case"fullwidth":ye("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ye("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ye("/OpenAction [3 0 R /Fit]");break;case"original":ye("/OpenAction [3 0 R /XYZ null null 1]");break;default:var pe=""+Qe;pe.substr(pe.length-1)==="%"&&(Qe=parseInt(Qe)/100),typeof Qe=="number"&&ye("/OpenAction [3 0 R /XYZ null null "+H(Qe)+"]")}switch(Fn||(Fn="continuous"),Fn){case"continuous":ye("/PageLayout /OneColumn");break;case"single":ye("/PageLayout /SinglePage");break;case"two":case"twoleft":ye("/PageLayout /TwoColumnLeft");break;case"tworight":ye("/PageLayout /TwoColumnRight")}rn&&ye("/PageMode /"+rn),bn.publish("putCatalog"),ye(">>"),ye("endobj")},br=S.__private__.putTrailer=function(){ye("trailer"),ye("<<"),ye("/Size "+(Te+1)),ye("/Root "+Te+" 0 R"),ye("/Info "+(Te-1)+" 0 R"),T!==null&&ye("/Encrypt "+io.oid+" 0 R"),ye("/ID [ <"+te+"> <"+te+"> ]"),ye(">>")},Ii=S.__private__.putHeader=function(){ye("%PDF-"+F),ye("%")},pi=S.__private__.putXRef=function(){var j="0000000000";ye("xref"),ye("0 "+(Te+1)),ye("0000000000 65535 f ");for(var Q=1;Q<=Te;Q++)typeof le[Q]=="function"?ye((j+le[Q]()).slice(-10)+" 00000 n "):le[Q]!==void 0?ye((j+le[Q]).slice(-10)+" 00000 n "):ye("0000000000 00000 n ")},dr=S.__private__.buildDocument=function(){var j;Te=0,ve=0,_e=[],le=[],De=[],An=tt(),yn=tt(),qt(_e),bn.publish("buildDocument"),Ii(),Ja(),(function(){bn.publish("putAdditionalObjects");for(var pe=0;pe<De.length;pe++){var Me=De[pe];Bt(Me.objId,!0),ye(Me.content),ye("endobj")}bn.publish("postPutAdditionalObjects")})(),j=[],(function(){for(var pe in jt)jt.hasOwnProperty(pe)&&(D===!1||D===!0&&M.hasOwnProperty(pe))&&Qa(jt[pe])})(),(function(){var pe;for(pe in cn)cn.hasOwnProperty(pe)&&di(cn[pe])})(),(function(){for(var pe in Dn)Dn.hasOwnProperty(pe)&&Ia(Dn[pe])})(),(function(pe){var Me;for(Me in ln)ln.hasOwnProperty(Me)&&(ln[Me]instanceof pd?Go(ln[Me]):ln[Me]instanceof Zd&&Ca(ln[Me],pe))})(j),bn.publish("putResources"),j.forEach(To),To({resourcesOid:yn,objectOid:Number.MAX_SAFE_INTEGER}),bn.publish("postPutResources"),T!==null&&(io.oid=Ht(),ye("<<"),ye("/Filter /Standard"),ye("/V "+io.v),ye("/R "+io.r),ye("/U <"+io.toHexString(io.U)+">"),ye("/O <"+io.toHexString(io.O)+">"),ye("/P "+io.P),ye(">>"),ye("endobj")),Pr(),Gs();var Q=ve;return pi(),br(),ye("startxref"),ye(""+Q),ye("%%EOF"),qt(Xe[V]),_e.join(`
`)},ns=S.__private__.getBlob=function(j){return new Blob([Gt(j)],{type:"application/pdf"})},Gl=S.output=S.__private__.output=(Rt=function(j,Q){switch(typeof(Q=Q||{})=="string"?Q={filename:Q}:Q.filename=Q.filename||"generated.pdf",j){case void 0:return dr();case"save":S.save(Q.filename);break;case"arraybuffer":return Gt(dr());case"blob":return ns(dr());case"bloburi":case"bloburl":if(ui.URL!==void 0&&typeof ui.URL.createObjectURL=="function")return ui.URL&&ui.URL.createObjectURL(ns(dr()))||void 0;no.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var pe="",Me=dr();try{pe=hy(Me)}catch{pe=hy(unescape(encodeURIComponent(Me)))}return"data:application/pdf;filename="+Q.filename+";base64,"+pe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(ui)==="[object Window]"){var qe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",xt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Q.pdfObjectUrl&&(qe=Q.pdfObjectUrl,xt="");var vt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+qe+'"'+xt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Q)+");<\/script></body></html>",Wt=ui.open();return Wt!==null&&Wt.document.write(vt),Wt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(ui)==="[object Window]"){var Zt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Q.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Q.filename+'" width="500px" height="400px" /></body></html>',on=ui.open();if(on!==null){on.document.write(Zt);var qn=this;on.document.documentElement.querySelector("#pdfViewer").onload=function(){on.document.title=Q.filename,on.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(qn.output("bloburl"))}}return on}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(ui)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ci='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Q)+'"></iframe></body></html>',Gr=ui.open();if(Gr!==null&&(Gr.document.write(ci),Gr.document.title=Q.filename),Gr||typeof safari>"u")return Gr;break;case"datauri":case"dataurl":return ui.document.location.href=this.output("datauristring",Q);default:return null}},Rt.foo=function(){try{return Rt.apply(this,arguments)}catch(pe){var j=pe.stack||"";~j.indexOf(" at ")&&(j=j.split(" at ")[1]);var Q="Error in function "+j.split(`
`)[0].split("<")[0]+": "+pe.message;if(!ui.console)throw new Error(Q);ui.console.error(Q,pe),ui.alert&&alert(Q)}},Rt.foo.bar=Rt,Rt.foo),po=function(j){return Array.isArray(ir)===!0&&ir.indexOf(j)>-1};switch(s){case"pt":$e=1;break;case"mm":$e=72/25.4;break;case"cm":$e=72/2.54;break;case"in":$e=72;break;case"px":$e=po("px_scaling")==1?.75:96/72;break;case"pc":case"em":$e=12;break;case"ex":$e=6;break;default:if(typeof s!="number")throw new Error("Invalid unit: "+s);$e=s}var io=null;k(),Ce();var Vi=S.__private__.getPageInfo=S.getPageInfo=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:fn[j].objId,pageNumber:j,pageContext:fn[j]}},Yo=S.__private__.getPageInfoByObjId=function(j){if(isNaN(j)||j%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Q in fn)if(fn[Q].objId===j)break;return Vi(Q)},Yl=S.__private__.getCurrentPageInfo=S.getCurrentPageInfo=function(){return{objId:fn[V].objId,pageNumber:V,pageContext:fn[V]}};S.addPage=function(){return Di.apply(this,arguments),this},S.setPage=function(){return es.apply(this,arguments),qt.call(this,Xe[V]),this},S.insertPage=function(j){return this.addPage(),this.movePage(V,j),this},S.movePage=function(j,Q){var pe,Me;if(j>Q){pe=Xe[j],Me=fn[j];for(var qe=j;qe>Q;qe--)Xe[qe]=Xe[qe-1],fn[qe]=fn[qe-1];Xe[Q]=pe,fn[Q]=Me,this.setPage(Q)}else if(j<Q){pe=Xe[j],Me=fn[j];for(var xt=j;xt<Q;xt++)Xe[xt]=Xe[xt+1],fn[xt]=fn[xt+1];Xe[Q]=pe,fn[Q]=Me,this.setPage(Q)}return this},S.deletePage=function(){return _s.apply(this,arguments),this},S.__private__.text=S.text=function(j,Q,pe,Me,qe){var xt,vt,Wt,Zt,on,qn,ci,Gr,Mi,vr=(Me=Me||{}).scope||this;if(typeof j=="number"&&typeof Q=="number"&&(typeof pe=="string"||Array.isArray(pe))){var wr=pe;pe=Q,Q=j,j=wr}if(arguments[3]instanceof Xt==0?(Wt=arguments[4],Zt=arguments[5],Ir(ci=arguments[3])==="object"&&ci!==null||(typeof Wt=="string"&&(Zt=Wt,Wt=null),typeof ci=="string"&&(Zt=ci,ci=null),typeof ci=="number"&&(Wt=ci,ci=null),Me={flags:ci,angle:Wt,align:Zt})):(U("The transform parameter of text() with a Matrix value"),Mi=qe),isNaN(Q)||isNaN(pe)||j==null)throw new Error("Invalid arguments passed to jsPDF.text");if(j.length===0)return vr;var Co,Ki="",da=typeof Me.lineHeightFactor=="number"?Me.lineHeightFactor:ms,Nr=vr.internal.scaleFactor;function fa(Ri){return Ri=Ri.split("	").join(Array(Me.TabLen||9).join(" ")),fi(Ri,ci)}function pa(Ri){for(var Oi,or=Ri.concat(),yo=[],ls=or.length;ls--;)typeof(Oi=or.shift())=="string"?yo.push(Oi):Array.isArray(Ri)&&(Oi.length===1||Oi[1]===void 0&&Oi[2]===void 0)?yo.push(Oi[0]):yo.push([Oi[0],Oi[1],Oi[2]]);return yo}function ws(Ri,Oi){var or;if(typeof Ri=="string")or=Oi(Ri)[0];else if(Array.isArray(Ri)){for(var yo,ls,Qs=Ri.concat(),xc=[],Qc=Qs.length;Qc--;)typeof(yo=Qs.shift())=="string"?xc.push(Oi(yo)[0]):Array.isArray(yo)&&typeof yo[0]=="string"&&(ls=Oi(yo[0],yo[1],yo[2]),xc.push([ls[0],ls[1],ls[2]]));or=xc}return or}var Zo=!1,Aa=!0;if(typeof j=="string")Zo=!0;else if(Array.isArray(j)){var oo=j.concat();vt=[];for(var ha,Hi=oo.length;Hi--;)(typeof(ha=oo.shift())!="string"||Array.isArray(ha)&&typeof ha[0]!="string")&&(Aa=!1);Zo=Aa}if(Zo===!1)throw new Error('Type of text must be string or Array. "'+j+'" is not recognized.');typeof j=="string"&&(j=j.match(/[\r?\n]/)?j.split(/\r\n|\r|\n/g):[j]);var za=ht/vr.internal.scaleFactor,ho=za*(da-1);switch(Me.baseline){case"bottom":pe-=ho;break;case"top":pe+=za-ho;break;case"hanging":pe+=za-2*ho;break;case"middle":pe+=za/2-ho}if((qn=Me.maxWidth||0)>0&&(typeof j=="string"?j=vr.splitTextToSize(j,qn):Object.prototype.toString.call(j)==="[object Array]"&&(j=j.reduce(function(Ri,Oi){return Ri.concat(vr.splitTextToSize(Oi,qn))},[]))),xt={text:j,x:Q,y:pe,options:Me,mutex:{pdfEscape:fi,activeFontKey:it,fonts:jt,activeFontSize:ht}},bn.publish("preProcessText",xt),j=xt.text,Wt=(Me=xt.options).angle,Mi instanceof Xt==0&&Wt&&typeof Wt=="number"){Wt*=Math.PI/180,Me.rotationDirection===0&&(Wt=-Wt),q===E&&(Wt=-Wt);var rs=Math.cos(Wt),Wi=Math.sin(Wt);Mi=new Xt(rs,Wi,-Wi,rs,0,0)}else Wt&&Wt instanceof Xt&&(Mi=Wt);q!==E||Mi||(Mi=Ti),(on=Me.charSpace||xn)!==void 0&&(Ki+=ee(Z(on))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Gr=Me.horizontalScale)!==void 0&&(Ki+=ee(100*Gr)+` Tz
`),Me.lang;var Yr=-1,wl=Me.renderingMode!==void 0?Me.renderingMode:Me.stroke,Dc=vr.internal.getCurrentPageInfo().pageContext;switch(wl){case 0:case!1:case"fill":Yr=0;break;case 1:case!0:case"stroke":Yr=1;break;case 2:case"fillThenStroke":Yr=2;break;case 3:case"invisible":Yr=3;break;case 4:case"fillAndAddForClipping":Yr=4;break;case 5:case"strokeAndAddPathForClipping":Yr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Yr=6;break;case 7:case"addToPathForClipping":Yr=7}var Ds=Dc.usedRenderingMode!==void 0?Dc.usedRenderingMode:-1;Yr!==-1?Ki+=Yr+` Tr
`:Ds!==-1&&(Ki+=`0 Tr
`),Yr!==-1&&(Dc.usedRenderingMode=Yr),Zt=Me.align||"left";var Pa,os=ht*da,Ks=vr.internal.pageSize.getWidth(),No=jt[it];on=Me.charSpace||xn,qn=Me.maxWidth||0,ci=Object.assign({autoencode:!0,noBOM:!0},Me.flags);var as=[],ao=function(Ri){return vr.getStringUnitWidth(Ri,{font:No,charSpace:on,fontSize:ht,doKerning:!1})*ht/Nr};if(Object.prototype.toString.call(j)==="[object Array]"){var qo;vt=pa(j),Zt!=="left"&&(Pa=vt.map(ao));var Ur,Rs=0;if(Zt==="right"){Q-=Pa[0],j=[],Hi=vt.length;for(var Jo=0;Jo<Hi;Jo++)Jo===0?(Ur=ua(Q),qo=vn(pe)):(Ur=Z(Rs-Pa[Jo]),qo=-os),j.push([vt[Jo],Ur,qo]),Rs=Pa[Jo]}else if(Zt==="center"){Q-=Pa[0]/2,j=[],Hi=vt.length;for(var Zs=0;Zs<Hi;Zs++)Zs===0?(Ur=ua(Q),qo=vn(pe)):(Ur=Z((Rs-Pa[Zs])/2),qo=-os),j.push([vt[Zs],Ur,qo]),Rs=Pa[Zs]}else if(Zt==="left"){j=[],Hi=vt.length;for(var Ea=0;Ea<Hi;Ea++)j.push(vt[Ea])}else if(Zt==="justify"&&No.encoding==="Identity-H"){j=[],Hi=vt.length,qn=qn!==0?qn:Ks;for(var Kl=0,ei=0;ei<Hi;ei++)if(qo=ei===0?vn(pe):-os,Ur=ei===0?ua(Q):Kl,ei<Hi-1){var Ss=Z((qn-Pa[ei])/(vt[ei].split(" ").length-1)),Bi=vt[ei].split(" ");j.push([Bi[0]+" ",Ur,qo]),Kl=0;for(var Qo=1;Qo<Bi.length;Qo++){var Vo=(ao(Bi[Qo-1]+" "+Bi[Qo])-ao(Bi[Qo]))*Nr+Ss;Qo==Bi.length-1?j.push([Bi[Qo],Vo,0]):j.push([Bi[Qo]+" ",Vo,0]),Kl-=Vo}}else j.push([vt[ei],Ur,qo]);j.push(["",Kl,0])}else{if(Zt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(j=[],Hi=vt.length,qn=qn!==0?qn:Ks,ei=0;ei<Hi;ei++){qo=ei===0?vn(pe):-os,Ur=ei===0?ua(Q):0;var ga=vt[ei].split(" ").length-1,Rc=ga>0?(qn-Pa[ei])/ga:0;ei<Hi-1?as.push(ee(Z(Rc))):as.push(0),j.push([vt[ei],Ur,qo])}}}(typeof Me.R2L=="boolean"?Me.R2L:dn)===!0&&(j=ws(j,function(Ri,Oi,or){return[Ri.split("").reverse().join(""),Oi,or]})),xt={text:j,x:Q,y:pe,options:Me,mutex:{pdfEscape:fi,activeFontKey:it,fonts:jt,activeFontSize:ht}},bn.publish("postProcessText",xt),j=xt.text,Co=xt.mutex.isHex||!1;var Js=jt[it].encoding;Js!=="WinAnsiEncoding"&&Js!=="StandardEncoding"||(j=ws(j,function(Ri,Oi,or){return[fa(Ri),Oi,or]})),vt=pa(j),j=[];for(var Sl,jl,go,Tl=Array.isArray(vt[0])?1:0,Ho="",qa=function(Ri,Oi,or){var yo="";return or instanceof Xt?(or=typeof Me.angle=="number"?mr(or,new Xt(1,0,0,1,Ri,Oi)):mr(new Xt(1,0,0,1,Ri,Oi),or),q===E&&(or=mr(new Xt(1,0,0,-1,0,0),or)),yo=or.join(" ")+` Tm
`):yo=ee(Ri)+" "+ee(Oi)+` Td
`,yo},rr=0;rr<vt.length;rr++){switch(Ho="",Tl){case 1:go=(Co?"<":"(")+vt[rr][0]+(Co?">":")"),Sl=parseFloat(vt[rr][1]),jl=parseFloat(vt[rr][2]);break;case 0:go=(Co?"<":"(")+vt[rr]+(Co?">":")"),Sl=ua(Q),jl=vn(pe)}as!==void 0&&as[rr]!==void 0&&(Ho=as[rr]+` Tw
`),rr===0?j.push(Ho+qa(Sl,jl,Mi)+go):Tl===0?j.push(Ho+go):Tl===1&&j.push(Ho+qa(Sl,jl,Mi)+go)}j=Tl===0?j.join(` Tj
T* `):j.join(` Tj
`),j+=` Tj
`;var ss=`BT
/`;return ss+=it+" "+ht+` Tf
`,ss+=ee(ht*da)+` TL
`,ss+=mn+`
`,ss+=Ki,ss+=j,ye(ss+="ET"),M[it]=!0,vr};var ca=S.__private__.clip=S.clip=function(j){return ye(j==="evenodd"?"W*":"W"),this};S.clipEvenOdd=function(){return ca("evenodd")},S.__private__.discardPath=S.discardPath=function(){return ye("n"),this};var fr=S.__private__.isValidStyle=function(j){var Q=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(j)!==-1&&(Q=!0),Q};S.__private__.setDefaultPathOperation=S.setDefaultPathOperation=function(j){return fr(j)&&(m=j),this};var Xl=S.__private__.getStyle=S.getStyle=function(j){var Q=m;switch(j){case"D":case"S":Q="S";break;case"F":Q="f";break;case"FD":case"DF":Q="B";break;case"f":case"f*":case"B":case"B*":Q=j}return Q},Or=S.close=function(){return ye("h"),this};S.stroke=function(){return ye("S"),this},S.fill=function(j){return ki("f",j),this},S.fillEvenOdd=function(j){return ki("f*",j),this},S.fillStroke=function(j){return ki("B",j),this},S.fillStrokeEvenOdd=function(j){return ki("B*",j),this};var ki=function(j,Q){Ir(Q)==="object"?Fo(Q,j):ye(j)},rl=function(j){j===null||q===E&&j===void 0||(j=Xl(j),ye(j))};function Ma(j,Q,pe,Me,qe){var xt=new Zd(Q||this.boundingBox,pe||this.xStep,Me||this.yStep,this.gState,qe||this.matrix);xt.stream=this.stream;var vt=j+"$$"+this.cloneIndex+++"$$";return Ln(vt,xt),xt}var Fo=function(j,Q){var pe=mt[j.key],Me=ln[pe];if(Me instanceof pd)ye("q"),ye(xs(Q)),Me.gState&&S.setGState(Me.gState),ye(j.matrix.toString()+" cm"),ye("/"+pe+" sh"),ye("Q");else if(Me instanceof Zd){var qe=new Xt(1,0,0,-1,0,vs());j.matrix&&(qe=qe.multiply(j.matrix||Ti),pe=Ma.call(Me,j.key,j.boundingBox,j.xStep,j.yStep,qe).id),ye("q"),ye("/Pattern cs"),ye("/"+pe+" scn"),Me.gState&&S.setGState(Me.gState),ye(Q),ye("Q")}},xs=function(j){switch(j){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Na=S.moveTo=function(j,Q){return ye(ee(Z(j))+" "+ee(G(Q))+" m"),this},Xo=S.lineTo=function(j,Q){return ye(ee(Z(j))+" "+ee(G(Q))+" l"),this},$r=S.curveTo=function(j,Q,pe,Me,qe,xt){return ye([ee(Z(j)),ee(G(Q)),ee(Z(pe)),ee(G(Me)),ee(Z(qe)),ee(G(xt)),"c"].join(" ")),this};S.__private__.line=S.line=function(j,Q,pe,Me,qe){if(isNaN(j)||isNaN(Q)||isNaN(pe)||isNaN(Me)||!fr(qe))throw new Error("Invalid arguments passed to jsPDF.line");return q===ae?this.lines([[pe-j,Me-Q]],j,Q,[1,1],qe||"S"):this.lines([[pe-j,Me-Q]],j,Q,[1,1]).stroke()},S.__private__.lines=S.lines=function(j,Q,pe,Me,qe,xt){var vt,Wt,Zt,on,qn,ci,Gr,Mi,vr,wr,Co,Ki;if(typeof j=="number"&&(Ki=pe,pe=Q,Q=j,j=Ki),Me=Me||[1,1],xt=xt||!1,isNaN(Q)||isNaN(pe)||!Array.isArray(j)||!Array.isArray(Me)||!fr(qe)||typeof xt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Na(Q,pe),vt=Me[0],Wt=Me[1],on=j.length,wr=Q,Co=pe,Zt=0;Zt<on;Zt++)(qn=j[Zt]).length===2?(wr=qn[0]*vt+wr,Co=qn[1]*Wt+Co,Xo(wr,Co)):(ci=qn[0]*vt+wr,Gr=qn[1]*Wt+Co,Mi=qn[2]*vt+wr,vr=qn[3]*Wt+Co,wr=qn[4]*vt+wr,Co=qn[5]*Wt+Co,$r(ci,Gr,Mi,vr,wr,Co));return xt&&Or(),rl(qe),this},S.path=function(j){for(var Q=0;Q<j.length;Q++){var pe=j[Q],Me=pe.c;switch(pe.op){case"m":Na(Me[0],Me[1]);break;case"l":Xo(Me[0],Me[1]);break;case"c":$r.apply(this,Me);break;case"h":Or()}}return this},S.__private__.rect=S.rect=function(j,Q,pe,Me,qe){if(isNaN(j)||isNaN(Q)||isNaN(pe)||isNaN(Me)||!fr(qe))throw new Error("Invalid arguments passed to jsPDF.rect");return q===ae&&(Me=-Me),ye([ee(Z(j)),ee(G(Q)),ee(Z(pe)),ee(Z(Me)),"re"].join(" ")),rl(qe),this},S.__private__.triangle=S.triangle=function(j,Q,pe,Me,qe,xt,vt){if(isNaN(j)||isNaN(Q)||isNaN(pe)||isNaN(Me)||isNaN(qe)||isNaN(xt)||!fr(vt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[pe-j,Me-Q],[qe-pe,xt-Me],[j-qe,Q-xt]],j,Q,[1,1],vt,!0),this},S.__private__.roundedRect=S.roundedRect=function(j,Q,pe,Me,qe,xt,vt){if(isNaN(j)||isNaN(Q)||isNaN(pe)||isNaN(Me)||isNaN(qe)||isNaN(xt)||!fr(vt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Wt=4/3*(Math.SQRT2-1);return qe=Math.min(qe,.5*pe),xt=Math.min(xt,.5*Me),this.lines([[pe-2*qe,0],[qe*Wt,0,qe,xt-xt*Wt,qe,xt],[0,Me-2*xt],[0,xt*Wt,-qe*Wt,xt,-qe,xt],[2*qe-pe,0],[-qe*Wt,0,-qe,-xt*Wt,-qe,-xt],[0,2*xt-Me],[0,-xt*Wt,qe*Wt,-xt,qe,-xt]],j+qe,Q,[1,1],vt,!0),this},S.__private__.ellipse=S.ellipse=function(j,Q,pe,Me,qe){if(isNaN(j)||isNaN(Q)||isNaN(pe)||isNaN(Me)||!fr(qe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var xt=4/3*(Math.SQRT2-1)*pe,vt=4/3*(Math.SQRT2-1)*Me;return Na(j+pe,Q),$r(j+pe,Q-vt,j+xt,Q-Me,j,Q-Me),$r(j-xt,Q-Me,j-pe,Q-vt,j-pe,Q),$r(j-pe,Q+vt,j-xt,Q+Me,j,Q+Me),$r(j+xt,Q+Me,j+pe,Q+vt,j+pe,Q),rl(qe),this},S.__private__.circle=S.circle=function(j,Q,pe,Me){if(isNaN(j)||isNaN(Q)||isNaN(pe)||!fr(Me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(j,Q,pe,pe,Me)},S.setFont=function(j,Q,pe){return pe&&(Q=Y(Q,pe)),it=ys(j,Q,{disableWarning:!1}),this};var pr=S.__private__.getFont=S.getFont=function(){return jt[ys.apply(S,arguments)]};S.__private__.getFontList=S.getFontList=function(){var j,Q,pe={};for(j in Ft)if(Ft.hasOwnProperty(j))for(Q in pe[j]=[],Ft[j])Ft[j].hasOwnProperty(Q)&&pe[j].push(Q);return pe},S.addFont=function(j,Q,pe,Me,qe){var xt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&xt.indexOf(arguments[3])!==-1?qe=arguments[3]:arguments[3]&&xt.indexOf(arguments[3])==-1&&(pe=Y(pe,Me)),gs.call(this,j,Q,pe,qe=qe||"Identity-H")};var ms,Ba=n.lineWidth||.200025,Ys=S.__private__.getLineWidth=S.getLineWidth=function(){return Ba},zn=S.__private__.setLineWidth=S.setLineWidth=function(j){return Ba=j,ye(ee(Z(j))+" w"),this};S.__private__.setLineDash=Wn.API.setLineDash=Wn.API.setLineDashPattern=function(j,Q){if(j=j||[],Q=Q||0,isNaN(Q)||!Array.isArray(j))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return j=j.map(function(pe){return ee(Z(pe))}).join(" "),Q=ee(Z(Q)),ye("["+j+"] "+Q+" d"),this};var Tt=S.__private__.getLineHeight=S.getLineHeight=function(){return ht*ms};S.__private__.getLineHeight=S.getLineHeight=function(){return ht*ms};var Qn=S.__private__.setLineHeightFactor=S.setLineHeightFactor=function(j){return typeof(j=j||1.15)=="number"&&(ms=j),this},Oa=S.__private__.getLineHeightFactor=S.getLineHeightFactor=function(){return ms};Qn(n.lineHeight);var ua=S.__private__.getHorizontalCoordinate=function(j){return Z(j)},vn=S.__private__.getVerticalCoordinate=function(j){return q===E?j:fn[V].mediaBox.topRightY-fn[V].mediaBox.bottomLeftY-Z(j)},jn=S.__private__.getHorizontalCoordinateString=S.getHorizontalCoordinateString=function(j){return ee(ua(j))},ol=S.__private__.getVerticalCoordinateString=S.getVerticalCoordinateString=function(j){return ee(vn(j))},Eo=n.strokeColor||"0 G";S.__private__.getStrokeColor=S.getDrawColor=function(){return $n(Eo)},S.__private__.setStrokeColor=S.setDrawColor=function(j,Q,pe,Me){return Eo=li({ch1:j,ch2:Q,ch3:pe,ch4:Me,pdfColorType:"draw",precision:2}),ye(Eo),this};var En=n.fillColor||"0 g";S.__private__.getFillColor=S.getFillColor=function(){return $n(En)},S.__private__.setFillColor=S.setFillColor=function(j,Q,pe,Me){return En=li({ch1:j,ch2:Q,ch3:pe,ch4:Me,pdfColorType:"fill",precision:2}),ye(En),this};var mn=n.textColor||"0 g",Ai=S.__private__.getTextColor=S.getTextColor=function(){return $n(mn)};S.__private__.setTextColor=S.setTextColor=function(j,Q,pe,Me){return mn=li({ch1:j,ch2:Q,ch3:pe,ch4:Me,pdfColorType:"text",precision:3}),this};var xn=n.charSpace,wi=S.__private__.getCharSpace=S.getCharSpace=function(){return parseFloat(xn||0)};S.__private__.setCharSpace=S.setCharSpace=function(j){if(isNaN(j))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return xn=j,this};var Tn=0;S.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},S.__private__.setLineCap=S.setLineCap=function(j){var Q=S.CapJoinStyles[j];if(Q===void 0)throw new Error("Line cap style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tn=Q,ye(Q+" J"),this};var Ko=0;S.__private__.setLineJoin=S.setLineJoin=function(j){var Q=S.CapJoinStyles[j];if(Q===void 0)throw new Error("Line join style of '"+j+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ko=Q,ye(Q+" j"),this},S.__private__.setLineMiterLimit=S.__private__.setMiterLimit=S.setLineMiterLimit=S.setMiterLimit=function(j){if(j=j||0,isNaN(j))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ye(ee(Z(j))+" M"),this},S.GState=ch,S.setGState=function(j){(j=typeof j=="string"?cn[_t[j]]:Jt(null,j)).equals(Yt)||(ye("/"+j.id+" gs"),Yt=j)};var Jt=function(j,Q){if(!j||!_t[j]){var pe=!1;for(var Me in cn)if(cn.hasOwnProperty(Me)&&cn[Me].equals(Q)){pe=!0;break}if(pe)Q=cn[Me];else{var qe="GS"+(Object.keys(cn).length+1).toString(10);cn[qe]=Q,Q.id=qe}return j&&(_t[j]=Q.id),bn.publish("addGState",Q),Q}};S.addGState=function(j,Q){return Jt(j,Q),this},S.saveGraphicsState=function(){return ye("q"),tn.push({key:it,size:ht,color:mn}),this},S.restoreGraphicsState=function(){ye("Q");var j=tn.pop();return it=j.key,ht=j.size,mn=j.color,Yt=null,this},S.setCurrentTransformationMatrix=function(j){return ye(j.toString()+" cm"),this},S.comment=function(j){return ye("#"+j),this};var ri=function(j,Q){var pe=j||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return pe},set:function(xt){isNaN(xt)||(pe=parseFloat(xt))}});var Me=Q||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Me},set:function(xt){isNaN(xt)||(Me=parseFloat(xt))}});var qe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return qe},set:function(xt){qe=xt.toString()}}),this},Qt=function(j,Q,pe,Me){ri.call(this,j,Q),this.type="rect";var qe=pe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return qe},set:function(vt){isNaN(vt)||(qe=parseFloat(vt))}});var xt=Me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return xt},set:function(vt){isNaN(vt)||(xt=parseFloat(vt))}}),this},Si=function(){this.page=gn,this.currentPage=V,this.pages=Xe.slice(0),this.pagesContext=fn.slice(0),this.x=at,this.y=Ot,this.matrix=Vt,this.width=ro(V),this.height=bs(V),this.outputDestination=kt,this.id="",this.objectNumber=-1};Si.prototype.restore=function(){gn=this.page,V=this.currentPage,fn=this.pagesContext,Xe=this.pages,at=this.x,Ot=this.y,Vt=this.matrix,ka(V,this.width),is(V,this.height),kt=this.outputDestination};var Ua=function(j,Q,pe,Me,qe){Mr.push(new Si),gn=V=0,Xe=[],at=j,Ot=Q,Vt=qe,Uo([pe,Me])};for(var Fa in S.beginFormObject=function(j,Q,pe,Me,qe){return Ua(j,Q,pe,Me,qe),this},S.endFormObject=function(j){return(function(Q){if(Cr[Q])Mr.pop().restore();else{var pe=new Si,Me="Xo"+(Object.keys(Dn).length+1).toString(10);pe.id=Me,Cr[Q]=Me,Dn[Me]=pe,bn.publish("addFormObject",pe),Mr.pop().restore()}})(j),this},S.doFormObject=function(j,Q){var pe=Dn[Cr[j]];return ye("q"),ye(Q.toString()+" cm"),ye("/"+pe.id+" Do"),ye("Q"),this},S.getFormObject=function(j){var Q=Dn[Cr[j]];return{x:Q.x,y:Q.y,width:Q.width,height:Q.height,matrix:Q.matrix}},S.save=function(j,Q){return j=j||"generated.pdf",(Q=Q||{}).returnPromise=Q.returnPromise||!1,Q.returnPromise===!1?(fd(ns(dr()),j),typeof fd.unload=="function"&&ui.setTimeout&&setTimeout(fd.unload,911),this):new Promise(function(pe,Me){try{var qe=fd(ns(dr()),j);typeof fd.unload=="function"&&ui.setTimeout&&setTimeout(fd.unload,911),pe(qe)}catch(xt){Me(xt.message)}})},Wn.API)Wn.API.hasOwnProperty(Fa)&&(Fa==="events"&&Wn.API.events.length?(function(j,Q){var pe,Me,qe;for(qe=Q.length-1;qe!==-1;qe--)pe=Q[qe][0],Me=Q[qe][1],j.subscribe.apply(j,[pe].concat(typeof Me=="function"?[Me]:Me))})(bn,Wn.API.events):S[Fa]=Wn.API[Fa]);function ro(j){return fn[j].mediaBox.topRightX-fn[j].mediaBox.bottomLeftX}function ka(j,Q){fn[j].mediaBox.topRightX=Q+fn[j].mediaBox.bottomLeftX}function bs(j){return fn[j].mediaBox.topRightY-fn[j].mediaBox.bottomLeftY}function is(j,Q){fn[j].mediaBox.topRightY=Q+fn[j].mediaBox.bottomLeftY}var Xs=S.getPageWidth=function(j){return ro(j=j||V)/$e},Zc=S.setPageWidth=function(j,Q){ka(j,Q*$e)},vs=S.getPageHeight=function(j){return bs(j=j||V)/$e},Jc=S.setPageHeight=function(j,Q){is(j,Q*$e)};return S.internal={pdfEscape:fi,getStyle:Xl,getFont:pr,getFontSize:$t,getCharSpace:wi,getTextColor:Ai,getLineHeight:Tt,getLineHeightFactor:Oa,getLineWidth:Ys,write:ut,getHorizontalCoordinate:ua,getVerticalCoordinate:vn,getCoordinateString:jn,getVerticalCoordinateString:ol,collections:{},newObject:Ht,newAdditionalObject:pn,newObjectDeferred:tt,newObjectDeferredBegin:Bt,getFilters:vi,putStream:qi,events:bn,scaleFactor:$e,pageSize:{getWidth:function(){return Xs(V)},setWidth:function(j){Zc(V,j)},getHeight:function(){return vs(V)},setHeight:function(j){Jc(V,j)}},encryptionOptions:T,encryption:io,getEncryptor:function(j){return T!==null?io.encryptor(j,0):function(Q){return Q}},output:Gl,getNumberOfPages:ts,get pages(){return Xe},out:ye,f2:H,f3:R,getPageInfo:Vi,getPageInfoByObjId:Yo,getCurrentPageInfo:Yl,getPDFVersion:_,Point:ri,Rectangle:Qt,Matrix:Xt,hasHotfix:po},Object.defineProperty(S.internal.pageSize,"width",{get:function(){return Xs(V)},set:function(j){Zc(V,j)},enumerable:!0,configurable:!0}),Object.defineProperty(S.internal.pageSize,"height",{get:function(){return vs(V)},set:function(j){Jc(V,j)},enumerable:!0,configurable:!0}),(function(j){for(var Q=0,pe=Et.length;Q<pe;Q++){var Me=gs.call(this,j[Q][0],j[Q][1],j[Q][2],Et[Q][3],!0);D===!1&&(M[Me]=!0);var qe=j[Q][0].split("-");Gn({id:Me,fontName:qe[0],fontStyle:qe[1]||""})}bn.publish("addFonts",{fonts:jt,dictionary:Ft})}).call(S,Et),it="F1",Di(l,o),bn.publish("initialized"),S}Xd.prototype.lsbFirstWord=function(n){return String.fromCharCode(255&n,n>>8&255,n>>16&255,n>>24&255)},Xd.prototype.toHexString=function(n){return n.split("").map(function(r){return("0"+(255&r.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Xd.prototype.hexToBytes=function(n){for(var r=[],o=0;o<n.length;o+=2)r.push(String.fromCharCode(parseInt(n.substr(o,2),16)));return r.join("")},Xd.prototype.processOwnerPassword=function(n,r){return Wg(Hg(r).substr(0,5),n)},Xd.prototype.encryptor=function(n,r){var o=Hg(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&r,r>>8&255)).substr(0,10);return function(s){return Wg(o,s)}},ch.prototype.equals=function(n){var r,o="id,objectNumber,equals";if(!n||Ir(n)!==Ir(this))return!1;var s=0;for(r in this)if(!(o.indexOf(r)>=0)){if(this.hasOwnProperty(r)&&!n.hasOwnProperty(r)||this[r]!==n[r])return!1;s++}for(r in n)n.hasOwnProperty(r)&&o.indexOf(r)<0&&s--;return s===0},Wn.API={events:[]},Wn.version="3.0.4";var la=Wn.API,t0=1,bd=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},$d=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},bi=function(n){return n.toFixed(2)},Ou=function(n){return n.toFixed(5)};la.__acroform__={};var vl=function(n,r){n.prototype=Object.create(r.prototype),n.prototype.constructor=n},my=function(n){return n*t0},$c=function(n){var r=new Px,o=Nn.internal.getHeight(n)||0,s=Nn.internal.getWidth(n)||0;return r.BBox=[0,0,Number(bi(s)),Number(bi(o))],r},Zv=la.__acroform__.setBit=function(n,r){if(n=n||0,r=r||0,isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|1<<r},Jv=la.__acroform__.clearBit=function(n,r){if(n=n||0,r=r||0,isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&~(1<<r)},Qv=la.__acroform__.getBit=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<r?1:0},Sa=la.__acroform__.getBitForPdf=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Qv(n,r-1)},ja=la.__acroform__.setBitForPdf=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Zv(n,r-1)},Ta=la.__acroform__.clearBitForPdf=function(n,r){if(isNaN(n)||isNaN(r))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Jv(n,r-1)},e5=la.__acroform__.calculateCoordinates=function(n,r){var o=r.internal.getHorizontalCoordinate,s=r.internal.getVerticalCoordinate,l=n[0],d=n[1],v=n[2],p=n[3],b={};return b.lowerLeft_X=o(l)||0,b.lowerLeft_Y=s(d+p)||0,b.upperRight_X=o(l+v)||0,b.upperRight_Y=s(d)||0,[Number(bi(b.lowerLeft_X)),Number(bi(b.lowerLeft_Y)),Number(bi(b.upperRight_X)),Number(bi(b.upperRight_Y))]},t5=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var r=[],o=n._V||n.DV,s=$g(n,o),l=n.scope.internal.getFont(n.fontName,n.fontStyle).id;r.push("/Tx BMC"),r.push("q"),r.push("BT"),r.push(n.scope.__private__.encodeColorString(n.color)),r.push("/"+l+" "+bi(s.fontSize)+" Tf"),r.push("1 0 0 1 0 0 Tm"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC");var d=$c(n);return d.scope=n.scope,d.stream=r.join(`
`),d}},$g=function(n,r){var o=n.fontSize===0?n.maxFontSize:n.fontSize,s={text:"",fontSize:""},l=(r=(r=r.substr(0,1)=="("?r.substr(1):r).substr(r.length-1)==")"?r.substr(0,r.length-1):r).split(" ");l=n.multiline?l.map(function(H){return H.split(`
`)}):l.map(function(H){return[H]});var d=o,v=Nn.internal.getHeight(n)||0;v=v<0?-v:v;var p=Nn.internal.getWidth(n)||0;p=p<0?-p:p;var b=function(H,R,Z){if(H+1<l.length){var G=R+" "+l[H+1][0];return Zp(G,n,Z).width<=p-4}return!1};d++;e:for(;d>0;){r="",d--;var m,T,D=Zp("3",n,d).height,M=n.multiline?v-d:(v-D)/2,S=M+=2,F=0,_=0,N=0;if(d<=0){r=`(...) Tj
`,r+="% Width of Text: "+Zp(r,n,d=12).width+", FieldWidth:"+p+`
`;break}for(var g="",ae=0,E=0;E<l.length;E++)if(l.hasOwnProperty(E)){var q=!1;if(l[E].length!==1&&N!==l[E].length-1){if((D+2)*(ae+2)+2>v)continue e;g+=l[E][N],q=!0,_=E,E--}else{g=(g+=l[E][N]+" ").substr(g.length-1)==" "?g.substr(0,g.length-1):g;var re=parseInt(E),J=b(re,g,d),Y=E>=l.length-1;if(J&&!Y){g+=" ",N=0;continue}if(J||Y){if(Y)_=re;else if(n.multiline&&(D+2)*(ae+2)+2>v)continue e}else{if(!n.multiline||(D+2)*(ae+2)+2>v)continue e;_=re}}for(var ee="",U=F;U<=_;U++){var $=l[U];if(n.multiline){if(U===_){ee+=$[N]+" ",N=(N+1)%$.length;continue}if(U===F){ee+=$[$.length-1]+" ";continue}}ee+=$[0]+" "}switch(ee=ee.substr(ee.length-1)==" "?ee.substr(0,ee.length-1):ee,T=Zp(ee,n,d).width,n.textAlign){case"right":m=p-T-2;break;case"center":m=(p-T)/2;break;default:m=2}r+=bi(m)+" "+bi(S)+` Td
`,r+="("+bd(ee)+`) Tj
`,r+=-bi(m)+` 0 Td
`,S=-(d+2),T=0,F=q?_:_+1,ae++,g=""}break}return s.text=r,s.fontSize=d,s},Zp=function(n,r,o){var s=r.scope.internal.getFont(r.fontName,r.fontStyle),l=r.scope.getStringUnitWidth(n,{font:s,fontSize:parseFloat(o),charSpace:0})*parseFloat(o);return{height:r.scope.getStringUnitWidth("3",{font:s,fontSize:parseFloat(o),charSpace:0})*parseFloat(o)*1.5,width:l}},n5={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},i5=function(n,r){var o={type:"reference",object:n};r.internal.getPageInfo(n.page).pageContext.annotations.find(function(s){return s.type===o.type&&s.object===o.object})===void 0&&r.internal.getPageInfo(n.page).pageContext.annotations.push(o)},r5=function(n,r){if(r.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Pc.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(n5)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");t0=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new _x,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(o){o.internal.events.unsubscribe(o.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete o.internal.acroformPlugin.acroFormDictionaryRoot._eventID,o.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(o){o.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var s=o.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var l in s)if(s.hasOwnProperty(l)){var d=s[l];d.objId=void 0,d.hasAnnotation&&i5(d,o)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(o){if(o.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");o.internal.write("/AcroForm "+o.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(o){(function(s,l){var d=!s;for(var v in s||(l.internal.newObjectDeferredBegin(l.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),l.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),s=s||l.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(s.hasOwnProperty(v)){var p=s[v],b=[],m=p.Rect;if(p.Rect&&(p.Rect=e5(p.Rect,l)),l.internal.newObjectDeferredBegin(p.objId,!0),p.DA=Nn.createDefaultAppearanceStream(p),Ir(p)==="object"&&typeof p.getKeyValueListForStream=="function"&&(b=p.getKeyValueListForStream()),p.Rect=m,p.hasAppearanceStream&&!p.appearanceStreamContent){var T=t5(p);b.push({key:"AP",value:"<</N "+T+">>"}),l.internal.acroformPlugin.xForms.push(T)}if(p.appearanceStreamContent){var D="";for(var M in p.appearanceStreamContent)if(p.appearanceStreamContent.hasOwnProperty(M)){var S=p.appearanceStreamContent[M];if(D+="/"+M+" ",D+="<<",Object.keys(S).length>=1||Array.isArray(S)){for(var v in S)if(S.hasOwnProperty(v)){var F=S[v];typeof F=="function"&&(F=F.call(l,p)),D+="/"+v+" "+F+" ",l.internal.acroformPlugin.xForms.indexOf(F)>=0||l.internal.acroformPlugin.xForms.push(F)}}else typeof(F=S)=="function"&&(F=F.call(l,p)),D+="/"+v+" "+F,l.internal.acroformPlugin.xForms.indexOf(F)>=0||l.internal.acroformPlugin.xForms.push(F);D+=">>"}b.push({key:"AP",value:`<<
`+D+">>"})}l.internal.putStream({additionalKeyValues:b,objectId:p.objId}),l.internal.out("endobj")}d&&(function(_,N){for(var g in _)if(_.hasOwnProperty(g)){var ae=g,E=_[g];N.internal.newObjectDeferredBegin(E.objId,!0),Ir(E)==="object"&&typeof E.putStream=="function"&&E.putStream(),delete _[ae]}})(l.internal.acroformPlugin.xForms,l)})(o,n)}),n.internal.acroformPlugin.isInitialized=!0}},zx=la.__acroform__.arrayToPdfArray=function(n,r,o){var s=function(v){return v};if(Array.isArray(n)){for(var l="[",d=0;d<n.length;d++)switch(d!==0&&(l+=" "),Ir(n[d])){case"boolean":case"number":case"object":l+=n[d].toString();break;case"string":n[d].substr(0,1)!=="/"?(r!==void 0&&o&&(s=o.internal.getEncryptor(r)),l+="("+bd(s(n[d].toString()))+")"):l+=n[d].toString()}return l+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},kg=function(n,r,o){var s=function(l){return l};return r!==void 0&&o&&(s=o.internal.getEncryptor(r)),(n=n||"").toString(),"("+bd(s(n))+")"},Xc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Xc.prototype.toString=function(){return this.objId+" 0 R"},Xc.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},Xc.prototype.getKeyValueListForStream=function(){var n=[],r=Object.getOwnPropertyNames(this).filter(function(d){return d!="content"&&d!="appearanceStreamContent"&&d!="scope"&&d!="objId"&&d.substring(0,1)!="_"});for(var o in r)if(Object.getOwnPropertyDescriptor(this,r[o]).configurable===!1){var s=r[o],l=this[s];l&&(Array.isArray(l)?n.push({key:s,value:zx(l,this.objId,this.scope)}):l instanceof Xc?(l.scope=this.scope,n.push({key:s,value:l.objId+" 0 R"})):typeof l!="function"&&n.push({key:s,value:l}))}return n};var Px=function(){Xc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,r=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return r},set:function(o){r=o}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(o){n=o.trim()},get:function(){return n||null}})};vl(Px,Xc);var _x=function(){Xc.call(this);var n,r=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return r.length>0?r:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return r}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var o=function(s){return s};return this.scope&&(o=this.scope.internal.getEncryptor(this.objId)),"("+bd(o(n))+")"}},set:function(o){n=o}})};vl(_x,Xc);var Pc=function n(){Xc.call(this);var r=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return r},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute F supplied.');r=g}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Sa(r,3)},set:function(g){g?this.F=ja(r,3):this.F=Ta(r,3)}});var o=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return o},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute Ff supplied.');o=g}});var s=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(s.length!==0)return s},set:function(g){s=g!==void 0?g:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[0])?0:s[0]},set:function(g){s[0]=g}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[1])?0:s[1]},set:function(g){s[1]=g}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[2])?0:s[2]},set:function(g){s[2]=g}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!s||isNaN(s[3])?0:s[3]},set:function(g){s[3]=g}});var l="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return l},set:function(g){switch(g){case"/Btn":case"/Tx":case"/Ch":case"/Sig":l=g;break;default:throw new Error('Invalid value "'+g+'" for attribute FT supplied.')}}});var d=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!d||d.length<1){if(this instanceof uh)return;d="FieldObject"+n.FieldNum++}var g=function(ae){return ae};return this.scope&&(g=this.scope.internal.getEncryptor(this.objId)),"("+bd(g(d))+")"},set:function(g){d=g.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return d},set:function(g){d=g}});var v="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return v},set:function(g){v=g}});var p="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return p},set:function(g){p=g}});var b=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return b},set:function(g){b=g}});var m=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return m===void 0?50/t0:m},set:function(g){m=g}});var T="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return T},set:function(g){T=g}});var D="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!D||this instanceof uh||this instanceof gd))return kg(D,this.objId,this.scope)},set:function(g){g=g.toString(),D=g}});var M=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(M)return this instanceof hs==0?kg(M,this.objId,this.scope):M},set:function(g){g=g.toString(),M=this instanceof hs==0?g.substr(0,1)==="("?$d(g.substr(1,g.length-2)):$d(g):g}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof hs==1?$d(M.substr(1,M.length-1)):M},set:function(g){g=g.toString(),M=this instanceof hs==1?"/"+g:g}});var S=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(S)return S},set:function(g){this.V=g}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(S)return this instanceof hs==0?kg(S,this.objId,this.scope):S},set:function(g){g=g.toString(),S=this instanceof hs==0?g.substr(0,1)==="("?$d(g.substr(1,g.length-2)):$d(g):g}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof hs==1?$d(S.substr(1,S.length-1)):S},set:function(g){g=g.toString(),S=this instanceof hs==1?"/"+g:g}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var F,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(g){g=!!g,_=g}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(F)return F},set:function(g){F=g}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,1)},set:function(g){g?this.Ff=ja(this.Ff,1):this.Ff=Ta(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,2)},set:function(g){g?this.Ff=ja(this.Ff,2):this.Ff=Ta(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,3)},set:function(g){g?this.Ff=ja(this.Ff,3):this.Ff=Ta(this.Ff,3)}});var N=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(N!==null)return N},set:function(g){if([0,1,2].indexOf(g)===-1)throw new Error('Invalid value "'+g+'" for attribute Q supplied.');N=g}}),Object.defineProperty(this,"textAlign",{get:function(){var g;switch(N){case 0:default:g="left";break;case 1:g="center";break;case 2:g="right"}return g},configurable:!0,enumerable:!0,set:function(g){switch(g){case"right":case 2:N=2;break;case"center":case 1:N=1;break;default:N=0}}})};vl(Pc,Xc);var Jd=function(){Pc.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(o){n=o}});var r=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return zx(r,this.objId,this.scope)},set:function(o){var s,l;l=[],typeof(s=o)=="string"&&(l=(function(d,v,p){p||(p=1);for(var b,m=[];b=v.exec(d);)m.push(b[p]);return m})(s,/\((.*?)\)/g)),r=l}}),this.getOptions=function(){return r},this.setOptions=function(o){r=o,this.sort&&r.sort()},this.addOption=function(o){o=(o=o||"").toString(),r.push(o),this.sort&&r.sort()},this.removeOption=function(o,s){for(s=s||!1,o=(o=o||"").toString();r.indexOf(o)!==-1&&(r.splice(r.indexOf(o),1),s!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,18)},set:function(o){o?this.Ff=ja(this.Ff,18):this.Ff=Ta(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,19)},set:function(o){this.combo===!0&&(o?this.Ff=ja(this.Ff,19):this.Ff=Ta(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,20)},set:function(o){o?(this.Ff=ja(this.Ff,20),r.sort()):this.Ff=Ta(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,22)},set:function(o){o?this.Ff=ja(this.Ff,22):this.Ff=Ta(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,23)},set:function(o){o?this.Ff=ja(this.Ff,23):this.Ff=Ta(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,27)},set:function(o){o?this.Ff=ja(this.Ff,27):this.Ff=Ta(this.Ff,27)}}),this.hasAppearanceStream=!1};vl(Jd,Pc);var Qd=function(){Jd.call(this),this.fontName="helvetica",this.combo=!1};vl(Qd,Jd);var ef=function(){Qd.call(this),this.combo=!0};vl(ef,Qd);var nh=function(){ef.call(this),this.edit=!0};vl(nh,ef);var hs=function(){Pc.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,15)},set:function(o){o?this.Ff=ja(this.Ff,15):this.Ff=Ta(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,16)},set:function(o){o?this.Ff=ja(this.Ff,16):this.Ff=Ta(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,17)},set:function(o){o?this.Ff=ja(this.Ff,17):this.Ff=Ta(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,26)},set:function(o){o?this.Ff=ja(this.Ff,26):this.Ff=Ta(this.Ff,26)}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(d){return d};if(this.scope&&(o=this.scope.internal.getEncryptor(this.objId)),Object.keys(r).length!==0){var s,l=[];for(s in l.push("<<"),r)l.push("/"+s+" ("+bd(o(r[s]))+")");return l.push(">>"),l.join(`
`)}},set:function(o){Ir(o)==="object"&&(r=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(o){typeof o=="string"&&(r.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(o){n="/"+o}})};vl(hs,Pc);var ih=function(){hs.call(this),this.pushButton=!0};vl(ih,hs);var tf=function(){hs.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(r){n=r!==void 0?r:[]}})};vl(tf,hs);var uh=function(){var n,r;Pc.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(l){n=l}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return r},set:function(l){r=l}});var o,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var l=function(p){return p};this.scope&&(l=this.scope.internal.getEncryptor(this.objId));var d,v=[];for(d in v.push("<<"),s)v.push("/"+d+" ("+bd(l(s[d]))+")");return v.push(">>"),v.join(`
`)},set:function(l){Ir(l)==="object"&&(s=l)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(l){typeof l=="string"&&(s.CA=l)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return o.substr(1,o.length-1)},set:function(l){o="/"+l}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Nn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};vl(uh,Pc),tf.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var r in this.Kids)if(this.Kids.hasOwnProperty(r)){var o=this.Kids[r];o.appearanceStreamContent=n.createAppearanceStream(o.optionName),o.caption=n.getCA()}},tf.prototype.createOption=function(n){var r=new uh;return r.Parent=this,r.optionName=n,this.Kids.push(r),o5.call(this.scope,r),r};var rh=function(){hs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Nn.CheckBox.createAppearanceStream()};vl(rh,hs);var gd=function(){Pc.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,13)},set:function(r){r?this.Ff=ja(this.Ff,13):this.Ff=Ta(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,21)},set:function(r){r?this.Ff=ja(this.Ff,21):this.Ff=Ta(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,23)},set:function(r){r?this.Ff=ja(this.Ff,23):this.Ff=Ta(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,24)},set:function(r){r?this.Ff=ja(this.Ff,24):this.Ff=Ta(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,25)},set:function(r){r?this.Ff=ja(this.Ff,25):this.Ff=Ta(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,26)},set:function(r){r?this.Ff=ja(this.Ff,26):this.Ff=Ta(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(r){n=r}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(r){Number.isInteger(r)&&(n=r)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};vl(gd,Pc);var oh=function(){gd.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Sa(this.Ff,14)},set:function(n){n?this.Ff=ja(this.Ff,14):this.Ff=Ta(this.Ff,14)}}),this.password=!0};vl(oh,gd);var Nn={CheckBox:{createAppearanceStream:function(){return{N:{On:Nn.CheckBox.YesNormal},D:{On:Nn.CheckBox.YesPushDown,Off:Nn.CheckBox.OffPushDown}}},YesPushDown:function(n){var r=$c(n);r.scope=n.scope;var o=[],s=n.scope.internal.getFont(n.fontName,n.fontStyle).id,l=n.scope.__private__.encodeColorString(n.color),d=$g(n,n.caption);return o.push("0.749023 g"),o.push("0 0 "+bi(Nn.internal.getWidth(n))+" "+bi(Nn.internal.getHeight(n))+" re"),o.push("f"),o.push("BMC"),o.push("q"),o.push("0 0 1 rg"),o.push("/"+s+" "+bi(d.fontSize)+" Tf "+l),o.push("BT"),o.push(d.text),o.push("ET"),o.push("Q"),o.push("EMC"),r.stream=o.join(`
`),r},YesNormal:function(n){var r=$c(n);r.scope=n.scope;var o=n.scope.internal.getFont(n.fontName,n.fontStyle).id,s=n.scope.__private__.encodeColorString(n.color),l=[],d=Nn.internal.getHeight(n),v=Nn.internal.getWidth(n),p=$g(n,n.caption);return l.push("1 g"),l.push("0 0 "+bi(v)+" "+bi(d)+" re"),l.push("f"),l.push("q"),l.push("0 0 1 rg"),l.push("0 0 "+bi(v-1)+" "+bi(d-1)+" re"),l.push("W"),l.push("n"),l.push("0 g"),l.push("BT"),l.push("/"+o+" "+bi(p.fontSize)+" Tf "+s),l.push(p.text),l.push("ET"),l.push("Q"),r.stream=l.join(`
`),r},OffPushDown:function(n){var r=$c(n);r.scope=n.scope;var o=[];return o.push("0.749023 g"),o.push("0 0 "+bi(Nn.internal.getWidth(n))+" "+bi(Nn.internal.getHeight(n))+" re"),o.push("f"),r.stream=o.join(`
`),r}},RadioButton:{Circle:{createAppearanceStream:function(n){var r={D:{Off:Nn.RadioButton.Circle.OffPushDown},N:{}};return r.N[n]=Nn.RadioButton.Circle.YesNormal,r.D[n]=Nn.RadioButton.Circle.YesPushDown,r},getCA:function(){return"l"},YesNormal:function(n){var r=$c(n);r.scope=n.scope;var o=[],s=Nn.internal.getWidth(n)<=Nn.internal.getHeight(n)?Nn.internal.getWidth(n)/4:Nn.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var l=Nn.internal.Bezier_C,d=Number((s*l).toFixed(5));return o.push("q"),o.push("1 0 0 1 "+Ou(Nn.internal.getWidth(n)/2)+" "+Ou(Nn.internal.getHeight(n)/2)+" cm"),o.push(s+" 0 m"),o.push(s+" "+d+" "+d+" "+s+" 0 "+s+" c"),o.push("-"+d+" "+s+" -"+s+" "+d+" -"+s+" 0 c"),o.push("-"+s+" -"+d+" -"+d+" -"+s+" 0 -"+s+" c"),o.push(d+" -"+s+" "+s+" -"+d+" "+s+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r},YesPushDown:function(n){var r=$c(n);r.scope=n.scope;var o=[],s=Nn.internal.getWidth(n)<=Nn.internal.getHeight(n)?Nn.internal.getWidth(n)/4:Nn.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var l=Number((2*s).toFixed(5)),d=Number((l*Nn.internal.Bezier_C).toFixed(5)),v=Number((s*Nn.internal.Bezier_C).toFixed(5));return o.push("0.749023 g"),o.push("q"),o.push("1 0 0 1 "+Ou(Nn.internal.getWidth(n)/2)+" "+Ou(Nn.internal.getHeight(n)/2)+" cm"),o.push(l+" 0 m"),o.push(l+" "+d+" "+d+" "+l+" 0 "+l+" c"),o.push("-"+d+" "+l+" -"+l+" "+d+" -"+l+" 0 c"),o.push("-"+l+" -"+d+" -"+d+" -"+l+" 0 -"+l+" c"),o.push(d+" -"+l+" "+l+" -"+d+" "+l+" 0 c"),o.push("f"),o.push("Q"),o.push("0 g"),o.push("q"),o.push("1 0 0 1 "+Ou(Nn.internal.getWidth(n)/2)+" "+Ou(Nn.internal.getHeight(n)/2)+" cm"),o.push(s+" 0 m"),o.push(s+" "+v+" "+v+" "+s+" 0 "+s+" c"),o.push("-"+v+" "+s+" -"+s+" "+v+" -"+s+" 0 c"),o.push("-"+s+" -"+v+" -"+v+" -"+s+" 0 -"+s+" c"),o.push(v+" -"+s+" "+s+" -"+v+" "+s+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r},OffPushDown:function(n){var r=$c(n);r.scope=n.scope;var o=[],s=Nn.internal.getWidth(n)<=Nn.internal.getHeight(n)?Nn.internal.getWidth(n)/4:Nn.internal.getHeight(n)/4;s=Number((.9*s).toFixed(5));var l=Number((2*s).toFixed(5)),d=Number((l*Nn.internal.Bezier_C).toFixed(5));return o.push("0.749023 g"),o.push("q"),o.push("1 0 0 1 "+Ou(Nn.internal.getWidth(n)/2)+" "+Ou(Nn.internal.getHeight(n)/2)+" cm"),o.push(l+" 0 m"),o.push(l+" "+d+" "+d+" "+l+" 0 "+l+" c"),o.push("-"+d+" "+l+" -"+l+" "+d+" -"+l+" 0 c"),o.push("-"+l+" -"+d+" -"+d+" -"+l+" 0 -"+l+" c"),o.push(d+" -"+l+" "+l+" -"+d+" "+l+" 0 c"),o.push("f"),o.push("Q"),r.stream=o.join(`
`),r}},Cross:{createAppearanceStream:function(n){var r={D:{Off:Nn.RadioButton.Cross.OffPushDown},N:{}};return r.N[n]=Nn.RadioButton.Cross.YesNormal,r.D[n]=Nn.RadioButton.Cross.YesPushDown,r},getCA:function(){return"8"},YesNormal:function(n){var r=$c(n);r.scope=n.scope;var o=[],s=Nn.internal.calculateCross(n);return o.push("q"),o.push("1 1 "+bi(Nn.internal.getWidth(n)-2)+" "+bi(Nn.internal.getHeight(n)-2)+" re"),o.push("W"),o.push("n"),o.push(bi(s.x1.x)+" "+bi(s.x1.y)+" m"),o.push(bi(s.x2.x)+" "+bi(s.x2.y)+" l"),o.push(bi(s.x4.x)+" "+bi(s.x4.y)+" m"),o.push(bi(s.x3.x)+" "+bi(s.x3.y)+" l"),o.push("s"),o.push("Q"),r.stream=o.join(`
`),r},YesPushDown:function(n){var r=$c(n);r.scope=n.scope;var o=Nn.internal.calculateCross(n),s=[];return s.push("0.749023 g"),s.push("0 0 "+bi(Nn.internal.getWidth(n))+" "+bi(Nn.internal.getHeight(n))+" re"),s.push("f"),s.push("q"),s.push("1 1 "+bi(Nn.internal.getWidth(n)-2)+" "+bi(Nn.internal.getHeight(n)-2)+" re"),s.push("W"),s.push("n"),s.push(bi(o.x1.x)+" "+bi(o.x1.y)+" m"),s.push(bi(o.x2.x)+" "+bi(o.x2.y)+" l"),s.push(bi(o.x4.x)+" "+bi(o.x4.y)+" m"),s.push(bi(o.x3.x)+" "+bi(o.x3.y)+" l"),s.push("s"),s.push("Q"),r.stream=s.join(`
`),r},OffPushDown:function(n){var r=$c(n);r.scope=n.scope;var o=[];return o.push("0.749023 g"),o.push("0 0 "+bi(Nn.internal.getWidth(n))+" "+bi(Nn.internal.getHeight(n))+" re"),o.push("f"),r.stream=o.join(`
`),r}}},createDefaultAppearanceStream:function(n){var r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,o=n.scope.__private__.encodeColorString(n.color);return"/"+r+" "+n.fontSize+" Tf "+o}};Nn.internal={Bezier_C:.551915024494,calculateCross:function(n){var r=Nn.internal.getWidth(n),o=Nn.internal.getHeight(n),s=Math.min(r,o);return{x1:{x:(r-s)/2,y:(o-s)/2+s},x2:{x:(r-s)/2+s,y:(o-s)/2},x3:{x:(r-s)/2,y:(o-s)/2},x4:{x:(r-s)/2+s,y:(o-s)/2+s}}}},Nn.internal.getWidth=function(n){var r=0;return Ir(n)==="object"&&(r=my(n.Rect[2])),r},Nn.internal.getHeight=function(n){var r=0;return Ir(n)==="object"&&(r=my(n.Rect[3])),r};var o5=la.addField=function(n){if(r5(this,n),!(n instanceof Pc))throw new Error("Invalid argument passed to jsPDF.addField.");var r;return(r=n).scope.internal.acroformPlugin.printedOut&&(r.scope.internal.acroformPlugin.printedOut=!1,r.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),r.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(r),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};la.AcroFormChoiceField=Jd,la.AcroFormListBox=Qd,la.AcroFormComboBox=ef,la.AcroFormEditBox=nh,la.AcroFormButton=hs,la.AcroFormPushButton=ih,la.AcroFormRadioButton=tf,la.AcroFormCheckBox=rh,la.AcroFormTextField=gd,la.AcroFormPasswordField=oh,la.AcroFormAppearance=Nn,la.AcroForm={ChoiceField:Jd,ListBox:Qd,ComboBox:ef,EditBox:nh,Button:hs,PushButton:ih,RadioButton:tf,CheckBox:rh,TextField:gd,PasswordField:oh,Appearance:Nn},Wn.AcroForm={ChoiceField:Jd,ListBox:Qd,ComboBox:ef,EditBox:nh,Button:hs,PushButton:ih,RadioButton:tf,CheckBox:rh,TextField:gd,PasswordField:oh,Appearance:Nn};Wn.AcroForm;function Dx(n){return n.reduce(function(r,o,s){return r[o]=s,r},{})}(function(n){var r="addImage_";n.__addimage__={};var o="UNKNOWN",s={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},l=n.__addimage__.getImageFileTypeByImageData=function(H,R){var Z,G,we,te,de,Ce=o;if((R=R||o)==="RGBA"||H.data!==void 0&&H.data instanceof Uint8ClampedArray&&"height"in H&&"width"in H)return"RGBA";if(J(H))for(de in s)for(we=s[de],Z=0;Z<we.length;Z+=1){for(te=!0,G=0;G<we[Z].length;G+=1)if(we[Z][G]!==void 0&&we[Z][G]!==H[G]){te=!1;break}if(te===!0){Ce=de;break}}else for(de in s)for(we=s[de],Z=0;Z<we.length;Z+=1){for(te=!0,G=0;G<we[Z].length;G+=1)if(we[Z][G]!==void 0&&we[Z][G]!==H.charCodeAt(G)){te=!1;break}if(te===!0){Ce=de;break}}return Ce===o&&R!==o&&(Ce=R),Ce},d=function H(R){for(var Z=this.internal.write,G=this.internal.putStream,we=(0,this.internal.getFilters)();we.indexOf("FlateEncode")!==-1;)we.splice(we.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var te=[];if(te.push({key:"Type",value:"/XObject"}),te.push({key:"Subtype",value:"/Image"}),te.push({key:"Width",value:R.width}),te.push({key:"Height",value:R.height}),R.colorSpace===g.INDEXED?te.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(te.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===g.DEVICE_CMYK&&te.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),te.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&te.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)&&R.transparency.length>0){for(var de="",Ce=0,Re=R.transparency.length;Ce<Re;Ce++)de+=R.transparency[Ce]+" "+R.transparency[Ce]+" ";te.push({key:"Mask",value:"["+de+"]"})}R.sMask!==void 0&&te.push({key:"SMask",value:R.objectId+1+" 0 R"});var xe=R.filter!==void 0?["/"+R.filter]:void 0;if(G({data:R.data,additionalKeyValues:te,alreadyAppliedFilters:xe,objectId:R.objectId}),Z("endobj"),"sMask"in R&&R.sMask!==void 0){var k,A=(k=R.sMaskBitsPerComponent)!==null&&k!==void 0?k:R.bitsPerComponent,V={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:A,data:R.sMask};"filter"in R&&(V.decodeParameters="/Predictor ".concat(R.predictor," /Colors 1 /BitsPerComponent ").concat(A," /Columns ").concat(R.width),V.filter=R.filter),H.call(this,V)}if(R.colorSpace===g.INDEXED){var W=this.internal.newObject();G({data:ee(new Uint8Array(R.palette)),objectId:W}),Z("endobj")}},v=function(){var H=this.internal.collections[r+"images"];for(var R in H)d.call(this,H[R])},p=function(){var H,R=this.internal.collections[r+"images"],Z=this.internal.write;for(var G in R)Z("/I"+(H=R[G]).index,H.objectId,"0","R")},b=function(){this.internal.collections[r+"images"]||(this.internal.collections[r+"images"]={},this.internal.events.subscribe("putResources",v),this.internal.events.subscribe("putXobjectDict",p))},m=function(){var H=this.internal.collections[r+"images"];return b.call(this),H},T=function(){return Object.keys(this.internal.collections[r+"images"]).length},D=function(H){return typeof n["process"+H.toUpperCase()]=="function"},M=function(H){return Ir(H)==="object"&&H.nodeType===1},S=function(H,R){if(H.nodeName==="IMG"&&H.hasAttribute("src")){var Z=""+H.getAttribute("src");if(Z.indexOf("data:image/")===0)return th(unescape(Z).split("base64,").pop());var G=n.loadFile(Z,!0);if(G!==void 0)return G}if(H.nodeName==="CANVAS"){if(H.width===0||H.height===0)throw new Error("Given canvas must have data. Canvas width: "+H.width+", height: "+H.height);var we;switch(R){case"PNG":we="image/png";break;case"WEBP":we="image/webp";break;default:we="image/jpeg"}return th(H.toDataURL(we,1).split("base64,").pop())}},F=function(H){var R=this.internal.collections[r+"images"];if(R){for(var Z in R)if(H===R[Z].alias)return R[Z]}},_=function(H,R,Z){return H||R||(H=-96,R=-96),H<0&&(H=-1*Z.width*72/H/this.internal.scaleFactor),R<0&&(R=-1*Z.height*72/R/this.internal.scaleFactor),H===0&&(H=R*Z.width/Z.height),R===0&&(R=H*Z.height/Z.width),[H,R]},N=function(H,R,Z,G,we,te){var de=_.call(this,Z,G,we),Ce=this.internal.getCoordinateString,Re=this.internal.getVerticalCoordinateString,xe=m.call(this);if(Z=de[0],G=de[1],xe[we.index]=we,te){te*=Math.PI/180;var k=Math.cos(te),A=Math.sin(te),V=function(se){return se.toFixed(4)},W=[V(k),V(A),V(-1*A),V(k),0,0,"cm"]}this.internal.write("q"),te?(this.internal.write([1,"0","0",1,Ce(H),Re(R+G),"cm"].join(" ")),this.internal.write(W.join(" ")),this.internal.write([Ce(Z),"0","0",Ce(G),"0","0","cm"].join(" "))):this.internal.write([Ce(Z),"0","0",Ce(G),Ce(H),Re(R+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+we.index+" Do"),this.internal.write("Q")},g=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var ae=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},E=n.__addimage__.sHashCode=function(H){var R,Z,G=0;if(typeof H=="string")for(Z=H.length,R=0;R<Z;R++)G=(G<<5)-G+H.charCodeAt(R),G|=0;else if(J(H))for(Z=H.byteLength/2,R=0;R<Z;R++)G=(G<<5)-G+H[R],G|=0;return G},q=n.__addimage__.validateStringAsBase64=function(H){(H=H||"").toString().trim();var R=!0;return H.length===0&&(R=!1),H.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(H.substr(0,H.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(H.substr(-2))===!1&&(R=!1),R},re=n.__addimage__.extractImageFromDataUrl=function(H){if(H==null||!(H=H.trim()).startsWith("data:"))return null;var R=H.indexOf(",");return R<0?null:H.substring(0,R).trim().endsWith("base64")?H.substring(R+1):null};n.__addimage__.isArrayBuffer=function(H){return H instanceof ArrayBuffer};var J=n.__addimage__.isArrayBufferView=function(H){return H instanceof Int8Array||H instanceof Uint8Array||H instanceof Uint8ClampedArray||H instanceof Int16Array||H instanceof Uint16Array||H instanceof Int32Array||H instanceof Uint32Array||H instanceof Float32Array||H instanceof Float64Array},Y=n.__addimage__.binaryStringToUint8Array=function(H){for(var R=H.length,Z=new Uint8Array(R),G=0;G<R;G++)Z[G]=H.charCodeAt(G);return Z},ee=n.__addimage__.arrayBufferToBinaryString=function(H){for(var R="",Z=J(H)?H:new Uint8Array(H),G=0;G<Z.length;G+=8192)R+=String.fromCharCode.apply(null,Z.subarray(G,G+8192));return R};n.addImage=function(){var H,R,Z,G,we,te,de,Ce,Re;if(typeof arguments[1]=="number"?(R=o,Z=arguments[1],G=arguments[2],we=arguments[3],te=arguments[4],de=arguments[5],Ce=arguments[6],Re=arguments[7]):(R=arguments[1],Z=arguments[2],G=arguments[3],we=arguments[4],te=arguments[5],de=arguments[6],Ce=arguments[7],Re=arguments[8]),Ir(H=arguments[0])==="object"&&!M(H)&&"imageData"in H){var xe=H;H=xe.imageData,R=xe.format||R||o,Z=xe.x||Z||0,G=xe.y||G||0,we=xe.w||xe.width||we,te=xe.h||xe.height||te,de=xe.alias||de,Ce=xe.compression||Ce,Re=xe.rotation||xe.angle||Re}var k=this.internal.getFilters();if(Ce===void 0&&k.indexOf("FlateEncode")!==-1&&(Ce="SLOW"),isNaN(Z)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");b.call(this);var A=U.call(this,H,R,de,Ce);return N.call(this,Z,G,we,te,A,Re),this};var U=function(H,R,Z,G){var we,te,de;if(typeof H=="string"&&l(H)===o){H=unescape(H);var Ce=$(H,!1);(Ce!==""||(Ce=n.loadFile(H,!0))!==void 0)&&(H=Ce)}if(M(H)&&(H=S(H,R)),R=l(H,R),!D(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((de=Z)==null||de.length===0)&&(Z=(function(Re){return typeof Re=="string"||J(Re)?E(Re):J(Re.data)?E(Re.data):null})(H)),(we=F.call(this,Z))||(H instanceof Uint8Array||R==="RGBA"||(te=H,H=Y(H)),we=this["process"+R.toUpperCase()](H,T.call(this),Z,(function(Re){return Re&&typeof Re=="string"&&(Re=Re.toUpperCase()),Re in n.image_compression?Re:ae.NONE})(G),te)),!we)throw new Error("An unknown error occurred whilst processing the image.");return we},$=n.__addimage__.convertBase64ToBinaryString=function(H,R){R=typeof R!="boolean"||R;var Z,G="";if(typeof H=="string"){var we;Z=(we=re(H))!==null&&we!==void 0?we:H;try{G=th(Z)}catch(te){if(R)throw q(Z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+te.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};n.getImageProperties=function(H){var R,Z,G="";if(M(H)&&(H=S(H)),typeof H=="string"&&l(H)===o&&((G=$(H,!1))===""&&(G=n.loadFile(H)||""),H=G),Z=l(H),!D(Z))throw new Error("addImage does not support files of type '"+Z+"', please ensure that a plugin for '"+Z+"' support is added.");if(H instanceof Uint8Array||(H=Y(H)),!(R=this["process"+Z.toUpperCase()](H)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=Z,R}})(Wn.API),(function(n){var r=function(o){if(o!==void 0&&o!="")return!0};Wn.API.events.push(["addPage",function(o){this.internal.getPageInfo(o.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(o){for(var s,l,d,v=this.internal.getCoordinateString,p=this.internal.getVerticalCoordinateString,b=this.internal.getPageInfoByObjId(o.objId),m=o.pageContext.annotations,T=!1,D=0;D<m.length&&!T;D++)switch((s=m[D]).type){case"link":(r(s.options.url)||r(s.options.pageNumber))&&(T=!0);break;case"reference":case"text":case"freetext":T=!0}if(T!=0){this.internal.write("/Annots [");for(var M=0;M<m.length;M++){s=m[M];var S=this.internal.pdfEscape,F=this.internal.getEncryptor(o.objId);switch(s.type){case"reference":this.internal.write(" "+s.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),N=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(_.objId),ae=s.title||"Note";d="<</Type /Annot /Subtype /Text "+(l="/Rect ["+v(s.bounds.x)+" "+p(s.bounds.y+s.bounds.h)+" "+v(s.bounds.x+s.bounds.w)+" "+p(s.bounds.y)+"] ")+"/Contents ("+S(g(s.contents))+")",d+=" /Popup "+N.objId+" 0 R",d+=" /P "+b.objId+" 0 R",d+=" /T ("+S(g(ae))+") >>",_.content=d;var E=_.objId+" 0 R";d="<</Type /Annot /Subtype /Popup "+(l="/Rect ["+v(s.bounds.x+30)+" "+p(s.bounds.y+s.bounds.h)+" "+v(s.bounds.x+s.bounds.w+30)+" "+p(s.bounds.y)+"] ")+" /Parent "+E,s.open&&(d+=" /Open true"),d+=" >>",N.content=d,this.internal.write(_.objId,"0 R",N.objId,"0 R");break;case"freetext":l="/Rect ["+v(s.bounds.x)+" "+p(s.bounds.y)+" "+v(s.bounds.x+s.bounds.w)+" "+p(s.bounds.y+s.bounds.h)+"] ";var q=s.color||"#000000";d="<</Type /Annot /Subtype /FreeText "+l+"/Contents ("+S(F(s.contents))+")",d+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+q+")",d+=" /Border [0 0 0]",d+=" >>",this.internal.write(d);break;case"link":if(s.options.name){var re=this.annotations._nameMap[s.options.name];s.options.pageNumber=re.page,s.options.top=re.y}else s.options.top||(s.options.top=0);if(l="/Rect ["+s.finalBounds.x+" "+s.finalBounds.y+" "+s.finalBounds.w+" "+s.finalBounds.h+"] ",d="",s.options.url)d="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /A <</S /URI /URI ("+S(F(s.options.url))+") >>";else if(s.options.pageNumber)switch(d="<</Type /Annot /Subtype /Link "+l+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(s.options.pageNumber).objId+" 0 R",s.options.magFactor=s.options.magFactor||"XYZ",s.options.magFactor){case"Fit":d+=" /Fit]";break;case"FitH":d+=" /FitH "+s.options.top+"]";break;case"FitV":s.options.left=s.options.left||0,d+=" /FitV "+s.options.left+"]";break;default:var J=p(s.options.top);s.options.left=s.options.left||0,s.options.zoom===void 0&&(s.options.zoom=0),d+=" /XYZ "+s.options.left+" "+J+" "+s.options.zoom+"]"}d!=""&&(d+=" >>",this.internal.write(d))}}this.internal.write("]")}}]),n.createAnnotation=function(o){var s=this.internal.getCurrentPageInfo();switch(o.type){case"link":this.link(o.bounds.x,o.bounds.y,o.bounds.w,o.bounds.h,o);break;case"text":case"freetext":s.pageContext.annotations.push(o)}},n.link=function(o,s,l,d,v){var p=this.internal.getCurrentPageInfo(),b=this.internal.getCoordinateString,m=this.internal.getVerticalCoordinateString;p.pageContext.annotations.push({finalBounds:{x:b(o),y:m(s),w:b(o+l),h:m(s+d)},options:v,type:"link"})},n.textWithLink=function(o,s,l,d){var v,p,b=this.getTextWidth(o),m=this.internal.getLineHeight()/this.internal.scaleFactor;if(d.maxWidth!==void 0){p=d.maxWidth;var T=this.splitTextToSize(o,p).length;v=Math.ceil(m*T)}else p=b,v=m;return this.text(o,s,l,d),l+=.2*m,d.align==="center"&&(s-=b/2),d.align==="right"&&(s-=b),this.link(s,l-m,p,v,d),b},n.getTextWidth=function(o){var s=this.internal.getFontSize();return this.getStringUnitWidth(o)*s/this.internal.scaleFactor}})(Wn.API),(function(n){var r={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},o={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},s={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},l=[1570,1571,1573,1575];n.__arabicParser__={};var d=n.__arabicParser__.isInArabicSubstitutionA=function(_){return r[_.charCodeAt(0)]!==void 0},v=n.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},p=n.__arabicParser__.isArabicEndLetter=function(_){return v(_)&&d(_)&&r[_.charCodeAt(0)].length<=2},b=n.__arabicParser__.isArabicAlfLetter=function(_){return v(_)&&l.indexOf(_.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return v(_)&&d(_)&&r[_.charCodeAt(0)].length>=1};var m=n.__arabicParser__.arabicLetterHasFinalForm=function(_){return v(_)&&d(_)&&r[_.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(_){return v(_)&&d(_)&&r[_.charCodeAt(0)].length>=3};var T=n.__arabicParser__.arabicLetterHasMedialForm=function(_){return v(_)&&d(_)&&r[_.charCodeAt(0)].length==4},D=n.__arabicParser__.resolveLigatures=function(_){var N=0,g=o,ae="",E=0;for(N=0;N<_.length;N+=1)g[_.charCodeAt(N)]!==void 0?(E++,typeof(g=g[_.charCodeAt(N)])=="number"&&(ae+=String.fromCharCode(g),g=o,E=0),N===_.length-1&&(g=o,ae+=_.charAt(N-(E-1)),N-=E-1,E=0)):(g=o,ae+=_.charAt(N-E),N-=E,E=0);return ae};n.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&s[_.charCodeAt(0)]!==void 0};var M=n.__arabicParser__.getCorrectForm=function(_,N,g){return v(_)?d(_)===!1?-1:!m(_)||!v(N)&&!v(g)||!v(g)&&p(N)||p(_)&&!v(N)||p(_)&&b(N)||p(_)&&p(N)?0:T(_)&&v(N)&&!p(N)&&v(g)&&m(g)?3:p(_)||!v(g)?1:2:-1},S=function(_){var N=0,g=0,ae=0,E="",q="",re="",J=(_=_||"").split("\\s+"),Y=[];for(N=0;N<J.length;N+=1){for(Y.push(""),g=0;g<J[N].length;g+=1)E=J[N][g],q=J[N][g-1],re=J[N][g+1],v(E)?(ae=M(E,q,re),Y[N]+=ae!==-1?String.fromCharCode(r[E.charCodeAt(0)][ae]):E):Y[N]+=E;Y[N]=D(Y[N])}return Y.join(" ")},F=n.__arabicParser__.processArabic=n.processArabic=function(){var _,N=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,g=[];if(Array.isArray(N)){var ae=0;for(g=[],ae=0;ae<N.length;ae+=1)Array.isArray(N[ae])?g.push([S(N[ae][0]),N[ae][1],N[ae][2]]):g.push([S(N[ae])]);_=g}else _=S(N);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};n.events.push(["preProcessText",F])})(Wn.API),Wn.API.autoPrint=function(n){var r;return(n=n||{}).variant=n.variant||"non-conform",n.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+r+" 0 R")})),this},(function(n){var r=function(){var o=void 0;Object.defineProperty(this,"pdf",{get:function(){return o},set:function(p){o=p}});var s=150;Object.defineProperty(this,"width",{get:function(){return s},set:function(p){s=isNaN(p)||Number.isInteger(p)===!1||p<0?150:p,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=s+1)}});var l=300;Object.defineProperty(this,"height",{get:function(){return l},set:function(p){l=isNaN(p)||Number.isInteger(p)===!1||p<0?300:p,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=l+1)}});var d=[];Object.defineProperty(this,"childNodes",{get:function(){return d},set:function(p){d=p}});var v={};Object.defineProperty(this,"style",{get:function(){return v},set:function(p){v=p}}),Object.defineProperty(this,"parentNode",{})};r.prototype.getContext=function(o,s){var l;if((o=o||"2d")!=="2d")return null;for(l in s)this.pdf.context2d.hasOwnProperty(l)&&(this.pdf.context2d[l]=s[l]);return this.pdf.context2d._canvas=this,this.pdf.context2d},r.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new r,this.canvas.pdf=this}])})(Wn.API),(function(n){var r={left:0,top:0,bottom:0,right:0},o=!1,s=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},r),this.internal.__cell__.margins.width=this.getPageWidth(),l.call(this))},l=function(){this.internal.__cell__.lastCell=new d,this.internal.__cell__.pages=1},d=function(){var b=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return b},set:function(_){b=_}});var m=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return m},set:function(_){m=_}});var T=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return T},set:function(_){T=_}});var D=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return D},set:function(_){D=_}});var M=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return M},set:function(_){M=_}});var S=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return S},set:function(_){S=_}});var F=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return F},set:function(_){F=_}}),this};d.prototype.clone=function(){return new d(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},d.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(b){return s.call(this),this.internal.__cell__.headerFunction=typeof b=="function"?b:void 0,this},n.getTextDimensions=function(b,m){s.call(this);var T=(m=m||{}).fontSize||this.getFontSize(),D=m.font||this.getFont(),M=m.scaleFactor||this.internal.scaleFactor,S=0,F=0,_=0,N=this;if(!Array.isArray(b)&&typeof b!="string"){if(typeof b!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");b=String(b)}var g=m.maxWidth;g>0?typeof b=="string"?b=this.splitTextToSize(b,g):Object.prototype.toString.call(b)==="[object Array]"&&(b=b.reduce(function(E,q){return E.concat(N.splitTextToSize(q,g))},[])):b=Array.isArray(b)?b:[b];for(var ae=0;ae<b.length;ae++)S<(_=this.getStringUnitWidth(b[ae],{font:D})*T)&&(S=_);return S!==0&&(F=b.length),{w:S/=M,h:Math.max((F*T*this.getLineHeightFactor()-T*(this.getLineHeightFactor()-1))/M,0)}},n.cellAddPage=function(){s.call(this),this.addPage();var b=this.internal.__cell__.margins||r;return this.internal.__cell__.lastCell=new d(b.left,b.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var v=n.cell=function(){var b;b=arguments[0]instanceof d?arguments[0]:new d(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),s.call(this);var m=this.internal.__cell__.lastCell,T=this.internal.__cell__.padding,D=this.internal.__cell__.margins||r,M=this.internal.__cell__.tableHeaderRow,S=this.internal.__cell__.printHeaders;return m.lineNumber!==void 0&&(m.lineNumber===b.lineNumber?(b.x=(m.x||0)+(m.width||0),b.y=m.y||0):m.y+m.height+b.height+D.bottom>this.getPageHeight()?(this.cellAddPage(),b.y=D.top,S&&M&&(this.printHeaderRow(b.lineNumber,!0),b.y+=M[0].height)):b.y=m.y+m.height||b.y),b.text[0]!==void 0&&(this.rect(b.x,b.y,b.width,b.height,o===!0?"FD":void 0),b.align==="right"?this.text(b.text,b.x+b.width-T,b.y+T,{align:"right",baseline:"top"}):b.align==="center"?this.text(b.text,b.x+b.width/2,b.y+T,{align:"center",baseline:"top",maxWidth:b.width-T-T}):this.text(b.text,b.x+T,b.y+T,{align:"left",baseline:"top",maxWidth:b.width-T-T})),this.internal.__cell__.lastCell=b,this};n.table=function(b,m,T,D,M){if(s.call(this),!T)throw new Error("No data for PDF table.");var S,F,_,N,g=[],ae=[],E=[],q={},re={},J=[],Y=[],ee=(M=M||{}).autoSize||!1,U=M.printHeaders!==!1,$=M.css&&M.css["font-size"]!==void 0?16*M.css["font-size"]:M.fontSize||12,H=M.margins||Object.assign({width:this.getPageWidth()},r),R=typeof M.padding=="number"?M.padding:3,Z=M.headerBackgroundColor||"#c8c8c8",G=M.headerTextColor||"#000";if(l.call(this),this.internal.__cell__.printHeaders=U,this.internal.__cell__.margins=H,this.internal.__cell__.table_font_size=$,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=Z,this.internal.__cell__.headerTextColor=G,this.setFontSize($),D==null)ae=g=Object.keys(T[0]),E=g.map(function(){return"left"});else if(Array.isArray(D)&&Ir(D[0])==="object")for(g=D.map(function(xe){return xe.name}),ae=D.map(function(xe){return xe.prompt||xe.name||""}),E=D.map(function(xe){return xe.align||"left"}),S=0;S<D.length;S+=1)re[D[S].name]=.7499990551181103*D[S].width;else Array.isArray(D)&&typeof D[0]=="string"&&(ae=g=D,E=g.map(function(){return"left"}));if(ee||Array.isArray(D)&&typeof D[0]=="string")for(S=0;S<g.length;S+=1){for(q[N=g[S]]=T.map(function(xe){return xe[N]}),this.setFont(void 0,"bold"),J.push(this.getTextDimensions(ae[S],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),F=q[N],this.setFont(void 0,"normal"),_=0;_<F.length;_+=1)J.push(this.getTextDimensions(F[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);re[N]=Math.max.apply(null,J)+R+R,J=[]}if(U){var we={};for(S=0;S<g.length;S+=1)we[g[S]]={},we[g[S]].text=ae[S],we[g[S]].align=E[S];var te=p.call(this,we,re);Y=g.map(function(xe){return new d(b,m,re[xe],te,we[xe].text,void 0,we[xe].align)}),this.setTableHeaderRow(Y),this.printHeaderRow(1,!1)}var de=D.reduce(function(xe,k){return xe[k.name]=k.align,xe},{});for(S=0;S<T.length;S+=1){"rowStart"in M&&M.rowStart instanceof Function&&M.rowStart({row:S,data:T[S]},this);var Ce=p.call(this,T[S],re);for(_=0;_<g.length;_+=1){var Re=T[S][g[_]];"cellStart"in M&&M.cellStart instanceof Function&&M.cellStart({row:S,col:_,data:Re},this),v.call(this,new d(b,m,re[g[_]],Ce,Re,S+2,de[g[_]]))}}return this.internal.__cell__.table_x=b,this.internal.__cell__.table_y=m,this};var p=function(b,m){var T=this.internal.__cell__.padding,D=this.internal.__cell__.table_font_size,M=this.internal.scaleFactor;return Object.keys(b).map(function(S){var F=b[S];return this.splitTextToSize(F.hasOwnProperty("text")?F.text:F,m[S]-T-T)},this).map(function(S){return this.getLineHeightFactor()*S.length*D/M+T+T},this).reduce(function(S,F){return Math.max(S,F)},0)};n.setTableHeaderRow=function(b){s.call(this),this.internal.__cell__.tableHeaderRow=b},n.printHeaderRow=function(b,m){if(s.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var T;if(o=!0,typeof this.internal.__cell__.headerFunction=="function"){var D=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new d(D[0],D[1],D[2],D[3],void 0,-1)}this.setFont(void 0,"bold");for(var M=[],S=0;S<this.internal.__cell__.tableHeaderRow.length;S+=1){T=this.internal.__cell__.tableHeaderRow[S].clone(),m&&(T.y=this.internal.__cell__.margins.top||0,M.push(T)),T.lineNumber=b;var F=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),v.call(this,T),this.setTextColor(F)}M.length>0&&this.setTableHeaderRow(M),this.setFont(void 0,"normal"),o=!1}})(Wn.API);var Rx={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Lx=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Gg=Dx(Lx),Ix=[100,200,300,400,500,600,700,800,900],a5=Dx(Ix);function Ag(n){var r=n.family.replace(/"|'/g,"").toLowerCase(),o=(function(d){return Rx[d=d||"normal"]?d:"normal"})(n.style),s=(function(d){return d?typeof d=="number"?d>=100&&d<=900&&d%100==0?d:400:/^\d00$/.test(d)?parseInt(d):d==="bold"?700:400:400})(n.weight),l=(function(d){return typeof Gg[d=d||"normal"]=="number"?d:"normal"})(n.stretch);return{family:r,style:o,weight:s,stretch:l,src:n.src||[],ref:n.ref||{name:r,style:[l,o,s].join(" ")}}}function by(n,r,o,s){var l;for(l=o;l>=0&&l<r.length;l+=s)if(n[r[l]])return n[r[l]];for(l=o;l>=0&&l<r.length;l-=s)if(n[r[l]])return n[r[l]]}var s5={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},vy={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function wy(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function Sy(n){return n.trimLeft()}function l5(n,r){for(var o=0;o<n.length;){if(n.charAt(o)===r)return[n.substring(0,o),n.substring(o+1)];o+=1}return null}function c5(n){var r=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return r===null?null:[r[0],n.substring(r[0].length)]}var Jp,jy,Ty,Gd,Qp,Cy,Ny,ky,zg=["times"];function Ay(n,r,o,s,l){var d=4,v=Py;switch(l){case Wn.API.image_compression.FAST:d=1,v=zy;break;case Wn.API.image_compression.MEDIUM:d=6,v=_y;break;case Wn.API.image_compression.SLOW:d=9,v=Dy}n=(function(b,m,T,D){for(var M,S=b.length/m,F=new Uint8Array(b.length+S),_=[u5,zy,Py,_y,Dy],N=0;N<S;N+=1){var g=N*m,ae=b.subarray(g,g+m);if(D)F.set(D(ae,T,M),g+N);else{for(var E=_.length,q=[],re=0;re<E;re+=1)q[re]=_[re](ae,T,M);var J=f5(q.concat());F.set(q[J],g+N)}M=ae}return F})(n,r,Math.ceil(o*s/8),v);var p=Fg(n,{level:d});return Wn.API.__addimage__.arrayBufferToBinaryString(p)}function u5(n){var r=Array.apply([],n);return r.unshift(0),r}function zy(n,r){var o=n.length,s=[];s[0]=1;for(var l=0;l<o;l+=1){var d=n[l-r]||0;s[l+1]=n[l]-d+256&255}return s}function Py(n,r,o){var s=n.length,l=[];l[0]=2;for(var d=0;d<s;d+=1){var v=o&&o[d]||0;l[d+1]=n[d]-v+256&255}return l}function _y(n,r,o){var s=n.length,l=[];l[0]=3;for(var d=0;d<s;d+=1){var v=n[d-r]||0,p=o&&o[d]||0;l[d+1]=n[d]+256-(v+p>>>1)&255}return l}function Dy(n,r,o){var s=n.length,l=[];l[0]=4;for(var d=0;d<s;d+=1){var v=d5(n[d-r]||0,o&&o[d]||0,o&&o[d-r]||0);l[d+1]=n[d]-v+256&255}return l}function d5(n,r,o){if(n===r&&r===o)return n;var s=Math.abs(r-o),l=Math.abs(n-o),d=Math.abs(n+r-o-o);return s<=l&&s<=d?n:l<=d?r:o}function f5(n){var r=n.map(function(o){return o.reduce(function(s,l){return s+Math.abs(l)},0)});return r.indexOf(Math.min.apply(null,r))}function Pg(n,r,o){var s=r*o,l=Math.floor(s/8),d=16-(s-8*l+o),v=(1<<o)-1;return Mx(n,l)>>d&v}function Ry(n,r,o,s){var l=o*s,d=Math.floor(l/8),v=16-(l-8*d+s),p=(1<<s)-1,b=(r&p)<<v;(function(m,T,D){if(T+1<m.byteLength)m.setUint16(T,D,!1);else{var M=D>>8&255;m.setUint8(T,M)}})(n,d,Mx(n,d)&~(p<<v)&65535|b)}function Mx(n,r){return r+1<n.byteLength?n.getUint16(r,!1):n.getUint8(r)<<8}function p5(n){var r=0;if(n[r++]!==71||n[r++]!==73||n[r++]!==70||n[r++]!==56||(n[r++]+1&253)!=56||n[r++]!==97)throw new Error("Invalid GIF 87a/89a header.");var o=n[r++]|n[r++]<<8,s=n[r++]|n[r++]<<8,l=n[r++],d=l>>7,v=1<<1+(7&l);n[r++],n[r++];var p=null,b=null;d&&(p=r,b=v,r+=3*v);var m=!0,T=[],D=0,M=null,S=0,F=null;for(this.width=o,this.height=s;m&&r<n.length;)switch(n[r++]){case 33:switch(n[r++]){case 255:if(n[r]!==11||n[r+1]==78&&n[r+2]==69&&n[r+3]==84&&n[r+4]==83&&n[r+5]==67&&n[r+6]==65&&n[r+7]==80&&n[r+8]==69&&n[r+9]==50&&n[r+10]==46&&n[r+11]==48&&n[r+12]==3&&n[r+13]==1&&n[r+16]==0)r+=14,F=n[r++]|n[r++]<<8,r++;else for(r+=12;;){if(!((H=n[r++])>=0))throw Error("Invalid block size");if(H===0)break;r+=H}break;case 249:if(n[r++]!==4||n[r+4]!==0)throw new Error("Invalid graphics extension block.");var _=n[r++];D=n[r++]|n[r++]<<8,M=n[r++],1&_||(M=null),S=_>>2&7,r++;break;case 254:for(;;){if(!((H=n[r++])>=0))throw Error("Invalid block size");if(H===0)break;r+=H}break;default:throw new Error("Unknown graphic control label: 0x"+n[r-1].toString(16))}break;case 44:var N=n[r++]|n[r++]<<8,g=n[r++]|n[r++]<<8,ae=n[r++]|n[r++]<<8,E=n[r++]|n[r++]<<8,q=n[r++],re=q>>6&1,J=1<<1+(7&q),Y=p,ee=b,U=!1;q>>7&&(U=!0,Y=r,ee=J,r+=3*J);var $=r;for(r++;;){var H;if(!((H=n[r++])>=0))throw Error("Invalid block size");if(H===0)break;r+=H}T.push({x:N,y:g,width:ae,height:E,has_local_palette:U,palette_offset:Y,palette_size:ee,data_offset:$,data_length:r-$,transparent_index:M,interlaced:!!re,delay:D,disposal:S});break;case 59:m=!1;break;default:throw new Error("Unknown gif block: 0x"+n[r-1].toString(16))}this.numFrames=function(){return T.length},this.loopCount=function(){return F},this.frameInfo=function(R){if(R<0||R>=T.length)throw new Error("Frame index out of range.");return T[R]},this.decodeAndBlitFrameBGRA=function(R,Z){var G=this.frameInfo(R),we=G.width*G.height,te=new Uint8Array(we);Ly(n,G.data_offset,te,we);var de=G.palette_offset,Ce=G.transparent_index;Ce===null&&(Ce=256);var Re=G.width,xe=o-Re,k=Re,A=4*(G.y*o+G.x),V=4*((G.y+G.height)*o+G.x),W=A,se=4*xe;G.interlaced===!0&&(se+=4*o*7);for(var Te=8,le=0,_e=te.length;le<_e;++le){var ve=te[le];if(k===0&&(k=Re,(W+=se)>=V&&(se=4*xe+4*o*(Te-1),W=A+(Re+xe)*(Te<<1),Te>>=1)),ve===Ce)W+=4;else{var De=n[de+3*ve],Xe=n[de+3*ve+1],st=n[de+3*ve+2];Z[W++]=st,Z[W++]=Xe,Z[W++]=De,Z[W++]=255}--k}},this.decodeAndBlitFrameRGBA=function(R,Z){var G=this.frameInfo(R),we=G.width*G.height,te=new Uint8Array(we);Ly(n,G.data_offset,te,we);var de=G.palette_offset,Ce=G.transparent_index;Ce===null&&(Ce=256);var Re=G.width,xe=o-Re,k=Re,A=4*(G.y*o+G.x),V=4*((G.y+G.height)*o+G.x),W=A,se=4*xe;G.interlaced===!0&&(se+=4*o*7);for(var Te=8,le=0,_e=te.length;le<_e;++le){var ve=te[le];if(k===0&&(k=Re,(W+=se)>=V&&(se=4*xe+4*o*(Te-1),W=A+(Re+xe)*(Te<<1),Te>>=1)),ve===Ce)W+=4;else{var De=n[de+3*ve],Xe=n[de+3*ve+1],st=n[de+3*ve+2];Z[W++]=De,Z[W++]=Xe,Z[W++]=st,Z[W++]=255}--k}}}function Ly(n,r,o,s){for(var l=n[r++],d=1<<l,v=d+1,p=v+1,b=l+1,m=(1<<b)-1,T=0,D=0,M=0,S=n[r++],F=new Int32Array(4096),_=null;;){for(;T<16&&S!==0;)D|=n[r++]<<T,T+=8,S===1?S=n[r++]:--S;if(T<b)break;var N=D&m;if(D>>=b,T-=b,N!==d){if(N===v)break;for(var g=N<p?N:_,ae=0,E=g;E>d;)E=F[E]>>8,++ae;var q=E;if(M+ae+(g!==N?1:0)>s)return void no.log("Warning, gif stream longer than expected.");o[M++]=q;var re=M+=ae;for(g!==N&&(o[M++]=q),E=g;ae--;)E=F[E],o[--re]=255&E,E>>=8;_!==null&&p<4096&&(F[p++]=_<<8|q,p>=m+1&&b<12&&(++b,m=m<<1|1)),_=N}else p=v+1,m=(1<<(b=l+1))-1,_=null}return M!==s&&no.log("Warning, gif stream shorter than expected."),o}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function _g(n){var r,o,s,l,d,v=Math.floor,p=new Array(64),b=new Array(64),m=new Array(64),T=new Array(64),D=new Array(65535),M=new Array(65535),S=new Array(64),F=new Array(64),_=[],N=0,g=7,ae=new Array(64),E=new Array(64),q=new Array(64),re=new Array(256),J=new Array(2048),Y=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ee=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],H=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Z=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],we=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function te(A,V){for(var W=0,se=0,Te=new Array,le=1;le<=16;le++){for(var _e=1;_e<=A[le];_e++)Te[V[se]]=[],Te[V[se]][0]=W,Te[V[se]][1]=le,se++,W++;W*=2}return Te}function de(A){for(var V=A[0],W=A[1]-1;W>=0;)V&1<<W&&(N|=1<<g),W--,--g<0&&(N==255?(Ce(255),Ce(0)):Ce(N),g=7,N=0)}function Ce(A){_.push(A)}function Re(A){Ce(A>>8&255),Ce(255&A)}function xe(A,V,W,se,Te){for(var le,_e=Te[0],ve=Te[240],De=(function(ht,Qe){var $t,dn,rn,kn,Fn,Be,fe,lt,it,$e,at=0;for(it=0;it<8;++it){$t=ht[at],dn=ht[at+1],rn=ht[at+2],kn=ht[at+3],Fn=ht[at+4],Be=ht[at+5],fe=ht[at+6];var Ot=$t+(lt=ht[at+7]),Vt=$t-lt,jt=dn+fe,Ft=dn-fe,tn=rn+Be,ln=rn-Be,mt=kn+Fn,cn=kn-Fn,_t=Ot+mt,Yt=Ot-mt,gn=jt+tn,fn=jt-tn;ht[at]=_t+gn,ht[at+4]=_t-gn;var bn=.707106781*(fn+Yt);ht[at+2]=Yt+bn,ht[at+6]=Yt-bn;var ir=.382683433*((_t=cn+ln)-(fn=Ft+Vt)),Dn=.5411961*_t+ir,Cr=1.306562965*fn+ir,Mr=.707106781*(gn=ln+Ft),Xt=Vt+Mr,mr=Vt-Mr;ht[at+5]=mr+Dn,ht[at+3]=mr-Dn,ht[at+1]=Xt+Cr,ht[at+7]=Xt-Cr,at+=8}for(at=0,it=0;it<8;++it){$t=ht[at],dn=ht[at+8],rn=ht[at+16],kn=ht[at+24],Fn=ht[at+32],Be=ht[at+40],fe=ht[at+48];var Ti=$t+(lt=ht[at+56]),Ln=$t-lt,Rt=dn+fe,Ht=dn-fe,tt=rn+Be,Bt=rn-Be,pn=kn+Fn,An=kn-Fn,yn=Ti+pn,$n=Ti-pn,li=Rt+tt,vi=Rt-tt;ht[at]=yn+li,ht[at+32]=yn-li;var qi=.707106781*(vi+$n);ht[at+16]=$n+qi,ht[at+48]=$n-qi;var Br=.382683433*((yn=An+Bt)-(vi=Ht+Ln)),Ja=.5411961*yn+Br,Qa=1.306562965*vi+Br,Ia=.707106781*(li=Bt+Ht),Go=Ln+Ia,Ca=Ln-Ia;ht[at+40]=Ca+Ja,ht[at+24]=Ca-Ja,ht[at+8]=Go+Qa,ht[at+56]=Go-Qa,at++}for(it=0;it<64;++it)$e=ht[it]*Qe[it],S[it]=$e>0?$e+.5|0:$e-.5|0;return S})(A,V),Xe=0;Xe<64;++Xe)F[Y[Xe]]=De[Xe];var st=F[0]-W;W=F[0],st==0?de(se[0]):(de(se[M[le=32767+st]]),de(D[le]));for(var kt=63;kt>0&&F[kt]==0;)kt--;if(kt==0)return de(_e),W;for(var qt,ye=1;ye<=kt;){for(var ut=ye;F[ye]==0&&ye<=kt;)++ye;var Gt=ye-ut;if(Gt>=16){qt=Gt>>4;for(var Et=1;Et<=qt;++Et)de(ve);Gt&=15}le=32767+F[ye],de(Te[(Gt<<4)+M[le]]),de(D[le]),ye++}return kt!=63&&de(_e),W}function k(A){A=Math.min(Math.max(A,1),100),d!=A&&((function(V){for(var W=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],se=0;se<64;se++){var Te=v((W[se]*V+50)/100);Te=Math.min(Math.max(Te,1),255),p[Y[se]]=Te}for(var le=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],_e=0;_e<64;_e++){var ve=v((le[_e]*V+50)/100);ve=Math.min(Math.max(ve,1),255),b[Y[_e]]=ve}for(var De=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Xe=0,st=0;st<8;st++)for(var kt=0;kt<8;kt++)m[Xe]=1/(p[Y[Xe]]*De[st]*De[kt]*8),T[Xe]=1/(b[Y[Xe]]*De[st]*De[kt]*8),Xe++})(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),d=A)}this.encode=function(A,V){V&&k(V),_=new Array,N=0,g=7,Re(65496),Re(65504),Re(16),Ce(74),Ce(70),Ce(73),Ce(70),Ce(0),Ce(1),Ce(1),Ce(0),Re(1),Re(1),Ce(0),Ce(0),(function(){Re(65499),Re(132),Ce(0);for(var dn=0;dn<64;dn++)Ce(p[dn]);Ce(1);for(var rn=0;rn<64;rn++)Ce(b[rn])})(),(function(dn,rn){Re(65472),Re(17),Ce(8),Re(rn),Re(dn),Ce(3),Ce(1),Ce(17),Ce(0),Ce(2),Ce(17),Ce(1),Ce(3),Ce(17),Ce(1)})(A.width,A.height),(function(){Re(65476),Re(418),Ce(0);for(var dn=0;dn<16;dn++)Ce(ee[dn+1]);for(var rn=0;rn<=11;rn++)Ce(U[rn]);Ce(16);for(var kn=0;kn<16;kn++)Ce($[kn+1]);for(var Fn=0;Fn<=161;Fn++)Ce(H[Fn]);Ce(1);for(var Be=0;Be<16;Be++)Ce(R[Be+1]);for(var fe=0;fe<=11;fe++)Ce(Z[fe]);Ce(17);for(var lt=0;lt<16;lt++)Ce(G[lt+1]);for(var it=0;it<=161;it++)Ce(we[it])})(),Re(65498),Re(12),Ce(3),Ce(1),Ce(0),Ce(2),Ce(17),Ce(3),Ce(17),Ce(0),Ce(63),Ce(0);var W=0,se=0,Te=0;N=0,g=7,this.encode.displayName="_encode_";for(var le,_e,ve,De,Xe,st,kt,qt,ye,ut=A.data,Gt=A.width,Et=A.height,ht=4*Gt,Qe=0;Qe<Et;){for(le=0;le<ht;){for(Xe=ht*Qe+le,kt=-1,qt=0,ye=0;ye<64;ye++)st=Xe+(qt=ye>>3)*ht+(kt=4*(7&ye)),Qe+qt>=Et&&(st-=ht*(Qe+1+qt-Et)),le+kt>=ht&&(st-=le+kt-ht+4),_e=ut[st++],ve=ut[st++],De=ut[st++],ae[ye]=(J[_e]+J[ve+256|0]+J[De+512|0]>>16)-128,E[ye]=(J[_e+768|0]+J[ve+1024|0]+J[De+1280|0]>>16)-128,q[ye]=(J[_e+1280|0]+J[ve+1536|0]+J[De+1792|0]>>16)-128;W=xe(ae,m,W,r,s),se=xe(E,T,se,o,l),Te=xe(q,T,Te,o,l),le+=32}Qe+=8}if(g>=0){var $t=[];$t[1]=g+1,$t[0]=(1<<g+1)-1,de($t)}return Re(65497),new Uint8Array(_)},n=n||50,(function(){for(var A=String.fromCharCode,V=0;V<256;V++)re[V]=A(V)})(),r=te(ee,U),o=te(R,Z),s=te($,H),l=te(G,we),(function(){for(var A=1,V=2,W=1;W<=15;W++){for(var se=A;se<V;se++)M[32767+se]=W,D[32767+se]=[],D[32767+se][1]=W,D[32767+se][0]=se;for(var Te=-(V-1);Te<=-A;Te++)M[32767+Te]=W,D[32767+Te]=[],D[32767+Te][1]=W,D[32767+Te][0]=V-1+Te;A<<=1,V<<=1}})(),(function(){for(var A=0;A<256;A++)J[A]=19595*A,J[A+256|0]=38470*A,J[A+512|0]=7471*A+32768,J[A+768|0]=-11059*A,J[A+1024|0]=-21709*A,J[A+1280|0]=32768*A+8421375,J[A+1536|0]=-27439*A,J[A+1792|0]=-5329*A})(),k(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ac(n,r){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!r,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Iy(n){function r(U){if(!U)throw Error("assert :P")}function o(U,$,H){for(var R=0;4>R;R++)if(U[$+R]!=H.charCodeAt(R))return!0;return!1}function s(U,$,H,R,Z){for(var G=0;G<Z;G++)U[$+G]=H[R+G]}function l(U,$,H,R){for(var Z=0;Z<R;Z++)U[$+Z]=H}function d(U){return new Int32Array(U)}function v(U,$){for(var H=[],R=0;R<U;R++)H.push(new $);return H}function p(U,$){var H=[];return(function R(Z,G,we){for(var te=we[G],de=0;de<te&&(Z.push(we.length>G+1?[]:new $),!(we.length<G+1));de++)R(Z[de],G+1,we)})(H,0,U),H}var b=function(){var U=this;function $(f,y){for(var C=1<<y-1>>>0;f&C;)C>>>=1;return C?(f&C-1)+C:f}function H(f,y,C,L,X){r(!(L%C));do f[y+(L-=C)]=X;while(0<L)}function R(f,y,C,L,X){if(r(2328>=X),512>=X)var ie=d(512);else if((ie=d(X))==null)return 0;return(function(oe,ce,he,je,Pe,Ee){var ke,He,Je=ce,bt=1<<he,et=d(16),yt=d(16);for(r(Pe!=0),r(je!=null),r(oe!=null),r(0<he),He=0;He<Pe;++He){if(15<je[He])return 0;++et[je[He]]}if(et[0]==Pe)return 0;for(yt[1]=0,ke=1;15>ke;++ke){if(et[ke]>1<<ke)return 0;yt[ke+1]=yt[ke]+et[ke]}for(He=0;He<Pe;++He)ke=je[He],0<je[He]&&(Ee[yt[ke]++]=He);if(yt[15]==1)return(je=new Z).g=0,je.value=Ee[0],H(oe,Je,1,bt,je),bt;var wt,It=-1,zt=bt-1,wn=0,un=1,Sn=1,en=1<<he;for(He=0,ke=1,Pe=2;ke<=he;++ke,Pe<<=1){if(un+=Sn<<=1,0>(Sn-=et[ke]))return 0;for(;0<et[ke];--et[ke])(je=new Z).g=ke,je.value=Ee[He++],H(oe,Je+wn,Pe,en,je),wn=$(wn,ke)}for(ke=he+1,Pe=2;15>=ke;++ke,Pe<<=1){if(un+=Sn<<=1,0>(Sn-=et[ke]))return 0;for(;0<et[ke];--et[ke]){if(je=new Z,(wn&zt)!=It){for(Je+=en,wt=1<<(It=ke)-he;15>It&&!(0>=(wt-=et[It]));)++It,wt<<=1;bt+=en=1<<(wt=It-he),oe[ce+(It=wn&zt)].g=wt+he,oe[ce+It].value=Je-ce-It}je.g=ke-he,je.value=Ee[He++],H(oe,Je+(wn>>he),Pe,en,je),wn=$(wn,ke)}}return un!=2*yt[15]-1?0:bt})(f,y,C,L,X,ie)}function Z(){this.value=this.g=0}function G(){this.value=this.g=0}function we(){this.G=v(5,Z),this.H=d(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=v(ao,G)}function te(f,y,C,L){r(f!=null),r(y!=null),r(2147483648>L),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=y,f.pa=C,f.Jd=y,f.Yc=C+L,f.Zc=4<=L?C+L-4+1:C,_e(f)}function de(f,y){for(var C=0;0<y--;)C|=De(f,128)<<y;return C}function Ce(f,y){var C=de(f,y);return ve(f)?-C:C}function Re(f,y,C,L){var X,ie=0;for(r(f!=null),r(y!=null),r(4294967288>L),f.Sb=L,f.Ra=0,f.u=0,f.h=0,4<L&&(L=4),X=0;X<L;++X)ie+=y[C+X]<<8*X;f.Ra=ie,f.bb=L,f.oa=y,f.pa=C}function xe(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<Rs-8>>>0,++f.bb,f.u-=8;se(f)&&(f.h=1,f.u=0)}function k(f,y){if(r(0<=y),!f.h&&y<=Ur){var C=W(f)&qo[y];return f.u+=y,xe(f),C}return f.h=1,f.u=0}function A(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function V(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function W(f){return f.Ra>>>(f.u&Rs-1)>>>0}function se(f){return r(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>Rs}function Te(f,y){f.u=y,f.h=se(f)}function le(f){f.u>=Jo&&(r(f.u>=Jo),xe(f))}function _e(f){r(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(r(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function ve(f){return de(f,1)}function De(f,y){var C=f.Ca;0>f.b&&_e(f);var L=f.b,X=C*y>>>8,ie=(f.I>>>L>X)+0;for(ie?(C-=X,f.I-=X+1<<L>>>0):C=X+1,L=C,X=0;256<=L;)X+=8,L>>=8;return L=7^X+Zs[L],f.b-=L,f.Ca=(C<<L)-1,ie}function Xe(f,y,C){f[y+0]=C>>24&255,f[y+1]=C>>16&255,f[y+2]=C>>8&255,f[y+3]=255&C}function st(f,y){return f[y+0]|f[y+1]<<8}function kt(f,y){return st(f,y)|f[y+2]<<16}function qt(f,y){return st(f,y)|st(f,y+2)<<16}function ye(f,y){var C=1<<y;return r(f!=null),r(0<y),f.X=d(C),f.X==null?0:(f.Mb=32-y,f.Xa=y,1)}function ut(f,y){r(f!=null),r(y!=null),r(f.Xa==y.Xa),s(y.X,0,f.X,0,1<<y.Xa)}function Gt(){this.X=[],this.Xa=this.Mb=0}function Et(f,y,C,L){r(C!=null),r(L!=null);var X=C[0],ie=L[0];return X==0&&(X=(f*ie+y/2)/y),ie==0&&(ie=(y*X+f/2)/f),0>=X||0>=ie?0:(C[0]=X,L[0]=ie,1)}function ht(f,y){return f+(1<<y)-1>>>y}function Qe(f,y){return((4278255360&f)+(4278255360&y)>>>0&4278255360)+((16711935&f)+(16711935&y)>>>0&16711935)>>>0}function $t(f,y){U[y]=function(C,L,X,ie,oe,ce,he){var je;for(je=0;je<oe;++je){var Pe=U[f](ce[he+je-1],X,ie+je);ce[he+je]=Qe(C[L+je],Pe)}}}function dn(){this.ud=this.hd=this.jd=0}function rn(f,y){return((4278124286&(f^y))>>>1)+(f&y)>>>0}function kn(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function Fn(f,y){return kn(f+(f-y+.5>>1))}function Be(f,y,C){return Math.abs(y-C)-Math.abs(f-C)}function fe(f,y,C,L,X,ie,oe){for(L=ie[oe-1],C=0;C<X;++C)ie[oe+C]=L=Qe(f[y+C],L)}function lt(f,y,C,L,X){var ie;for(ie=0;ie<C;++ie){var oe=f[y+ie],ce=oe>>8&255,he=16711935&(he=(he=16711935&oe)+((ce<<16)+ce));L[X+ie]=(4278255360&oe)+he>>>0}}function it(f,y){y.jd=255&f,y.hd=f>>8&255,y.ud=f>>16&255}function $e(f,y,C,L,X,ie){var oe;for(oe=0;oe<L;++oe){var ce=y[C+oe],he=ce>>>8,je=ce,Pe=255&(Pe=(Pe=ce>>>16)+((f.jd<<24>>24)*(he<<24>>24)>>>5));je=255&(je=(je+=(f.hd<<24>>24)*(he<<24>>24)>>>5)+((f.ud<<24>>24)*(Pe<<24>>24)>>>5)),X[ie+oe]=(4278255360&ce)+(Pe<<16)+je}}function at(f,y,C,L,X){U[y]=function(ie,oe,ce,he,je,Pe,Ee,ke,He){for(he=Ee;he<ke;++he)for(Ee=0;Ee<He;++Ee)je[Pe++]=X(ce[L(ie[oe++])])},U[f]=function(ie,oe,ce,he,je,Pe,Ee){var ke=8>>ie.b,He=ie.Ea,Je=ie.K[0],bt=ie.w;if(8>ke)for(ie=(1<<ie.b)-1,bt=(1<<ke)-1;oe<ce;++oe){var et,yt=0;for(et=0;et<He;++et)et&ie||(yt=L(he[je++])),Pe[Ee++]=X(Je[yt&bt]),yt>>=ke}else U["VP8LMapColor"+C](he,je,Je,bt,Pe,Ee,oe,ce,He)}}function Ot(f,y,C,L,X){for(C=y+C;y<C;){var ie=f[y++];L[X++]=ie>>16&255,L[X++]=ie>>8&255,L[X++]=255&ie}}function Vt(f,y,C,L,X){for(C=y+C;y<C;){var ie=f[y++];L[X++]=ie>>16&255,L[X++]=ie>>8&255,L[X++]=255&ie,L[X++]=ie>>24&255}}function jt(f,y,C,L,X){for(C=y+C;y<C;){var ie=(oe=f[y++])>>16&240|oe>>12&15,oe=240&oe|oe>>28&15;L[X++]=ie,L[X++]=oe}}function Ft(f,y,C,L,X){for(C=y+C;y<C;){var ie=(oe=f[y++])>>16&248|oe>>13&7,oe=oe>>5&224|oe>>3&31;L[X++]=ie,L[X++]=oe}}function tn(f,y,C,L,X){for(C=y+C;y<C;){var ie=f[y++];L[X++]=255&ie,L[X++]=ie>>8&255,L[X++]=ie>>16&255}}function ln(f,y,C,L,X,ie){if(ie==0)for(C=y+C;y<C;)Xe(L,((ie=f[y++])[0]>>24|ie[1]>>8&65280|ie[2]<<8&16711680|ie[3]<<24)>>>0),X+=32;else s(L,X,f,y,C)}function mt(f,y){U[y][0]=U[f+"0"],U[y][1]=U[f+"1"],U[y][2]=U[f+"2"],U[y][3]=U[f+"3"],U[y][4]=U[f+"4"],U[y][5]=U[f+"5"],U[y][6]=U[f+"6"],U[y][7]=U[f+"7"],U[y][8]=U[f+"8"],U[y][9]=U[f+"9"],U[y][10]=U[f+"10"],U[y][11]=U[f+"11"],U[y][12]=U[f+"12"],U[y][13]=U[f+"13"],U[y][14]=U[f+"0"],U[y][15]=U[f+"0"]}function cn(f){return f==cs||f==ta||f==ll||f==eu}function _t(){this.eb=[],this.size=this.A=this.fb=0}function Yt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function gn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new _t,this.f.kb=new Yt,this.sd=null}function fn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function bn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ir(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function Dn(f,y){var C=f.T,L=y.ba.f.RGBA,X=L.eb,ie=L.fb+f.ka*L.A,oe=_r[y.ba.S],ce=f.y,he=f.O,je=f.f,Pe=f.N,Ee=f.ea,ke=f.W,He=y.cc,Je=y.dc,bt=y.Mc,et=y.Nc,yt=f.ka,wt=f.ka+f.T,It=f.U,zt=It+1>>1;for(yt==0?oe(ce,he,null,null,je,Pe,Ee,ke,je,Pe,Ee,ke,X,ie,null,null,It):(oe(y.ec,y.fc,ce,he,He,Je,bt,et,je,Pe,Ee,ke,X,ie-L.A,X,ie,It),++C);yt+2<wt;yt+=2)He=je,Je=Pe,bt=Ee,et=ke,Pe+=f.Rc,ke+=f.Rc,ie+=2*L.A,oe(ce,(he+=2*f.fa)-f.fa,ce,he,He,Je,bt,et,je,Pe,Ee,ke,X,ie-L.A,X,ie,It);return he+=f.fa,f.j+wt<f.o?(s(y.ec,y.fc,ce,he,It),s(y.cc,y.dc,je,Pe,zt),s(y.Mc,y.Nc,Ee,ke,zt),C--):1&wt||oe(ce,he,null,null,je,Pe,Ee,ke,je,Pe,Ee,ke,X,ie+L.A,null,null,It),C}function Cr(f,y,C){var L=f.F,X=[f.J];if(L!=null){var ie=f.U,oe=y.ba.S,ce=oe==Zr||oe==ll;y=y.ba.f.RGBA;var he=[0],je=f.ka;he[0]=f.T,f.Kb&&(je==0?--he[0]:(--je,X[0]-=f.width),f.j+f.ka+f.T==f.o&&(he[0]=f.o-f.j-je));var Pe=y.eb;je=y.fb+je*y.A,f=Xr(L,X[0],f.width,ie,he,Pe,je+(ce?0:3),y.A),r(C==he),f&&cn(oe)&&xo(Pe,je,ce,ie,he,y.A)}return 0}function Mr(f){var y=f.ma,C=y.ba.S,L=11>C,X=C==Ci||C==lr||C==Zr||C==sl||C==12||cn(C);if(y.memory=null,y.Ib=null,y.Jb=null,y.Nd=null,!Ks(y.Oa,f,X?11:12))return 0;if(X&&cn(C)&&pa(),f.da)alert("todo:use_scaling");else{if(L){if(y.Ib=ir,f.Kb){if(C=f.U+1>>1,y.memory=d(f.U+2*C),y.memory==null)return 0;y.ec=y.memory,y.fc=0,y.cc=y.ec,y.dc=y.fc+f.U,y.Mc=y.cc,y.Nc=y.dc+C,y.Ib=Dn,pa()}}else alert("todo:EmitYUV");X&&(y.Jb=Cr,L&&Nr())}if(L&&!Zl){for(f=0;256>f;++f)ra[f]=89858*(f-128)+ks>>Ns,Da[f]=-22014*(f-128)+ks,Ga[f]=-45773*(f-128),vo[f]=113618*(f-128)+ks>>Ns;for(f=Er;f<$a;++f)y=76283*(f-16)+ks>>Ns,ds[f-Er]=Pr(y,255),Ra[f-Er]=Pr(y+8>>4,15);Zl=1}return 1}function Xt(f){var y=f.ma,C=f.U,L=f.T;return r(!(1&f.ka)),0>=C||0>=L?0:(C=y.Ib(f,y),y.Jb!=null&&y.Jb(f,y,C),y.Dc+=C,1)}function mr(f){f.ma.memory=null}function Ti(f,y,C,L){return k(f,8)!=47?0:(y[0]=k(f,14)+1,C[0]=k(f,14)+1,L[0]=k(f,1),k(f,3)!=0?0:!f.h)}function Ln(f,y){if(4>f)return f+1;var C=f-2>>1;return(2+(1&f)<<C)+k(y,C)+1}function Rt(f,y){return 120<y?y-120:1<=(C=((C=Ts[y-1])>>4)*f+(8-(15&C)))?C:1;var C}function Ht(f,y,C){var L=W(C),X=f[y+=255&L].g-8;return 0<X&&(Te(C,C.u+8),L=W(C),y+=f[y].value,y+=L&(1<<X)-1),Te(C,C.u+f[y].g),f[y].value}function tt(f,y,C){return C.g+=f.g,C.value+=f.value<<y>>>0,r(8>=C.g),f.g}function Bt(f,y,C){var L=f.xc;return r((y=L==0?0:f.vc[f.md*(C>>L)+(y>>L)])<f.Wb),f.Ya[y]}function pn(f,y,C,L){var X=f.ab,ie=f.c*y,oe=f.C;y=oe+y;var ce=C,he=L;for(L=f.Ta,C=f.Ua;0<X--;){var je=f.gc[X],Pe=oe,Ee=y,ke=ce,He=he,Je=(he=L,ce=C,je.Ea);switch(r(Pe<Ee),r(Ee<=je.nc),je.hc){case 2:ei(ke,He,(Ee-Pe)*Je,he,ce);break;case 0:var bt=Pe,et=Ee,yt=he,wt=ce,It=(en=je).Ea;bt==0&&(Ea(ke,He,null,null,1,yt,wt),fe(ke,He+1,0,0,It-1,yt,wt+1),He+=It,wt+=It,++bt);for(var zt=1<<en.b,wn=zt-1,un=ht(It,en.b),Sn=en.K,en=en.w+(bt>>en.b)*un;bt<et;){var hi=Sn,zr=en,Pn=1;for(Kl(ke,He,yt,wt-It,1,yt,wt);Pn<It;){var Ut=(Pn&~wn)+zt;Ut>It&&(Ut=It),(0,ga[hi[zr++]>>8&15])(ke,He+ +Pn,yt,wt+Pn-It,Ut-Pn,yt,wt+Pn),Pn=Ut}He+=It,wt+=It,++bt&wn||(en+=un)}Ee!=je.nc&&s(he,ce-Je,he,ce+(Ee-Pe-1)*Je,Je);break;case 1:for(Je=ke,et=He,It=(ke=je.Ea)-(wt=ke&~(yt=(He=1<<je.b)-1)),bt=ht(ke,je.b),zt=je.K,je=je.w+(Pe>>je.b)*bt;Pe<Ee;){for(wn=zt,un=je,Sn=new dn,en=et+wt,hi=et+ke;et<en;)it(wn[un++],Sn),Rc(Sn,Je,et,He,he,ce),et+=He,ce+=He;et<hi&&(it(wn[un++],Sn),Rc(Sn,Je,et,It,he,ce),et+=It,ce+=It),++Pe&yt||(je+=bt)}break;case 3:if(ke==he&&He==ce&&0<je.b){for(et=he,ke=Je=ce+(Ee-Pe)*Je-(wt=(Ee-Pe)*ht(je.Ea,je.b)),He=he,yt=ce,bt=[],wt=(It=wt)-1;0<=wt;--wt)bt[wt]=He[yt+wt];for(wt=It-1;0<=wt;--wt)et[ke+wt]=bt[wt];Ss(je,Pe,Ee,he,Je,he,ce)}else Ss(je,Pe,Ee,ke,He,he,ce)}ce=L,he=C}he!=C&&s(L,C,ce,he,ie)}function An(f,y){var C=f.V,L=f.Ba+f.c*f.C,X=y-f.C;if(r(y<=f.l.o),r(16>=X),0<X){var ie=f.l,oe=f.Ta,ce=f.Ua,he=ie.width;if(pn(f,X,C,L),X=ce=[ce],r((C=f.C)<(L=y)),r(ie.v<ie.va),L>ie.o&&(L=ie.o),C<ie.j){var je=ie.j-C;C=ie.j,X[0]+=je*he}if(C>=L?C=0:(X[0]+=4*ie.v,ie.ka=C-ie.j,ie.U=ie.va-ie.v,ie.T=L-C,C=1),C){if(ce=ce[0],11>(C=f.ca).S){var Pe=C.f.RGBA,Ee=(L=C.S,X=ie.U,ie=ie.T,je=Pe.eb,Pe.A),ke=ie;for(Pe=Pe.fb+f.Ma*Pe.A;0<ke--;){var He=oe,Je=ce,bt=X,et=je,yt=Pe;switch(L){case zi:Js(He,Je,bt,et,yt);break;case Ci:Sl(He,Je,bt,et,yt);break;case cs:Sl(He,Je,bt,et,yt),xo(et,yt,0,bt,1,0);break;case Lc:Tl(He,Je,bt,et,yt);break;case lr:ln(He,Je,bt,et,yt,1);break;case ta:ln(He,Je,bt,et,yt,1),xo(et,yt,0,bt,1,0);break;case Zr:ln(He,Je,bt,et,yt,0);break;case ll:ln(He,Je,bt,et,yt,0),xo(et,yt,1,bt,1,0);break;case sl:jl(He,Je,bt,et,yt);break;case eu:jl(He,Je,bt,et,yt),Ao(et,yt,bt,1,0);break;case Jr:go(He,Je,bt,et,yt);break;default:r(0)}ce+=he,Pe+=Ee}f.Ma+=ie}else alert("todo:EmitRescaledRowsYUVA");r(f.Ma<=C.height)}}f.C=y,r(f.C<=f.i)}function yn(f){var y;if(0<f.ua)return 0;for(y=0;y<f.Wb;++y){var C=f.Ya[y].G,L=f.Ya[y].H;if(0<C[1][L[1]+0].g||0<C[2][L[2]+0].g||0<C[3][L[3]+0].g)return 0}return 1}function $n(f,y,C,L,X,ie){if(f.Z!=0){var oe=f.qd,ce=f.rd;for(r(ba[f.Z]!=null);y<C;++y)ba[f.Z](oe,ce,L,X,L,X,ie),oe=L,ce=X,X+=ie;f.qd=oe,f.rd=ce}}function li(f,y){var C=f.l.ma,L=C.Z==0||C.Z==1?f.l.j:f.C;if(L=f.C<L?L:f.C,r(y<=f.l.o),y>L){var X=f.l.width,ie=C.ca,oe=C.tb+X*L,ce=f.V,he=f.Ba+f.c*L,je=f.gc;r(f.ab==1),r(je[0].hc==3),Qo(je[0],L,y,ce,he,ie,oe),$n(C,L,y,ie,oe,X)}f.C=f.Ma=y}function vi(f,y,C,L,X,ie,oe){var ce=f.$/L,he=f.$%L,je=f.m,Pe=f.s,Ee=C+f.$,ke=Ee;X=C+L*X;var He=C+L*ie,Je=280+Pe.ua,bt=f.Pb?ce:16777216,et=0<Pe.ua?Pe.Wa:null,yt=Pe.wc,wt=Ee<He?Bt(Pe,he,ce):null;r(f.C<ie),r(He<=X);var It=!1;e:for(;;){for(;It||Ee<He;){var zt=0;if(ce>=bt){var wn=Ee-C;r((bt=f).Pb),bt.wd=bt.m,bt.xd=wn,0<bt.s.ua&&ut(bt.s.Wa,bt.s.vb),bt=ce+Wa}if(he&yt||(wt=Bt(Pe,he,ce)),r(wt!=null),wt.Qb&&(y[Ee]=wt.qb,It=!0),!It)if(le(je),wt.jc){zt=je,wn=y;var un=Ee,Sn=wt.pd[W(zt)&ao-1];r(wt.jc),256>Sn.g?(Te(zt,zt.u+Sn.g),wn[un]=Sn.value,zt=0):(Te(zt,zt.u+Sn.g-256),r(256<=Sn.value),zt=Sn.value),zt==0&&(It=!0)}else zt=Ht(wt.G[0],wt.H[0],je);if(je.h)break;if(It||256>zt){if(!It)if(wt.nd)y[Ee]=(wt.qb|zt<<8)>>>0;else{if(le(je),It=Ht(wt.G[1],wt.H[1],je),le(je),wn=Ht(wt.G[2],wt.H[2],je),un=Ht(wt.G[3],wt.H[3],je),je.h)break;y[Ee]=(un<<24|It<<16|zt<<8|wn)>>>0}if(It=!1,++Ee,++he>=L&&(he=0,++ce,oe!=null&&ce<=ie&&!(ce%16)&&oe(f,ce),et!=null))for(;ke<Ee;)zt=y[ke++],et.X[(506832829*zt&4294967295)>>>et.Mb]=zt}else if(280>zt){if(zt=Ln(zt-256,je),wn=Ht(wt.G[4],wt.H[4],je),le(je),wn=Rt(L,wn=Ln(wn,je)),je.h)break;if(Ee-C<wn||X-Ee<zt)break e;for(un=0;un<zt;++un)y[Ee+un]=y[Ee+un-wn];for(Ee+=zt,he+=zt;he>=L;)he-=L,++ce,oe!=null&&ce<=ie&&!(ce%16)&&oe(f,ce);if(r(Ee<=X),he&yt&&(wt=Bt(Pe,he,ce)),et!=null)for(;ke<Ee;)zt=y[ke++],et.X[(506832829*zt&4294967295)>>>et.Mb]=zt}else{if(!(zt<Je))break e;for(It=zt-280,r(et!=null);ke<Ee;)zt=y[ke++],et.X[(506832829*zt&4294967295)>>>et.Mb]=zt;zt=Ee,r(!(It>>>(wn=et).Xa)),y[zt]=wn.X[It],It=!0}It||r(je.h==se(je))}if(f.Pb&&je.h&&Ee<X)r(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&ut(f.s.vb,f.s.Wa);else{if(je.h)break e;oe?.(f,ce>ie?ie:ce),f.a=0,f.$=Ee-C}return 1}return f.a=3,0}function qi(f){r(f!=null),f.vc=null,f.yc=null,f.Ya=null;var y=f.Wa;y!=null&&(y.X=null),f.vb=null,r(f!=null)}function Br(){var f=new on;return f==null?null:(f.a=0,f.xb=Mc,mt("Predictor","VP8LPredictors"),mt("Predictor","VP8LPredictors_C"),mt("PredictorAdd","VP8LPredictorsAdd"),mt("PredictorAdd","VP8LPredictorsAdd_C"),ei=lt,Rc=$e,Js=Ot,Sl=Vt,jl=jt,go=Ft,Tl=tn,U.VP8LMapColor32b=Bi,U.VP8LMapColor8b=Vo,f)}function Ja(f,y,C,L,X){var ie=1,oe=[f],ce=[y],he=L.m,je=L.s,Pe=null,Ee=0;e:for(;;){if(C)for(;ie&&k(he,1);){var ke=oe,He=ce,Je=L,bt=1,et=Je.m,yt=Je.gc[Je.ab],wt=k(et,2);if(Je.Oc&1<<wt)ie=0;else{switch(Je.Oc|=1<<wt,yt.hc=wt,yt.Ea=ke[0],yt.nc=He[0],yt.K=[null],++Je.ab,r(4>=Je.ab),wt){case 0:case 1:yt.b=k(et,3)+2,bt=Ja(ht(yt.Ea,yt.b),ht(yt.nc,yt.b),0,Je,yt.K),yt.K=yt.K[0];break;case 3:var It,zt=k(et,8)+1,wn=16<zt?0:4<zt?1:2<zt?2:3;if(ke[0]=ht(yt.Ea,wn),yt.b=wn,It=bt=Ja(zt,1,0,Je,yt.K)){var un,Sn=zt,en=yt,hi=1<<(8>>en.b),zr=d(hi);if(zr==null)It=0;else{var Pn=en.K[0],Ut=en.w;for(zr[0]=en.K[0][0],un=1;un<1*Sn;++un)zr[un]=Qe(Pn[Ut+un],zr[un-1]);for(;un<4*hi;++un)zr[un]=0;en.K[0]=null,en.K[0]=zr,It=1}}bt=It;break;case 2:break;default:r(0)}ie=bt}}if(oe=oe[0],ce=ce[0],ie&&k(he,1)&&!(ie=1<=(Ee=k(he,4))&&11>=Ee)){L.a=3;break e}var Kt;if(Kt=ie)t:{var ar,Xn,gi,Ji=L,_i=oe,ur=ce,$i=Ee,Dr=C,eo=Ji.m,Sr=Ji.s,ii=[null],Gi=1,hr=0,ai=na[$i];n:for(;;){if(Dr&&k(eo,1)){var Qi=k(eo,3)+2,ji=ht(_i,Qi),yi=ht(ur,Qi),Yi=ji*yi;if(!Ja(ji,yi,0,Ji,ii))break n;for(ii=ii[0],Sr.xc=Qi,ar=0;ar<Yi;++ar){var Ui=ii[ar]>>8&65535;ii[ar]=Ui,Ui>=Gi&&(Gi=Ui+1)}}if(eo.h)break n;for(Xn=0;5>Xn;++Xn){var Rr=cl[Xn];!Xn&&0<$i&&(Rr+=1<<$i),hr<Rr&&(hr=Rr)}var lo=v(Gi*ai,Z),jr=Gi,si=v(jr,we);if(si==null)var Do=null;else r(65536>=jr),Do=si;var qr=d(hr);if(Do==null||qr==null||lo==null){Ji.a=1;break n}var Bn=lo;for(ar=gi=0;ar<Gi;++ar){var In=Do[ar],Fi=In.G,La=In.H,co=0,Ro=1,to=0;for(Xn=0;5>Xn;++Xn){Rr=cl[Xn],Fi[Xn]=Bn,La[Xn]=gi,!Xn&&0<$i&&(Rr+=1<<$i);r:{var dl,zl=Rr,bc=Ji,Tr=qr,vc=Bn,fl=gi,Oc=0,Ya=bc.m,Hu=k(Ya,1);if(l(Tr,0,0,zl),Hu){var pl=k(Ya,1)+1,Jl=k(Ya,1),Ql=k(Ya,Jl==0?1:8);Tr[Ql]=1,pl==2&&(Tr[Ql=k(Ya,8)]=1);var Lo=1}else{var Vr=d(19),ec=k(Ya,4)+4;if(19<ec){bc.a=3;var hl=0;break r}for(dl=0;dl<ec;++dl)Vr[Nl[dl]]=k(Ya,3);var tc=void 0,nc=void 0,Xa=bc,ic=Vr,rc=zl,Uc=Tr,wc=0,tl=Xa.m,Wu=8,gl=v(128,Z);i:for(;R(gl,0,7,ic,19);){if(k(tl,1)){var mu=2+2*k(tl,3);if((tc=2+k(tl,mu))>rc)break i}else tc=rc;for(nc=0;nc<rc&&tc--;){le(tl);var oc=gl[0+(127&W(tl))];Te(tl,tl.u+oc.g);var Pl=oc.value;if(16>Pl)Uc[nc++]=Pl,Pl!=0&&(Wu=Pl);else{var $u=Pl==16,nu=Pl-16,Gu=us[nu],ac=k(tl,js[nu])+Gu;if(nc+ac>rc)break i;for(var bu=$u?Wu:0;0<ac--;)Uc[nc++]=bu}}wc=1;break i}wc||(Xa.a=3),Lo=wc}(Lo=Lo&&!Ya.h)&&(Oc=R(vc,fl,8,Tr,zl)),Lo&&Oc!=0?hl=Oc:(bc.a=3,hl=0)}if(hl==0)break n;if(Ro&&Ic[Xn]==1&&(Ro=Bn[gi].g==0),co+=Bn[gi].g,gi+=hl,3>=Xn){var sc,iu=qr[0];for(sc=1;sc<Rr;++sc)qr[sc]>iu&&(iu=qr[sc]);to+=iu}}if(In.nd=Ro,In.Qb=0,Ro&&(In.qb=(Fi[3][La[3]+0].value<<24|Fi[1][La[1]+0].value<<16|Fi[2][La[2]+0].value)>>>0,co==0&&256>Fi[0][La[0]+0].value&&(In.Qb=1,In.qb+=Fi[0][La[0]+0].value<<8)),In.jc=!In.Qb&&6>to,In.jc){var lc,As=In;for(lc=0;lc<ao;++lc){var fs=lc,Is=As.pd[fs],cc=As.G[0][As.H[0]+fs];256<=cc.value?(Is.g=cc.g+256,Is.value=cc.value):(Is.g=0,Is.value=0,fs>>=tt(cc,8,Is),fs>>=tt(As.G[1][As.H[1]+fs],16,Is),fs>>=tt(As.G[2][As.H[2]+fs],0,Is),tt(As.G[3][As.H[3]+fs],24,Is))}}}Sr.vc=ii,Sr.Wb=Gi,Sr.Ya=Do,Sr.yc=lo,Kt=1;break t}Kt=0}if(!(ie=Kt)){L.a=3;break e}if(0<Ee){if(je.ua=1<<Ee,!ye(je.Wa,Ee)){L.a=1,ie=0;break e}}else je.ua=0;var vu=L,Ms=oe,vd=ce,Bs=vu.s,Ka=Bs.xc;if(vu.c=Ms,vu.i=vd,Bs.md=ht(Ms,Ka),Bs.wc=Ka==0?-1:(1<<Ka)-1,C){L.xb=ma;break e}if((Pe=d(oe*ce))==null){L.a=1,ie=0;break e}ie=(ie=vi(L,Pe,0,oe,ce,ce,null))&&!he.h;break e}return ie?(X!=null?X[0]=Pe:(r(Pe==null),r(C)),L.$=0,C||qi(je)):qi(je),ie}function Qa(f,y){var C=f.c*f.i,L=C+y+16*y;return r(f.c<=y),f.V=d(L),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+C+y,1)}function Ia(f,y){var C=f.C,L=y-C,X=f.V,ie=f.Ba+f.c*C;for(r(y<=f.l.o);0<L;){var oe=16<L?16:L,ce=f.l.ma,he=f.l.width,je=he*oe,Pe=ce.ca,Ee=ce.tb+he*C,ke=f.Ta,He=f.Ua;pn(f,oe,X,ie),ya(ke,He,Pe,Ee,je),$n(ce,C,C+oe,Pe,Ee,he),L-=oe,X+=oe*f.c,C+=oe}r(C==y),f.C=f.Ma=y}function Go(){this.ub=this.yd=this.td=this.Rb=0}function Ca(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function di(){this.Fb=this.Bb=this.Cb=0,this.Zb=d(4),this.Lb=d(4)}function To(){this.Yb=(function(){var f=[];return(function y(C,L,X){for(var ie=X[L],oe=0;oe<ie&&(C.push(X.length>L+1?[]:0),!(X.length<L+1));oe++)y(C[oe],L+1,X)})(f,0,[3,11]),f})()}function Gn(){this.jb=d(3),this.Wc=p([4,8],To),this.Xc=p([4,17],To)}function gs(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new d(4),this.od=new d(4)}function fi(){this.ld=this.La=this.dd=this.tc=0}function Uo(){this.Na=this.la=0}function Di(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function _s(){this.ad=d(384),this.Za=0,this.Ob=d(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function es(){this.uc=this.M=this.Nb=0,this.wa=Array(new fi),this.Y=0,this.ya=Array(new _s),this.aa=0,this.l=new Gs}function ts(){this.y=d(16),this.f=d(8),this.ea=d(8)}function ys(){this.cb=this.a=0,this.sc="",this.m=new A,this.Od=new Go,this.Kc=new Ca,this.ed=new gs,this.Qa=new di,this.Ic=this.$c=this.Aa=0,this.D=new es,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=v(8,A),this.ia=0,this.pb=v(4,Di),this.Pa=new Gn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ts),this.Hd=0,this.rb=Array(new Uo),this.sb=0,this.wa=Array(new fi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new _s),this.L=this.aa=0,this.gd=p([4,2],fi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Pr(f,y){return 0>f?0:f>y?y:f}function Gs(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function br(){var f=new ys;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,_a||(_a=ns)),f}function Ii(f,y,C){return f.a==0&&(f.a=y,f.sc=C,f.cb=0),0}function pi(f,y,C){return 3<=C&&f[y+0]==157&&f[y+1]==1&&f[y+2]==42}function dr(f,y){if(f==null)return 0;if(f.a=0,f.sc="OK",y==null)return Ii(f,2,"null VP8Io passed to VP8GetHeaders()");var C=y.data,L=y.w,X=y.ha;if(4>X)return Ii(f,7,"Truncated header.");var ie=C[L+0]|C[L+1]<<8|C[L+2]<<16,oe=f.Od;if(oe.Rb=!(1&ie),oe.td=ie>>1&7,oe.yd=ie>>4&1,oe.ub=ie>>5,3<oe.td)return Ii(f,3,"Incorrect keyframe parameters.");if(!oe.yd)return Ii(f,4,"Frame not displayable.");L+=3,X-=3;var ce=f.Kc;if(oe.Rb){if(7>X)return Ii(f,7,"cannot parse picture header");if(!pi(C,L,X))return Ii(f,3,"Bad code word");ce.c=16383&(C[L+4]<<8|C[L+3]),ce.Td=C[L+4]>>6,ce.i=16383&(C[L+6]<<8|C[L+5]),ce.Ud=C[L+6]>>6,L+=7,X-=7,f.za=ce.c+15>>4,f.Ub=ce.i+15>>4,y.width=ce.c,y.height=ce.i,y.Da=0,y.j=0,y.v=0,y.va=y.width,y.o=y.height,y.da=0,y.ib=y.width,y.hb=y.height,y.U=y.width,y.T=y.height,l((ie=f.Pa).jb,0,255,ie.jb.length),r((ie=f.Qa)!=null),ie.Cb=0,ie.Bb=0,ie.Fb=1,l(ie.Zb,0,0,ie.Zb.length),l(ie.Lb,0,0,ie.Lb)}if(oe.ub>X)return Ii(f,7,"bad partition length");te(ie=f.m,C,L,oe.ub),L+=oe.ub,X-=oe.ub,oe.Rb&&(ce.Ld=ve(ie),ce.Kd=ve(ie)),ce=f.Qa;var he,je=f.Pa;if(r(ie!=null),r(ce!=null),ce.Cb=ve(ie),ce.Cb){if(ce.Bb=ve(ie),ve(ie)){for(ce.Fb=ve(ie),he=0;4>he;++he)ce.Zb[he]=ve(ie)?Ce(ie,7):0;for(he=0;4>he;++he)ce.Lb[he]=ve(ie)?Ce(ie,6):0}if(ce.Bb)for(he=0;3>he;++he)je.jb[he]=ve(ie)?de(ie,8):255}else ce.Bb=0;if(ie.Ka)return Ii(f,3,"cannot parse segment header");if((ce=f.ed).zd=ve(ie),ce.Tb=de(ie,6),ce.wb=de(ie,3),ce.Pc=ve(ie),ce.Pc&&ve(ie)){for(je=0;4>je;++je)ve(ie)&&(ce.vd[je]=Ce(ie,6));for(je=0;4>je;++je)ve(ie)&&(ce.od[je]=Ce(ie,6))}if(f.L=ce.Tb==0?0:ce.zd?1:2,ie.Ka)return Ii(f,3,"cannot parse filter header");var Pe=X;if(X=he=L,L=he+Pe,ce=Pe,f.Xb=(1<<de(f.m,2))-1,Pe<3*(je=f.Xb))C=7;else{for(he+=3*je,ce-=3*je,Pe=0;Pe<je;++Pe){var Ee=C[X+0]|C[X+1]<<8|C[X+2]<<16;Ee>ce&&(Ee=ce),te(f.Jc[+Pe],C,he,Ee),he+=Ee,ce-=Ee,X+=3}te(f.Jc[+je],C,he,ce),C=he<L?0:5}if(C!=0)return Ii(f,C,"cannot parse partitions");for(C=de(he=f.m,7),X=ve(he)?Ce(he,4):0,L=ve(he)?Ce(he,4):0,ce=ve(he)?Ce(he,4):0,je=ve(he)?Ce(he,4):0,he=ve(he)?Ce(he,4):0,Pe=f.Qa,Ee=0;4>Ee;++Ee){if(Pe.Cb){var ke=Pe.Zb[Ee];Pe.Fb||(ke+=C)}else{if(0<Ee){f.pb[Ee]=f.pb[0];continue}ke=C}var He=f.pb[Ee];He.Sc[0]=mo[Pr(ke+X,127)],He.Sc[1]=Po[Pr(ke+0,127)],He.Eb[0]=2*mo[Pr(ke+L,127)],He.Eb[1]=101581*Po[Pr(ke+ce,127)]>>16,8>He.Eb[1]&&(He.Eb[1]=8),He.Qc[0]=mo[Pr(ke+je,117)],He.Qc[1]=Po[Pr(ke+he,127)],He.lc=ke+he}if(!oe.Rb)return Ii(f,4,"Not a key frame.");for(ve(ie),oe=f.Pa,C=0;4>C;++C){for(X=0;8>X;++X)for(L=0;3>L;++L)for(ce=0;11>ce;++ce)je=De(ie,Ar[C][X][L][ce])?de(ie,8):Vu[C][X][L][ce],oe.Wc[C][X].Yb[L][ce]=je;for(X=0;17>X;++X)oe.Xc[C][X]=oe.Wc[C][Vn[X]]}return f.kc=ve(ie),f.kc&&(f.Bd=de(ie,8)),f.cb=1}function ns(f,y,C,L,X,ie,oe){var ce=y[X].Yb[C];for(C=0;16>X;++X){if(!De(f,ce[C+0]))return X;for(;!De(f,ce[C+1]);)if(ce=y[++X].Yb[0],C=0,X==16)return 16;var he=y[X+1].Yb;if(De(f,ce[C+2])){var je=f,Pe=0;if(De(je,(ke=ce)[(Ee=C)+3]))if(De(je,ke[Ee+6])){for(ce=0,Ee=2*(Pe=De(je,ke[Ee+8]))+(ke=De(je,ke[Ee+9+Pe])),Pe=0,ke=tu[Ee];ke[ce];++ce)Pe+=Pe+De(je,ke[ce]);Pe+=3+(8<<Ee)}else De(je,ke[Ee+7])?(Pe=7+2*De(je,165),Pe+=De(je,145)):Pe=5+De(je,159);else Pe=De(je,ke[Ee+4])?3+De(je,ke[Ee+5]):2;ce=he[2]}else Pe=1,ce=he[1];he=oe+kl[X],0>(je=f).b&&_e(je);var Ee,ke=je.b,He=(Ee=je.Ca>>1)-(je.I>>ke)>>31;--je.b,je.Ca+=He,je.Ca|=1,je.I-=(Ee+1&He)<<ke,ie[he]=((Pe^He)-He)*L[(0<X)+0]}return 16}function Gl(f){var y=f.rb[f.sb-1];y.la=0,y.Na=0,l(f.zc,0,0,f.zc.length),f.ja=0}function po(f,y,C,L,X){X=f[y+C+32*L]+(X>>3),f[y+C+32*L]=-256&X?0>X?0:255:X}function io(f,y,C,L,X,ie){po(f,y,0,C,L+X),po(f,y,1,C,L+ie),po(f,y,2,C,L-ie),po(f,y,3,C,L-X)}function Vi(f){return(20091*f>>16)+f}function Yo(f,y,C,L){var X,ie=0,oe=d(16);for(X=0;4>X;++X){var ce=f[y+0]+f[y+8],he=f[y+0]-f[y+8],je=(35468*f[y+4]>>16)-Vi(f[y+12]),Pe=Vi(f[y+4])+(35468*f[y+12]>>16);oe[ie+0]=ce+Pe,oe[ie+1]=he+je,oe[ie+2]=he-je,oe[ie+3]=ce-Pe,ie+=4,y++}for(X=ie=0;4>X;++X)ce=(f=oe[ie+0]+4)+oe[ie+8],he=f-oe[ie+8],je=(35468*oe[ie+4]>>16)-Vi(oe[ie+12]),po(C,L,0,0,ce+(Pe=Vi(oe[ie+4])+(35468*oe[ie+12]>>16))),po(C,L,1,0,he+je),po(C,L,2,0,he-je),po(C,L,3,0,ce-Pe),ie++,L+=32}function Yl(f,y,C,L){var X=f[y+0]+4,ie=35468*f[y+4]>>16,oe=Vi(f[y+4]),ce=35468*f[y+1]>>16;io(C,L,0,X+oe,f=Vi(f[y+1]),ce),io(C,L,1,X+ie,f,ce),io(C,L,2,X-ie,f,ce),io(C,L,3,X-oe,f,ce)}function ca(f,y,C,L,X){Yo(f,y,C,L),X&&Yo(f,y+16,C,L+4)}function fr(f,y,C,L){qa(f,y+0,C,L,1),qa(f,y+32,C,L+128,1)}function Xl(f,y,C,L){var X;for(f=f[y+0]+4,X=0;4>X;++X)for(y=0;4>y;++y)po(C,L,y,X,f)}function Or(f,y,C,L){f[y+0]&&Ri(f,y+0,C,L),f[y+16]&&Ri(f,y+16,C,L+4),f[y+32]&&Ri(f,y+32,C,L+128),f[y+48]&&Ri(f,y+48,C,L+128+4)}function ki(f,y,C,L){var X,ie=d(16);for(X=0;4>X;++X){var oe=f[y+0+X]+f[y+12+X],ce=f[y+4+X]+f[y+8+X],he=f[y+4+X]-f[y+8+X],je=f[y+0+X]-f[y+12+X];ie[0+X]=oe+ce,ie[8+X]=oe-ce,ie[4+X]=je+he,ie[12+X]=je-he}for(X=0;4>X;++X)oe=(f=ie[0+4*X]+3)+ie[3+4*X],ce=ie[1+4*X]+ie[2+4*X],he=ie[1+4*X]-ie[2+4*X],je=f-ie[3+4*X],C[L+0]=oe+ce>>3,C[L+16]=je+he>>3,C[L+32]=oe-ce>>3,C[L+48]=je-he>>3,L+=64}function rl(f,y,C){var L,X=y-32,ie=ea,oe=255-f[X-1];for(L=0;L<C;++L){var ce,he=ie,je=oe+f[y-1];for(ce=0;ce<C;++ce)f[y+ce]=he[je+f[X+ce]];y+=32}}function Ma(f,y){rl(f,y,4)}function Fo(f,y){rl(f,y,8)}function xs(f,y){rl(f,y,16)}function Na(f,y){var C;for(C=0;16>C;++C)s(f,y+32*C,f,y-32,16)}function Xo(f,y){var C;for(C=16;0<C;--C)l(f,y,f[y-1],16),y+=32}function $r(f,y,C){var L;for(L=0;16>L;++L)l(y,C+32*L,f,16)}function pr(f,y){var C,L=16;for(C=0;16>C;++C)L+=f[y-1+32*C]+f[y+C-32];$r(L>>5,f,y)}function ms(f,y){var C,L=8;for(C=0;16>C;++C)L+=f[y-1+32*C];$r(L>>4,f,y)}function Ba(f,y){var C,L=8;for(C=0;16>C;++C)L+=f[y+C-32];$r(L>>4,f,y)}function Ys(f,y){$r(128,f,y)}function zn(f,y,C){return f+2*y+C+2>>2}function Tt(f,y){var C,L=y-32;for(L=new Uint8Array([zn(f[L-1],f[L+0],f[L+1]),zn(f[L+0],f[L+1],f[L+2]),zn(f[L+1],f[L+2],f[L+3]),zn(f[L+2],f[L+3],f[L+4])]),C=0;4>C;++C)s(f,y+32*C,L,0,L.length)}function Qn(f,y){var C=f[y-1],L=f[y-1+32],X=f[y-1+64],ie=f[y-1+96];Xe(f,y+0,16843009*zn(f[y-1-32],C,L)),Xe(f,y+32,16843009*zn(C,L,X)),Xe(f,y+64,16843009*zn(L,X,ie)),Xe(f,y+96,16843009*zn(X,ie,ie))}function Oa(f,y){var C,L=4;for(C=0;4>C;++C)L+=f[y+C-32]+f[y-1+32*C];for(L>>=3,C=0;4>C;++C)l(f,y+32*C,L,4)}function ua(f,y){var C=f[y-1+0],L=f[y-1+32],X=f[y-1+64],ie=f[y-1-32],oe=f[y+0-32],ce=f[y+1-32],he=f[y+2-32],je=f[y+3-32];f[y+0+96]=zn(L,X,f[y-1+96]),f[y+1+96]=f[y+0+64]=zn(C,L,X),f[y+2+96]=f[y+1+64]=f[y+0+32]=zn(ie,C,L),f[y+3+96]=f[y+2+64]=f[y+1+32]=f[y+0+0]=zn(oe,ie,C),f[y+3+64]=f[y+2+32]=f[y+1+0]=zn(ce,oe,ie),f[y+3+32]=f[y+2+0]=zn(he,ce,oe),f[y+3+0]=zn(je,he,ce)}function vn(f,y){var C=f[y+1-32],L=f[y+2-32],X=f[y+3-32],ie=f[y+4-32],oe=f[y+5-32],ce=f[y+6-32],he=f[y+7-32];f[y+0+0]=zn(f[y+0-32],C,L),f[y+1+0]=f[y+0+32]=zn(C,L,X),f[y+2+0]=f[y+1+32]=f[y+0+64]=zn(L,X,ie),f[y+3+0]=f[y+2+32]=f[y+1+64]=f[y+0+96]=zn(X,ie,oe),f[y+3+32]=f[y+2+64]=f[y+1+96]=zn(ie,oe,ce),f[y+3+64]=f[y+2+96]=zn(oe,ce,he),f[y+3+96]=zn(ce,he,he)}function jn(f,y){var C=f[y-1+0],L=f[y-1+32],X=f[y-1+64],ie=f[y-1-32],oe=f[y+0-32],ce=f[y+1-32],he=f[y+2-32],je=f[y+3-32];f[y+0+0]=f[y+1+64]=ie+oe+1>>1,f[y+1+0]=f[y+2+64]=oe+ce+1>>1,f[y+2+0]=f[y+3+64]=ce+he+1>>1,f[y+3+0]=he+je+1>>1,f[y+0+96]=zn(X,L,C),f[y+0+64]=zn(L,C,ie),f[y+0+32]=f[y+1+96]=zn(C,ie,oe),f[y+1+32]=f[y+2+96]=zn(ie,oe,ce),f[y+2+32]=f[y+3+96]=zn(oe,ce,he),f[y+3+32]=zn(ce,he,je)}function ol(f,y){var C=f[y+0-32],L=f[y+1-32],X=f[y+2-32],ie=f[y+3-32],oe=f[y+4-32],ce=f[y+5-32],he=f[y+6-32],je=f[y+7-32];f[y+0+0]=C+L+1>>1,f[y+1+0]=f[y+0+64]=L+X+1>>1,f[y+2+0]=f[y+1+64]=X+ie+1>>1,f[y+3+0]=f[y+2+64]=ie+oe+1>>1,f[y+0+32]=zn(C,L,X),f[y+1+32]=f[y+0+96]=zn(L,X,ie),f[y+2+32]=f[y+1+96]=zn(X,ie,oe),f[y+3+32]=f[y+2+96]=zn(ie,oe,ce),f[y+3+64]=zn(oe,ce,he),f[y+3+96]=zn(ce,he,je)}function Eo(f,y){var C=f[y-1+0],L=f[y-1+32],X=f[y-1+64],ie=f[y-1+96];f[y+0+0]=C+L+1>>1,f[y+2+0]=f[y+0+32]=L+X+1>>1,f[y+2+32]=f[y+0+64]=X+ie+1>>1,f[y+1+0]=zn(C,L,X),f[y+3+0]=f[y+1+32]=zn(L,X,ie),f[y+3+32]=f[y+1+64]=zn(X,ie,ie),f[y+3+64]=f[y+2+64]=f[y+0+96]=f[y+1+96]=f[y+2+96]=f[y+3+96]=ie}function En(f,y){var C=f[y-1+0],L=f[y-1+32],X=f[y-1+64],ie=f[y-1+96],oe=f[y-1-32],ce=f[y+0-32],he=f[y+1-32],je=f[y+2-32];f[y+0+0]=f[y+2+32]=C+oe+1>>1,f[y+0+32]=f[y+2+64]=L+C+1>>1,f[y+0+64]=f[y+2+96]=X+L+1>>1,f[y+0+96]=ie+X+1>>1,f[y+3+0]=zn(ce,he,je),f[y+2+0]=zn(oe,ce,he),f[y+1+0]=f[y+3+32]=zn(C,oe,ce),f[y+1+32]=f[y+3+64]=zn(L,C,oe),f[y+1+64]=f[y+3+96]=zn(X,L,C),f[y+1+96]=zn(ie,X,L)}function mn(f,y){var C;for(C=0;8>C;++C)s(f,y+32*C,f,y-32,8)}function Ai(f,y){var C;for(C=0;8>C;++C)l(f,y,f[y-1],8),y+=32}function xn(f,y,C){var L;for(L=0;8>L;++L)l(y,C+32*L,f,8)}function wi(f,y){var C,L=8;for(C=0;8>C;++C)L+=f[y+C-32]+f[y-1+32*C];xn(L>>4,f,y)}function Tn(f,y){var C,L=4;for(C=0;8>C;++C)L+=f[y+C-32];xn(L>>3,f,y)}function Ko(f,y){var C,L=4;for(C=0;8>C;++C)L+=f[y-1+32*C];xn(L>>3,f,y)}function Jt(f,y){xn(128,f,y)}function ri(f,y,C){var L=f[y-C],X=f[y+0],ie=3*(X-L)+al[1020+f[y-2*C]-f[y+C]],oe=Ha[112+(ie+4>>3)];f[y-C]=ea[255+L+Ha[112+(ie+3>>3)]],f[y+0]=ea[255+X-oe]}function Qt(f,y,C,L){var X=f[y+0],ie=f[y+C];return Fr[255+f[y-2*C]-f[y-C]]>L||Fr[255+ie-X]>L}function Si(f,y,C,L){return 4*Fr[255+f[y-C]-f[y+0]]+Fr[255+f[y-2*C]-f[y+C]]<=L}function Ua(f,y,C,L,X){var ie=f[y-3*C],oe=f[y-2*C],ce=f[y-C],he=f[y+0],je=f[y+C],Pe=f[y+2*C],Ee=f[y+3*C];return 4*Fr[255+ce-he]+Fr[255+oe-je]>L?0:Fr[255+f[y-4*C]-ie]<=X&&Fr[255+ie-oe]<=X&&Fr[255+oe-ce]<=X&&Fr[255+Ee-Pe]<=X&&Fr[255+Pe-je]<=X&&Fr[255+je-he]<=X}function Fa(f,y,C,L){var X=2*L+1;for(L=0;16>L;++L)Si(f,y+L,C,X)&&ri(f,y+L,C)}function ro(f,y,C,L){var X=2*L+1;for(L=0;16>L;++L)Si(f,y+L*C,1,X)&&ri(f,y+L*C,1)}function ka(f,y,C,L){var X;for(X=3;0<X;--X)Fa(f,y+=4*C,C,L)}function bs(f,y,C,L){var X;for(X=3;0<X;--X)ro(f,y+=4,C,L)}function is(f,y,C,L,X,ie,oe,ce){for(ie=2*ie+1;0<X--;){if(Ua(f,y,C,ie,oe))if(Qt(f,y,C,ce))ri(f,y,C);else{var he=f,je=y,Pe=C,Ee=he[je-2*Pe],ke=he[je-Pe],He=he[je+0],Je=he[je+Pe],bt=he[je+2*Pe],et=27*(wt=al[1020+3*(He-ke)+al[1020+Ee-Je]])+63>>7,yt=18*wt+63>>7,wt=9*wt+63>>7;he[je-3*Pe]=ea[255+he[je-3*Pe]+wt],he[je-2*Pe]=ea[255+Ee+yt],he[je-Pe]=ea[255+ke+et],he[je+0]=ea[255+He-et],he[je+Pe]=ea[255+Je-yt],he[je+2*Pe]=ea[255+bt-wt]}y+=L}}function Xs(f,y,C,L,X,ie,oe,ce){for(ie=2*ie+1;0<X--;){if(Ua(f,y,C,ie,oe))if(Qt(f,y,C,ce))ri(f,y,C);else{var he=f,je=y,Pe=C,Ee=he[je-Pe],ke=he[je+0],He=he[je+Pe],Je=Ha[112+(4+(bt=3*(ke-Ee))>>3)],bt=Ha[112+(bt+3>>3)],et=Je+1>>1;he[je-2*Pe]=ea[255+he[je-2*Pe]+et],he[je-Pe]=ea[255+Ee+bt],he[je+0]=ea[255+ke-Je],he[je+Pe]=ea[255+He-et]}y+=L}}function Zc(f,y,C,L,X,ie){is(f,y,C,1,16,L,X,ie)}function vs(f,y,C,L,X,ie){is(f,y,1,C,16,L,X,ie)}function Jc(f,y,C,L,X,ie){var oe;for(oe=3;0<oe;--oe)Xs(f,y+=4*C,C,1,16,L,X,ie)}function j(f,y,C,L,X,ie){var oe;for(oe=3;0<oe;--oe)Xs(f,y+=4,1,C,16,L,X,ie)}function Q(f,y,C,L,X,ie,oe,ce){is(f,y,X,1,8,ie,oe,ce),is(C,L,X,1,8,ie,oe,ce)}function pe(f,y,C,L,X,ie,oe,ce){is(f,y,1,X,8,ie,oe,ce),is(C,L,1,X,8,ie,oe,ce)}function Me(f,y,C,L,X,ie,oe,ce){Xs(f,y+4*X,X,1,8,ie,oe,ce),Xs(C,L+4*X,X,1,8,ie,oe,ce)}function qe(f,y,C,L,X,ie,oe,ce){Xs(f,y+4,1,X,8,ie,oe,ce),Xs(C,L+4,1,X,8,ie,oe,ce)}function xt(){this.ba=new gn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new bn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function vt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Wt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Zt(){this.ua=0,this.Wa=new Gt,this.vb=new Gt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new we,this.yc=new Z}function on(){this.xb=this.a=0,this.l=new Gs,this.ca=new gn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new V,this.Pb=0,this.wd=new V,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Zt,this.ab=0,this.gc=v(4,Wt),this.Oc=0}function qn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Gs,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ci(f,y,C,L,X,ie,oe){for(f=f==null?0:f[y+0],y=0;y<oe;++y)X[ie+y]=f+C[L+y]&255,f=X[ie+y]}function Gr(f,y,C,L,X,ie,oe){var ce;if(f==null)ci(null,null,C,L,X,ie,oe);else for(ce=0;ce<oe;++ce)X[ie+ce]=f[y+ce]+C[L+ce]&255}function Mi(f,y,C,L,X,ie,oe){if(f==null)ci(null,null,C,L,X,ie,oe);else{var ce,he=f[y+0],je=he,Pe=he;for(ce=0;ce<oe;++ce)je=Pe+(he=f[y+ce])-je,Pe=C[L+ce]+(-256&je?0>je?0:255:je)&255,je=he,X[ie+ce]=Pe}}function vr(f,y,C,L){var X=y.width,ie=y.o;if(r(f!=null&&y!=null),0>C||0>=L||C+L>ie)return null;if(!f.Cc){if(f.ga==null){var oe;if(f.ga=new qn,(oe=f.ga==null)||(oe=y.width*y.o,r(f.Gb.length==0),f.Gb=d(oe),f.Uc=0,f.Gb==null?oe=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,oe=1),oe=!oe),!oe){oe=f.ga;var ce=f.Fa,he=f.P,je=f.qc,Pe=f.mb,Ee=f.nb,ke=he+1,He=je-1,Je=oe.l;if(r(ce!=null&&Pe!=null&&y!=null),ba[0]=null,ba[1]=ci,ba[2]=Gr,ba[3]=Mi,oe.ca=Pe,oe.tb=Ee,oe.c=y.width,oe.i=y.height,r(0<oe.c&&0<oe.i),1>=je)y=0;else if(oe.$a=3&ce[he+0],oe.Z=ce[he+0]>>2&3,oe.Lc=ce[he+0]>>4&3,he=ce[he+0]>>6&3,0>oe.$a||1<oe.$a||4<=oe.Z||1<oe.Lc||he)y=0;else if(Je.put=Xt,Je.ac=Mr,Je.bc=mr,Je.ma=oe,Je.width=y.width,Je.height=y.height,Je.Da=y.Da,Je.v=y.v,Je.va=y.va,Je.j=y.j,Je.o=y.o,oe.$a)e:{r(oe.$a==1),y=Br();t:for(;;){if(y==null){y=0;break e}if(r(oe!=null),oe.mc=y,y.c=oe.c,y.i=oe.i,y.l=oe.l,y.l.ma=oe,y.l.width=oe.c,y.l.height=oe.i,y.a=0,Re(y.m,ce,ke,He),!Ja(oe.c,oe.i,1,y,null)||(y.ab==1&&y.gc[0].hc==3&&yn(y.s)?(oe.ic=1,ce=y.c*y.i,y.Ta=null,y.Ua=0,y.V=d(ce),y.Ba=0,y.V==null?(y.a=1,y=0):y=1):(oe.ic=0,y=Qa(y,oe.c)),!y))break t;y=1;break e}oe.mc=null,y=0}else y=He>=oe.c*oe.i;oe=!y}if(oe)return null;f.ga.Lc!=1?f.Ga=0:L=ie-C}r(f.ga!=null),r(C+L<=ie);e:{if(y=(ce=f.ga).c,ie=ce.l.o,ce.$a==0){if(ke=f.rc,He=f.Vc,Je=f.Fa,he=f.P+1+C*y,je=f.mb,Pe=f.nb+C*y,r(he<=f.P+f.qc),ce.Z!=0)for(r(ba[ce.Z]!=null),oe=0;oe<L;++oe)ba[ce.Z](ke,He,Je,he,je,Pe,y),ke=je,He=Pe,Pe+=y,he+=y;else for(oe=0;oe<L;++oe)s(je,Pe,Je,he,y),ke=je,He=Pe,Pe+=y,he+=y;f.rc=ke,f.Vc=He}else{if(r(ce.mc!=null),y=C+L,r((oe=ce.mc)!=null),r(y<=oe.i),oe.C>=y)y=1;else if(ce.ic||Nr(),ce.ic){ce=oe.V,ke=oe.Ba,He=oe.c;var bt=oe.i,et=(Je=1,he=oe.$/He,je=oe.$%He,Pe=oe.m,Ee=oe.s,oe.$),yt=He*bt,wt=He*y,It=Ee.wc,zt=et<wt?Bt(Ee,je,he):null;r(et<=yt),r(y<=bt),r(yn(Ee));t:for(;;){for(;!Pe.h&&et<wt;){if(je&It||(zt=Bt(Ee,je,he)),r(zt!=null),le(Pe),256>(bt=Ht(zt.G[0],zt.H[0],Pe)))ce[ke+et]=bt,++et,++je>=He&&(je=0,++he<=y&&!(he%16)&&li(oe,he));else{if(!(280>bt)){Je=0;break t}bt=Ln(bt-256,Pe);var wn,un=Ht(zt.G[4],zt.H[4],Pe);if(le(Pe),!(et>=(un=Rt(He,un=Ln(un,Pe)))&&yt-et>=bt)){Je=0;break t}for(wn=0;wn<bt;++wn)ce[ke+et+wn]=ce[ke+et+wn-un];for(et+=bt,je+=bt;je>=He;)je-=He,++he<=y&&!(he%16)&&li(oe,he);et<wt&&je&It&&(zt=Bt(Ee,je,he))}r(Pe.h==se(Pe))}li(oe,he>y?y:he);break t}!Je||Pe.h&&et<yt?(Je=0,oe.a=Pe.h?5:3):oe.$=et,y=Je}else y=vi(oe,oe.V,oe.Ba,oe.c,oe.i,y,Ia);if(!y){L=0;break e}}C+L>=ie&&(f.Cc=1),L=1}if(!L)return null;if(f.Cc&&((L=f.ga)!=null&&(L.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+C*X}function wr(f,y,C,L,X,ie){for(;0<X--;){var oe,ce=f,he=y+(C?1:0),je=f,Pe=y+(C?0:3);for(oe=0;oe<L;++oe){var Ee=je[Pe+4*oe];Ee!=255&&(Ee*=32897,ce[he+4*oe+0]=ce[he+4*oe+0]*Ee>>23,ce[he+4*oe+1]=ce[he+4*oe+1]*Ee>>23,ce[he+4*oe+2]=ce[he+4*oe+2]*Ee>>23)}y+=ie}}function Co(f,y,C,L,X){for(;0<L--;){var ie;for(ie=0;ie<C;++ie){var oe=f[y+2*ie+0],ce=15&(je=f[y+2*ie+1]),he=4369*ce,je=(240&je|je>>4)*he>>16;f[y+2*ie+0]=(240&oe|oe>>4)*he>>16&240|(15&oe|oe<<4)*he>>16>>4&15,f[y+2*ie+1]=240&je|ce}y+=X}}function Ki(f,y,C,L,X,ie,oe,ce){var he,je,Pe=255;for(je=0;je<X;++je){for(he=0;he<L;++he){var Ee=f[y+he];ie[oe+4*he]=Ee,Pe&=Ee}y+=C,oe+=ce}return Pe!=255}function da(f,y,C,L,X){var ie;for(ie=0;ie<X;++ie)C[L+ie]=f[y+ie]>>8}function Nr(){xo=wr,Ao=Co,Xr=Ki,ya=da}function fa(f,y,C){U[f]=function(L,X,ie,oe,ce,he,je,Pe,Ee,ke,He,Je,bt,et,yt,wt,It){var zt,wn=It-1>>1,un=ce[he+0]|je[Pe+0]<<16,Sn=Ee[ke+0]|He[Je+0]<<16;r(L!=null);var en=3*un+Sn+131074>>2;for(y(L[X+0],255&en,en>>16,bt,et),ie!=null&&(en=3*Sn+un+131074>>2,y(ie[oe+0],255&en,en>>16,yt,wt)),zt=1;zt<=wn;++zt){var hi=ce[he+zt]|je[Pe+zt]<<16,zr=Ee[ke+zt]|He[Je+zt]<<16,Pn=un+hi+Sn+zr+524296,Ut=Pn+2*(hi+Sn)>>3;en=Ut+un>>1,un=(Pn=Pn+2*(un+zr)>>3)+hi>>1,y(L[X+2*zt-1],255&en,en>>16,bt,et+(2*zt-1)*C),y(L[X+2*zt-0],255&un,un>>16,bt,et+(2*zt-0)*C),ie!=null&&(en=Pn+Sn>>1,un=Ut+zr>>1,y(ie[oe+2*zt-1],255&en,en>>16,yt,wt+(2*zt-1)*C),y(ie[oe+2*zt+0],255&un,un>>16,yt,wt+(2*zt+0)*C)),un=hi,Sn=zr}1&It||(en=3*un+Sn+131074>>2,y(L[X+It-1],255&en,en>>16,bt,et+(It-1)*C),ie!=null&&(en=3*Sn+un+131074>>2,y(ie[oe+It-1],255&en,en>>16,yt,wt+(It-1)*C)))}}function pa(){_r[zi]=mc,_r[Ci]=Bc,_r[Lc]=yu,_r[lr]=xu,_r[Zr]=ul,_r[sl]=el,_r[Jr]=Al,_r[cs]=Bc,_r[ta]=xu,_r[ll]=ul,_r[eu]=el}function ws(f){return f&-16384?0>f?0:255:f>>bo}function Zo(f,y){return ws((19077*f>>8)+(26149*y>>8)-14234)}function Aa(f,y,C){return ws((19077*f>>8)-(6419*y>>8)-(13320*C>>8)+8708)}function oo(f,y){return ws((19077*f>>8)+(33050*y>>8)-17685)}function ha(f,y,C,L,X){L[X+0]=Zo(f,C),L[X+1]=Aa(f,y,C),L[X+2]=oo(f,y)}function Hi(f,y,C,L,X){L[X+0]=oo(f,y),L[X+1]=Aa(f,y,C),L[X+2]=Zo(f,C)}function za(f,y,C,L,X){var ie=Aa(f,y,C);y=ie<<3&224|oo(f,y)>>3,L[X+0]=248&Zo(f,C)|ie>>5,L[X+1]=y}function ho(f,y,C,L,X){var ie=240&oo(f,y)|15;L[X+0]=240&Zo(f,C)|Aa(f,y,C)>>4,L[X+1]=ie}function rs(f,y,C,L,X){L[X+0]=255,ha(f,y,C,L,X+1)}function Wi(f,y,C,L,X){Hi(f,y,C,L,X),L[X+3]=255}function Yr(f,y,C,L,X){ha(f,y,C,L,X),L[X+3]=255}function wl(f,y,C){U[f]=function(L,X,ie,oe,ce,he,je,Pe,Ee){for(var ke=Pe+(-2&Ee)*C;Pe!=ke;)y(L[X+0],ie[oe+0],ce[he+0],je,Pe),y(L[X+1],ie[oe+0],ce[he+0],je,Pe+C),X+=2,++oe,++he,Pe+=2*C;1&Ee&&y(L[X+0],ie[oe+0],ce[he+0],je,Pe)}}function Dc(f,y,C){return C==0?f==0?y==0?6:5:y==0?4:0:C}function Ds(f,y,C,L,X){switch(f>>>30){case 3:qa(y,C,L,X,0);break;case 2:rr(y,C,L,X);break;case 1:Ri(y,C,L,X)}}function Pa(f,y){var C,L,X=y.M,ie=y.Nb,oe=f.oc,ce=f.pc+40,he=f.oc,je=f.pc+584,Pe=f.oc,Ee=f.pc+600;for(C=0;16>C;++C)oe[ce+32*C-1]=129;for(C=0;8>C;++C)he[je+32*C-1]=129,Pe[Ee+32*C-1]=129;for(0<X?oe[ce-1-32]=he[je-1-32]=Pe[Ee-1-32]=129:(l(oe,ce-32-1,127,21),l(he,je-32-1,127,9),l(Pe,Ee-32-1,127,9)),L=0;L<f.za;++L){var ke=y.ya[y.aa+L];if(0<L){for(C=-1;16>C;++C)s(oe,ce+32*C-4,oe,ce+32*C+12,4);for(C=-1;8>C;++C)s(he,je+32*C-4,he,je+32*C+4,4),s(Pe,Ee+32*C-4,Pe,Ee+32*C+4,4)}var He=f.Gd,Je=f.Hd+L,bt=ke.ad,et=ke.Hc;if(0<X&&(s(oe,ce-32,He[Je].y,0,16),s(he,je-32,He[Je].f,0,8),s(Pe,Ee-32,He[Je].ea,0,8)),ke.Za){var yt=oe,wt=ce-32+16;for(0<X&&(L>=f.za-1?l(yt,wt,He[Je].y[15],4):s(yt,wt,He[Je+1].y,0,4)),C=0;4>C;C++)yt[wt+128+C]=yt[wt+256+C]=yt[wt+384+C]=yt[wt+0+C];for(C=0;16>C;++C,et<<=2)yt=oe,wt=ce+Li[C],Qr[ke.Ob[C]](yt,wt),Ds(et,bt,16*+C,yt,wt)}else if(yt=Dc(L,X,ke.Ob[0]),ia[yt](oe,ce),et!=0)for(C=0;16>C;++C,et<<=2)Ds(et,bt,16*+C,oe,ce+Li[C]);for(C=ke.Gc,yt=Dc(L,X,ke.Dd),xa[yt](he,je),xa[yt](Pe,Ee),et=bt,yt=he,wt=je,255&(ke=0|C)&&(170&ke?ss(et,256,yt,wt):Oi(et,256,yt,wt)),ke=Pe,et=Ee,255&(C>>=8)&&(170&C?ss(bt,320,ke,et):Oi(bt,320,ke,et)),X<f.Ub-1&&(s(He[Je].y,0,oe,ce+480,16),s(He[Je].f,0,he,je+224,8),s(He[Je].ea,0,Pe,Ee+224,8)),C=8*ie*f.B,He=f.sa,Je=f.ta+16*L+16*ie*f.R,bt=f.qa,ke=f.ra+8*L+C,et=f.Ha,yt=f.Ia+8*L+C,C=0;16>C;++C)s(He,Je+C*f.R,oe,ce+32*C,16);for(C=0;8>C;++C)s(bt,ke+C*f.B,he,je+32*C,8),s(et,yt+C*f.B,Pe,Ee+32*C,8)}}function os(f,y,C,L,X,ie,oe,ce,he){var je=[0],Pe=[0],Ee=0,ke=he!=null?he.kd:0,He=he??new vt;if(f==null||12>C)return 7;He.data=f,He.w=y,He.ha=C,y=[y],C=[C],He.gb=[He.gb];e:{var Je=y,bt=C,et=He.gb;if(r(f!=null),r(bt!=null),r(et!=null),et[0]=0,12<=bt[0]&&!o(f,Je[0],"RIFF")){if(o(f,Je[0]+8,"WEBP")){et=3;break e}var yt=qt(f,Je[0]+4);if(12>yt||4294967286<yt){et=3;break e}if(ke&&yt>bt[0]-8){et=7;break e}et[0]=yt,Je[0]+=12,bt[0]-=12}et=0}if(et!=0)return et;for(yt=0<He.gb[0],C=C[0];;){e:{var wt=f;bt=y,et=C;var It=je,zt=Pe,wn=Je=[0];if((en=Ee=[Ee])[0]=0,8>et[0])et=7;else{if(!o(wt,bt[0],"VP8X")){if(qt(wt,bt[0]+4)!=10){et=3;break e}if(18>et[0]){et=7;break e}var un=qt(wt,bt[0]+8),Sn=1+kt(wt,bt[0]+12);if(2147483648<=Sn*(wt=1+kt(wt,bt[0]+15))){et=3;break e}wn!=null&&(wn[0]=un),It!=null&&(It[0]=Sn),zt!=null&&(zt[0]=wt),bt[0]+=18,et[0]-=18,en[0]=1}et=0}}if(Ee=Ee[0],Je=Je[0],et!=0)return et;if(bt=!!(2&Je),!yt&&Ee)return 3;if(ie!=null&&(ie[0]=!!(16&Je)),oe!=null&&(oe[0]=bt),ce!=null&&(ce[0]=0),oe=je[0],Je=Pe[0],Ee&&bt&&he==null){et=0;break}if(4>C){et=7;break}if(yt&&Ee||!yt&&!Ee&&!o(f,y[0],"ALPH")){C=[C],He.na=[He.na],He.P=[He.P],He.Sa=[He.Sa];e:{un=f,et=y,yt=C;var en=He.gb;It=He.na,zt=He.P,wn=He.Sa,Sn=22,r(un!=null),r(yt!=null),wt=et[0];var hi=yt[0];for(r(It!=null),r(wn!=null),It[0]=null,zt[0]=null,wn[0]=0;;){if(et[0]=wt,yt[0]=hi,8>hi){et=7;break e}var zr=qt(un,wt+4);if(4294967286<zr){et=3;break e}var Pn=8+zr+1&-2;if(Sn+=Pn,0<en&&Sn>en){et=3;break e}if(!o(un,wt,"VP8 ")||!o(un,wt,"VP8L")){et=0;break e}if(hi[0]<Pn){et=7;break e}o(un,wt,"ALPH")||(It[0]=un,zt[0]=wt+8,wn[0]=zr),wt+=Pn,hi-=Pn}}if(C=C[0],He.na=He.na[0],He.P=He.P[0],He.Sa=He.Sa[0],et!=0)break}C=[C],He.Ja=[He.Ja],He.xa=[He.xa];e:if(en=f,et=y,yt=C,It=He.gb[0],zt=He.Ja,wn=He.xa,un=et[0],wt=!o(en,un,"VP8 "),Sn=!o(en,un,"VP8L"),r(en!=null),r(yt!=null),r(zt!=null),r(wn!=null),8>yt[0])et=7;else{if(wt||Sn){if(en=qt(en,un+4),12<=It&&en>It-12){et=3;break e}if(ke&&en>yt[0]-8){et=7;break e}zt[0]=en,et[0]+=8,yt[0]-=8,wn[0]=Sn}else wn[0]=5<=yt[0]&&en[un+0]==47&&!(en[un+4]>>5),zt[0]=yt[0];et=0}if(C=C[0],He.Ja=He.Ja[0],He.xa=He.xa[0],y=y[0],et!=0)break;if(4294967286<He.Ja)return 3;if(ce==null||bt||(ce[0]=He.xa?2:1),oe=[oe],Je=[Je],He.xa){if(5>C){et=7;break}ce=oe,ke=Je,bt=ie,f==null||5>C?f=0:5<=C&&f[y+0]==47&&!(f[y+4]>>5)?(yt=[0],en=[0],It=[0],Re(zt=new V,f,y,C),Ti(zt,yt,en,It)?(ce!=null&&(ce[0]=yt[0]),ke!=null&&(ke[0]=en[0]),bt!=null&&(bt[0]=It[0]),f=1):f=0):f=0}else{if(10>C){et=7;break}ce=Je,f==null||10>C||!pi(f,y+3,C-3)?f=0:(ke=f[y+0]|f[y+1]<<8|f[y+2]<<16,bt=16383&(f[y+7]<<8|f[y+6]),f=16383&(f[y+9]<<8|f[y+8]),1&ke||3<(ke>>1&7)||!(ke>>4&1)||ke>>5>=He.Ja||!bt||!f?f=0:(oe&&(oe[0]=bt),ce&&(ce[0]=f),f=1))}if(!f||(oe=oe[0],Je=Je[0],Ee&&(je[0]!=oe||Pe[0]!=Je)))return 3;he!=null&&(he[0]=He,he.offset=y-he.w,r(4294967286>y-he.w),r(he.offset==he.ha-C));break}return et==0||et==7&&Ee&&he==null?(ie!=null&&(ie[0]|=He.na!=null&&0<He.na.length),L!=null&&(L[0]=oe),X!=null&&(X[0]=Je),0):et}function Ks(f,y,C){var L=y.width,X=y.height,ie=0,oe=0,ce=L,he=X;if(y.Da=f!=null&&0<f.Da,y.Da&&(ce=f.cd,he=f.bd,ie=f.v,oe=f.j,11>C||(ie&=-2,oe&=-2),0>ie||0>oe||0>=ce||0>=he||ie+ce>L||oe+he>X))return 0;if(y.v=ie,y.j=oe,y.va=ie+ce,y.o=oe+he,y.U=ce,y.T=he,y.da=f!=null&&0<f.da,y.da){if(!Et(ce,he,C=[f.ib],ie=[f.hb]))return 0;y.ib=C[0],y.hb=ie[0]}return y.ob=f!=null&&f.ob,y.Kb=f==null||!f.Sd,y.da&&(y.ob=y.ib<3*L/4&&y.hb<3*X/4,y.Kb=0),1}function No(f){if(f==null)return 2;if(11>f.S){var y=f.f.RGBA;y.fb+=(f.height-1)*y.A,y.A=-y.A}else y=f.f.kb,f=f.height,y.O+=(f-1)*y.fa,y.fa=-y.fa,y.N+=(f-1>>1)*y.Ab,y.Ab=-y.Ab,y.W+=(f-1>>1)*y.Db,y.Db=-y.Db,y.F!=null&&(y.J+=(f-1)*y.lb,y.lb=-y.lb);return 0}function as(f,y,C,L){if(L==null||0>=f||0>=y)return 2;if(C!=null){if(C.Da){var X=C.cd,ie=C.bd,oe=-2&C.v,ce=-2&C.j;if(0>oe||0>ce||0>=X||0>=ie||oe+X>f||ce+ie>y)return 2;f=X,y=ie}if(C.da){if(!Et(f,y,X=[C.ib],ie=[C.hb]))return 2;f=X[0],y=ie[0]}}L.width=f,L.height=y;e:{var he=L.width,je=L.height;if(f=L.S,0>=he||0>=je||!(f>=zi&&13>f))f=2;else{if(0>=L.Rd&&L.sd==null){oe=ie=X=y=0;var Pe=(ce=he*va[f])*je;if(11>f||(ie=(je+1)/2*(y=(he+1)/2),f==12&&(oe=(X=he)*je)),(je=d(Pe+2*ie+oe))==null){f=1;break e}L.sd=je,11>f?((he=L.f.RGBA).eb=je,he.fb=0,he.A=ce,he.size=Pe):((he=L.f.kb).y=je,he.O=0,he.fa=ce,he.Fd=Pe,he.f=je,he.N=0+Pe,he.Ab=y,he.Cd=ie,he.ea=je,he.W=0+Pe+ie,he.Db=y,he.Ed=ie,f==12&&(he.F=je,he.J=0+Pe+2*ie),he.Tc=oe,he.lb=X)}if(y=1,X=L.S,ie=L.width,oe=L.height,X>=zi&&13>X)if(11>X)f=L.f.RGBA,y&=(ce=Math.abs(f.A))*(oe-1)+ie<=f.size,y&=ce>=ie*va[X],y&=f.eb!=null;else{f=L.f.kb,ce=(ie+1)/2,Pe=(oe+1)/2,he=Math.abs(f.fa),je=Math.abs(f.Ab);var Ee=Math.abs(f.Db),ke=Math.abs(f.lb),He=ke*(oe-1)+ie;y&=he*(oe-1)+ie<=f.Fd,y&=je*(Pe-1)+ce<=f.Cd,y=(y&=Ee*(Pe-1)+ce<=f.Ed)&he>=ie&je>=ce&Ee>=ce,y&=f.y!=null,y&=f.f!=null,y&=f.ea!=null,X==12&&(y&=ke>=ie,y&=He<=f.Tc,y&=f.F!=null)}else y=0;f=y?0:2}}return f!=0||C!=null&&C.fd&&(f=No(L)),f}var ao=64,qo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ur=24,Rs=32,Jo=8,Zs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];$t("Predictor0","PredictorAdd0"),U.Predictor0=function(){return 4278190080},U.Predictor1=function(f){return f},U.Predictor2=function(f,y,C){return y[C+0]},U.Predictor3=function(f,y,C){return y[C+1]},U.Predictor4=function(f,y,C){return y[C-1]},U.Predictor5=function(f,y,C){return rn(rn(f,y[C+1]),y[C+0])},U.Predictor6=function(f,y,C){return rn(f,y[C-1])},U.Predictor7=function(f,y,C){return rn(f,y[C+0])},U.Predictor8=function(f,y,C){return rn(y[C-1],y[C+0])},U.Predictor9=function(f,y,C){return rn(y[C+0],y[C+1])},U.Predictor10=function(f,y,C){return rn(rn(f,y[C-1]),rn(y[C+0],y[C+1]))},U.Predictor11=function(f,y,C){var L=y[C+0];return 0>=Be(L>>24&255,f>>24&255,(y=y[C-1])>>24&255)+Be(L>>16&255,f>>16&255,y>>16&255)+Be(L>>8&255,f>>8&255,y>>8&255)+Be(255&L,255&f,255&y)?L:f},U.Predictor12=function(f,y,C){var L=y[C+0];return(kn((f>>24&255)+(L>>24&255)-((y=y[C-1])>>24&255))<<24|kn((f>>16&255)+(L>>16&255)-(y>>16&255))<<16|kn((f>>8&255)+(L>>8&255)-(y>>8&255))<<8|kn((255&f)+(255&L)-(255&y)))>>>0},U.Predictor13=function(f,y,C){var L=y[C-1];return(Fn((f=rn(f,y[C+0]))>>24&255,L>>24&255)<<24|Fn(f>>16&255,L>>16&255)<<16|Fn(f>>8&255,L>>8&255)<<8|Fn(255&f,255&L))>>>0};var Ea=U.PredictorAdd0;U.PredictorAdd1=fe,$t("Predictor2","PredictorAdd2"),$t("Predictor3","PredictorAdd3"),$t("Predictor4","PredictorAdd4"),$t("Predictor5","PredictorAdd5"),$t("Predictor6","PredictorAdd6"),$t("Predictor7","PredictorAdd7"),$t("Predictor8","PredictorAdd8"),$t("Predictor9","PredictorAdd9"),$t("Predictor10","PredictorAdd10"),$t("Predictor11","PredictorAdd11"),$t("Predictor12","PredictorAdd12"),$t("Predictor13","PredictorAdd13");var Kl=U.PredictorAdd2;at("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),at("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var ei,Ss=U.ColorIndexInverseTransform,Bi=U.MapARGB,Qo=U.VP8LColorIndexInverseTransformAlpha,Vo=U.MapAlpha,ga=U.VP8LPredictorsAdd=[];ga.length=16,(U.VP8LPredictors=[]).length=16,(U.VP8LPredictorsAdd_C=[]).length=16,(U.VP8LPredictors_C=[]).length=16;var Rc,Js,Sl,jl,go,Tl,Ho,qa,rr,ss,Ri,Oi,or,yo,ls,Qs,xc,Qc,qu,Va,so,Cl,ko,Ls,xo,Ao,Xr,ya,Zi=d(511),oi=d(2041),kr=d(225),Kr=d(767),zo=0,al=oi,Ha=kr,ea=Kr,Fr=Zi,zi=0,Ci=1,Lc=2,lr=3,Zr=4,sl=5,Jr=6,cs=7,ta=8,ll=9,eu=10,js=[2,3,7],us=[3,3,11],cl=[280,256,256,256,40],Ic=[0,1,1,1,0],Nl=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Ts=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],na=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Wa=8,mo=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Po=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],_a=null,tu=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],kl=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Cs=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Vu=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],cr=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Ar=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Vn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ia=[],Qr=[],xa=[],ma=1,Mc=2,ba=[],_r=[];fa("UpsampleRgbLinePair",ha,3),fa("UpsampleBgrLinePair",Hi,3),fa("UpsampleRgbaLinePair",Yr,4),fa("UpsampleBgraLinePair",Wi,4),fa("UpsampleArgbLinePair",rs,4),fa("UpsampleRgba4444LinePair",ho,2),fa("UpsampleRgb565LinePair",za,2);var mc=U.UpsampleRgbLinePair,yu=U.UpsampleBgrLinePair,Bc=U.UpsampleRgbaLinePair,xu=U.UpsampleBgraLinePair,ul=U.UpsampleArgbLinePair,el=U.UpsampleRgba4444LinePair,Al=U.UpsampleRgb565LinePair,Ns=16,ks=1<<Ns-1,Er=-227,$a=482,bo=6,Zl=0,ra=d(256),vo=d(256),Ga=d(256),Da=d(256),ds=d($a-Er),Ra=d($a-Er);wl("YuvToRgbRow",ha,3),wl("YuvToBgrRow",Hi,3),wl("YuvToRgbaRow",Yr,4),wl("YuvToBgraRow",Wi,4),wl("YuvToArgbRow",rs,4),wl("YuvToRgba4444Row",ho,2),wl("YuvToRgb565Row",za,2);var Li=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],_o=[0,2,8],oa=[8,7,6,4,4,2,2,2,1,1,1,1],Wo=1;this.WebPDecodeRGBA=function(f,y,C,L,X){var ie=Ci,oe=new xt,ce=new gn;oe.ba=ce,ce.S=ie,ce.width=[ce.width],ce.height=[ce.height];var he=ce.width,je=ce.height,Pe=new fn;if(Pe==null||f==null)var Ee=2;else r(Pe!=null),Ee=os(f,y,C,Pe.width,Pe.height,Pe.Pd,Pe.Qd,Pe.format,null);if(Ee!=0?he=0:(he!=null&&(he[0]=Pe.width[0]),je!=null&&(je[0]=Pe.height[0]),he=1),he){ce.width=ce.width[0],ce.height=ce.height[0],L!=null&&(L[0]=ce.width),X!=null&&(X[0]=ce.height);e:{if(L=new Gs,(X=new vt).data=f,X.w=y,X.ha=C,X.kd=1,y=[0],r(X!=null),((f=os(X.data,X.w,X.ha,null,null,null,y,null,X))==0||f==7)&&y[0]&&(f=4),(y=f)==0){if(r(oe!=null),L.data=X.data,L.w=X.w+X.offset,L.ha=X.ha-X.offset,L.put=Xt,L.ac=Mr,L.bc=mr,L.ma=oe,X.xa){if((f=Br())==null){oe=1;break e}if((function(ke,He){var Je=[0],bt=[0],et=[0];t:for(;;){if(ke==null)return 0;if(He==null)return ke.a=2,0;if(ke.l=He,ke.a=0,Re(ke.m,He.data,He.w,He.ha),!Ti(ke.m,Je,bt,et)){ke.a=3;break t}if(ke.xb=Mc,He.width=Je[0],He.height=bt[0],!Ja(Je[0],bt[0],1,ke,null))break t;return 1}return r(ke.a!=0),0})(f,L)){if(L=(y=as(L.width,L.height,oe.Oa,oe.ba))==0){t:{L=f;n:for(;;){if(L==null){L=0;break t}if(r(L.s.yc!=null),r(L.s.Ya!=null),r(0<L.s.Wb),r((C=L.l)!=null),r((X=C.ma)!=null),L.xb!=0){if(L.ca=X.ba,L.tb=X.tb,r(L.ca!=null),!Ks(X.Oa,C,lr)){L.a=2;break n}if(!Qa(L,C.width)||C.da)break n;if((C.da||cn(L.ca.S))&&Nr(),11>L.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),L.ca.f.kb.F!=null&&Nr()),L.Pb&&0<L.s.ua&&L.s.vb.X==null&&!ye(L.s.vb,L.s.Wa.Xa)){L.a=1;break n}L.xb=0}if(!vi(L,L.V,L.Ba,L.c,L.i,C.o,An))break n;X.Dc=L.Ma,L=1;break t}r(L.a!=0),L=0}L=!L}L&&(y=f.a)}else y=f.a}else{if((f=new br)==null){oe=1;break e}if(f.Fa=X.na,f.P=X.P,f.qc=X.Sa,dr(f,L)){if((y=as(L.width,L.height,oe.Oa,oe.ba))==0){if(f.Aa=0,C=oe.Oa,r((X=f)!=null),C!=null){if(0<(he=0>(he=C.Md)?0:100<he?255:255*he/100)){for(je=Pe=0;4>je;++je)12>(Ee=X.pb[je]).lc&&(Ee.ia=he*oa[0>Ee.lc?0:Ee.lc]>>3),Pe|=Ee.ia;Pe&&(alert("todo:VP8InitRandom"),X.ia=1)}X.Ga=C.Id,100<X.Ga?X.Ga=100:0>X.Ga&&(X.Ga=0)}(function(ke,He){if(ke==null)return 0;if(He==null)return Ii(ke,2,"NULL VP8Io parameter in VP8Decode().");if(!ke.cb&&!dr(ke,He))return 0;if(r(ke.cb),He.ac==null||He.ac(He)){He.ob&&(ke.L=0);var Je=_o[ke.L];if(ke.L==2?(ke.yb=0,ke.zb=0):(ke.yb=He.v-Je>>4,ke.zb=He.j-Je>>4,0>ke.yb&&(ke.yb=0),0>ke.zb&&(ke.zb=0)),ke.Va=He.o+15+Je>>4,ke.Hb=He.va+15+Je>>4,ke.Hb>ke.za&&(ke.Hb=ke.za),ke.Va>ke.Ub&&(ke.Va=ke.Ub),0<ke.L){var bt=ke.ed;for(Je=0;4>Je;++Je){var et;if(ke.Qa.Cb){var yt=ke.Qa.Lb[Je];ke.Qa.Fb||(yt+=bt.Tb)}else yt=bt.Tb;for(et=0;1>=et;++et){var wt=ke.gd[Je][et],It=yt;if(bt.Pc&&(It+=bt.vd[0],et&&(It+=bt.od[0])),0<(It=0>It?0:63<It?63:It)){var zt=It;0<bt.wb&&(zt=4<bt.wb?zt>>2:zt>>1)>9-bt.wb&&(zt=9-bt.wb),1>zt&&(zt=1),wt.dd=zt,wt.tc=2*It+zt,wt.ld=40<=It?2:15<=It?1:0}else wt.tc=0;wt.La=et}}}Je=0}else Ii(ke,6,"Frame setup failed"),Je=ke.a;if(Je=Je==0){if(Je){ke.$c=0,0<ke.Aa||(ke.Ic=Wo);t:{Je=ke.Ic,bt=4*(zt=ke.za);var wn=32*zt,un=zt+1,Sn=0<ke.L?zt*(0<ke.Aa?2:1):0,en=(ke.Aa==2?2:1)*zt;if((wt=bt+832+(et=3*(16*Je+_o[ke.L])/2*wn)+(yt=ke.Fa!=null&&0<ke.Fa.length?ke.Kc.c*ke.Kc.i:0))!=wt)Je=0;else{if(wt>ke.Vb){if(ke.Vb=0,ke.Ec=d(wt),ke.Fc=0,ke.Ec==null){Je=Ii(ke,1,"no memory during frame initialization.");break t}ke.Vb=wt}wt=ke.Ec,It=ke.Fc,ke.Ac=wt,ke.Bc=It,It+=bt,ke.Gd=v(wn,ts),ke.Hd=0,ke.rb=v(un+1,Uo),ke.sb=1,ke.wa=Sn?v(Sn,fi):null,ke.Y=0,ke.D.Nb=0,ke.D.wa=ke.wa,ke.D.Y=ke.Y,0<ke.Aa&&(ke.D.Y+=zt),r(!0),ke.oc=wt,ke.pc=It,It+=832,ke.ya=v(en,_s),ke.aa=0,ke.D.ya=ke.ya,ke.D.aa=ke.aa,ke.Aa==2&&(ke.D.aa+=zt),ke.R=16*zt,ke.B=8*zt,zt=(wn=_o[ke.L])*ke.R,wn=wn/2*ke.B,ke.sa=wt,ke.ta=It+zt,ke.qa=ke.sa,ke.ra=ke.ta+16*Je*ke.R+wn,ke.Ha=ke.qa,ke.Ia=ke.ra+8*Je*ke.B+wn,ke.$c=0,It+=et,ke.mb=yt?wt:null,ke.nb=yt?It:null,r(It+yt<=ke.Fc+ke.Vb),Gl(ke),l(ke.Ac,ke.Bc,0,bt),Je=1}}if(Je){if(He.ka=0,He.y=ke.sa,He.O=ke.ta,He.f=ke.qa,He.N=ke.ra,He.ea=ke.Ha,He.Vd=ke.Ia,He.fa=ke.R,He.Rc=ke.B,He.F=null,He.J=0,!zo){for(Je=-255;255>=Je;++Je)Zi[255+Je]=0>Je?-Je:Je;for(Je=-1020;1020>=Je;++Je)oi[1020+Je]=-128>Je?-128:127<Je?127:Je;for(Je=-112;112>=Je;++Je)kr[112+Je]=-16>Je?-16:15<Je?15:Je;for(Je=-255;510>=Je;++Je)Kr[255+Je]=0>Je?0:255<Je?255:Je;zo=1}Ho=ki,qa=ca,ss=fr,Ri=Xl,Oi=Or,rr=Yl,or=Zc,yo=vs,ls=Q,Qs=pe,xc=Jc,Qc=j,qu=Me,Va=qe,so=Fa,Cl=ro,ko=ka,Ls=bs,Qr[0]=Oa,Qr[1]=Ma,Qr[2]=Tt,Qr[3]=Qn,Qr[4]=ua,Qr[5]=jn,Qr[6]=vn,Qr[7]=ol,Qr[8]=En,Qr[9]=Eo,ia[0]=pr,ia[1]=xs,ia[2]=Na,ia[3]=Xo,ia[4]=ms,ia[5]=Ba,ia[6]=Ys,xa[0]=wi,xa[1]=Fo,xa[2]=mn,xa[3]=Ai,xa[4]=Ko,xa[5]=Tn,xa[6]=Jt,Je=1}else Je=0}Je&&(Je=(function(hi,zr){for(hi.M=0;hi.M<hi.Va;++hi.M){var Pn,Ut=hi.Jc[hi.M&hi.Xb],Kt=hi.m,ar=hi;for(Pn=0;Pn<ar.za;++Pn){var Xn=Kt,gi=ar,Ji=gi.Ac,_i=gi.Bc+4*Pn,ur=gi.zc,$i=gi.ya[gi.aa+Pn];if(gi.Qa.Bb?$i.$b=De(Xn,gi.Pa.jb[0])?2+De(Xn,gi.Pa.jb[2]):De(Xn,gi.Pa.jb[1]):$i.$b=0,gi.kc&&($i.Ad=De(Xn,gi.Bd)),$i.Za=!De(Xn,145)+0,$i.Za){var Dr=$i.Ob,eo=0;for(gi=0;4>gi;++gi){var Sr,ii=ur[0+gi];for(Sr=0;4>Sr;++Sr){ii=cr[Ji[_i+Sr]][ii];for(var Gi=Cs[De(Xn,ii[0])];0<Gi;)Gi=Cs[2*Gi+De(Xn,ii[Gi])];ii=-Gi,Ji[_i+Sr]=ii}s(Dr,eo,Ji,_i,4),eo+=4,ur[0+gi]=ii}}else ii=De(Xn,156)?De(Xn,128)?1:3:De(Xn,163)?2:0,$i.Ob[0]=ii,l(Ji,_i,ii,4),l(ur,0,ii,4);$i.Dd=De(Xn,142)?De(Xn,114)?De(Xn,183)?1:3:2:0}if(ar.m.Ka)return Ii(hi,7,"Premature end-of-partition0 encountered.");for(;hi.ja<hi.za;++hi.ja){if(ar=Ut,Xn=(Kt=hi).rb[Kt.sb-1],Ji=Kt.rb[Kt.sb+Kt.ja],Pn=Kt.ya[Kt.aa+Kt.ja],_i=Kt.kc?Pn.Ad:0)Xn.la=Ji.la=0,Pn.Za||(Xn.Na=Ji.Na=0),Pn.Hc=0,Pn.Gc=0,Pn.ia=0;else{var hr,ai;if(Xn=Ji,Ji=ar,_i=Kt.Pa.Xc,ur=Kt.ya[Kt.aa+Kt.ja],$i=Kt.pb[ur.$b],gi=ur.ad,Dr=0,eo=Kt.rb[Kt.sb-1],ii=Sr=0,l(gi,Dr,0,384),ur.Za)var Qi=0,ji=_i[3];else{Gi=d(16);var yi=Xn.Na+eo.Na;if(yi=_a(Ji,_i[1],yi,$i.Eb,0,Gi,0),Xn.Na=eo.Na=(0<yi)+0,1<yi)Ho(Gi,0,gi,Dr);else{var Yi=Gi[0]+3>>3;for(Gi=0;256>Gi;Gi+=16)gi[Dr+Gi]=Yi}Qi=1,ji=_i[0]}var Ui=15&Xn.la,Rr=15&eo.la;for(Gi=0;4>Gi;++Gi){var lo=1&Rr;for(Yi=ai=0;4>Yi;++Yi)Ui=Ui>>1|(lo=(yi=_a(Ji,ji,yi=lo+(1&Ui),$i.Sc,Qi,gi,Dr))>Qi)<<7,ai=ai<<2|(3<yi?3:1<yi?2:gi[Dr+0]!=0),Dr+=16;Ui>>=4,Rr=Rr>>1|lo<<7,Sr=(Sr<<8|ai)>>>0}for(ji=Ui,Qi=Rr>>4,hr=0;4>hr;hr+=2){for(ai=0,Ui=Xn.la>>4+hr,Rr=eo.la>>4+hr,Gi=0;2>Gi;++Gi){for(lo=1&Rr,Yi=0;2>Yi;++Yi)yi=lo+(1&Ui),Ui=Ui>>1|(lo=0<(yi=_a(Ji,_i[2],yi,$i.Qc,0,gi,Dr)))<<3,ai=ai<<2|(3<yi?3:1<yi?2:gi[Dr+0]!=0),Dr+=16;Ui>>=2,Rr=Rr>>1|lo<<5}ii|=ai<<4*hr,ji|=Ui<<4<<hr,Qi|=(240&Rr)<<hr}Xn.la=ji,eo.la=Qi,ur.Hc=Sr,ur.Gc=ii,ur.ia=43690&ii?0:$i.ia,_i=!(Sr|ii)}if(0<Kt.L&&(Kt.wa[Kt.Y+Kt.ja]=Kt.gd[Pn.$b][Pn.Za],Kt.wa[Kt.Y+Kt.ja].La|=!_i),ar.Ka)return Ii(hi,7,"Premature end-of-file encountered.")}if(Gl(hi),Kt=zr,ar=1,Pn=(Ut=hi).D,Xn=0<Ut.L&&Ut.M>=Ut.zb&&Ut.M<=Ut.Va,Ut.Aa==0)t:{if(Pn.M=Ut.M,Pn.uc=Xn,Pa(Ut,Pn),ar=1,Pn=(ai=Ut.D).Nb,Xn=(ii=_o[Ut.L])*Ut.R,Ji=ii/2*Ut.B,Gi=16*Pn*Ut.R,Yi=8*Pn*Ut.B,_i=Ut.sa,ur=Ut.ta-Xn+Gi,$i=Ut.qa,gi=Ut.ra-Ji+Yi,Dr=Ut.Ha,eo=Ut.Ia-Ji+Yi,Rr=(Ui=ai.M)==0,Sr=Ui>=Ut.Va-1,Ut.Aa==2&&Pa(Ut,ai),ai.uc)for(lo=(yi=Ut).D.M,r(yi.D.uc),ai=yi.yb;ai<yi.Hb;++ai){Qi=ai,ji=lo;var jr=(si=(to=yi).D).Nb;hr=to.R;var si=si.wa[si.Y+Qi],Do=to.sa,qr=to.ta+16*jr*hr+16*Qi,Bn=si.dd,In=si.tc;if(In!=0)if(r(3<=In),to.L==1)0<Qi&&Cl(Do,qr,hr,In+4),si.La&&Ls(Do,qr,hr,In),0<ji&&so(Do,qr,hr,In+4),si.La&&ko(Do,qr,hr,In);else{var Fi=to.B,La=to.qa,co=to.ra+8*jr*Fi+8*Qi,Ro=to.Ha,to=to.Ia+8*jr*Fi+8*Qi;jr=si.ld,0<Qi&&(yo(Do,qr,hr,In+4,Bn,jr),Qs(La,co,Ro,to,Fi,In+4,Bn,jr)),si.La&&(Qc(Do,qr,hr,In,Bn,jr),Va(La,co,Ro,to,Fi,In,Bn,jr)),0<ji&&(or(Do,qr,hr,In+4,Bn,jr),ls(La,co,Ro,to,Fi,In+4,Bn,jr)),si.La&&(xc(Do,qr,hr,In,Bn,jr),qu(La,co,Ro,to,Fi,In,Bn,jr))}}if(Ut.ia&&alert("todo:DitherRow"),Kt.put!=null){if(ai=16*Ui,Ui=16*(Ui+1),Rr?(Kt.y=Ut.sa,Kt.O=Ut.ta+Gi,Kt.f=Ut.qa,Kt.N=Ut.ra+Yi,Kt.ea=Ut.Ha,Kt.W=Ut.Ia+Yi):(ai-=ii,Kt.y=_i,Kt.O=ur,Kt.f=$i,Kt.N=gi,Kt.ea=Dr,Kt.W=eo),Sr||(Ui-=ii),Ui>Kt.o&&(Ui=Kt.o),Kt.F=null,Kt.J=null,Ut.Fa!=null&&0<Ut.Fa.length&&ai<Ui&&(Kt.J=vr(Ut,Kt,ai,Ui-ai),Kt.F=Ut.mb,Kt.F==null&&Kt.F.length==0)){ar=Ii(Ut,3,"Could not decode alpha data.");break t}ai<Kt.j&&(ii=Kt.j-ai,ai=Kt.j,r(!(1&ii)),Kt.O+=Ut.R*ii,Kt.N+=Ut.B*(ii>>1),Kt.W+=Ut.B*(ii>>1),Kt.F!=null&&(Kt.J+=Kt.width*ii)),ai<Ui&&(Kt.O+=Kt.v,Kt.N+=Kt.v>>1,Kt.W+=Kt.v>>1,Kt.F!=null&&(Kt.J+=Kt.v),Kt.ka=ai-Kt.j,Kt.U=Kt.va-Kt.v,Kt.T=Ui-ai,ar=Kt.put(Kt))}Pn+1!=Ut.Ic||Sr||(s(Ut.sa,Ut.ta-Xn,_i,ur+16*Ut.R,Xn),s(Ut.qa,Ut.ra-Ji,$i,gi+8*Ut.B,Ji),s(Ut.Ha,Ut.Ia-Ji,Dr,eo+8*Ut.B,Ji))}if(!ar)return Ii(hi,6,"Output aborted.")}return 1})(ke,He)),He.bc!=null&&He.bc(He),Je&=1}return Je?(ke.cb=0,Je):0})(f,L)||(y=f.a)}}else y=f.a}y==0&&oe.Oa!=null&&oe.Oa.fd&&(y=No(oe.ba))}oe=y}ie=oe!=0?null:11>ie?ce.f.RGBA.eb:ce.f.kb.y}else ie=null;return ie};var va=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function m(U,$){for(var H="",R=0;R<4;R++)H+=String.fromCharCode(U[$++]);return H}function T(U,$){return U[$+0]|U[$+1]<<8}function D(U,$){return(U[$+0]|U[$+1]<<8|U[$+2]<<16)>>>0}function M(U,$){return(U[$+0]|U[$+1]<<8|U[$+2]<<16|U[$+3]<<24)>>>0}new b;var S=[0],F=[0],_=[],N=new b,g=n,ae=(function(U,$){var H={},R=0,Z=!1,G=0,we=0;if(H.frames=[],!(function(A,V){for(var W=0;W<4;W++)if(A[V+W]!="RIFF".charCodeAt(W))return!0;return!1})(U,$)){for(M(U,$+=4),$+=8;$<U.length;){var te=m(U,$),de=M(U,$+=4);$+=4;var Ce=de+(1&de);switch(te){case"VP8 ":case"VP8L":H.frames[R]===void 0&&(H.frames[R]={}),(k=H.frames[R]).src_off=Z?we:$-8,k.src_size=G+de+8,R++,Z&&(Z=!1,G=0,we=0);break;case"VP8X":(k=H.header={}).feature_flags=U[$];var Re=$+4;k.canvas_width=1+D(U,Re),Re+=3,k.canvas_height=1+D(U,Re),Re+=3;break;case"ALPH":Z=!0,G=Ce+8,we=$-8;break;case"ANIM":(k=H.header).bgcolor=M(U,$),Re=$+4,k.loop_count=T(U,Re),Re+=2;break;case"ANMF":var xe,k;(k=H.frames[R]={}).offset_x=2*D(U,$),$+=3,k.offset_y=2*D(U,$),$+=3,k.width=1+D(U,$),$+=3,k.height=1+D(U,$),$+=3,k.duration=D(U,$),$+=3,xe=U[$++],k.dispose=1&xe,k.blend=xe>>1&1}te!="ANMF"&&($+=Ce)}return H}})(g,0);ae.response=g,ae.rgbaoutput=!0,ae.dataurl=!1;var E=ae.header?ae.header:null,q=ae.frames?ae.frames:null;if(E){E.loop_counter=E.loop_count,S=[E.canvas_height],F=[E.canvas_width];for(var re=0;re<q.length&&q[re].blend!=0;re++);}var J=q[0],Y=N.WebPDecodeRGBA(g,J.src_off,J.src_size,F,S);J.rgba=Y,J.imgwidth=F[0],J.imgheight=S[0];for(var ee=0;ee<F[0]*S[0]*4;ee++)_[ee]=Y[ee];return this.width=F,this.height=S,this.data=_,this}(function(n){var r,o,s,l,d,v,p,b,m,T=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new b,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new v,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new v,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new D(this),r=this.internal.f2,o=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,l=this.internal.getHorizontalCoordinate,d=this.internal.getVerticalCoordinate,v=this.internal.Point,p=this.internal.Rectangle,b=this.internal.Matrix,m=new T}]);var D=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var V=A;Object.defineProperty(this,"pdf",{get:function(){return V}});var W=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return W},set:function(ye){W=!!ye}});var se=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return se},set:function(ye){se=!!ye}});var Te=0;Object.defineProperty(this,"posX",{get:function(){return Te},set:function(ye){isNaN(ye)||(Te=ye)}});var le=0;Object.defineProperty(this,"posY",{get:function(){return le},set:function(ye){isNaN(ye)||(le=ye)}}),Object.defineProperty(this,"margin",{get:function(){return m.margin},set:function(ye){var ut;typeof ye=="number"?ut=[ye,ye,ye,ye]:((ut=new Array(4))[0]=ye[0],ut[1]=ye.length>=2?ye[1]:ut[0],ut[2]=ye.length>=3?ye[2]:ut[0],ut[3]=ye.length>=4?ye[3]:ut[1]),m.margin=ut}});var _e=!1;Object.defineProperty(this,"autoPaging",{get:function(){return _e},set:function(ye){_e=ye}});var ve=0;Object.defineProperty(this,"lastBreak",{get:function(){return ve},set:function(ye){ve=ye}});var De=[];Object.defineProperty(this,"pageBreaks",{get:function(){return De},set:function(ye){De=ye}}),Object.defineProperty(this,"ctx",{get:function(){return m},set:function(ye){ye instanceof T&&(m=ye)}}),Object.defineProperty(this,"path",{get:function(){return m.path},set:function(ye){m.path=ye}});var Xe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Xe},set:function(ye){Xe=ye}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ye){var ut;ut=M(ye),this.ctx.fillStyle=ut.style,this.ctx.isFillTransparent=ut.a===0,this.ctx.fillOpacity=ut.a,this.pdf.setFillColor(ut.r,ut.g,ut.b,{a:ut.a}),this.pdf.setTextColor(ut.r,ut.g,ut.b,{a:ut.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ye){var ut=M(ye);this.ctx.strokeStyle=ut.style,this.ctx.isStrokeTransparent=ut.a===0,this.ctx.strokeOpacity=ut.a,ut.a===0?this.pdf.setDrawColor(255,255,255):(ut.a,this.pdf.setDrawColor(ut.r,ut.g,ut.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ye){["butt","round","square"].indexOf(ye)!==-1&&(this.ctx.lineCap=ye,this.pdf.setLineCap(ye))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ye){isNaN(ye)||(this.ctx.lineWidth=ye,this.pdf.setLineWidth(ye))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ye){["bevel","round","miter"].indexOf(ye)!==-1&&(this.ctx.lineJoin=ye,this.pdf.setLineJoin(ye))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ye){isNaN(ye)||(this.ctx.miterLimit=ye,this.pdf.setMiterLimit(ye))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ye){this.ctx.textBaseline=ye}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ye){["right","end","center","left","start"].indexOf(ye)!==-1&&(this.ctx.textAlign=ye)}});var st=null,kt=null,qt=null;Object.defineProperty(this,"fontFaces",{get:function(){return qt},set:function(ye){st=null,kt=null,qt=ye}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ye){var ut;if(this.ctx.font=ye,(ut=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(ye))!==null){var Gt=ut[1];ut[2];var Et=ut[3],ht=ut[4];ut[5];var Qe=ut[6],$t=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ht)[2];ht=Math.floor($t==="px"?parseFloat(ht)*this.pdf.internal.scaleFactor:$t==="em"?parseFloat(ht)*this.pdf.getFontSize():parseFloat(ht)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ht);var dn=(function(at){var Ot,Vt,jt=[],Ft=at.trim();if(Ft==="")return zg;if(Ft in vy)return[vy[Ft]];for(;Ft!=="";){switch(Vt=null,Ot=(Ft=Sy(Ft)).charAt(0)){case'"':case"'":Vt=l5(Ft.substring(1),Ot);break;default:Vt=c5(Ft)}if(Vt===null||(jt.push(Vt[0]),(Ft=Sy(Vt[1]))!==""&&Ft.charAt(0)!==","))return zg;Ft=Ft.replace(/^,/,"")}return jt})(Qe);if(this.fontFaces){var rn=(function(at,Ot){var Vt=at.getFontList(),jt=JSON.stringify(Vt);if(st===null||kt!==jt){var Ft=(function(tn){var ln=[];return Object.keys(tn).forEach(function(mt){tn[mt].forEach(function(cn){var _t=null;switch(cn){case"bold":_t={family:mt,weight:"bold"};break;case"italic":_t={family:mt,style:"italic"};break;case"bolditalic":_t={family:mt,weight:"bold",style:"italic"};break;case"":case"normal":_t={family:mt}}_t!==null&&(_t.ref={name:mt,style:cn},ln.push(_t))})}),ln})(Vt);st=(function(tn){for(var ln={},mt=0;mt<tn.length;++mt){var cn=Ag(tn[mt]),_t=cn.family,Yt=cn.stretch,gn=cn.style,fn=cn.weight;ln[_t]=ln[_t]||{},ln[_t][Yt]=ln[_t][Yt]||{},ln[_t][Yt][gn]=ln[_t][Yt][gn]||{},ln[_t][Yt][gn][fn]=cn}return ln})(Ft.concat(Ot)),kt=jt}return st})(this.pdf,this.fontFaces),kn=dn.map(function(at){return{family:at,stretch:"normal",weight:Et,style:Gt}}),Fn=(function(at,Ot,Vt){for(var jt=(Vt=Vt||{}).defaultFontFamily||"times",Ft=Object.assign({},s5,Vt.genericFontFamilies||{}),tn=null,ln=null,mt=0;mt<Ot.length;++mt)if(Ft[(tn=Ag(Ot[mt])).family]&&(tn.family=Ft[tn.family]),at.hasOwnProperty(tn.family)){ln=at[tn.family];break}if(!(ln=ln||at[jt]))throw new Error("Could not find a font-family for the rule '"+wy(tn)+"' and default family '"+jt+"'.");if(ln=(function(cn,_t){if(_t[cn])return _t[cn];var Yt=Gg[cn],gn=Yt<=Gg.normal?-1:1,fn=by(_t,Lx,Yt,gn);if(!fn)throw new Error("Could not find a matching font-stretch value for "+cn);return fn})(tn.stretch,ln),ln=(function(cn,_t){if(_t[cn])return _t[cn];for(var Yt=Rx[cn],gn=0;gn<Yt.length;++gn)if(_t[Yt[gn]])return _t[Yt[gn]];throw new Error("Could not find a matching font-style for "+cn)})(tn.style,ln),!(ln=(function(cn,_t){if(_t[cn])return _t[cn];if(cn===400&&_t[500])return _t[500];if(cn===500&&_t[400])return _t[400];var Yt=a5[cn],gn=by(_t,Ix,Yt,cn<400?-1:1);if(!gn)throw new Error("Could not find a matching font-weight for value "+cn);return gn})(tn.weight,ln)))throw new Error("Failed to resolve a font for the rule '"+wy(tn)+"'.");return ln})(rn,kn);this.pdf.setFont(Fn.ref.name,Fn.ref.style)}else{var Be="";(Et==="bold"||parseInt(Et,10)>=700||Gt==="bold")&&(Be="bold"),Gt==="italic"&&(Be+="italic"),Be.length===0&&(Be="normal");for(var fe="",lt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},it=0;it<dn.length;it++){if(this.pdf.internal.getFont(dn[it],Be,{noFallback:!0,disableWarning:!0})!==void 0){fe=dn[it];break}if(Be==="bolditalic"&&this.pdf.internal.getFont(dn[it],"bold",{noFallback:!0,disableWarning:!0})!==void 0)fe=dn[it],Be="bold";else if(this.pdf.internal.getFont(dn[it],"normal",{noFallback:!0,disableWarning:!0})!==void 0){fe=dn[it],Be="normal";break}}if(fe===""){for(var $e=0;$e<dn.length;$e++)if(lt[dn[$e]]){fe=lt[dn[$e]];break}}fe=fe===""?"Times":fe,this.pdf.setFont(fe,Be)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ye){this.ctx.globalCompositeOperation=ye}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ye){this.ctx.globalAlpha=ye}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ye){this.ctx.lineDashOffset=ye,k.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ye){this.ctx.lineDash=ye,k.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ye){this.ctx.ignoreClearRect=!!ye}})};D.prototype.setLineDash=function(A){this.lineDash=A},D.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},D.prototype.fill=function(){q.call(this,"fill",!1)},D.prototype.stroke=function(){q.call(this,"stroke",!1)},D.prototype.beginPath=function(){this.path=[{type:"begin"}]},D.prototype.moveTo=function(A,V){if(isNaN(A)||isNaN(V))throw no.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var W=this.ctx.transform.applyToPoint(new v(A,V));this.path.push({type:"mt",x:W.x,y:W.y}),this.ctx.lastPoint=new v(A,V)},D.prototype.closePath=function(){var A=new v(0,0),V=0;for(V=this.path.length-1;V!==-1;V--)if(this.path[V].type==="begin"&&Ir(this.path[V+1])==="object"&&typeof this.path[V+1].x=="number"){A=new v(this.path[V+1].x,this.path[V+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new v(A.x,A.y)},D.prototype.lineTo=function(A,V){if(isNaN(A)||isNaN(V))throw no.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var W=this.ctx.transform.applyToPoint(new v(A,V));this.path.push({type:"lt",x:W.x,y:W.y}),this.ctx.lastPoint=new v(W.x,W.y)},D.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),q.call(this,null,!0)},D.prototype.quadraticCurveTo=function(A,V,W,se){if(isNaN(W)||isNaN(se)||isNaN(A)||isNaN(V))throw no.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Te=this.ctx.transform.applyToPoint(new v(W,se)),le=this.ctx.transform.applyToPoint(new v(A,V));this.path.push({type:"qct",x1:le.x,y1:le.y,x:Te.x,y:Te.y}),this.ctx.lastPoint=new v(Te.x,Te.y)},D.prototype.bezierCurveTo=function(A,V,W,se,Te,le){if(isNaN(Te)||isNaN(le)||isNaN(A)||isNaN(V)||isNaN(W)||isNaN(se))throw no.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var _e=this.ctx.transform.applyToPoint(new v(Te,le)),ve=this.ctx.transform.applyToPoint(new v(A,V)),De=this.ctx.transform.applyToPoint(new v(W,se));this.path.push({type:"bct",x1:ve.x,y1:ve.y,x2:De.x,y2:De.y,x:_e.x,y:_e.y}),this.ctx.lastPoint=new v(_e.x,_e.y)},D.prototype.arc=function(A,V,W,se,Te,le){if(isNaN(A)||isNaN(V)||isNaN(W)||isNaN(se)||isNaN(Te))throw no.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(le=!!le,!this.ctx.transform.isIdentity){var _e=this.ctx.transform.applyToPoint(new v(A,V));A=_e.x,V=_e.y;var ve=this.ctx.transform.applyToPoint(new v(0,W)),De=this.ctx.transform.applyToPoint(new v(0,0));W=Math.sqrt(Math.pow(ve.x-De.x,2)+Math.pow(ve.y-De.y,2))}Math.abs(Te-se)>=2*Math.PI&&(se=0,Te=2*Math.PI),this.path.push({type:"arc",x:A,y:V,radius:W,startAngle:se,endAngle:Te,counterclockwise:le})},D.prototype.arcTo=function(A,V,W,se,Te){throw new Error("arcTo not implemented.")},D.prototype.rect=function(A,V,W,se){if(isNaN(A)||isNaN(V)||isNaN(W)||isNaN(se))throw no.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,V),this.lineTo(A+W,V),this.lineTo(A+W,V+se),this.lineTo(A,V+se),this.lineTo(A,V),this.lineTo(A+W,V),this.lineTo(A,V)},D.prototype.fillRect=function(A,V,W,se){if(isNaN(A)||isNaN(V)||isNaN(W)||isNaN(se))throw no.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!S.call(this)){var Te={};this.lineCap!=="butt"&&(Te.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Te.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,V,W,se),this.fill(),Te.hasOwnProperty("lineCap")&&(this.lineCap=Te.lineCap),Te.hasOwnProperty("lineJoin")&&(this.lineJoin=Te.lineJoin)}},D.prototype.strokeRect=function(A,V,W,se){if(isNaN(A)||isNaN(V)||isNaN(W)||isNaN(se))throw no.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");F.call(this)||(this.beginPath(),this.rect(A,V,W,se),this.stroke())},D.prototype.clearRect=function(A,V,W,se){if(isNaN(A)||isNaN(V)||isNaN(W)||isNaN(se))throw no.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,V,W,se))},D.prototype.save=function(A){A=typeof A!="boolean"||A;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("q");if(this.pdf.setPage(V),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var se=new T(this.ctx);this.ctxStack.push(this.ctx),this.ctx=se}},D.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("Q");this.pdf.setPage(V),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},D.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var M=function(A){var V,W,se,Te;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))V=0,W=0,se=0,Te=0;else{var le=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(le!==null)V=parseInt(le[1]),W=parseInt(le[2]),se=parseInt(le[3]),Te=1;else if((le=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)V=parseInt(le[1]),W=parseInt(le[2]),se=parseInt(le[3]),Te=parseFloat(le[4]);else{if(Te=1,typeof A=="string"&&A.charAt(0)!=="#"){var _e=new Nx(A);A=_e.ok?_e.toHex():"#000000"}A.length===4?(V=A.substring(1,2),V+=V,W=A.substring(2,3),W+=W,se=A.substring(3,4),se+=se):(V=A.substring(1,3),W=A.substring(3,5),se=A.substring(5,7)),V=parseInt(V,16),W=parseInt(W,16),se=parseInt(se,16)}}return{r:V,g:W,b:se,a:Te,style:A}},S=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},F=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};D.prototype.fillText=function(A,V,W,se){if(isNaN(V)||isNaN(W)||typeof A!="string")throw no.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(se=isNaN(se)?void 0:se,!S.call(this)){var Te=Ce(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;R.call(this,{text:A,x:V,y:W,scale:le,angle:Te,align:this.textAlign,maxWidth:se})}},D.prototype.strokeText=function(A,V,W,se){if(isNaN(V)||isNaN(W)||typeof A!="string")throw no.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!F.call(this)){se=isNaN(se)?void 0:se;var Te=Ce(this.ctx.transform.rotation),le=this.ctx.transform.scaleX;R.call(this,{text:A,x:V,y:W,scale:le,renderingMode:"stroke",angle:Te,align:this.textAlign,maxWidth:se})}},D.prototype.measureText=function(A){if(typeof A!="string")throw no.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var V=this.pdf,W=this.pdf.internal.scaleFactor,se=V.internal.getFontSize(),Te=V.getStringUnitWidth(A)*se/V.internal.scaleFactor;return new function(le){var _e=(le=le||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return _e}}),this}({width:Te*=Math.round(96*W/72*1e4)/1e4})},D.prototype.scale=function(A,V){if(isNaN(A)||isNaN(V))throw no.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var W=new b(A,0,0,V,0,0);this.ctx.transform=this.ctx.transform.multiply(W)},D.prototype.rotate=function(A){if(isNaN(A))throw no.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var V=new b(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(V)},D.prototype.translate=function(A,V){if(isNaN(A)||isNaN(V))throw no.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var W=new b(1,0,0,1,A,V);this.ctx.transform=this.ctx.transform.multiply(W)},D.prototype.transform=function(A,V,W,se,Te,le){if(isNaN(A)||isNaN(V)||isNaN(W)||isNaN(se)||isNaN(Te)||isNaN(le))throw no.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var _e=new b(A,V,W,se,Te,le);this.ctx.transform=this.ctx.transform.multiply(_e)},D.prototype.setTransform=function(A,V,W,se,Te,le){A=isNaN(A)?1:A,V=isNaN(V)?0:V,W=isNaN(W)?0:W,se=isNaN(se)?1:se,Te=isNaN(Te)?0:Te,le=isNaN(le)?0:le,this.ctx.transform=new b(A,V,W,se,Te,le)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};D.prototype.drawImage=function(A,V,W,se,Te,le,_e,ve,De){var Xe=this.pdf.getImageProperties(A),st=1,kt=1,qt=1,ye=1;se!==void 0&&ve!==void 0&&(qt=ve/se,ye=De/Te,st=Xe.width/se*ve/se,kt=Xe.height/Te*De/Te),le===void 0&&(le=V,_e=W,V=0,W=0),se!==void 0&&ve===void 0&&(ve=se,De=Te),se===void 0&&ve===void 0&&(ve=Xe.width,De=Xe.height);var ut=this.ctx.transform.decompose(),Gt=Ce(ut.rotate.shx),Et=new b,ht=(Et=(Et=(Et=Et.multiply(ut.translate)).multiply(ut.skew)).multiply(ut.scale)).applyToRectangle(new p(le-V*qt,_e-W*ye,se*st,Te*kt));if(this.autoPaging){for(var Qe,$t=N.call(this,ht),dn=[],rn=0;rn<$t.length;rn+=1)dn.indexOf($t[rn])===-1&&dn.push($t[rn]);E(dn);for(var kn=dn[0],Fn=dn[dn.length-1],Be=kn;Be<Fn+1;Be++){this.pdf.setPage(Be);var fe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],lt=Be===1?this.posY+this.margin[0]:this.margin[0],it=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$e=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],at=Be===1?0:it+(Be-2)*$e;if(this.ctx.clip_path.length!==0){var Ot=this.path;Qe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ae(Qe,this.posX+this.margin[3],-at+lt+this.ctx.prevPageLastElemOffset),re.call(this,"fill",!0),this.path=Ot}var Vt=JSON.parse(JSON.stringify(ht));Vt=ae([Vt],this.posX+this.margin[3],-at+lt+this.ctx.prevPageLastElemOffset)[0];var jt=(Be>kn||Be<Fn)&&_.call(this);jt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],fe,$e,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",Vt.x,Vt.y,Vt.w,Vt.h,null,null,Gt),jt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(A,"JPEG",ht.x,ht.y,ht.w,ht.h,null,null,Gt)};var N=function(A,V,W){var se=[];V=V||this.pdf.internal.pageSize.width,W=W||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Te=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":se.push(Math.floor((A.y+Te)/W)+1);break;case"arc":se.push(Math.floor((A.y+Te-A.radius)/W)+1),se.push(Math.floor((A.y+Te+A.radius)/W)+1);break;case"qct":var le=Re(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);se.push(Math.floor((le.y+Te)/W)+1),se.push(Math.floor((le.y+le.h+Te)/W)+1);break;case"bct":var _e=xe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);se.push(Math.floor((_e.y+Te)/W)+1),se.push(Math.floor((_e.y+_e.h+Te)/W)+1);break;case"rect":se.push(Math.floor((A.y+Te)/W)+1),se.push(Math.floor((A.y+A.h+Te)/W)+1)}for(var ve=0;ve<se.length;ve+=1)for(;this.pdf.internal.getNumberOfPages()<se[ve];)g.call(this);return se},g=function(){var A=this.fillStyle,V=this.strokeStyle,W=this.font,se=this.lineCap,Te=this.lineWidth,le=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=V,this.font=W,this.lineCap=se,this.lineWidth=Te,this.lineJoin=le},ae=function(A,V,W){for(var se=0;se<A.length;se++)switch(A[se].type){case"bct":A[se].x2+=V,A[se].y2+=W;case"qct":A[se].x1+=V,A[se].y1+=W;default:A[se].x+=V,A[se].y+=W}return A},E=function(A){return A.sort(function(V,W){return V-W})},q=function(A,V){var W=this.fillStyle,se=this.strokeStyle,Te=this.lineCap,le=this.lineWidth,_e=Math.abs(le*this.ctx.transform.scaleX),ve=this.lineJoin;if(this.autoPaging){for(var De,Xe,st=JSON.parse(JSON.stringify(this.path)),kt=JSON.parse(JSON.stringify(this.path)),qt=[],ye=0;ye<kt.length;ye++)if(kt[ye].x!==void 0)for(var ut=N.call(this,kt[ye]),Gt=0;Gt<ut.length;Gt+=1)qt.indexOf(ut[Gt])===-1&&qt.push(ut[Gt]);for(var Et=0;Et<qt.length;Et++)for(;this.pdf.internal.getNumberOfPages()<qt[Et];)g.call(this);E(qt);for(var ht=qt[0],Qe=qt[qt.length-1],$t=ht;$t<Qe+1;$t++){this.pdf.setPage($t),this.fillStyle=W,this.strokeStyle=se,this.lineCap=Te,this.lineWidth=_e,this.lineJoin=ve;var dn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],rn=$t===1?this.posY+this.margin[0]:this.margin[0],kn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Fn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Be=$t===1?0:kn+($t-2)*Fn;if(this.ctx.clip_path.length!==0){var fe=this.path;De=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ae(De,this.posX+this.margin[3],-Be+rn+this.ctx.prevPageLastElemOffset),re.call(this,A,!0),this.path=fe}if(Xe=JSON.parse(JSON.stringify(st)),this.path=ae(Xe,this.posX+this.margin[3],-Be+rn+this.ctx.prevPageLastElemOffset),V===!1||$t===0){var lt=($t>ht||$t<Qe)&&_.call(this);lt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],dn,Fn,null).clip().discardPath()),re.call(this,A,V),lt&&this.pdf.restoreGraphicsState()}this.lineWidth=le}this.path=st}else this.lineWidth=_e,re.call(this,A,V),this.lineWidth=le},re=function(A,V){if((A!=="stroke"||V||!F.call(this))&&(A==="stroke"||V||!S.call(this))){for(var W,se,Te=[],le=this.path,_e=0;_e<le.length;_e++){var ve=le[_e];switch(ve.type){case"begin":Te.push({begin:!0});break;case"close":Te.push({close:!0});break;case"mt":Te.push({start:ve,deltas:[],abs:[]});break;case"lt":var De=Te.length;if(le[_e-1]&&!isNaN(le[_e-1].x)&&(W=[ve.x-le[_e-1].x,ve.y-le[_e-1].y],De>0)){for(;De>=0;De--)if(Te[De-1].close!==!0&&Te[De-1].begin!==!0){Te[De-1].deltas.push(W),Te[De-1].abs.push(ve);break}}break;case"bct":W=[ve.x1-le[_e-1].x,ve.y1-le[_e-1].y,ve.x2-le[_e-1].x,ve.y2-le[_e-1].y,ve.x-le[_e-1].x,ve.y-le[_e-1].y],Te[Te.length-1].deltas.push(W);break;case"qct":var Xe=le[_e-1].x+2/3*(ve.x1-le[_e-1].x),st=le[_e-1].y+2/3*(ve.y1-le[_e-1].y),kt=ve.x+2/3*(ve.x1-ve.x),qt=ve.y+2/3*(ve.y1-ve.y),ye=ve.x,ut=ve.y;W=[Xe-le[_e-1].x,st-le[_e-1].y,kt-le[_e-1].x,qt-le[_e-1].y,ye-le[_e-1].x,ut-le[_e-1].y],Te[Te.length-1].deltas.push(W);break;case"arc":Te.push({deltas:[],abs:[],arc:!0}),Array.isArray(Te[Te.length-1].abs)&&Te[Te.length-1].abs.push(ve)}}se=V?null:A==="stroke"?"stroke":"fill";for(var Gt=!1,Et=0;Et<Te.length;Et++)if(Te[Et].arc)for(var ht=Te[Et].abs,Qe=0;Qe<ht.length;Qe++){var $t=ht[Qe];$t.type==="arc"?ee.call(this,$t.x,$t.y,$t.radius,$t.startAngle,$t.endAngle,$t.counterclockwise,void 0,V,!Gt):Z.call(this,$t.x,$t.y),Gt=!0}else if(Te[Et].close===!0)this.pdf.internal.out("h"),Gt=!1;else if(Te[Et].begin!==!0){var dn=Te[Et].start.x,rn=Te[Et].start.y;G.call(this,Te[Et].deltas,dn,rn),Gt=!0}se&&U.call(this,se),V&&$.call(this)}},J=function(A){var V=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,W=V*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-W;case"top":return A+V-W;case"hanging":return A+V-2*W;case"middle":return A+V/2-W;default:return A}},Y=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};D.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(V,W){this.colorStops.push([V,W])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},D.prototype.createPattern=function(){return this.createLinearGradient()},D.prototype.createRadialGradient=function(){return this.createLinearGradient()};var ee=function(A,V,W,se,Te,le,_e,ve,De){for(var Xe=te.call(this,W,se,Te,le),st=0;st<Xe.length;st++){var kt=Xe[st];st===0&&(De?H.call(this,kt.x1+A,kt.y1+V):Z.call(this,kt.x1+A,kt.y1+V)),we.call(this,A,V,kt.x2,kt.y2,kt.x3,kt.y3,kt.x4,kt.y4)}ve?$.call(this):U.call(this,_e)},U=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},$=function(){this.pdf.clip(),this.pdf.discardPath()},H=function(A,V){this.pdf.internal.out(o(A)+" "+s(V)+" m")},R=function(A){var V;switch(A.align){case"right":case"end":V="right";break;case"center":V="center";break;default:V="left"}var W,se,Te,le=this.pdf.getTextDimensions(A.text),_e=J.call(this,A.y),ve=Y.call(this,_e)-le.h,De=this.ctx.transform.applyToPoint(new v(A.x,_e));if(this.autoPaging){var Xe=this.ctx.transform.decompose(),st=new b;st=(st=(st=st.multiply(Xe.translate)).multiply(Xe.skew)).multiply(Xe.scale);for(var kt=this.ctx.transform.applyToRectangle(new p(A.x,_e,le.w,le.h)),qt=st.applyToRectangle(new p(A.x,ve,le.w,le.h)),ye=N.call(this,qt),ut=[],Gt=0;Gt<ye.length;Gt+=1)ut.indexOf(ye[Gt])===-1&&ut.push(ye[Gt]);E(ut);for(var Et=ut[0],ht=ut[ut.length-1],Qe=Et;Qe<ht+1;Qe++){this.pdf.setPage(Qe);var $t=Qe===1?this.posY+this.margin[0]:this.margin[0],dn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],rn=this.pdf.internal.pageSize.height-this.margin[2],kn=rn-this.margin[0],Fn=this.pdf.internal.pageSize.width-this.margin[1],Be=Fn-this.margin[3],fe=Qe===1?0:dn+(Qe-2)*kn;if(this.ctx.clip_path.length!==0){var lt=this.path;W=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=ae(W,this.posX+this.margin[3],-1*fe+$t),re.call(this,"fill",!0),this.path=lt}var it=ae([JSON.parse(JSON.stringify(qt))],this.posX+this.margin[3],-fe+$t+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(se*A.scale),Te=this.lineWidth,this.lineWidth=Te*A.scale);var $e=this.autoPaging!=="text";if($e||it.y+it.h<=rn){if($e||it.y>=$t&&it.x<=Fn){var at=$e?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||Fn-it.x)[0],Ot=ae([JSON.parse(JSON.stringify(kt))],this.posX+this.margin[3],-fe+$t+this.ctx.prevPageLastElemOffset)[0],Vt=$e&&(Qe>Et||Qe<ht)&&_.call(this);Vt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Be,kn,null).clip().discardPath()),this.pdf.text(at,Ot.x,Ot.y,{angle:A.angle,align:V,renderingMode:A.renderingMode}),Vt&&this.pdf.restoreGraphicsState()}}else it.y<rn&&(this.ctx.prevPageLastElemOffset+=rn-it.y);A.scale>=.01&&(this.pdf.setFontSize(se),this.lineWidth=Te)}}else A.scale>=.01&&(se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(se*A.scale),Te=this.lineWidth,this.lineWidth=Te*A.scale),this.pdf.text(A.text,De.x+this.posX,De.y+this.posY,{angle:A.angle,align:V,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(se),this.lineWidth=Te)},Z=function(A,V,W,se){W=W||0,se=se||0,this.pdf.internal.out(o(A+W)+" "+s(V+se)+" l")},G=function(A,V,W){return this.pdf.lines(A,V,W,null,null)},we=function(A,V,W,se,Te,le,_e,ve){this.pdf.internal.out([r(l(W+A)),r(d(se+V)),r(l(Te+A)),r(d(le+V)),r(l(_e+A)),r(d(ve+V)),"c"].join(" "))},te=function(A,V,W,se){for(var Te=2*Math.PI,le=Math.PI/2;V>W;)V-=Te;var _e=Math.abs(W-V);_e<Te&&se&&(_e=Te-_e);for(var ve=[],De=se?-1:1,Xe=V;_e>1e-5;){var st=Xe+De*Math.min(_e,le);ve.push(de.call(this,A,Xe,st)),_e-=Math.abs(st-Xe),Xe=st}return ve},de=function(A,V,W){var se=(W-V)/2,Te=A*Math.cos(se),le=A*Math.sin(se),_e=Te,ve=-le,De=_e*_e+ve*ve,Xe=De+_e*Te+ve*le,st=4/3*(Math.sqrt(2*De*Xe)-Xe)/(_e*le-ve*Te),kt=_e-st*ve,qt=ve+st*_e,ye=kt,ut=-qt,Gt=se+V,Et=Math.cos(Gt),ht=Math.sin(Gt);return{x1:A*Math.cos(V),y1:A*Math.sin(V),x2:kt*Et-qt*ht,y2:kt*ht+qt*Et,x3:ye*Et-ut*ht,y3:ye*ht+ut*Et,x4:A*Math.cos(W),y4:A*Math.sin(W)}},Ce=function(A){return 180*A/Math.PI},Re=function(A,V,W,se,Te,le){var _e=A+.5*(W-A),ve=V+.5*(se-V),De=Te+.5*(W-Te),Xe=le+.5*(se-le),st=Math.min(A,Te,_e,De),kt=Math.max(A,Te,_e,De),qt=Math.min(V,le,ve,Xe),ye=Math.max(V,le,ve,Xe);return new p(st,qt,kt-st,ye-qt)},xe=function(A,V,W,se,Te,le,_e,ve){var De,Xe,st,kt,qt,ye,ut,Gt,Et,ht,Qe,$t,dn,rn,kn=W-A,Fn=se-V,Be=Te-W,fe=le-se,lt=_e-Te,it=ve-le;for(Xe=0;Xe<41;Xe++)Et=(ut=(st=A+(De=Xe/40)*kn)+De*((qt=W+De*Be)-st))+De*(qt+De*(Te+De*lt-qt)-ut),ht=(Gt=(kt=V+De*Fn)+De*((ye=se+De*fe)-kt))+De*(ye+De*(le+De*it-ye)-Gt),Xe==0?(Qe=Et,$t=ht,dn=Et,rn=ht):(Qe=Math.min(Qe,Et),$t=Math.min($t,ht),dn=Math.max(dn,Et),rn=Math.max(rn,ht));return new p(Math.round(Qe),Math.round($t),Math.round(dn-Qe),Math.round(rn-$t))},k=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,V,W=(A=this.ctx.lineDash,V=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:V}));this.prevLineDash!==W&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=W)}}})(Wn.API),(function(n){var r=function(v){var p,b,m,T,D,M,S,F,_,N;for(b=[],m=0,T=(v+=p="\0\0\0\0".slice(v.length%4||4)).length;T>m;m+=4)(D=(v.charCodeAt(m)<<24)+(v.charCodeAt(m+1)<<16)+(v.charCodeAt(m+2)<<8)+v.charCodeAt(m+3))!==0?(M=(D=((D=((D=((D=(D-(N=D%85))/85)-(_=D%85))/85)-(F=D%85))/85)-(S=D%85))/85)%85,b.push(M+33,S+33,F+33,_+33,N+33)):b.push(122);return(function(g,ae){for(var E=ae;E>0;E--)g.pop()})(b,p.length),String.fromCharCode.apply(String,b)+"~>"},o=function(v){var p,b,m,T,D,M=String,S="length",F=255,_="charCodeAt",N="slice",g="replace";for(v[N](-2),v=v[N](0,-2)[g](/\s/g,"")[g]("z","!!!!!"),m=[],T=0,D=(v+=p="uuuuu"[N](v[S]%5||5))[S];D>T;T+=5)b=52200625*(v[_](T)-33)+614125*(v[_](T+1)-33)+7225*(v[_](T+2)-33)+85*(v[_](T+3)-33)+(v[_](T+4)-33),m.push(F&b>>24,F&b>>16,F&b>>8,F&b);return(function(ae,E){for(var q=E;q>0;q--)ae.pop()})(m,p[S]),M.fromCharCode.apply(M,m)},s=function(v){return v.split("").map(function(p){return("0"+p.charCodeAt().toString(16)).slice(-2)}).join("")+">"},l=function(v){var p=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((v=v.replace(/\s/g,"")).indexOf(">")!==-1&&(v=v.substr(0,v.indexOf(">"))),v.length%2&&(v+="0"),p.test(v)===!1)return"";for(var b="",m=0;m<v.length;m+=2)b+=String.fromCharCode("0x"+(v[m]+v[m+1]));return b},d=function(v){for(var p=new Uint8Array(v.length),b=v.length;b--;)p[b]=v.charCodeAt(b);return(p=Fg(p)).reduce(function(m,T){return m+String.fromCharCode(T)},"")};n.processDataByFilters=function(v,p){var b=0,m=v||"",T=[];for(typeof(p=p||[])=="string"&&(p=[p]),b=0;b<p.length;b+=1)switch(p[b]){case"ASCII85Decode":case"/ASCII85Decode":m=o(m),T.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":m=r(m),T.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":m=l(m),T.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":m=s(m),T.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":m=d(m),T.push("/FlateDecode");break;default:throw new Error('The filter: "'+p[b]+'" is not implemented')}return{data:m,reverseChain:T.reverse().join(" ")}}})(Wn.API),(function(n){n.loadFile=function(r,o,s){return(function(l,d,v){d=d!==!1,v=typeof v=="function"?v:function(){};var p=void 0;try{p=(function(b,m,T){var D=new XMLHttpRequest,M=0,S=function(F){var _=F.length,N=[],g=String.fromCharCode;for(M=0;M<_;M+=1)N.push(g(255&F.charCodeAt(M)));return N.join("")};if(D.open("GET",b,!m),D.overrideMimeType("text/plain; charset=x-user-defined"),m===!1&&(D.onload=function(){D.status===200?T(S(this.responseText)):T(void 0)}),D.send(null),m&&D.status===200)return S(D.responseText)})(l,d,v)}catch{}return p})(r,o,s)},n.loadImageFile=n.loadFile})(Wn.API),(function(n){function r(){return(ui.html2canvas?Promise.resolve(ui.html2canvas):ug(()=>import("./html2canvas.esm-B0tyYwQk.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load html2canvas: "+p))}).then(function(p){return p.default?p.default:p})}function o(){return(ui.DOMPurify?Promise.resolve(ui.DOMPurify):ug(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load dompurify: "+p))}).then(function(p){return p.default?p.default:p})}var s=function(p){var b=Ir(p);return b==="undefined"?"undefined":b==="string"||p instanceof String?"string":b==="number"||p instanceof Number?"number":b==="function"||p instanceof Function?"function":p&&p.constructor===Array?"array":p&&p.nodeType===1?"element":b==="object"?"object":"unknown"},l=function(p,b){var m=document.createElement(p);for(var T in b.className&&(m.className=b.className),b.innerHTML&&b.dompurify&&(m.innerHTML=b.dompurify.sanitize(b.innerHTML)),b.style)m.style[T]=b.style[T];return m},d=function p(b,m){for(var T=b.nodeType===3?document.createTextNode(b.nodeValue):b.cloneNode(!1),D=b.firstChild;D;D=D.nextSibling)m!==!0&&D.nodeType===1&&D.nodeName==="SCRIPT"||T.appendChild(p(D,m));return b.nodeType===1&&(b.nodeName==="CANVAS"?(T.width=b.width,T.height=b.height,T.getContext("2d").drawImage(b,0,0)):b.nodeName!=="TEXTAREA"&&b.nodeName!=="SELECT"||(T.value=b.value),T.addEventListener("load",function(){T.scrollTop=b.scrollTop,T.scrollLeft=b.scrollLeft},!0)),T},v=function p(b){var m=Object.assign(p.convert(Promise.resolve()),JSON.parse(JSON.stringify(p.template))),T=p.convert(Promise.resolve(),m);return(T=T.setProgress(1,p,1,[p])).set(b)};(v.prototype=Object.create(Promise.prototype)).constructor=v,v.convert=function(p,b){return p.__proto__=b||v.prototype,p},v.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},v.prototype.from=function(p,b){return this.then(function(){switch(b=b||(function(m){switch(s(m)){case"string":return"string";case"element":return m.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(p),b){case"string":return this.then(o).then(function(m){return this.set({src:l("div",{innerHTML:p,dompurify:m})})});case"element":return this.set({src:p});case"canvas":return this.set({canvas:p});case"img":return this.set({img:p});default:return this.error("Unknown source type.")}})},v.prototype.to=function(p){switch(p){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},v.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var p={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},b=d(this.prop.src,this.opt.html2canvas.javascriptEnabled);b.tagName==="BODY"&&(p.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=l("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=l("div",{className:"html2pdf__container",style:p}),this.prop.container.appendChild(b),this.prop.container.firstChild.appendChild(l("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},v.prototype.toCanvas=function(){var p=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(p).then(r).then(function(b){var m=Object.assign({},this.opt.html2canvas);return delete m.onrendered,b(this.prop.container,m)}).then(function(b){(this.opt.html2canvas.onrendered||function(){})(b),this.prop.canvas=b,document.body.removeChild(this.prop.overlay)})},v.prototype.toContext2d=function(){var p=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(p).then(r).then(function(b){var m=this.opt.jsPDF,T=this.opt.fontFaces,D=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,M=Object.assign({async:!0,allowTaint:!0,scale:D,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete M.onrendered,m.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,m.context2d.posX=this.opt.x,m.context2d.posY=this.opt.y,m.context2d.margin=this.opt.margin,m.context2d.fontFaces=T,T)for(var S=0;S<T.length;++S){var F=T[S],_=F.src.find(function(N){return N.format==="truetype"});_&&m.addFont(_.url,F.ref.name,F.ref.style)}return M.windowHeight=M.windowHeight||0,M.windowHeight=M.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):M.windowHeight,m.context2d.save(!0),b(this.prop.container,M)}).then(function(b){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(b),this.prop.canvas=b,document.body.removeChild(this.prop.overlay)})},v.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var p=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=p})},v.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},v.prototype.output=function(p,b,m){return(m=m||"pdf").toLowerCase()==="img"||m.toLowerCase()==="image"?this.outputImg(p,b):this.outputPdf(p,b)},v.prototype.outputPdf=function(p,b){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(p,b)})},v.prototype.outputImg=function(p){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(p){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+p+'" is not supported.'}})},v.prototype.save=function(p){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(p?{filename:p}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},v.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},v.prototype.set=function(p){if(s(p)!=="object")return this;var b=Object.keys(p||{}).map(function(m){if(m in v.template.prop)return function(){this.prop[m]=p[m]};switch(m){case"margin":return this.setMargin.bind(this,p.margin);case"jsPDF":return function(){return this.opt.jsPDF=p.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,p.pageSize);default:return function(){this.opt[m]=p[m]}}},this);return this.then(function(){return this.thenList(b)})},v.prototype.get=function(p,b){return this.then(function(){var m=p in v.template.prop?this.prop[p]:this.opt[p];return b?b(m):m})},v.prototype.setMargin=function(p){return this.then(function(){switch(s(p)){case"number":p=[p,p,p,p];case"array":if(p.length===2&&(p=[p[0],p[1],p[0],p[1]]),p.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=p}).then(this.setPageSize)},v.prototype.setPageSize=function(p){function b(m,T){return Math.floor(m*T/72*96)}return this.then(function(){(p=p||Wn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(p.inner={width:p.width-this.opt.margin[1]-this.opt.margin[3],height:p.height-this.opt.margin[0]-this.opt.margin[2]},p.inner.px={width:b(p.inner.width,p.k),height:b(p.inner.height,p.k)},p.inner.ratio=p.inner.height/p.inner.width),this.prop.pageSize=p})},v.prototype.setProgress=function(p,b,m,T){return p!=null&&(this.progress.val=p),b!=null&&(this.progress.state=b),m!=null&&(this.progress.n=m),T!=null&&(this.progress.stack=T),this.progress.ratio=this.progress.val/this.progress.state,this},v.prototype.updateProgress=function(p,b,m,T){return this.setProgress(p?this.progress.val+p:null,b||null,m?this.progress.n+m:null,T?this.progress.stack.concat(T):null)},v.prototype.then=function(p,b){var m=this;return this.thenCore(p,b,function(T,D){return m.updateProgress(null,null,1,[T]),Promise.prototype.then.call(this,function(M){return m.updateProgress(null,T),M}).then(T,D).then(function(M){return m.updateProgress(1),M})})},v.prototype.thenCore=function(p,b,m){m=m||Promise.prototype.then;var T=this;p&&(p=p.bind(T)),b&&(b=b.bind(T));var D=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?T:v.convert(Object.assign({},T),Promise.prototype),M=m.call(D,p,b);return v.convert(M,T.__proto__)},v.prototype.thenExternal=function(p,b){return Promise.prototype.then.call(this,p,b)},v.prototype.thenList=function(p){var b=this;return p.forEach(function(m){b=b.thenCore(m)}),b},v.prototype.catch=function(p){p&&(p=p.bind(this));var b=Promise.prototype.catch.call(this,p);return v.convert(b,this)},v.prototype.catchExternal=function(p){return Promise.prototype.catch.call(this,p)},v.prototype.error=function(p){return this.then(function(){throw new Error(p)})},v.prototype.using=v.prototype.set,v.prototype.saveAs=v.prototype.save,v.prototype.export=v.prototype.output,v.prototype.run=v.prototype.then,Wn.getPageSize=function(p,b,m){if(Ir(p)==="object"){var T=p;p=T.orientation,b=T.unit||b,m=T.format||m}b=b||"mm",m=m||"a4",p=(""+(p||"P")).toLowerCase();var D,M=(""+m).toLowerCase(),S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(b){case"pt":D=1;break;case"mm":D=72/25.4;break;case"cm":D=72/2.54;break;case"in":D=72;break;case"px":D=.75;break;case"pc":case"em":D=12;break;case"ex":D=6;break;default:throw"Invalid unit: "+b}var F,_=0,N=0;if(S.hasOwnProperty(M))_=S[M][1]/D,N=S[M][0]/D;else try{_=m[1],N=m[0]}catch{throw new Error("Invalid format: "+m)}if(p==="p"||p==="portrait")p="p",N>_&&(F=N,N=_,_=F);else{if(p!=="l"&&p!=="landscape")throw"Invalid orientation: "+p;p="l",_>N&&(F=N,N=_,_=F)}return{width:N,height:_,unit:b,k:D,orientation:p}},n.html=function(p,b){(b=b||{}).callback=b.callback||function(){},b.html2canvas=b.html2canvas||{},b.html2canvas.canvas=b.html2canvas.canvas||this.canvas,b.jsPDF=b.jsPDF||this,b.fontFaces=b.fontFaces?b.fontFaces.map(Ag):null;var m=new v(b);return b.worker?m:m.from(p).doCallback()}})(Wn.API),Wn.API.addJS=function(n){return Ty=n,this.internal.events.subscribe("postPutResources",function(){Jp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Jp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),jy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ty+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Jp!==void 0&&jy!==void 0&&this.internal.out("/Names <</JavaScript "+Jp+" 0 R>>")}),this},(function(n){var r;n.events.push(["postPutResources",function(){var o=this,s=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var l=o.outline.render().split(/\r\n/),d=0;d<l.length;d++){var v=l[d],p=s.exec(v);if(p!=null){var b=p[1];o.internal.newObjectDeferredBegin(b,!1)}o.internal.write(v)}if(this.outline.createNamedDestinations){var m=this.internal.pages.length,T=[];for(d=0;d<m;d++){var D=o.internal.newObject();T.push(D);var M=o.internal.getPageInfo(d+1);o.internal.write("<< /D["+M.objId+" 0 R /XYZ null null null]>> endobj")}var S=o.internal.newObject();for(o.internal.write("<< /Names [ "),d=0;d<T.length;d++)o.internal.write("(page_"+(d+1)+")"+T[d]+" 0 R");o.internal.write(" ] >>","endobj"),r=o.internal.newObject(),o.internal.write("<< /Dests "+S+" 0 R"),o.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){var o=this;o.outline.root.children.length>0&&(o.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&o.internal.write("/Names "+r+" 0 R"))}]),n.events.push(["initialized",function(){var o=this;o.outline={createNamedDestinations:!1,root:{children:[]}},o.outline.add=function(s,l,d){var v={title:l,options:d,children:[]};return s==null&&(s=this.root),s.children.push(v),v},o.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=o,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},o.outline.genIds_r=function(s){s.id=o.internal.newObjectDeferred();for(var l=0;l<s.children.length;l++)this.genIds_r(s.children[l])},o.outline.renderRoot=function(s){this.objStart(s),this.line("/Type /Outlines"),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1]))),this.line("/Count "+this.count_r({count:0},s)),this.objEnd()},o.outline.renderItems=function(s){for(var l=this.ctx.pdf.internal.getVerticalCoordinateString,d=0;d<s.children.length;d++){var v=s.children[d];this.objStart(v),this.line("/Title "+this.makeString(v.title)),this.line("/Parent "+this.makeRef(s)),d>0&&this.line("/Prev "+this.makeRef(s.children[d-1])),d<s.children.length-1&&this.line("/Next "+this.makeRef(s.children[d+1])),v.children.length>0&&(this.line("/First "+this.makeRef(v.children[0])),this.line("/Last "+this.makeRef(v.children[v.children.length-1])));var p=this.count=this.count_r({count:0},v);if(p>0&&this.line("/Count "+p),v.options&&v.options.pageNumber){var b=o.internal.getPageInfo(v.options.pageNumber);this.line("/Dest ["+b.objId+" 0 R /XYZ 0 "+l(0)+" 0]")}this.objEnd()}for(var m=0;m<s.children.length;m++)this.renderItems(s.children[m])},o.outline.line=function(s){this.ctx.val+=s+`\r
`},o.outline.makeRef=function(s){return s.id+" 0 R"},o.outline.makeString=function(s){return"("+o.internal.pdfEscape(s)+")"},o.outline.objStart=function(s){this.ctx.val+=`\r
`+s.id+` 0 obj\r
<<\r
`},o.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},o.outline.count_r=function(s,l){for(var d=0;d<l.children.length;d++)s.count++,this.count_r(s,l.children[d]);return s.count}}])})(Wn.API),(function(n){var r=[192,193,194,195,196,197,198,199];n.processJPEG=function(o,s,l,d,v,p){var b,m=this.decode.DCT_DECODE,T=null;if(typeof o=="string"||this.__addimage__.isArrayBuffer(o)||this.__addimage__.isArrayBufferView(o)){switch(o=v||o,o=this.__addimage__.isArrayBuffer(o)?new Uint8Array(o):o,b=(function(D){for(var M,S=256*D.charCodeAt(4)+D.charCodeAt(5),F=D.length,_={width:0,height:0,numcomponents:1},N=4;N<F;N+=2){if(N+=S,r.indexOf(D.charCodeAt(N+1))!==-1){M=256*D.charCodeAt(N+5)+D.charCodeAt(N+6),_={width:256*D.charCodeAt(N+7)+D.charCodeAt(N+8),height:M,numcomponents:D.charCodeAt(N+9)};break}S=256*D.charCodeAt(N+2)+D.charCodeAt(N+3)}return _})(o=this.__addimage__.isArrayBufferView(o)?this.__addimage__.arrayBufferToBinaryString(o):o),b.numcomponents){case 1:p=this.color_spaces.DEVICE_GRAY;break;case 4:p=this.color_spaces.DEVICE_CMYK;break;case 3:p=this.color_spaces.DEVICE_RGB}T={data:o,width:b.width,height:b.height,colorSpace:p,bitsPerComponent:8,filter:m,index:s,alias:l}}return T}})(Wn.API),Wn.API.processPNG=function(n,r,o,s){if(this.__addimage__.isArrayBuffer(n)&&(n=new Uint8Array(n)),this.__addimage__.isArrayBufferView(n)){var l,d=$v(n,{checkCrc:!0}),v=d.width,p=d.height,b=d.channels,m=d.palette,T=d.depth;l=m&&b===1?(function(ee){for(var U=ee.width,$=ee.height,H=ee.data,R=ee.palette,Z=ee.depth,G=!1,we=[],te=[],de=void 0,Ce=!1,Re=0,xe=0;xe<R.length;xe++){var k=A1(R[xe],4),A=k[0],V=k[1],W=k[2],se=k[3];we.push(A,V,W),se!=null&&(se===0?(Re++,te.length<1&&te.push(xe)):se<255&&(Ce=!0))}if(Ce||Re>1){G=!0,te=void 0;var Te=U*$;de=new Uint8Array(Te);for(var le=new DataView(H.buffer),_e=0;_e<Te;_e++){var ve=Pg(le,_e,Z),De=A1(R[ve],4)[3];de[_e]=De}}else Re===0&&(te=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:G?8:void 0,colorBytes:H,alphaBytes:de,needSMask:G,palette:we,mask:te}})(d):b===2||b===4?(function(ee){for(var U=ee.data,$=ee.width,H=ee.height,R=ee.channels,Z=ee.depth,G=R===2?"DeviceGray":"DeviceRGB",we=R-1,te=$*H,de=we,Ce=te*de,Re=1*te,xe=Math.ceil(Ce*Z/8),k=Math.ceil(Re*Z/8),A=new Uint8Array(xe),V=new Uint8Array(k),W=new DataView(U.buffer),se=new DataView(A.buffer),Te=new DataView(V.buffer),le=!1,_e=0;_e<te;_e++){for(var ve=_e*R,De=0;De<de;De++)Ry(se,Pg(W,ve+De,Z),_e*de+De,Z);var Xe=Pg(W,ve+de,Z);Xe<(1<<Z)-1&&(le=!0),Ry(Te,Xe,1*_e,Z)}return{colorSpace:G,colorsPerPixel:we,sMaskBitsPerComponent:le?Z:void 0,colorBytes:A,alphaBytes:V,needSMask:le}})(d):(function(ee){var U=ee.data,$=ee.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:$,colorsPerPixel:$==="DeviceGray"?1:3,colorBytes:U instanceof Uint16Array?(function(H){for(var R=H.length,Z=new Uint8Array(2*R),G=new DataView(Z.buffer,Z.byteOffset,Z.byteLength),we=0;we<R;we++)G.setUint16(2*we,H[we],!1);return Z})(U):U,needSMask:!1}})(d);var D,M,S,F=l,_=F.colorSpace,N=F.colorsPerPixel,g=F.sMaskBitsPerComponent,ae=F.colorBytes,E=F.alphaBytes,q=F.needSMask,re=F.palette,J=F.mask,Y=null;return s!==Wn.API.image_compression.NONE&&typeof Fg=="function"?(Y=(function(ee){var U;switch(ee){case Wn.API.image_compression.FAST:U=11;break;case Wn.API.image_compression.MEDIUM:U=13;break;case Wn.API.image_compression.SLOW:U=14;break;default:U=12}return U})(s),D=this.decode.FLATE_DECODE,M="/Predictor ".concat(Y," /Colors ").concat(N," /BitsPerComponent ").concat(T," /Columns ").concat(v),n=Ay(ae,Math.ceil(v*N*T/8),N,T,s),q&&(S=Ay(E,Math.ceil(v*g/8),1,g,s))):(D=void 0,M=void 0,n=ae,q&&(S=E)),(this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n))&&(n=this.__addimage__.arrayBufferToBinaryString(n)),(S&&this.__addimage__.isArrayBuffer(S)||this.__addimage__.isArrayBufferView(S))&&(S=this.__addimage__.arrayBufferToBinaryString(S)),{alias:o,data:n,index:r,filter:D,decodeParameters:M,transparency:J,palette:re,sMask:S,predictor:Y,width:v,height:p,bitsPerComponent:T,sMaskBitsPerComponent:g,colorSpace:_}}},(function(n){n.processGIF89A=function(r,o,s,l){var d=new p5(r),v=d.width,p=d.height,b=[];d.decodeAndBlitFrameRGBA(0,b);var m={data:b,width:v,height:p},T=new _g(100).encode(m,100);return n.processJPEG.call(this,T,o,s,l)},n.processGIF87A=n.processGIF89A})(Wn.API),Ac.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var r=0;r<n;r++){var o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0);this.palette[r]={red:l,green:s,blue:o,quad:d}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ac.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,r=this.width*this.height*4;this.data=new Uint8Array(r),this[n]()}catch(o){no.log("bit decode error:"+o)}},Ac.prototype.bit1=function(){var n,r=Math.ceil(this.width/8),o=r%4;for(n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,l=0;l<r;l++)for(var d=this.datav.getUint8(this.pos++,!0),v=s*this.width*4+8*l*4,p=0;p<8&&8*l+p<this.width;p++){var b=this.palette[d>>7-p&1];this.data[v+4*p]=b.blue,this.data[v+4*p+1]=b.green,this.data[v+4*p+2]=b.red,this.data[v+4*p+3]=255}o!==0&&(this.pos+=4-o)}},Ac.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),r=n%4,o=this.height-1;o>=0;o--){for(var s=this.bottom_up?o:this.height-1-o,l=0;l<n;l++){var d=this.datav.getUint8(this.pos++,!0),v=s*this.width*4+2*l*4,p=d>>4,b=15&d,m=this.palette[p];if(this.data[v]=m.blue,this.data[v+1]=m.green,this.data[v+2]=m.red,this.data[v+3]=255,2*l+1>=this.width)break;m=this.palette[b],this.data[v+4]=m.blue,this.data[v+4+1]=m.green,this.data[v+4+2]=m.red,this.data[v+4+3]=255}r!==0&&(this.pos+=4-r)}},Ac.prototype.bit8=function(){for(var n=this.width%4,r=this.height-1;r>=0;r--){for(var o=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var l=this.datav.getUint8(this.pos++,!0),d=o*this.width*4+4*s;if(l<this.palette.length){var v=this.palette[l];this.data[d]=v.red,this.data[d+1]=v.green,this.data[d+2]=v.blue,this.data[d+3]=255}else this.data[d]=255,this.data[d+1]=255,this.data[d+2]=255,this.data[d+3]=255}n!==0&&(this.pos+=4-n)}},Ac.prototype.bit15=function(){for(var n=this.width%3,r=parseInt("11111",2),o=this.height-1;o>=0;o--){for(var s=this.bottom_up?o:this.height-1-o,l=0;l<this.width;l++){var d=this.datav.getUint16(this.pos,!0);this.pos+=2;var v=(d&r)/r*255|0,p=(d>>5&r)/r*255|0,b=(d>>10&r)/r*255|0,m=d>>15?255:0,T=s*this.width*4+4*l;this.data[T]=b,this.data[T+1]=p,this.data[T+2]=v,this.data[T+3]=m}this.pos+=n}},Ac.prototype.bit16=function(){for(var n=this.width%3,r=parseInt("11111",2),o=parseInt("111111",2),s=this.height-1;s>=0;s--){for(var l=this.bottom_up?s:this.height-1-s,d=0;d<this.width;d++){var v=this.datav.getUint16(this.pos,!0);this.pos+=2;var p=(v&r)/r*255|0,b=(v>>5&o)/o*255|0,m=(v>>11)/r*255|0,T=l*this.width*4+4*d;this.data[T]=m,this.data[T+1]=b,this.data[T+2]=p,this.data[T+3]=255}this.pos+=n}},Ac.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),v=r*this.width*4+4*o;this.data[v]=d,this.data[v+1]=l,this.data[v+2]=s,this.data[v+3]=255}this.pos+=this.width%4}},Ac.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var r=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var s=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),d=this.datav.getUint8(this.pos++,!0),v=this.datav.getUint8(this.pos++,!0),p=r*this.width*4+4*o;this.data[p]=d,this.data[p+1]=l,this.data[p+2]=s,this.data[p+3]=v}},Ac.prototype.getData=function(){return this.data},(function(n){n.processBMP=function(r,o,s,l){var d=new Ac(r,!1),v=d.width,p=d.height,b={data:d.getData(),width:v,height:p},m=new _g(100).encode(b,100);return n.processJPEG.call(this,m,o,s,l)}})(Wn.API),Iy.prototype.getData=function(){return this.data},(function(n){n.processWEBP=function(r,o,s,l){var d=new Iy(r),v=d.width,p=d.height,b={data:d.getData(),width:v,height:p},m=new _g(100).encode(b,100);return n.processJPEG.call(this,m,o,s,l)}})(Wn.API),Wn.API.processRGBA=function(n,r,o){for(var s=n.data,l=s.length,d=new Uint8Array(l/4*3),v=new Uint8Array(l/4),p=0,b=0,m=0;m<l;m+=4){var T=s[m],D=s[m+1],M=s[m+2],S=s[m+3];d[p++]=T,d[p++]=D,d[p++]=M,v[b++]=S}var F=this.__addimage__.arrayBufferToBinaryString(d);return{alpha:this.__addimage__.arrayBufferToBinaryString(v),data:F,index:r,alias:o,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},Wn.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Gd=Wn.API,Qp=Gd.getCharWidthsArray=function(n,r){var o,s,l=(r=r||{}).font||this.internal.getFont(),d=r.fontSize||this.internal.getFontSize(),v=r.charSpace||this.internal.getCharSpace(),p=r.widths?r.widths:l.metadata.Unicode.widths,b=p.fof?p.fof:1,m=r.kerning?r.kerning:l.metadata.Unicode.kerning,T=m.fof?m.fof:1,D=r.doKerning!==!1,M=0,S=n.length,F=0,_=p[0]||b,N=[];for(o=0;o<S;o++)s=n.charCodeAt(o),typeof l.metadata.widthOfString=="function"?N.push((l.metadata.widthOfGlyph(l.metadata.characterToGlyph(s))+v*(1e3/d)||0)/1e3):(M=D&&Ir(m[s])==="object"&&!isNaN(parseInt(m[s][F],10))?m[s][F]/T:0,N.push((p[s]||_)/b+M)),F=s;return N},Cy=Gd.getStringUnitWidth=function(n,r){var o=(r=r||{}).fontSize||this.internal.getFontSize(),s=r.font||this.internal.getFont(),l=r.charSpace||this.internal.getCharSpace();return Gd.processArabic&&(n=Gd.processArabic(n)),typeof s.metadata.widthOfString=="function"?s.metadata.widthOfString(n,o,l)/o:Qp.apply(this,arguments).reduce(function(d,v){return d+v},0)},Ny=function(n,r,o,s){for(var l=[],d=0,v=n.length,p=0;d!==v&&p+r[d]<o;)p+=r[d],d++;l.push(n.slice(0,d));var b=d;for(p=0;d!==v;)p+r[d]>s&&(l.push(n.slice(b,d)),p=0,b=d),p+=r[d],d++;return b!==d&&l.push(n.slice(b,d)),l},ky=function(n,r,o){o||(o={});var s,l,d,v,p,b,m,T=[],D=[T],M=o.textIndent||0,S=0,F=0,_=n.split(" "),N=Qp.apply(this,[" ",o])[0];if(b=o.lineIndent===-1?_[0].length+2:o.lineIndent||0){var g=Array(b).join(" "),ae=[];_.map(function(q){(q=q.split(/\s*\n/)).length>1?ae=ae.concat(q.map(function(re,J){return(J&&re.length?`
`:"")+re})):ae.push(q[0])}),_=ae,b=Cy.apply(this,[g,o])}for(d=0,v=_.length;d<v;d++){var E=0;if(s=_[d],b&&s[0]==`
`&&(s=s.substr(1),E=1),M+S+(F=(l=Qp.apply(this,[s,o])).reduce(function(q,re){return q+re},0))>r||E){if(F>r){for(p=Ny.apply(this,[s,l,r-(M+S),r]),T.push(p.shift()),T=[p.pop()];p.length;)D.push([p.shift()]);F=l.slice(s.length-(T[0]?T[0].length:0)).reduce(function(q,re){return q+re},0)}else T=[s];D.push(T),M=F+b,S=N}else T.push(s),M+=S+F,S=N}return m=b?function(q,re){return(re?g:"")+q.join(" ")}:function(q){return q.join(" ")},D.map(m)},Gd.splitTextToSize=function(n,r,o){var s,l=(o=o||{}).fontSize||this.internal.getFontSize(),d=(function(T){if(T.widths&&T.kerning)return{widths:T.widths,kerning:T.kerning};var D=this.internal.getFont(T.fontName,T.fontStyle),M="Unicode";return D.metadata[M]?{widths:D.metadata[M].widths||{0:1},kerning:D.metadata[M].kerning||{}}:{font:D.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,o);s=Array.isArray(n)?n:String(n).split(/\r?\n/);var v=1*this.internal.scaleFactor*r/l;d.textIndent=o.textIndent?1*o.textIndent*this.internal.scaleFactor/l:0,d.lineIndent=o.lineIndent;var p,b,m=[];for(p=0,b=s.length;p<b;p++)m=m.concat(ky.apply(this,[s[p],v,d]));return m},(function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var r="0123456789abcdef",o="klmnopqrstuvwxyz",s={},l={},d=0;d<16;d++)s[o[d]]=r[d],l[r[d]]=o[d];var v=function(M){return"0x"+parseInt(M,10).toString(16)},p=n.__fontmetrics__.compress=function(M){var S,F,_,N,g=["{"];for(var ae in M){if(S=M[ae],isNaN(parseInt(ae,10))?F="'"+ae+"'":(ae=parseInt(ae,10),F=(F=v(ae).slice(2)).slice(0,-1)+l[F.slice(-1)]),typeof S=="number")S<0?(_=v(S).slice(3),N="-"):(_=v(S).slice(2),N=""),_=N+_.slice(0,-1)+l[_.slice(-1)];else{if(Ir(S)!=="object")throw new Error("Don't know what to do with value type "+Ir(S)+".");_=p(S)}g.push(F+_)}return g.push("}"),g.join("")},b=n.__fontmetrics__.uncompress=function(M){if(typeof M!="string")throw new Error("Invalid argument passed to uncompress.");for(var S,F,_,N,g={},ae=1,E=g,q=[],re="",J="",Y=M.length-1,ee=1;ee<Y;ee+=1)(N=M[ee])=="'"?S?(_=S.join(""),S=void 0):S=[]:S?S.push(N):N=="{"?(q.push([E,_]),E={},_=void 0):N=="}"?((F=q.pop())[0][F[1]]=E,_=void 0,E=F[0]):N=="-"?ae=-1:_===void 0?s.hasOwnProperty(N)?(re+=s[N],_=parseInt(re,16)*ae,ae=1,re=""):re+=N:s.hasOwnProperty(N)?(J+=s[N],E[_]=parseInt(J,16)*ae,ae=1,_=void 0,J=""):J+=N;return g},m={codePages:["WinAnsiEncoding"],WinAnsiEncoding:b("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},T={Unicode:{Courier:m,"Courier-Bold":m,"Courier-BoldOblique":m,"Courier-Oblique":m,Helvetica:m,"Helvetica-Bold":m,"Helvetica-BoldOblique":m,"Helvetica-Oblique":m,"Times-Roman":m,"Times-Bold":m,"Times-BoldItalic":m,"Times-Italic":m}},D={Unicode:{"Courier-Oblique":b("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":b("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":b("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:b("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":b("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":b("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:b("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:b("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":b("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:b("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":b("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":b("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":b("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":b("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(M){var S=M.font,F=D.Unicode[S.postScriptName];F&&(S.metadata.Unicode={},S.metadata.Unicode.widths=F.widths,S.metadata.Unicode.kerning=F.kerning);var _=T.Unicode[S.postScriptName];_&&(S.metadata.Unicode.encoding=_,S.encoding=_.codePages[0])}])})(Wn.API),(function(n){var r=function(o){for(var s=o.length,l=new Uint8Array(s),d=0;d<s;d++)l[d]=o.charCodeAt(d);return l};n.API.events.push(["addFont",function(o){var s=void 0,l=o.font,d=o.instance;if(!l.isStandardFont){if(d===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");if(typeof(s=d.existsFileInVFS(l.postScriptName)===!1?d.loadFile(l.postScriptName):d.getFileFromVFS(l.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+l.postScriptName+"').");(function(v,p){p=/^\x00\x01\x00\x00/.test(p)?r(p):r(th(p)),v.metadata=n.API.TTFFont.open(p),v.metadata.Unicode=v.metadata.Unicode||{encoding:{},kerning:{},widths:[]},v.metadata.glyIdsUsed=[0]})(l,s)}}])})(Wn),Wn.API.addSvgAsImage=function(n,r,o,s,l,d,v,p){if(isNaN(r)||isNaN(o))throw no.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(l))throw no.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var b=document.createElement("canvas");b.width=s,b.height=l;var m=b.getContext("2d");m.fillStyle="#fff",m.fillRect(0,0,b.width,b.height);var T={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},D=this;return(ui.canvg?Promise.resolve(ui.canvg):ug(()=>import("./index.es-B5wh8UW3.js"),[])).catch(function(M){return Promise.reject(new Error("Could not load canvg: "+M))}).then(function(M){return M.default?M.default:M}).then(function(M){return M.fromString(m,n,T)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(M){return M.render(T)}).then(function(){D.addImage(b.toDataURL("image/jpeg",1),r,o,s,l,v,p)})},Wn.API.putTotalPages=function(n){var r,o=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(r=new RegExp(n,"g"),o=this.internal.getNumberOfPages()):(r=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),o=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var s=1;s<=this.internal.getNumberOfPages();s++)for(var l=0;l<this.internal.pages[s].length;l++)this.internal.pages[s][l]=this.internal.pages[s][l].replace(r,o);return this},Wn.API.viewerPreferences=function(n,r){var o;n=n||{},r=r||!1;var s,l,d,v={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},p=Object.keys(v),b=[],m=0,T=0,D=0;function M(F,_){var N,g=!1;for(N=0;N<F.length;N+=1)F[N]===_&&(g=!0);return g}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(v)),this.internal.viewerpreferences.isSubscribed=!1),o=this.internal.viewerpreferences.configuration,n==="reset"||r===!0){var S=p.length;for(D=0;D<S;D+=1)o[p[D]].value=o[p[D]].defaultValue,o[p[D]].explicitSet=!1}if(Ir(n)==="object"){for(l in n)if(d=n[l],M(p,l)&&d!==void 0){if(o[l].type==="boolean"&&typeof d=="boolean")o[l].value=d;else if(o[l].type==="name"&&M(o[l].valueSet,d))o[l].value=d;else if(o[l].type==="integer"&&Number.isInteger(d))o[l].value=d;else if(o[l].type==="array"){for(m=0;m<d.length;m+=1)if(s=!0,d[m].length===1&&typeof d[m][0]=="number")b.push(String(d[m]-1));else if(d[m].length>1){for(T=0;T<d[m].length;T+=1)typeof d[m][T]!="number"&&(s=!1);s===!0&&b.push([d[m][0]-1,d[m][1]-1].join(" "))}o[l].value="["+b.join(" ")+"]"}else o[l].value=o[l].defaultValue;o[l].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var F,_=[];for(F in o)o[F].explicitSet===!0&&(o[F].type==="name"?_.push("/"+F+" /"+o[F].value):_.push("/"+F+" "+o[F].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=o,this},(function(n){var r=function(){var s='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',l=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),d=unescape(encodeURIComponent(s)),v=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),p=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),b=unescape(encodeURIComponent("</x:xmpmeta>")),m=d.length+v.length+p.length+l.length+b.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+m+" >>"),this.internal.write("stream"),this.internal.write(l+d+v+p+b),this.internal.write("endstream"),this.internal.write("endobj")},o=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(s,l){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:s,namespaceuri:l||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",o),this.internal.events.subscribe("postPutResources",r)),this}})(Wn.API),(function(n){var r=n.API,o=r.pdfEscape16=function(d,v){for(var p,b=v.metadata.Unicode.widths,m=["","0","00","000","0000"],T=[""],D=0,M=d.length;D<M;++D){if(p=v.metadata.characterToGlyph(d.charCodeAt(D)),v.metadata.glyIdsUsed.push(p),v.metadata.toUnicode[p]=d.charCodeAt(D),b.indexOf(p)==-1&&(b.push(p),b.push([parseInt(v.metadata.widthOfGlyph(p),10)])),p=="0")return T.join("");p=p.toString(16),T.push(m[4-p.length],p)}return T.join("")},s=function(d){var v,p,b,m,T,D,M;for(T=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,b=[],D=0,M=(p=Object.keys(d).sort(function(S,F){return S-F})).length;D<M;D++)v=p[D],b.length>=100&&(T+=`
`+b.length+` beginbfchar
`+b.join(`
`)+`
endbfchar`,b=[]),d[v]!==void 0&&d[v]!==null&&typeof d[v].toString=="function"&&(m=("0000"+d[v].toString(16)).slice(-4),v=("0000"+(+v).toString(16)).slice(-4),b.push("<"+v+"><"+m+">"));return b.length&&(T+=`
`+b.length+` beginbfchar
`+b.join(`
`)+`
endbfchar
`),T+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};r.events.push(["putFont",function(d){(function(v){var p=v.font,b=v.out,m=v.newObject,T=v.putStream;if(p.metadata instanceof n.API.TTFFont&&p.encoding==="Identity-H"){for(var D=p.metadata.Unicode.widths,M=p.metadata.subset.encode(p.metadata.glyIdsUsed,1),S="",F=0;F<M.length;F++)S+=String.fromCharCode(M[F]);var _=m();T({data:S,addLength1:!0,objectId:_}),b("endobj");var N=m();T({data:s(p.metadata.toUnicode),addLength1:!0,objectId:N}),b("endobj");var g=m();b("<<"),b("/Type /FontDescriptor"),b("/FontName /"+Kd(p.fontName)),b("/FontFile2 "+_+" 0 R"),b("/FontBBox "+n.API.PDFObject.convert(p.metadata.bbox)),b("/Flags "+p.metadata.flags),b("/StemV "+p.metadata.stemV),b("/ItalicAngle "+p.metadata.italicAngle),b("/Ascent "+p.metadata.ascender),b("/Descent "+p.metadata.decender),b("/CapHeight "+p.metadata.capHeight),b(">>"),b("endobj");var ae=m();b("<<"),b("/Type /Font"),b("/BaseFont /"+Kd(p.fontName)),b("/FontDescriptor "+g+" 0 R"),b("/W "+n.API.PDFObject.convert(D)),b("/CIDToGIDMap /Identity"),b("/DW 1000"),b("/Subtype /CIDFontType2"),b("/CIDSystemInfo"),b("<<"),b("/Supplement 0"),b("/Registry (Adobe)"),b("/Ordering ("+p.encoding+")"),b(">>"),b(">>"),b("endobj"),p.objectNumber=m(),b("<<"),b("/Type /Font"),b("/Subtype /Type0"),b("/ToUnicode "+N+" 0 R"),b("/BaseFont /"+Kd(p.fontName)),b("/Encoding /"+p.encoding),b("/DescendantFonts ["+ae+" 0 R]"),b(">>"),b("endobj"),p.isAlreadyPutted=!0}})(d)}]),r.events.push(["putFont",function(d){(function(v){var p=v.font,b=v.out,m=v.newObject,T=v.putStream;if(p.metadata instanceof n.API.TTFFont&&p.encoding==="WinAnsiEncoding"){for(var D=p.metadata.rawData,M="",S=0;S<D.length;S++)M+=String.fromCharCode(D[S]);var F=m();T({data:M,addLength1:!0,objectId:F}),b("endobj");var _=m();T({data:s(p.metadata.toUnicode),addLength1:!0,objectId:_}),b("endobj");var N=m();b("<<"),b("/Descent "+p.metadata.decender),b("/CapHeight "+p.metadata.capHeight),b("/StemV "+p.metadata.stemV),b("/Type /FontDescriptor"),b("/FontFile2 "+F+" 0 R"),b("/Flags 96"),b("/FontBBox "+n.API.PDFObject.convert(p.metadata.bbox)),b("/FontName /"+Kd(p.fontName)),b("/ItalicAngle "+p.metadata.italicAngle),b("/Ascent "+p.metadata.ascender),b(">>"),b("endobj"),p.objectNumber=m();for(var g=0;g<p.metadata.hmtx.widths.length;g++)p.metadata.hmtx.widths[g]=parseInt(p.metadata.hmtx.widths[g]*(1e3/p.metadata.head.unitsPerEm));b("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+Kd(p.fontName)+"/FontDescriptor "+N+" 0 R/Encoding/"+p.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(p.metadata.hmtx.widths)+">>"),b("endobj"),p.isAlreadyPutted=!0}})(d)}]);var l=function(d){var v,p=d.text||"",b=d.x,m=d.y,T=d.options||{},D=d.mutex||{},M=D.pdfEscape,S=D.activeFontKey,F=D.fonts,_=S,N="",g=0,ae="",E=F[_].encoding;if(F[_].encoding!=="Identity-H")return{text:p,x:b,y:m,options:T,mutex:D};for(ae=p,_=S,Array.isArray(p)&&(ae=p[0]),g=0;g<ae.length;g+=1)F[_].metadata.hasOwnProperty("cmap")&&(v=F[_].metadata.cmap.unicode.codeMap[ae[g].charCodeAt(0)]),v||ae[g].charCodeAt(0)<256&&F[_].metadata.hasOwnProperty("Unicode")?N+=ae[g]:N+="";var q="";return parseInt(_.slice(1))<14||E==="WinAnsiEncoding"?q=M(N,_).split("").map(function(re){return re.charCodeAt(0).toString(16)}).join(""):E==="Identity-H"&&(q=o(N,F[_])),D.isHex=!0,{text:q,x:b,y:m,options:T,mutex:D}};r.events.push(["postProcessText",function(d){var v=d.text||"",p=[],b={text:v,x:d.x,y:d.y,options:d.options,mutex:d.mutex};if(Array.isArray(v)){var m=0;for(m=0;m<v.length;m+=1)Array.isArray(v[m])&&v[m].length===3?p.push([l(Object.assign({},b,{text:v[m][0]})).text,v[m][1],v[m][2]]):p.push(l(Object.assign({},b,{text:v[m]})).text);d.text=p}else d.text=l(Object.assign({},b,{text:v})).text}])})(Wn),(function(n){var r=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(o){return r.call(this),this.internal.vFS[o]!==void 0},n.addFileToVFS=function(o,s){return r.call(this),this.internal.vFS[o]=s,this},n.getFileFromVFS=function(o){return r.call(this),this.internal.vFS[o]!==void 0?this.internal.vFS[o]:null}})(Wn.API),(function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(s){var l,d,v,p,b,m,T,D=r,M=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],S=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],F={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},N=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),ae=!1,E=0;this.__bidiEngine__={};var q=function(H){var R=H.charCodeAt(),Z=R>>8,G=_[Z];return G!==void 0?D[256*G+(255&R)]:Z===252||Z===253?"AL":g.test(Z)?"L":Z===8?"R":"N"},re=function(H){for(var R,Z=0;Z<H.length;Z++){if((R=q(H.charAt(Z)))==="L")return!1;if(R==="R")return!0}return!1},J=function(H,R,Z,G){var we,te,de,Ce,Re=R[G];switch(Re){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":ae=!1;break;case"N":case"AN":break;case"EN":ae&&(Re="AN");break;case"AL":ae=!0,Re="R";break;case"WS":case"BN":Re="N";break;case"CS":G<1||G+1>=R.length||(we=Z[G-1])!=="EN"&&we!=="AN"||(te=R[G+1])!=="EN"&&te!=="AN"?Re="N":ae&&(te="AN"),Re=te===we?te:"N";break;case"ES":Re=(we=G>0?Z[G-1]:"B")==="EN"&&G+1<R.length&&R[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&Z[G-1]==="EN"){Re="EN";break}if(ae){Re="N";break}for(de=G+1,Ce=R.length;de<Ce&&R[de]==="ET";)de++;Re=de<Ce&&R[de]==="EN"?"EN":"N";break;case"NSM":if(v&&!p){for(Ce=R.length,de=G+1;de<Ce&&R[de]==="NSM";)de++;if(de<Ce){var xe=H[G],k=xe>=1425&&xe<=2303||xe===64286;if(we=R[de],k&&(we==="R"||we==="AL")){Re="R";break}}}Re=G<1||(we=R[G-1])==="B"?"N":Z[G-1];break;case"B":ae=!1,l=!0,Re=E;break;case"S":d=!0,Re="N"}return Re},Y=function(H,R,Z){var G=H.split("");return Z&&ee(G,Z,{hiLevel:E}),G.reverse(),R&&R.reverse(),G.join("")},ee=function(H,R,Z){var G,we,te,de,Ce,Re=-1,xe=H.length,k=0,A=[],V=E?S:M,W=[];for(ae=!1,l=!1,d=!1,we=0;we<xe;we++)W[we]=q(H[we]);for(te=0;te<xe;te++){if(Ce=k,A[te]=J(H,W,A,te),G=240&(k=V[Ce][F[A[te]]]),k&=15,R[te]=de=V[k][5],G>0)if(G===16){for(we=Re;we<te;we++)R[we]=1;Re=-1}else Re=-1;if(V[k][6])Re===-1&&(Re=te);else if(Re>-1){for(we=Re;we<te;we++)R[we]=de;Re=-1}W[te]==="B"&&(R[te]=0),Z.hiLevel|=de}d&&(function(se,Te,le){for(var _e=0;_e<le;_e++)if(se[_e]==="S"){Te[_e]=E;for(var ve=_e-1;ve>=0&&se[ve]==="WS";ve--)Te[ve]=E}})(W,R,xe)},U=function(H,R,Z,G,we){if(!(we.hiLevel<H)){if(H===1&&E===1&&!l)return R.reverse(),void(Z&&Z.reverse());for(var te,de,Ce,Re,xe=R.length,k=0;k<xe;){if(G[k]>=H){for(Ce=k+1;Ce<xe&&G[Ce]>=H;)Ce++;for(Re=k,de=Ce-1;Re<de;Re++,de--)te=R[Re],R[Re]=R[de],R[de]=te,Z&&(te=Z[Re],Z[Re]=Z[de],Z[de]=te);k=Ce}k++}}},$=function(H,R,Z){var G=H.split(""),we={hiLevel:E};return Z||(Z=[]),ee(G,Z,we),(function(te,de,Ce){if(Ce.hiLevel!==0&&T)for(var Re,xe=0;xe<te.length;xe++)de[xe]===1&&(Re=N.indexOf(te[xe]))>=0&&(te[xe]=N[Re+1])})(G,Z,we),U(2,G,R,Z,we),U(1,G,R,Z,we),G.join("")};return this.__bidiEngine__.doBidiReorder=function(H,R,Z){if((function(we,te){if(te)for(var de=0;de<we.length;de++)te[de]=de;p===void 0&&(p=re(we)),m===void 0&&(m=re(we))})(H,R),v||!b||m)if(v&&b&&p^m)E=p?1:0,H=Y(H,R,Z);else if(!v&&b&&m)E=p?1:0,H=$(H,R,Z),H=Y(H,R);else if(!v||p||b||m){if(v&&!b&&p^m)H=Y(H,R),p?(E=0,H=$(H,R,Z)):(E=1,H=$(H,R,Z),H=Y(H,R));else if(v&&p&&!b&&m)E=1,H=$(H,R,Z),H=Y(H,R);else if(!v&&!b&&p^m){var G=T;p?(E=1,H=$(H,R,Z),E=0,T=!1,H=$(H,R,Z),T=G):(E=0,H=$(H,R,Z),H=Y(H,R),E=1,T=!1,H=$(H,R,Z),T=G,H=Y(H,R))}}else E=0,H=$(H,R,Z);else E=p?1:0,H=$(H,R,Z);return H},this.__bidiEngine__.setOptions=function(H){H&&(v=H.isInputVisual,b=H.isOutputVisual,p=H.isInputRtl,m=H.isOutputRtl,T=H.isSymmetricSwapping)},this.__bidiEngine__.setOptions(s),this.__bidiEngine__};var r=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],o=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(s){var l=s.text;s.x,s.y;var d=s.options||{};s.mutex,d.lang;var v=[];if(d.isInputVisual=typeof d.isInputVisual!="boolean"||d.isInputVisual,o.setOptions(d),Object.prototype.toString.call(l)==="[object Array]"){var p=0;for(v=[],p=0;p<l.length;p+=1)Object.prototype.toString.call(l[p])==="[object Array]"?v.push([o.doBidiReorder(l[p][0]),l[p][1],l[p][2]]):v.push([o.doBidiReorder(l[p])]);s.text=v}else s.text=o.doBidiReorder(l);o.setOptions({isInputVisual:!0})}])})(Wn),Wn.API.TTFFont=(function(){function n(r){var o;if(this.rawData=r,o=this.contents=new Eu(r),this.contents.pos=4,o.readString(4)==="ttcf")throw new Error("TTCF not supported.");o.pos=0,this.parse(),this.subset=new A5(this),this.registerTTF()}return n.open=function(r){return new n(r)},n.prototype.parse=function(){return this.directory=new h5(this.contents),this.head=new y5(this),this.name=new w5(this),this.cmap=new Bx(this),this.toUnicode={},this.hhea=new x5(this),this.maxp=new S5(this),this.hmtx=new j5(this),this.post=new b5(this),this.os2=new m5(this),this.loca=new k5(this),this.glyf=new T5(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var r,o,s,l,d;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var v,p,b,m;for(m=[],v=0,p=(b=this.bbox).length;v<p;v++)r=b[v],m.push(Math.round(r*this.scaleFactor));return m}).call(this),this.stemV=0,this.post.exists?(s=255&(l=this.post.italic_angle),32768&(o=l>>16)&&(o=-(1+(65535^o))),this.italicAngle=+(o+"."+s)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(d=this.familyClass)===1||d===2||d===3||d===4||d===5||d===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(r){var o;return((o=this.cmap.unicode)!=null?o.codeMap[r]:void 0)||0},n.prototype.widthOfGlyph=function(r){var o;return o=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(r).advance*o},n.prototype.widthOfString=function(r,o,s){var l,d,v,p;for(v=0,d=0,p=(r=""+r).length;0<=p?d<p:d>p;d=0<=p?++d:--d)l=r.charCodeAt(d),v+=this.widthOfGlyph(this.characterToGlyph(l))+s*(1e3/o)||0;return v*(o/1e3)},n.prototype.lineHeight=function(r,o){var s;return o==null&&(o=!1),s=o?this.lineGap:0,(this.ascender+s-this.decender)/1e3*r},n})();var _c,Eu=(function(){function n(r){this.data=r??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(r){return this.data[this.pos++]=r},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(r){return this.writeByte(r>>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt32=function(){var r;return(r=this.readUInt32())>=2147483648?r-4294967296:r},n.prototype.writeInt32=function(r){return r<0&&(r+=4294967296),this.writeUInt32(r)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(r){return this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt16=function(){var r;return(r=this.readUInt16())>=32768?r-65536:r},n.prototype.writeInt16=function(r){return r<0&&(r+=65536),this.writeUInt16(r)},n.prototype.readString=function(r){var o,s;for(s=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)s[o]=String.fromCharCode(this.readByte());return s.join("")},n.prototype.writeString=function(r){var o,s,l;for(l=[],o=0,s=r.length;0<=s?o<s:o>s;o=0<=s?++o:--o)l.push(this.writeByte(r.charCodeAt(o)));return l},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(r){return this.writeInt16(r)},n.prototype.readLongLong=function(){var r,o,s,l,d,v,p,b;return r=this.readByte(),o=this.readByte(),s=this.readByte(),l=this.readByte(),d=this.readByte(),v=this.readByte(),p=this.readByte(),b=this.readByte(),128&r?-1*(72057594037927940*(255^r)+281474976710656*(255^o)+1099511627776*(255^s)+4294967296*(255^l)+16777216*(255^d)+65536*(255^v)+256*(255^p)+(255^b)+1):72057594037927940*r+281474976710656*o+1099511627776*s+4294967296*l+16777216*d+65536*v+256*p+b},n.prototype.writeLongLong=function(r){var o,s;return o=Math.floor(r/4294967296),s=4294967295&r,this.writeByte(o>>24&255),this.writeByte(o>>16&255),this.writeByte(o>>8&255),this.writeByte(255&o),this.writeByte(s>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(r){return this.writeInt32(r)},n.prototype.read=function(r){var o,s;for(o=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)o.push(this.readByte());return o},n.prototype.write=function(r){var o,s,l,d;for(d=[],s=0,l=r.length;s<l;s++)o=r[s],d.push(this.writeByte(o));return d},n})(),h5=(function(){var n;function r(o){var s,l,d;for(this.scalarType=o.readInt(),this.tableCount=o.readShort(),this.searchRange=o.readShort(),this.entrySelector=o.readShort(),this.rangeShift=o.readShort(),this.tables={},l=0,d=this.tableCount;0<=d?l<d:l>d;l=0<=d?++l:--l)s={tag:o.readString(4),checksum:o.readInt(),offset:o.readInt(),length:o.readInt()},this.tables[s.tag]=s}return r.prototype.encode=function(o){var s,l,d,v,p,b,m,T,D,M,S,F,_;for(_ in S=Object.keys(o).length,b=Math.log(2),D=16*Math.floor(Math.log(S)/b),v=Math.floor(D/b),T=16*S-D,(l=new Eu).writeInt(this.scalarType),l.writeShort(S),l.writeShort(D),l.writeShort(v),l.writeShort(T),d=16*S,m=l.pos+d,p=null,F=[],o)for(M=o[_],l.writeString(_),l.writeInt(n(M)),l.writeInt(m),l.writeInt(M.length),F=F.concat(M),_==="head"&&(p=m),m+=M.length;m%4;)F.push(0),m++;return l.write(F),s=2981146554-n(l.data),l.pos=p+8,l.writeUInt32(s),l.data},n=function(o){var s,l,d,v;for(o=Ox.call(o);o.length%4;)o.push(0);for(d=new Eu(o),l=0,s=0,v=o.length;s<v;s=s+=4)l+=d.readUInt32();return 4294967295&l},r})(),g5={}.hasOwnProperty,Kc=function(n,r){for(var o in r)g5.call(r,o)&&(n[o]=r[o]);function s(){this.constructor=n}return s.prototype=r.prototype,n.prototype=new s,n.__super__=r.prototype,n};_c=(function(){function n(r){var o;this.file=r,o=this.file.directory.tables[this.tag],this.exists=!!o,o&&(this.offset=o.offset,this.length=o.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n})();var y5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Kc(n,_c),n.prototype.tag="head",n.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},n.prototype.encode=function(r){var o;return(o=new Eu).writeInt(this.version),o.writeInt(this.revision),o.writeInt(this.checkSumAdjustment),o.writeInt(this.magicNumber),o.writeShort(this.flags),o.writeShort(this.unitsPerEm),o.writeLongLong(this.created),o.writeLongLong(this.modified),o.writeShort(this.xMin),o.writeShort(this.yMin),o.writeShort(this.xMax),o.writeShort(this.yMax),o.writeShort(this.macStyle),o.writeShort(this.lowestRecPPEM),o.writeShort(this.fontDirectionHint),o.writeShort(r),o.writeShort(this.glyphDataFormat),o.data},n})(),My=(function(){function n(r,o){var s,l,d,v,p,b,m,T,D,M,S,F,_,N,g,ae,E;switch(this.platformID=r.readUInt16(),this.encodingID=r.readShort(),this.offset=o+r.readInt(),D=r.pos,r.pos=this.offset,this.format=r.readUInt16(),this.length=r.readUInt16(),this.language=r.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(b=0;b<256;++b)this.codeMap[b]=r.readByte();break;case 4:for(S=r.readUInt16(),M=S/2,r.pos+=6,d=(function(){var q,re;for(re=[],b=q=0;0<=M?q<M:q>M;b=0<=M?++q:--q)re.push(r.readUInt16());return re})(),r.pos+=2,_=(function(){var q,re;for(re=[],b=q=0;0<=M?q<M:q>M;b=0<=M?++q:--q)re.push(r.readUInt16());return re})(),m=(function(){var q,re;for(re=[],b=q=0;0<=M?q<M:q>M;b=0<=M?++q:--q)re.push(r.readUInt16());return re})(),T=(function(){var q,re;for(re=[],b=q=0;0<=M?q<M:q>M;b=0<=M?++q:--q)re.push(r.readUInt16());return re})(),l=(this.length-r.pos+this.offset)/2,p=(function(){var q,re;for(re=[],b=q=0;0<=l?q<l:q>l;b=0<=l?++q:--q)re.push(r.readUInt16());return re})(),b=g=0,E=d.length;g<E;b=++g)for(N=d[b],s=ae=F=_[b];F<=N?ae<=N:ae>=N;s=F<=N?++ae:--ae)T[b]===0?v=s+m[b]:(v=p[T[b]/2+(s-F)-(M-b)]||0)!==0&&(v+=m[b]),this.codeMap[s]=65535&v}r.pos=D}return n.encode=function(r,o){var s,l,d,v,p,b,m,T,D,M,S,F,_,N,g,ae,E,q,re,J,Y,ee,U,$,H,R,Z,G,we,te,de,Ce,Re,xe,k,A,V,W,se,Te,le,_e,ve,De,Xe,st;switch(G=new Eu,v=Object.keys(r).sort(function(kt,qt){return kt-qt}),o){case"macroman":for(_=0,N=(function(){var kt=[];for(F=0;F<256;++F)kt.push(0);return kt})(),ae={0:0},d={},we=0,Re=v.length;we<Re;we++)ae[ve=r[l=v[we]]]==null&&(ae[ve]=++_),d[l]={old:r[l],new:ae[r[l]]},N[l]=ae[r[l]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(N),{charMap:d,subtable:G.data,maxGlyphID:_+1};case"unicode":for(R=[],D=[],E=0,ae={},s={},g=m=null,te=0,xe=v.length;te<xe;te++)ae[re=r[l=v[te]]]==null&&(ae[re]=++E),s[l]={old:re,new:ae[re]},p=ae[re]-l,g!=null&&p===m||(g&&D.push(g),R.push(l),m=p),g=l;for(g&&D.push(g),D.push(65535),R.push(65535),$=2*(U=R.length),ee=2*Math.pow(Math.log(U)/Math.LN2,2),M=Math.log(ee/2)/Math.LN2,Y=2*U-ee,b=[],J=[],S=[],F=de=0,k=R.length;de<k;F=++de){if(H=R[F],T=D[F],H===65535){b.push(0),J.push(0);break}if(H-(Z=s[H].new)>=32768)for(b.push(0),J.push(2*(S.length+U-F)),l=Ce=H;H<=T?Ce<=T:Ce>=T;l=H<=T?++Ce:--Ce)S.push(s[l].new);else b.push(Z-H),J.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*U+2*S.length),G.writeUInt16(0),G.writeUInt16($),G.writeUInt16(ee),G.writeUInt16(M),G.writeUInt16(Y),le=0,A=D.length;le<A;le++)l=D[le],G.writeUInt16(l);for(G.writeUInt16(0),_e=0,V=R.length;_e<V;_e++)l=R[_e],G.writeUInt16(l);for(De=0,W=b.length;De<W;De++)p=b[De],G.writeUInt16(p);for(Xe=0,se=J.length;Xe<se;Xe++)q=J[Xe],G.writeUInt16(q);for(st=0,Te=S.length;st<Te;st++)_=S[st],G.writeUInt16(_);return{charMap:s,subtable:G.data,maxGlyphID:E+1}}},n})(),Bx=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Kc(n,_c),n.prototype.tag="cmap",n.prototype.parse=function(r){var o,s,l;for(r.pos=this.offset,this.version=r.readUInt16(),l=r.readUInt16(),this.tables=[],this.unicode=null,s=0;0<=l?s<l:s>l;s=0<=l?++s:--s)o=new My(r,this.offset),this.tables.push(o),o.isUnicode&&this.unicode==null&&(this.unicode=o);return!0},n.encode=function(r,o){var s,l;return o==null&&(o="macroman"),s=My.encode(r,o),(l=new Eu).writeUInt16(0),l.writeUInt16(1),s.table=l.data.concat(s.subtable),s},n})(),x5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Kc(n,_c),n.prototype.tag="hhea",n.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},n})(),m5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Kc(n,_c),n.prototype.tag="OS/2",n.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var o,s;for(s=[],o=0;o<10;++o)s.push(r.readByte());return s})(),this.charRange=(function(){var o,s;for(s=[],o=0;o<4;++o)s.push(r.readInt());return s})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var o,s;for(s=[],o=0;o<2;o=++o)s.push(r.readInt());return s})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},n})(),b5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Kc(n,_c),n.prototype.tag="post",n.prototype.parse=function(r){var o,s,l;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:case 196608:break;case 131072:var d;for(s=r.readUInt16(),this.glyphNameIndex=[],d=0;0<=s?d<s:d>s;d=0<=s?++d:--d)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],l=[];r.pos<this.offset+this.length;)o=r.readByte(),l.push(this.names.push(r.readString(o)));return l;case 151552:return s=r.readUInt16(),this.offsets=r.read(s);case 262144:return this.map=(function(){var v,p,b;for(b=[],d=v=0,p=this.file.maxp.numGlyphs;0<=p?v<p:v>p;d=0<=p?++v:--v)b.push(r.readUInt32());return b}).call(this)}},n})(),v5=function(n,r){this.raw=n,this.length=n.length,this.platformID=r.platformID,this.encodingID=r.encodingID,this.languageID=r.languageID},w5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Kc(n,_c),n.prototype.tag="name",n.prototype.parse=function(r){var o,s,l,d,v,p,b,m,T,D,M;for(r.pos=this.offset,r.readShort(),o=r.readShort(),p=r.readShort(),s=[],d=0;0<=o?d<o:d>o;d=0<=o?++d:--d)s.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+p+r.readShort()});for(b={},d=T=0,D=s.length;T<D;d=++T)l=s[d],r.pos=l.offset,m=r.readString(l.length),v=new v5(m,l),b[M=l.nameID]==null&&(b[M]=[]),b[l.nameID].push(v);this.strings=b,this.copyright=b[0],this.fontFamily=b[1],this.fontSubfamily=b[2],this.uniqueSubfamily=b[3],this.fontName=b[4],this.version=b[5];try{this.postscriptName=b[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=b[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=b[7],this.manufacturer=b[8],this.designer=b[9],this.description=b[10],this.vendorUrl=b[11],this.designerUrl=b[12],this.license=b[13],this.licenseUrl=b[14],this.preferredFamily=b[15],this.preferredSubfamily=b[17],this.compatibleFull=b[18],this.sampleText=b[19]},n})(),S5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Kc(n,_c),n.prototype.tag="maxp",n.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},n})(),j5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Kc(n,_c),n.prototype.tag="hmtx",n.prototype.parse=function(r){var o,s,l,d,v,p,b;for(r.pos=this.offset,this.metrics=[],o=0,p=this.file.hhea.numberOfMetrics;0<=p?o<p:o>p;o=0<=p?++o:--o)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(l=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var m,T;for(T=[],o=m=0;0<=l?m<l:m>l;o=0<=l?++m:--m)T.push(r.readInt16());return T})(),this.widths=(function(){var m,T,D,M;for(M=[],m=0,T=(D=this.metrics).length;m<T;m++)d=D[m],M.push(d.advance);return M}).call(this),s=this.widths[this.widths.length-1],b=[],o=v=0;0<=l?v<l:v>l;o=0<=l?++v:--v)b.push(this.widths.push(s));return b},n.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},n})(),Ox=[].slice,T5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Kc(n,_c),n.prototype.tag="glyf",n.prototype.parse=function(){return this.cache={}},n.prototype.glyphFor=function(r){var o,s,l,d,v,p,b,m,T,D;return r in this.cache?this.cache[r]:(d=this.file.loca,o=this.file.contents,s=d.indexOf(r),(l=d.lengthOf(r))===0?this.cache[r]=null:(o.pos=this.offset+s,v=(p=new Eu(o.read(l))).readShort(),m=p.readShort(),D=p.readShort(),b=p.readShort(),T=p.readShort(),this.cache[r]=v===-1?new N5(p,m,D,b,T):new C5(p,v,m,D,b,T),this.cache[r]))},n.prototype.encode=function(r,o,s){var l,d,v,p,b;for(v=[],d=[],p=0,b=o.length;p<b;p++)l=r[o[p]],d.push(v.length),l&&(v=v.concat(l.encode(s)));return d.push(v.length),{table:v,offsets:d}},n})(),C5=(function(){function n(r,o,s,l,d,v){this.raw=r,this.numberOfContours=o,this.xMin=s,this.yMin=l,this.xMax=d,this.yMax=v,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n})(),N5=(function(){function n(r,o,s,l,d){var v,p;for(this.raw=r,this.xMin=o,this.yMin=s,this.xMax=l,this.yMax=d,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],v=this.raw;p=v.readShort(),this.glyphOffsets.push(v.pos),this.glyphIDs.push(v.readUInt16()),32&p;)v.pos+=1&p?4:2,128&p?v.pos+=8:64&p?v.pos+=4:8&p&&(v.pos+=2)}return n.prototype.encode=function(){var r,o,s;for(o=new Eu(Ox.call(this.raw.data)),r=0,s=this.glyphIDs.length;r<s;++r)o.pos=this.glyphOffsets[r];return o.data},n})(),k5=(function(){function n(){return n.__super__.constructor.apply(this,arguments)}return Kc(n,_c),n.prototype.tag="loca",n.prototype.parse=function(r){var o,s;return r.pos=this.offset,o=this.file.head.indexToLocFormat,this.offsets=o===0?(function(){var l,d;for(d=[],s=0,l=this.length;s<l;s+=2)d.push(2*r.readUInt16());return d}).call(this):(function(){var l,d;for(d=[],s=0,l=this.length;s<l;s+=4)d.push(r.readUInt32());return d}).call(this)},n.prototype.indexOf=function(r){return this.offsets[r]},n.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},n.prototype.encode=function(r,o){for(var s=new Uint32Array(this.offsets.length),l=0,d=0,v=0;v<s.length;++v)if(s[v]=l,d<o.length&&o[d]==v){++d,s[v]=l;var p=this.offsets[v],b=this.offsets[v+1]-p;b>0&&(l+=b)}for(var m=new Array(4*s.length),T=0;T<s.length;++T)m[4*T+3]=255&s[T],m[4*T+2]=(65280&s[T])>>8,m[4*T+1]=(16711680&s[T])>>16,m[4*T]=(4278190080&s[T])>>24;return m},n})(),A5=(function(){function n(r){this.font=r,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var r,o,s,l,d;for(o in l=this.font.cmap.tables[0].codeMap,r={},d=this.subset)s=d[o],r[o]=l[s];return r},n.prototype.glyphsFor=function(r){var o,s,l,d,v,p,b;for(l={},v=0,p=r.length;v<p;v++)l[d=r[v]]=this.font.glyf.glyphFor(d);for(d in o=[],l)(s=l[d])!=null&&s.compound&&o.push.apply(o,s.glyphIDs);if(o.length>0)for(d in b=this.glyphsFor(o))s=b[d],l[d]=s;return l},n.prototype.encode=function(r,o){var s,l,d,v,p,b,m,T,D,M,S,F,_,N,g;for(l in s=Bx.encode(this.generateCmap(),"unicode"),v=this.glyphsFor(r),S={0:0},g=s.charMap)S[(b=g[l]).old]=b.new;for(F in M=s.maxGlyphID,v)F in S||(S[F]=M++);return T=(function(ae){var E,q;for(E in q={},ae)q[ae[E]]=E;return q})(S),D=Object.keys(T).sort(function(ae,E){return ae-E}),_=(function(){var ae,E,q;for(q=[],ae=0,E=D.length;ae<E;ae++)p=D[ae],q.push(T[p]);return q})(),d=this.font.glyf.encode(v,_,S),m=this.font.loca.encode(d.offsets,_),N={cmap:this.font.cmap.raw(),glyf:d.table,loca:m,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(o)},this.font.os2.exists&&(N["OS/2"]=this.font.os2.raw()),this.font.directory.encode(N)},n})();Wn.API.PDFObject=(function(){var n;function r(){}return n=function(o,s){return(Array(s+1).join("0")+o).slice(-s)},r.convert=function(o){var s,l,d,v;if(Array.isArray(o))return"["+(function(){var p,b,m;for(m=[],p=0,b=o.length;p<b;p++)s=o[p],m.push(r.convert(s));return m})().join(" ")+"]";if(typeof o=="string")return"/"+o;if(o?.isString)return"("+o+")";if(o instanceof Date)return"(D:"+n(o.getUTCFullYear(),4)+n(o.getUTCMonth(),2)+n(o.getUTCDate(),2)+n(o.getUTCHours(),2)+n(o.getUTCMinutes(),2)+n(o.getUTCSeconds(),2)+"Z)";if({}.toString.call(o)==="[object Object]"){for(l in d=["<<"],o)v=o[l],d.push("/"+l+" "+r.convert(v));return d.push(">>"),d.join(`
`)}return""+o},r})();const Dg=n=>{const r=Kg[n];return!r||!r.prefix||r.prefix.length<1?"?":r.prefix[0].substring(0,1).toUpperCase()},hc=(n,r,o)=>({color:r,size:o}),By=(n,r,o)=>{},Oo=(n,r,o,s)=>({color:o,size:s}),Yd=(n,r,o,s)=>{},z5=()=>{const n=new Map,r={top:"#0072B2",bottom:"#56B4E9"},o={top:18,bottom:18},s={top:"#FFFF00",bottom:"#FFFF00"},l={top:18,bottom:18},d={top:"#AA4499",bottom:"#F781BF"},v={top:6,bottom:6},p={top:"#6A3D9A",bottom:"#9467BD"},b={top:18,bottom:18};return n.set("select",{id:"select",name:"Select",toolType:"select",icon:"",shortcut:"S",tooltip:"Select objects or groups",colorReflective:!1,settings:hc("select","#ff0000",10),layerSettings:new Map([["top",Oo("select","top","#ff0000",10)],["bottom",Oo("select","bottom","#ff0000",10)]])}),n.set("via",{id:"via",name:"Via",toolType:"draw",drawingMode:"via",icon:"",shortcut:"V",tooltip:"Place via connection",colorReflective:!0,settings:hc("via",ig,ag.DEFAULT_SIZE),layerSettings:new Map([["top",Oo("via","top",ig,ag.DEFAULT_SIZE)],["bottom",Oo("via","bottom",ig,ag.DEFAULT_SIZE)]]),defaultLayer:"top"}),n.set("pad",{id:"pad",name:"Pad",toolType:"draw",drawingMode:"pad",icon:"",shortcut:"P",tooltip:"Place pad connection",colorReflective:!0,settings:hc("pad",s2,18),layerSettings:new Map([["top",Oo("pad","top",r.top,o.top)],["bottom",Oo("pad","bottom",r.bottom,o.bottom)]]),defaultLayer:"top"}),n.set("testPoint",{id:"testPoint",name:"Test Point",toolType:"draw",drawingMode:"testPoint",icon:"",shortcut:"Y",tooltip:"Place test point",colorReflective:!0,settings:hc("testPoint","#FFFF00",18),layerSettings:new Map([["top",Oo("testPoint","top",s.top,l.top)],["bottom",Oo("testPoint","bottom",s.bottom,l.bottom)]]),defaultLayer:"top"}),n.set("trace",{id:"trace",name:"Trace",toolType:"draw",drawingMode:"trace",icon:"",shortcut:"T",tooltip:"Draw copper traces",colorReflective:!0,settings:hc("trace",o2,6),layerSettings:new Map([["top",Oo("trace","top",d.top,v.top)],["bottom",Oo("trace","bottom",d.bottom,v.bottom)]]),defaultLayer:"top"}),n.set("component",{id:"component",name:"Component",toolType:"component",icon:"",shortcut:"C",tooltip:"Place component",colorReflective:!0,settings:hc("component",a2,Xg.DEFAULT_SIZE),layerSettings:new Map([["top",Oo("component","top",p.top,b.top)],["bottom",Oo("component","bottom",p.bottom,b.bottom)]]),defaultLayer:"top"}),n.set("componentConnection",{id:"componentConnection",name:"Component Connections",toolType:"componentConnection",icon:"",shortcut:"",tooltip:"Component connection lines",colorReflective:!1,settings:hc("componentConnection","#E69F00",3),layerSettings:new Map([["top",Oo("componentConnection","top","#E69F00",3)],["bottom",Oo("componentConnection","bottom","#E69F00",3)]])}),n.set("power",{id:"power",name:"Power",toolType:"power",icon:"",shortcut:"B",tooltip:"Place power node",colorReflective:!0,settings:hc("power",og,18),layerSettings:new Map([["top",Oo("power","top",og,18)],["bottom",Oo("power","bottom",og,18)]]),defaultLayer:"top"}),n.set("ground",{id:"ground",name:"Ground",toolType:"ground",icon:"",shortcut:"G",tooltip:"Place ground symbol",colorReflective:!0,settings:hc("ground",rg,18),layerSettings:new Map([["top",Oo("ground","top",rg,18)],["bottom",Oo("ground","bottom",rg,18)]]),defaultLayer:"top"}),n.set("erase",{id:"erase",name:"Erase",toolType:"erase",icon:"",shortcut:"E",tooltip:"Erase objects",colorReflective:!1,settings:hc("erase","#f5a3b3",18),layerSettings:new Map([["top",Oo("erase","top","#f5a3b3",18)],["bottom",Oo("erase","bottom","#f5a3b3",18)]])}),n.set("pan",{id:"pan",name:"Move",toolType:"pan",icon:"",shortcut:"H",tooltip:"Pan the view",colorReflective:!1,settings:hc("pan","#ff0000",10),layerSettings:new Map([["top",Oo("pan","top","#ff0000",10)],["bottom",Oo("pan","bottom","#ff0000",10)]])}),n.set("magnify",{id:"magnify",name:"Zoom",toolType:"magnify",icon:"+",shortcut:"M",tooltip:"Magnify",colorReflective:!1,settings:hc("magnify","#ff0000",10),layerSettings:new Map([["top",Oo("magnify","top","#ff0000",10)],["bottom",Oo("magnify","bottom","#ff0000",10)]])}),n},P5=({visible:n,toolRegistry:r,currentTool:o,drawingMode:s,traceToolLayer:l,padToolLayer:d,testPointToolLayer:v,componentToolLayer:p,updateToolSettings:b,updateToolLayerSettings:m,setBrushSize:T,saveToolSettings:D,saveToolLayerSettings:M,setTopTraceSize:S,setBottomTraceSize:F,setTopPadSize:_,setBottomPadSize:N,setTopTestPointSize:g,setBottomTestPointSize:ae,setTopComponentSize:E,setBottomComponentSize:q,setComponentConnectionSize:re,saveDefaultSize:J,onClose:Y})=>{const[ee,U]=I.useState({}),$=[{id:"via",name:"Via",instanceId:"via"},{id:"pad",name:"Pad",layer:"top",instanceId:"padTop"},{id:"pad",name:"Pad",layer:"bottom",instanceId:"padBottom"},{id:"testPoint",name:"Test Point",layer:"top",instanceId:"testPointTop"},{id:"testPoint",name:"Test Point",layer:"bottom",instanceId:"testPointBottom"},{id:"trace",name:"Trace",layer:"top",instanceId:"traceTop"},{id:"trace",name:"Trace",layer:"bottom",instanceId:"traceBottom"},{id:"component",name:"Component",layer:"top",instanceId:"componentTop"},{id:"component",name:"Component",layer:"bottom",instanceId:"componentBottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power",instanceId:"power"},{id:"ground",name:"Ground",instanceId:"ground"},{id:"erase",name:"Erase"}];I.useEffect(()=>{if(n){const Z={};for(const G of $){const we=G.instanceId||G.id;if(G.instanceId)try{const te=Un.get(G.instanceId);Z[we]=te.size}catch{const te=r.get(G.id);te&&(Z[we]=G.layer?te.layerSettings.get(G.layer)?.size??te.settings.size??10:te.settings.size??10)}else{const te=r.get(G.id);te&&(Z[we]=te.settings.size??10)}}U(Z)}},[n]);const H=I.useCallback((Z,G,we,te)=>{if(!r.get(Z)&&Z!=="componentConnection")return;const Ce=te||Z;U(xe=>({...xe,[Ce]:G})),["trace","pad","testPoint","component"].includes(Z)&&we&&te?(Un.setSize(te,G),(Z==="trace"&&o==="draw"&&s==="trace"||Z==="pad"&&o==="draw"&&s==="pad"||Z==="testPoint"&&o==="draw"&&s==="testPoint"||Z==="component"&&o==="component")&&((Z==="trace"?l:Z==="pad"?d:Z==="testPoint"?v:p)||"top")===we&&T(G)):te?(Un.setSize(te,G),(Z==="via"&&o==="draw"&&s==="via"||Z==="power"&&o==="power"||Z==="ground"&&o==="ground")&&T(G)):(Z==="componentConnection"&&(re(G),J("componentConnection",G)),Z==="erase"&&o==="erase"&&T(G))},[r,o,s,l,d,v,p,T,re,J]);if(!n)return null;const R=Array.from({length:50},(Z,G)=>G+1);return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:Z=>{Z.target===Z.currentTarget&&Y()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",maxWidth:"400px",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Z=>Z.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Size"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:$.map((Z,G)=>{if(!r.get(Z.id)&&Z.id!=="componentConnection")return null;const te=Z.layer?`${Z.name} (${Z.layer==="top"?"Top":"Bottom"})`:Z.name,de=Z.instanceId||Z.id,Ce=ee[de]??10;return i.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[i.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[te,":"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("select",{value:Ce,onChange:Re=>{const xe=parseInt(Re.target.value,10);H(Z.id,xe,Z.layer,Z.instanceId)},style:{width:"50px",padding:"4px 6px",background:"#2b2b31",border:"1px solid #3a3a44",borderRadius:4,color:"#f2f2f2",fontSize:"12px",cursor:"pointer"},children:R.map(Re=>i.jsx("option",{value:Re,style:{background:"#2b2b31",color:"#f2f2f2"},children:Re},Re))}),i.jsx("span",{style:{color:"#f2f2f2",fontSize:"12px"},children:"px"})]})]},`${Z.id}-${Z.layer||"default"}-${G}`)})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:Y,style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},_5=({visible:n,toolRegistry:r,currentTool:o,drawingMode:s,traceToolLayer:l,padToolLayer:d,testPointToolLayer:v,componentToolLayer:p,updateToolSettings:b,updateToolLayerSettings:m,saveToolSettings:T,saveToolLayerSettings:D,setBrushColor:M,setTopTraceColor:S,setBottomTraceColor:F,setTopPadColor:_,setBottomPadColor:N,setTopTestPointColor:g,setBottomTestPointColor:ae,setTopComponentColor:E,setBottomComponentColor:q,setComponentConnectionColor:re,saveDefaultColor:J,colorPalette:Y,onClose:ee})=>{const[U,$]=At.useState(null),[H,R]=At.useState(0);if(At.useEffect(()=>{const de=[];return[{id:"via"},{id:"pad",layer:"top"},{id:"pad",layer:"bottom"},{id:"testPoint",layer:"top"},{id:"testPoint",layer:"bottom"},{id:"trace",layer:"top"},{id:"trace",layer:"bottom"},{id:"component",layer:"top"},{id:"component",layer:"bottom"},{id:"power"},{id:"ground"}].forEach(({id:Re,layer:xe})=>{try{const k=Hp(Re,xe),A=Un.subscribe(k,()=>{R(V=>V+1)});de.push(A)}catch{}}),()=>{de.forEach(Re=>Re())}},[]),!n)return null;const Z=["pad","testPoint","trace","component"],G=[{id:"via",name:"Via"},{id:"pad",name:"Pad",layer:"top"},{id:"pad",name:"Pad",layer:"bottom"},{id:"testPoint",name:"Test Point",layer:"top"},{id:"testPoint",name:"Test Point",layer:"bottom"},{id:"trace",name:"Trace",layer:"top"},{id:"trace",name:"Trace",layer:"bottom"},{id:"component",name:"Component",layer:"top"},{id:"component",name:"Component",layer:"bottom"},{id:"componentConnection",name:"Component Connections"},{id:"power",name:"Power"},{id:"ground",name:"Ground"},{id:"erase",name:"Erase"}],we=(de,Ce,Re)=>{if(de==="componentConnection"){re(Ce),J("componentConnection",Ce),$(null);return}if(de==="erase"){const xe=r.get(de);xe&&(b(de,{...xe.settings,color:Ce}),T(de,Ce,xe.settings.size)),$(null);return}try{let xe;Re&&Z.includes(de)?xe=Hp(de,Re):xe=Hp(de),Un.setColor(xe,Ce),(de==="via"&&o==="draw"&&s==="via"||de==="trace"&&o==="draw"&&s==="trace"||de==="pad"&&o==="draw"&&s==="pad"||de==="testPoint"&&o==="draw"&&s==="testPoint"||de==="component"&&o==="component"||de==="power"&&o==="power"||de==="ground"&&o==="ground")&&(Re&&Z.includes(de)?((de==="trace"?l:de==="pad"?d:de==="testPoint"?v:p)||"top")===Re&&M(Ce):M(Ce))}catch(xe){console.error(`Error updating color for tool ${de}:`,xe);const k=r.get(de);k&&(Re&&Z.includes(de)?(m(de,Re,{...k.layerSettings.get(Re),color:Ce}),D(de,Re,Ce,k.layerSettings.get(Re)?.size||k.settings.size)):(b(de,{...k.settings,color:Ce}),T(de,Ce,k.settings.size)))}$(null)},te=(de,Ce)=>{let Re;try{const A=Hp(de,Ce);Re=Un.get(A).color}catch{const A=r.get(de);if(!A)return null;Re=A.settings.color??"#000000"}const xe=Ce?`${de}-${Ce}`:de,k=U?.toolId===de&&U?.layer===Ce;return i.jsxs("div",{style:{position:"relative",display:"inline-block",zIndex:10005},children:[i.jsx("button",{className:"color-swatch-button",onClick:A=>{A.stopPropagation(),$(k?null:{toolId:de,layer:Ce})},style:{width:"40px",height:"24px",background:Re,backgroundColor:Re,backgroundImage:"none",border:"1px solid #3a3a44",borderRadius:3,cursor:"pointer",padding:0,margin:0,display:"block","--swatch-color":Re},title:Re},`${xe}-button-${Re}-${H}`),k&&i.jsx("div",{onClick:A=>{A.stopPropagation()},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:100},children:i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:Y.map(A=>i.jsx("div",{onClick:()=>we(de,A,Ce),title:A,style:{width:22,height:22,backgroundColor:A,border:A===Re?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},A))})})]},`${xe}-${Re}-${H}`)};return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:de=>{de.target===de.currentTarget&&(ee(),$(null))},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"16px",width:"fit-content",minWidth:"450px",maxWidth:"600px",maxHeight:"85vh",overflowY:"auto",overflowX:"visible",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:de=>de.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 12px 0",color:"#fff",fontSize:"16px",fontWeight:600},children:"Set Tool Color"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:G.map((de,Ce)=>{if(!r.get(de.id))return null;const xe=de.layer?`${de.name} (${de.layer==="top"?"Top":"Bottom"})`:de.name;return i.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"6px 10px",background:"#1f1f24",borderRadius:4},children:[i.jsxs("label",{style:{color:"#f2f2f2",fontSize:"13px",width:"140px",flexShrink:0,marginRight:"8px"},children:[xe,":"]}),te(de.id,de.layer)]},`${de.id}-${de.layer||"default"}-${Ce}`)})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:()=>{ee(),$(null)},style:{padding:"6px 12px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:600},children:"Close"})})]})})},D5=({openMenu:n,setOpenMenu:r,isReadOnlyMode:o,currentProjectFilePath:s,isProjectActive:l,autoSaveEnabled:d,autoSaveInterval:v,hasUnsavedChangesState:p,onNewProject:b,onOpenProject:m,onSaveProject:T,onCloseProject:D,onPrint:M,onExportBOM:S,hasUnsavedChanges:F,bomExportFormat:_,setBomExportFormat:N,netlistExportFormat:g,setNetlistExportFormat:ae,onExportNetlist:E,setNewProjectDialog:q,setAutoSaveDialog:re,onShowGeminiSettings:J,topImage:Y,bottomImage:ee,setCurrentTool:U,resetImageTransform:$,areImagesLocked:H,setAreImagesLocked:R,onEnterBoardDimensions:Z,fileInputTopRef:G,fileInputBottomRef:we,openProjectRef:te,increaseSize:de,decreaseSize:Ce,brushSize:Re,drawingStrokes:xe,selectedIds:k,selectedComponentIds:A,selectedPowerIds:V,selectedGroundIds:W,componentsTop:se,componentsBottom:Te,powers:le,grounds:_e,powerNodeNames:ve,groundNodeNames:De,setSetSizeDialog:Xe,areViasLocked:st,setAreViasLocked:kt,arePadsLocked:qt,setArePadsLocked:ye,areTestPointsLocked:ut,setAreTestPointsLocked:Gt,areTracesLocked:Et,setAreTracesLocked:ht,areComponentsLocked:Qe,setAreComponentsLocked:$t,areGroundNodesLocked:dn,setAreGroundNodesLocked:rn,arePowerNodesLocked:kn,setArePowerNodesLocked:Fn,showTraceCornerDots:Be,setShowTraceCornerDots:fe,showCrosshairs:lt,setShowCrosshairs:it,setSelectedIds:$e,setSelectedComponentIds:at,setSelectedPowerIds:Ot,setSelectedGroundIds:Vt,selectAllVias:jt,selectAllTraces:Ft,selectAllPads:tn,selectAllComponents:ln,selectDisconnectedComponents:mt,selectAllComponentConnections:cn,selectAllPowerNodes:_t,selectAllGroundNodes:Yt,selectPowerNodesByName:gn,selectGroundNodesByName:fn,setShowPowerBusManager:bn,setShowGroundBusManager:ir,setShowPastMachine:Dn,toolRegistry:Cr,updateToolSettings:Mr,updateToolLayerSettings:Xt,setBrushSize:mr,setBrushColor:Ti,saveToolSettings:Ln,saveToolLayerSettings:Rt,colorPalette:Ht,currentTool:tt,drawingMode:Bt,traceToolLayer:pn,padToolLayer:An,testPointToolLayer:yn,componentToolLayer:$n,setTopTraceSize:li,setBottomTraceSize:vi,setTopPadSize:qi,setBottomPadSize:Br,setTopTestPointSize:Ja,setBottomTestPointSize:Qa,setTopComponentSize:Ia,setBottomComponentSize:Go,setComponentConnectionSize:Ca,topTraceColor:di,bottomTraceColor:To,topPadColor:Gn,bottomPadColor:gs,topTestPointColor:fi,bottomTestPointColor:Uo,topComponentColor:Di,bottomComponentColor:_s,setTopTraceColor:es,setBottomTraceColor:ts,setTopPadColor:ys,setBottomPadColor:Pr,setTopTestPointColor:Gs,setBottomTestPointColor:br,setTopComponentColor:Ii,setBottomComponentColor:pi,setComponentConnectionColor:dr,saveDefaultSize:ns,saveDefaultColor:Gl,menuBarRef:po,onOpenProjectNotes:io,onOpenTransformImages:Vi,onOpenTransformAll:Yo})=>{const[Yl,ca]=At.useState(null),fr=At.useRef(null),[Xl,Or]=At.useState(null),ki=At.useRef(null),[rl,Ma]=At.useState(!1),Fo=At.useRef(null),[xs,Na]=At.useState(!1),[Xo,$r]=At.useState(!1),pr=Tt=>{if(!l){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null);return}const Qn=Tt();Qn instanceof Promise&&Qn.catch(Oa=>{const ua=Oa instanceof Error?Oa.message:String(Oa);console.error("Error in requireProject action:",Oa),alert(`An error occurred:

${ua}

See console for details.`)})},ms=Tt=>{const Qn=Tt==="power"?ve:De,Oa=Qn.length>0,ua=Tt==="power"?"Select Power Nodes":"Select Ground Nodes";return i.jsxs("div",{onMouseEnter:()=>{fr.current&&(clearTimeout(fr.current),fr.current=null),ca(Tt)},onMouseLeave:()=>{fr.current=window.setTimeout(()=>{ca(vn=>vn===Tt?null:vn)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:[ua," by Name"]}),i.jsxs("button",{onClick:()=>{Tt==="power"?_t():Yt(),ca(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:["All ",Tt==="power"?"Power Nodes":"Ground Nodes"]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),Oa?Qn.map(vn=>i.jsx("button",{onClick:()=>{Tt==="power"?gn(vn):fn(vn),ca(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:vn},vn)):i.jsxs("div",{style:{padding:"4px 10px",fontSize:12,color:"#bbb"},children:["No ",Tt==="power"?"power":"ground"," nodes available."]})]})},Ba=()=>i.jsxs("div",{onMouseEnter:()=>{Fo.current&&(clearTimeout(Fo.current),Fo.current=null),Ma(!0)},onMouseLeave:()=>{Fo.current=window.setTimeout(()=>{Ma(!1)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:180,background:"#2b2b31",border:"1px solid #555",borderRadius:"4px",padding:"4px 0",zIndex:1001,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)"},children:[i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("kicad"),Ma(!1),r(null);try{await E("kicad")}catch(Tt){console.error("Error exporting netlist:",Tt)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":g==="kicad"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:g==="kicad"?"bold":"normal"},children:[g==="kicad"?" ":"","KiCad (.net)"]}),i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("protel"),Ma(!1),r(null);try{await E("protel")}catch(Tt){console.error("Error exporting netlist:",Tt)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":g==="protel"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:g==="protel"?"bold":"normal"},children:[g==="protel"?" ":"","Protel (.net)"]}),i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("spice"),Ma(!1),r(null);try{await E("spice")}catch(Tt){console.error("Error exporting netlist:",Tt)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":g==="spice"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:g==="spice"?"bold":"normal"},children:[g==="spice"?" ":"","SPICE (.cir)"]}),i.jsxs("button",{onClick:async()=>{if(!(o||!l)){ae("pads"),Ma(!1),r(null);try{await E("pads")}catch(Tt){console.error("Error exporting netlist:",Tt)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 16px",color:o||!l?"#777":g==="pads"?"#4CAF50":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer",fontWeight:g==="pads"?"bold":"normal"},children:[g==="pads"?" ":"","PADS-PCB (.json)"]})]}),Ys=()=>i.jsxs("div",{onMouseEnter:()=>{ki.current&&(clearTimeout(ki.current),ki.current=null),Or("lock")},onMouseLeave:()=>{ki.current=window.setTimeout(()=>{Or(Tt=>Tt==="lock"?null:Tt)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:st,onChange:()=>{kt(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Vias"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:qt,onChange:()=>{ye(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Pads"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:ut,onChange:()=>{Gt(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Test Points"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:Et,onChange:()=>{ht(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Traces"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:Qe,onChange:()=>{$t(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Components"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:dn,onChange:()=>{rn(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Ground Node"})]}),i.jsxs("label",{onClick:Tt=>{Tt.stopPropagation()},style:{display:"flex",alignItems:"center",width:"100%",padding:"6px 10px",color:"#f2f2f2",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:kn,onChange:()=>{Fn(Tt=>!Tt)},style:{marginRight:"8px",cursor:"pointer",width:"16px",height:"16px",accentColor:"#4a9eff"}}),i.jsx("span",{children:"Lock Power Nodes"})]})]}),zn=()=>i.jsxs("div",{onMouseEnter:()=>{ki.current&&(clearTimeout(ki.current),ki.current=null),Or("select")},onMouseLeave:()=>{ki.current=window.setTimeout(()=>{Or(Tt=>Tt==="select"?null:Tt)},200)},style:{position:"absolute",top:0,left:"100%",marginLeft:"4px",minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6,zIndex:10},children:[i.jsx("button",{onClick:()=>{jt(),Or(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Vias"}),i.jsx("button",{onClick:()=>{Ft(),Or(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Traces"}),i.jsx("button",{onClick:()=>{tn(),Or(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Pads"}),i.jsx("button",{onClick:()=>{const Tt=new Set(xe.filter(Qn=>Qn.type==="testPoint").map(Qn=>Qn.id));$e(Tt),at(new Set),Ot(new Set),Vt(new Set),Or(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Test Points"}),i.jsx("button",{onClick:()=>{ln(),Or(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Components"}),i.jsx("button",{onClick:()=>{cn(),Or(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"All Component Connections"}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{fr.current&&(clearTimeout(fr.current),fr.current=null),ca("power")},onMouseLeave:()=>{fr.current=window.setTimeout(()=>{ca(Tt=>Tt==="power"?null:Tt)},200)},onClick:()=>{ca(Tt=>Tt==="power"?null:"power")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Power Nodes "}),Yl==="power"&&ms("power")]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{fr.current&&(clearTimeout(fr.current),fr.current=null),ca("ground")},onMouseLeave:()=>{fr.current=window.setTimeout(()=>{ca(Tt=>Tt==="ground"?null:Tt)},200)},onClick:()=>{ca(Tt=>Tt==="ground"?null:"ground")},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"Ground Nodes "}),Yl==="ground"&&ms("ground")]}),i.jsx("button",{onClick:()=>{mt(),Or(null),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Disconnected Components"})]});return i.jsxs(i.Fragment,{children:[i.jsxs("div",{ref:po,style:{position:"relative",background:"rgba(250,250,255,0.9)",borderBottom:"1px solid #e6e6ef",padding:"6px 12px",display:"flex",gap:16,alignItems:"center",zIndex:3},children:[i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Tt=>{Tt.stopPropagation(),r(Qn=>Qn==="file"?null:"file")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="file"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"File "}),n==="file"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:200,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{o||(r(null),F()?q({visible:!0}):b())},disabled:o,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o?"not-allowed":"pointer"},children:"New Project"}),i.jsx("button",{onClick:async()=>{await m(),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none"},children:"Open Project"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{o||pr(()=>{T(),r(null)})},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Save Project"}),i.jsx("button",{onClick:async()=>{!o&&l&&(await D(),r(null))},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Close Project"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{o||pr(()=>{re({visible:!0,interval:5}),r(null)})},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Auto Save"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(Dn(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Restore from History"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{J(),r(null)},style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:"#f2f2f2",background:"transparent",border:"none",cursor:"pointer"},children:"AI Settings"}),i.jsx("button",{onClick:async()=>{if(!o){if(!l){alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null);return}try{await S(),r(null)}catch(Tt){console.error("Error exporting BOM:",Tt)}}},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Export BOM"}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{l&&Fo.current&&(clearTimeout(Fo.current),Fo.current=null),l&&Ma(!0)},onMouseLeave:()=>{l&&(Fo.current=window.setTimeout(()=>{Ma(!1)},200))},onClick:()=>{if(o||!l){l||(alert("Please create a new project (File  New Project) or open an existing project (File  Open Project) before using this feature."),r(null));return}Ma(Tt=>!Tt)},disabled:o||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||!l?"not-allowed":"pointer"},children:"Export Netlist "}),rl&&l&&Ba()]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{pr(()=>{M(),r(null)})},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Print"}),i.jsx("button",{onClick:()=>{pr(()=>{M(),r(null)})},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Printer Settings"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Tt=>{o||(Tt.stopPropagation(),r(Qn=>Qn==="transform"?null:"transform"))},disabled:o,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="transform"?"#eef3ff":"#fff",fontWeight:600,color:o?"#999":"#222",cursor:o?"not-allowed":"pointer",opacity:o?.5:1},children:"Images "}),n==="transform"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:260,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{!o&&!H&&l&&(G.current?.click(),r(null))},disabled:o||H||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||H||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||H||!l?"not-allowed":"pointer"},children:"Load Top PCB"}),i.jsx("button",{onClick:()=>{!o&&!H&&l&&(we.current?.click(),r(null))},disabled:o||H||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:o||H||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:o||H||!l?"not-allowed":"pointer"},children:"Load Bottom PCB"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{!H&&l&&(Z(),r(null))},disabled:H||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:H||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:H||!l?"not-allowed":"pointer"},children:"Enter PCB Dimensions"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(Vi(),r(null))},disabled:!Y&&!ee||H||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:!Y&&!ee||H||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:!Y&&!ee||H||!l?"not-allowed":"pointer"},children:"Transform Images"}),i.jsx("button",{onClick:()=>{!H&&l&&(U("transform"),$(),r(null))},disabled:H||!Y&&!ee||!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:H||!Y&&!ee||!l?"#777":"#f2f2f2",background:"transparent",border:"none",cursor:H||!Y&&!ee||!l?"not-allowed":"pointer"},children:"Reset Transform"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(R(Tt=>!Tt),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:H?"Unlock Images ":"Lock Images"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Tt=>{o||(Tt.stopPropagation(),r(Qn=>Qn==="tools"?null:"tools"))},disabled:o,style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="tools"?"#eef3ff":"#fff",fontWeight:600,color:o?"#999":"#222",cursor:o?"not-allowed":"pointer",opacity:o?.5:1},children:"Tools "}),n==="tools"&&i.jsxs("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:220,background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:6},children:[i.jsx("button",{onClick:()=>{l&&(Yo(),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Change Perspective"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:Tt=>{l&&(de(Tt.shiftKey?5:1),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Increase Size (+)"}),i.jsx("button",{onClick:Tt=>{l&&(Ce(Tt.shiftKey?5:1),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Decrease Size (-)"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{l&&ki.current&&(clearTimeout(ki.current),ki.current=null),l&&Or("lock")},onMouseLeave:()=>{l&&(ki.current=window.setTimeout(()=>{Or(Tt=>Tt==="lock"?null:Tt)},200))},onClick:()=>{l&&Or(Tt=>Tt==="lock"?null:"lock")},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Lock "}),Xl==="lock"&&l&&Ys()]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onMouseEnter:()=>{l&&ki.current&&(clearTimeout(ki.current),ki.current=null),l&&Or("select")},onMouseLeave:()=>{l&&(ki.current=window.setTimeout(()=>{Or(Tt=>Tt==="select"?null:Tt)},200))},onClick:()=>{l&&Or(Tt=>Tt==="select"?null:"select")},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Select "}),Xl==="select"&&l&&zn()]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(io(),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Open Project Notes"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(Na(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Set Tool Sizes"}),i.jsx("button",{onClick:()=>{l&&($r(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Set Tool Colors"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsx("button",{onClick:()=>{l&&(bn(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Manage Power Buses"}),i.jsx("button",{onClick:()=>{l&&(ir(!0),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:"Manage Ground Buses"}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsxs("button",{onClick:()=>{l&&(fe(!Be),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:[Be?" ":"   ","Show Trace Corner Dots"]}),i.jsx("div",{style:{height:1,background:"#eee",margin:"6px 0"}}),i.jsxs("button",{onClick:()=>{l&&(it(!lt),r(null))},disabled:!l,style:{display:"block",width:"100%",textAlign:"left",padding:"6px 10px",color:l?"#f2f2f2":"#777",background:"transparent",border:"none",cursor:l?"pointer":"not-allowed"},children:[lt?" ":"   ","Show X-Y Axis Crosshairs"]})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Tt=>{Tt.stopPropagation(),r(Qn=>Qn==="about"?null:"about")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="about"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"About "}),n==="about"&&i.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"PCBTracer (v3.1)"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"About"}),i.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"A specialized tool useful for both reverse engineering and troubleshooting electronics by tracing and documenting circuit connections from PCB images. This application supports typical 2 to 4 layer PCBs and enables comprehensive PCB analysis and documentation."}),i.jsx("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:"This tool can assist in troubleshooting by tracing circuits, holding contextual notes, comparing test results, and documenting findings during the debugging process."})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Technologies"}),i.jsxs("p",{style:{margin:"0 0 12px 0",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:["Built with ",i.jsx("strong",{children:"TypeScript"})," and ",i.jsx("strong",{children:"React"}),", with ",i.jsx("strong",{children:"Gemini AI"})," integration for intelligent pin name extraction from datasheets. The application runs entirely client-side in the browser, providing a responsive, interactive drawing experience with no backend server requirements."]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Features"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Via/Pad Placement"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsxs("li",{children:["Alt/Option+click the Via or Pad tool, or press ",i.jsx("code",{children:"Alt/Option+V"})," or ",i.jsx("code",{children:"Alt/Option+P"})," to open the placement dialog"]}),i.jsx("li",{children:"Place multiple vias or pads in Linear, 2-Sided, or 4-Sided arrangements"}),i.jsx("li",{children:"Automatic counter-clockwise numbering starting from Pin 1"}),i.jsx("li",{children:"Supports chip orientations of 0, 90, 180, or 270"}),i.jsx("li",{children:"Click and drag to define the placement area"}),i.jsx("li",{children:"Tool automatically returns to Select tool after placement"})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Tools & Shortcuts"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsx("div",{children:i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Select"}),"  ",i.jsx("code",{children:"S"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Via"}),"  ",i.jsx("code",{children:"V"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Pad"}),"  ",i.jsx("code",{children:"P"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Test Point"}),"  ",i.jsx("code",{children:"Y"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Trace"}),"  ",i.jsx("code",{children:"T"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component"}),"  ",i.jsx("code",{children:"C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component Properties"}),"  double-click component"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Resize Icons"}),"  ",i.jsx("code",{children:"+"})," / ",i.jsx("code",{children:"-"})," (",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:"+"})," / ",i.jsx("code",{children:"-"})," = 5x faster)"]})]})}),i.jsx("div",{children:i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Power"}),"  ",i.jsx("code",{children:"B"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Ground"}),"  ",i.jsx("code",{children:"G"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Move (Pan)"}),"  ",i.jsx("code",{children:"H"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Magnify"}),"  ",i.jsx("code",{children:"M"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Set View"}),"  ",i.jsx("code",{children:"X"})," then ",i.jsx("code",{children:"0-9"})," to save view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Recall View"}),"  ",i.jsx("code",{children:"0-9"})," to recall saved view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Default View 0"}),"  ",i.jsx("code",{children:"0"})," to recall default view (origin with all images contained)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Information Dialog"}),"  ",i.jsx("code",{children:"I"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Notes Dialog"}),"  ",i.jsx("code",{children:"N"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Project Notes / TODO"}),"  ",i.jsx("code",{children:"L"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Undo"}),"  ",i.jsx("code",{children:"Ctrl"})," + ",i.jsx("code",{children:"Z"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Copy Component"}),"  ",i.jsx("code",{children:"Ctrl"})," + ",i.jsx("code",{children:"C"})," / ",i.jsx("code",{children:"Cmd"})," + ",i.jsx("code",{children:"C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Paste Component"}),"  ",i.jsx("code",{children:"Ctrl"})," + ",i.jsx("code",{children:"V"})," / ",i.jsx("code",{children:"Cmd"})," + ",i.jsx("code",{children:"V"})]})]})})]}),i.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",i.jsx("code",{children:"Shift"})," = 10 units)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Switch Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to switch between top/bottom view"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Rotate Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to rotate in 90 increments (",i.jsx("code",{children:""})," = counter-clockwise, ",i.jsx("code",{children:""})," = clockwise)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Image Transformations"}),"  Arrow keys for scaling, rotating, and adjusting image transformations (when image is selected for transform)"]}),i.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 20px"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Image Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Load top and bottom PCB images"}),i.jsx("li",{children:"Image alignment and transformation"}),i.jsx("li",{children:"Transform modes: nudge, scale, rotate, slant, keystone"}),i.jsx("li",{children:"Horizontal and vertical flip controls"}),i.jsx("li",{children:"Brightness and contrast controls"}),i.jsx("li",{children:"Grayscale mode"}),i.jsx("li",{children:"Automated transparency slider"}),i.jsx("li",{children:"Board dimensions configuration"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Drawing Tools"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Draw copper traces (top and bottom layers)"}),i.jsx("li",{children:"Place vias for layer connections"}),i.jsx("li",{children:"Place component pads (SMD and through-hole)"}),i.jsx("li",{children:"Place test points for circuit testing"}),i.jsx("li",{children:"Place and annotate components"}),i.jsx("li",{children:"Place power and ground nodes"}),i.jsx("li",{children:"Erase tool for removing elements"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Layer Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"14 independent layers to manage PCB element types"}),i.jsx("li",{children:"Separate top and bottom layer support"}),i.jsx("li",{children:"Layer-specific color customization"}),i.jsx("li",{children:"Layer-specific size controls"}),i.jsx("li",{children:"Layer visibility toggles"}),i.jsx("li",{children:"Overlay view mode"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Component Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Component placement with pin counts"}),i.jsx("li",{children:"Pin connection tracking"}),i.jsx("li",{children:"Component type classification"}),i.jsx("li",{children:"Designator and value annotation"}),i.jsx("li",{children:"Component editor dialog"}),i.jsx("li",{children:"Find and center component"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Selection & Locking"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Select individual elements or groups"}),i.jsx("li",{children:"Select all vias, traces, pads, or components"}),i.jsx("li",{children:"Select power/ground nodes by name"}),i.jsx("li",{children:"Select disconnected components"}),i.jsx("li",{children:"Lock/unlock elements by type"}),i.jsx("li",{children:"Image locking for protection"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Power & Ground"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Multiple voltage power nodes"}),i.jsx("li",{children:"Power bus management"}),i.jsx("li",{children:"Ground node placement"}),i.jsx("li",{children:"Ground bus management"}),i.jsx("li",{children:"Node naming and organization"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Customization"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Customizable colors per layer"}),i.jsx("li",{children:"Adjustable brush/tool sizes"}),i.jsx("li",{children:"Size presets for common tools"}),i.jsx("li",{children:"Color palette management"}),i.jsx("li",{children:"Tool settings persistence"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"Project Management"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Create, open, and save projects"}),i.jsx("li",{children:"Auto-save with configurable intervals"}),i.jsx("li",{children:"File history automatically saved in history subdirectory when Auto Save is enabled"}),i.jsx("li",{children:"Project Notes / TODO list with spreadsheet-like editing"}),i.jsx("li",{children:"Project file format (JSON)"}),i.jsx("li",{children:"Print functionality"}),i.jsx("li",{children:"Export to KiCad schematic format (future feature, not yet implemented)"})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",color:"#f2f2f2",fontSize:"14px",fontWeight:600},children:"View Controls"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Zoom in/out with mouse wheel"}),i.jsx("li",{children:"Pan view with hand tool"}),i.jsx("li",{children:"Zoom to fit"}),i.jsx("li",{children:"View mode switching (top/bottom/overlay)"}),i.jsx("li",{children:"Save up to 10 view locations (X + 0-9)"}),i.jsx("li",{children:"Recall saved views instantly (0-9 keys)"}),i.jsxs("li",{children:["Default View 0: Press ",i.jsx("code",{children:"0"})," to recall the default view showing the origin with all loaded images fully contained within the canvas"]}),i.jsx("li",{children:"Change Perspective (Tools menu) - switch between top/bottom view and rotate all elements"}),i.jsx("li",{children:"Detailed information dialog"})]})]})]})]}),i.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:i.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["Use the ",i.jsx("strong",{children:"File"})," menu to manage projects, the ",i.jsx("strong",{children:"Images"})," menu for image loading and transformation, and the ",i.jsx("strong",{children:"Tools"})," menu for selection, locking, and customization options."]})}),i.jsxs("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Future / TODO List"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"A searchable list of common components"}),i.jsx("li",{children:"Output schematics (perhaps as KiCad files)"}),i.jsx("li",{children:"Dynamic layers"}),i.jsx("li",{children:"Create a desktop version of this application using Electron"})]})]})]})})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:Tt=>{Tt.stopPropagation(),r(Qn=>Qn==="help"?null:"help")},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #ddd",background:n==="help"?"#eef3ff":"#fff",fontWeight:600,color:"#222"},children:"Help "}),n==="help"&&i.jsx("div",{style:{position:"absolute",top:"calc(100% + 6px)",left:0,minWidth:500,maxWidth:700,maxHeight:"80vh",background:"#2b2b31",border:"1px solid #1f1f24",borderRadius:6,boxShadow:"0 6px 18px rgba(0,0,0,0.25)",padding:20,overflowY:"auto",zIndex:100},children:i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h2",{style:{margin:"0 0 16px 0",color:"#f2f2f2",fontSize:"20px",fontWeight:700},children:"Help: Typical Usage Steps"}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 1: Create or Open a Project"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"New Project:"})," File  New Project. Choose a project name and location."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Open Project:"})," File  Open Project. Select an existing project file (.json)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Auto-Save:"})," File  Auto Save  Enable to automatically save your work at regular intervals."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 2: Load PCB Images"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Load Top Image:"})," Images  Load Top Image. Select your top-side PCB photo (.png or .jpeg)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Load Bottom Image:"})," Images  Load Bottom Image. Select your bottom-side PCB photo."]}),i.jsxs("li",{children:["Images are automatically copied to the ",i.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"images/"})," subdirectory."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 3: Align and Transform Images"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Enter Transform Mode:"})," Images  Transform Images. Select which image (Top or Bottom) to transform."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Transform Operations:"})," Use Move, Nudge, Scale, Rotate, Slant, or Keystone to align images."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Image Adjustments:"})," Adjust brightness, contrast, sharpness, and grayscale as needed."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Flip Images:"})," Use horizontal or vertical flip if your images are mirrored."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Arrow Keys:"})," When transform tool is active, use arrow keys for precise image adjustments."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Move Components:"})," Select components, then use arrow keys to move them (1 unit per press, ",i.jsx("code",{children:"Shift"})," = 10 units for larger steps)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Change Perspective:"})," Tools  Change Perspective (or press ",i.jsx("code",{children:"E"}),") to switch between top/bottom view or rotate all elements (images, components, traces) together by 90, 180, or 270."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Quick Perspective Switch:"})," Press ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to quickly switch between top/bottom view."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Quick Perspective Rotation:"})," Press ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," to rotate perspective in 90 increments (",i.jsx("code",{children:""})," = counter-clockwise, ",i.jsx("code",{children:""})," = clockwise)."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 4: Set Board Dimensions"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Enter Dimensions:"})," Images  Enter Board Dimensions. Specify the actual physical dimensions of your PCB."]}),i.jsx("li",{children:"This helps ensure accurate measurements and scaling for your reverse engineering work."})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 5: Trace Connections"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Place Vias:"})," Click the Via tool (",i.jsx("code",{children:"V"}),") and click on the PCB where vias connect layers."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Pads:"})," Click the Pad tool (",i.jsx("code",{children:"P"}),") and mark component pad locations."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Multiple Vias/Pads:"})," Alt/Option+click the Via or Pad tool, or press ",i.jsx("code",{children:"Alt/Option+V"})," (vias) or ",i.jsx("code",{children:"Alt/Option+P"})," (pads) to open the placement dialog. Choose arrangement (Linear, 2-Sided, or 4-Sided), number of pins, orientation, and layer. Click and drag on the canvas to define the placement area. Vias/pads are automatically arranged in counter-clockwise order starting from Pin 1."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Test Points:"})," Click the Test Point tool (",i.jsx("code",{children:"Y"}),") to mark test points."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Draw Traces:"})," Click the Trace tool (",i.jsx("code",{children:"T"}),"), select Top or Bottom layer, then click to start a trace. Click again to add segments. Press ",i.jsx("code",{children:"Enter"})," or click outside to finish."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Snapping:"})," Traces automatically snap to nearby vias, pads, power nodes, and ground nodes."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 6: Place Components"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Place Component:"})," Click the Component tool (",i.jsx("code",{children:"C"}),"), select component type, then click on the PCB."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Edit Component:"})," Double-click a component or select a component and press ",i.jsx("code",{children:"A"})," to open the Component Properties dialog. If multiple components are selected, opens the most recently selected one."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Set Properties:"})," Enter designator (e.g., R1, C2), value, and other component details."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Connect Pins:"})," Click on pads or vias to connect component pins to the circuit."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 7: Add Power and Ground Nodes"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Manage Power Buses:"})," Tools  Manage Power Buses to create and configure voltage buses (e.g., +5V, +3.3V)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Power Nodes:"})," Click the Power tool (",i.jsx("code",{children:"B"}),"), select a voltage bus, then click on the PCB."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Manage Ground Buses:"})," Tools  Manage Ground Buses to configure ground connections."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Place Ground Nodes:"})," Click the Ground tool (",i.jsx("code",{children:"G"}),"), select a ground bus, then click on the PCB."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 8: Add Notes and Documentation"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Element Notes:"})," Press ",i.jsx("code",{children:"N"})," to open the Notes dialog for selected elements (vias, pads, traces, etc.)."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Project Notes:"})," Press ",i.jsx("code",{children:"L"})," to open Project Notes / TODO list for general project documentation."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Information Dialog:"})," Press ",i.jsx("code",{children:"I"})," to see detailed information about selected elements."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Find Elements:"})," Use the Find button in the Information dialog to center and highlight specific elements."]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Step 9: Save Your Work"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"14px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Manual Save:"})," File  Save Project to save your work manually."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Auto-Save:"})," If enabled, your project is automatically saved at regular intervals."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"History:"})," Auto-saved versions are stored in the ",i.jsx("code",{style:{background:"#1f1f24",padding:"2px 4px",borderRadius:3,color:"#fff"},children:"history/"})," subdirectory."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Restore from History:"})," File  Restore from History to access previous versions."]})]})]}),i.jsxs("div",{style:{marginBottom:20,paddingTop:16,borderTop:"1px solid #444"},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Keyboard Shortcuts"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px 16px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Drawing Tools"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Select"}),"  ",i.jsx("code",{children:"S"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Via"}),"  ",i.jsx("code",{children:"V"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Via Pattern"}),"  ",i.jsx("code",{children:"Alt/Option+V"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Pad"}),"  ",i.jsx("code",{children:"P"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Pad Pattern"}),"  ",i.jsx("code",{children:"Alt/Option+P"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Test Point"}),"  ",i.jsx("code",{children:"Y"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Trace"}),"  ",i.jsx("code",{children:"T"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component"}),"  ",i.jsx("code",{children:"C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Component Properties"}),"  ",i.jsx("code",{children:"A"})," (opens dialog for selected component)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Power"}),"  ",i.jsx("code",{children:"B"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Ground"}),"  ",i.jsx("code",{children:"G"})]})]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"View & Navigation"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Move (Pan)"}),"  ",i.jsx("code",{children:"H"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Magnify"}),"  ",i.jsx("code",{children:"M"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Set View"}),"  ",i.jsx("code",{children:"X"})," then ",i.jsx("code",{children:"0-9"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Recall View"}),"  ",i.jsx("code",{children:"0-9"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Default View 0"}),"  ",i.jsx("code",{children:"0"})," (origin with all images contained)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Default View 0"}),"  ",i.jsx("code",{children:"0"})," (origin with all images contained)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Information"}),"  ",i.jsx("code",{children:"I"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Notes"}),"  ",i.jsx("code",{children:"N"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Project Notes"}),"  ",i.jsx("code",{children:"L"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Undo"}),"  ",i.jsx("code",{children:"Ctrl+Z"})," / ",i.jsx("code",{children:"Cmd+Z"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Copy Component"}),"  ",i.jsx("code",{children:"Ctrl+C"})," / ",i.jsx("code",{children:"Cmd+C"})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Paste Component"}),"  ",i.jsx("code",{children:"Ctrl+V"})," / ",i.jsx("code",{children:"Cmd+V"})]})]})]})]}),i.jsxs("div",{style:{marginTop:"12px",fontSize:"13px",color:"#f2f2f2"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#f2f2f2"},children:"Arrow Keys"}),i.jsxs("ul",{style:{margin:0,paddingLeft:"20px",lineHeight:"1.6"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Move Selected Components"}),"  Arrow keys to nudge selected components (1 unit per press, ",i.jsx("code",{children:"Shift"})," = 10 units)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Switch Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Rotate Perspective"}),"  ",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," or ",i.jsx("code",{children:"Caps Lock"})," + ",i.jsx("code",{children:""})," / ",i.jsx("code",{children:""})," (",i.jsx("code",{children:""})," = counter-clockwise, ",i.jsx("code",{children:""})," = clockwise)"]}),i.jsx("li",{children:"Use arrow keys to adjust image transformations (when transform tool is active)"}),i.jsx("li",{children:"Click a slider first, then use arrow keys for precise adjustment"})]})]})]}),i.jsxs("div",{style:{marginBottom:20},children:[i.jsx("h3",{style:{margin:"0 0 10px 0",color:"#f2f2f2",fontSize:"16px",fontWeight:600},children:"Tips & Tricks"}),i.jsxs("ul",{style:{margin:"0 0 12px 0",paddingLeft:"20px",color:"#f2f2f2",fontSize:"13px",lineHeight:"1.6"},children:[i.jsx("li",{children:"Double-click any slider to reset it to the default value"}),i.jsx("li",{children:"Double-click a component to edit its properties"}),i.jsxs("li",{children:["Hold ",i.jsx("code",{children:"Shift"})," while clicking to add to selection"]}),i.jsxs("li",{children:["Use the Information dialog (",i.jsx("code",{children:"I"}),") to see details about selected elements"]}),i.jsx("li",{children:"Lock layers (Tools  Lock) to prevent accidental modifications"}),i.jsx("li",{children:"Use the Find button in the Information dialog to center elements in view"}),i.jsxs("li",{children:["Save views with ",i.jsx("code",{children:"X"})," + number key for quick navigation"]}),i.jsxs("li",{children:["Use ",i.jsx("code",{children:"+"})," and ",i.jsx("code",{children:"-"})," keys to resize tool icons (",i.jsx("code",{children:"Shift"})," + ",i.jsx("code",{children:"+"})," / ",i.jsx("code",{children:"-"})," changes size 5 times faster)"]})]})]}),i.jsx("div",{style:{marginTop:20,paddingTop:16,borderTop:"1px solid #444"},children:i.jsxs("p",{style:{margin:"0 0 8px 0",color:"#bbb",fontSize:"12px",lineHeight:"1.5"},children:["For more detailed feature information, see the ",i.jsx("strong",{children:"About"})," menu."]})})]})})]}),s&&i.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"8px",paddingLeft:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#333",fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"40vw"},title:s,children:s}),i.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",border:"1px solid #666",backgroundColor:p?d?"#ffaa00":"#ff0000":"#00ff00",flexShrink:0},title:p?d?`Changes detected  Auto Save: ON  Will be saved automatically every ${v||1} minute${v===1?"":"s"}`:"Changes detected  Auto Save: OFF  You need to save manually (File  Save Project)":"Project saved  No unsaved changes  Auto Save: "+(d?"ON":"OFF")})]})]}),i.jsx(P5,{visible:xs,toolRegistry:Cr,currentTool:tt,drawingMode:Bt,traceToolLayer:pn,padToolLayer:An,testPointToolLayer:yn,componentToolLayer:$n,updateToolSettings:Mr,updateToolLayerSettings:Xt,setBrushSize:mr,saveToolSettings:Ln,saveToolLayerSettings:Rt,setTopTraceSize:li,setBottomTraceSize:vi,setTopPadSize:qi,setBottomPadSize:Br,setTopTestPointSize:Ja,setBottomTestPointSize:Qa,setTopComponentSize:Ia,setBottomComponentSize:Go,setComponentConnectionSize:Ca,saveDefaultSize:ns,onClose:()=>Na(!1)}),i.jsx(_5,{visible:Xo,toolRegistry:Cr,currentTool:tt,drawingMode:Bt,traceToolLayer:pn,padToolLayer:An,testPointToolLayer:yn,componentToolLayer:$n,updateToolSettings:Mr,updateToolLayerSettings:Xt,saveToolSettings:Ln,saveToolLayerSettings:Rt,setBrushColor:Ti,setTopTraceColor:es,setBottomTraceColor:ts,setTopPadColor:ys,setBottomPadColor:Pr,setTopTestPointColor:Gs,setBottomTestPointColor:br,setTopComponentColor:Ii,setBottomComponentColor:pi,setComponentConnectionColor:dr,saveDefaultColor:Gl,colorPalette:Ht,onClose:()=>$r(!1)})]})},R5=({visible:n,canvasSize:r={width:960,height:600},canvasPosition:o={left:244,top:6},onDismiss:s})=>{const l=I.useRef(null),d=I.useRef(null),[v,p]=I.useState(!0),b=I.useCallback(()=>{l.current&&(l.current.pause(),l.current.src="",l.current.load()),p(!1),s&&s()},[s]);return I.useEffect(()=>{n&&p(!0)},[n]),I.useEffect(()=>{if(!n)return;const m=()=>{b()};return document.addEventListener("click",m,{once:!0}),document.addEventListener("mousedown",m,{once:!0}),()=>{document.removeEventListener("click",m),document.removeEventListener("mousedown",m)}},[n,b]),I.useEffect(()=>{n&&v&&l.current?l.current.play().catch(m=>{console.warn("Video autoplay failed:",m)}):(!n||!v)&&l.current&&l.current&&(l.current.pause(),l.current.src="",l.current.load())},[n,v]),n?i.jsxs("div",{ref:d,onClick:b,style:{position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"#ffffff",pointerEvents:"auto",zIndex:10},children:[v&&i.jsx("video",{ref:l,src:"/PCB_Reverse_Engineering_Tool/SplashLoop.mp4",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{position:"absolute",left:`${o.left}px`,top:`${o.top}px`,width:`${r.width}px`,height:`${r.height}px`,objectFit:"cover",pointerEvents:"none",zIndex:1}}),i.jsxs("div",{onClick:b,style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",padding:"24px 32px",background:"#ffffff",borderRadius:8,border:"2px solid #4CAF50",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",maxWidth:"500px",pointerEvents:"auto",zIndex:2,cursor:"pointer"},children:[i.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"12px"},children:"PCB Tracer: An Electronics Tool"}),i.jsxs("div",{style:{fontSize:"16px",fontWeight:600,color:"#000",marginBottom:"16px",lineHeight:"1.5"},children:["Reverse Engineer, Troubleshoot, Trace Signals,",i.jsx("br",{}),"Document Tests, Aid Repairs"]}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"1) Use the File menu to start a new project."}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"8px",lineHeight:"1.5",textAlign:"left"},children:"2) Use the Images menu to load images."}),i.jsx("div",{style:{fontSize:"13px",color:"#555",marginBottom:"12px",lineHeight:"1.5",textAlign:"left"},children:"3) Use the tools to draw vias, traces, components, etc."}),i.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"16px",textAlign:"center",fontStyle:"italic",fontWeight:"bold"},children:"Best viewed in browser's full screen mode."})]})]}):null},Ux=({visible:n,title:r,message:o,onClose:s})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:l=>{l.target===l.currentTarget&&s()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #ff4444"},onClick:l=>l.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{fontSize:"24px",color:"#ff4444"},children:""}),i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:r})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5"},children:o}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}):null,L5=({visible:n,selectedIds:r,selectedComponentIds:o,selectedPowerIds:s,selectedGroundIds:l,drawingStrokes:d,componentsTop:v,componentsBottom:p,powers:b,grounds:m,powerBuses:T,onClose:D,setComponentsTop:M,setComponentsBottom:S,determineViaType:F,determinePadType:_,determineTestPointType:N,onFindComponent:g,onFindStroke:ae,onFindPower:E,onFindGround:q,position:re,isDragging:J,onDragStart:Y,onOpenNotesDialog:ee})=>{const[U,$]=I.useState({visible:!1,title:"",message:""}),[H,R]=I.useState(()=>{const xe=localStorage.getItem("detailedInfoDialogSize");if(xe)try{return JSON.parse(xe)}catch{return{width:400,height:window.innerHeight*.8}}return{width:400,height:window.innerHeight*.8}}),[Z,G]=I.useState(!1),[we,te]=I.useState({x:0,y:0,width:0,height:0});I.useEffect(()=>{if(!Z)return;const xe=A=>{const V=A.clientX-we.x,W=A.clientY-we.y,se=Math.max(300,Math.min(window.innerWidth-20,we.width+V)),Te=Math.max(200,Math.min(window.innerHeight-20,we.height+W)),le={width:se,height:Te};R(le),localStorage.setItem("detailedInfoDialogSize",JSON.stringify(le))},k=()=>{G(!1)};return document.addEventListener("mousemove",xe),document.addEventListener("mouseup",k),()=>{document.removeEventListener("mousemove",xe),document.removeEventListener("mouseup",k)}},[Z,we]);const de=xe=>{xe.preventDefault(),xe.stopPropagation(),G(!0),te({x:xe.clientX,y:xe.clientY,width:H.width,height:H.height})};if(!n)return null;const Ce=re?{position:"fixed",left:`${re.x}px`,top:`${re.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${H.width}px`,height:`${H.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:J?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},Re={padding:"20px",overflow:"auto",flex:1};return i.jsxs("div",{style:Ce,children:[i.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",...re?{}:{backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${H.width}px`,height:`${H.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",pointerEvents:"auto"}},children:[i.jsxs("div",{onMouseDown:xe=>{const k=xe.target;k.tagName==="BUTTON"||k.closest("button")||re&&Y(xe)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:J?"grabbing":re?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Information (I)"}),i.jsx("button",{onClick:D,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:Re,children:i.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[(()=>{const xe=d.filter(se=>r.has(se.id)).length,k=[...v,...p].filter(se=>o.has(se.id)).length,A=b.filter(se=>s.has(se.id)).length,V=m.filter(se=>l.has(se.id)).length,W=xe+k+A+V;return i.jsx("div",{style:{padding:"12px 16px",backgroundColor:W>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:W>0?"#333":"#856404",marginBottom:"8px"},children:W>0?`${W} Object${W!==1?"s":""} Selected`:"Zero Objects Selected"})})(),o.size>0&&(()=>{const xe=d.some(k=>r.has(k.id)&&(k.type==="via"||k.type==="pad"));return[...v,...p].filter(k=>o.has(k.id)).map(k=>{const A=Hl(k),V=A?.fields,W=V&&V.length>0?i.jsx("div",{style:{marginTop:"6px",marginBottom:"6px",padding:"4px 0"},children:V.map(se=>{const Te=k[se.name];if(Te==null||Te==="")return null;const le=k[`${se.name}Unit`],_e=typeof Te=="boolean"?Te?"Yes":"No":Te;return i.jsxs("div",{style:{fontSize:"11px",color:"#444",marginBottom:"2px"},children:[se.label,": ",_e,le?` ${le}`:""]},se.name)})}):i.jsx("div",{style:{padding:"6px 0",fontSize:"11px",color:"#856404",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,marginTop:"6px",marginBottom:"6px"},children:"Component definition missing for this instance. Please ensure componentDefinitions.json entry and componentDefinitionKey are set."});return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",flexDirection:"column",gap:"4px",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Category:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A?.category||"N/A"})]})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A?.displayName?k.componentType==="Capacitor"&&!A.displayName.toLowerCase().includes("capacitor")?`${A.displayName} Capacitor`:A.displayName:k.componentType==="GenericComponent"&&k.genericType?Wl(k.genericType):k.componentType==="Diode"&&k.diodeType&&k.diodeType!=="Standard"?Wl(k.diodeType):k.componentType==="VariableResistor"&&k.vrType&&k.vrType!=="Potentiometer"?Wl(k.vrType):k.componentType==="Capacitor"&&k.dielectric==="Tantalum"?"Tantalum Capacitor":k.componentType==="Capacitor"&&k.capacitorType==="Electrolytic"?"Electrolytic Capacitor":k.componentType==="Capacitor"&&k.capacitorType==="Film"?"Film Capacitor":Wl(k.componentType)})]}),g&&i.jsx("button",{onClick:()=>{g(k.id,k.x,k.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:se=>{se.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:se=>{se.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[W,i.jsxs("div",{children:["Layer: ",k.layer]}),k.componentType==="IntegratedCircuit"&&i.jsxs(i.Fragment,{children:[k.description&&i.jsxs("div",{children:["Description: ",k.description]}),k.icType&&i.jsxs("div",{children:["IC Type: ",k.icType]})]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:k.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsxs("span",{children:["Designator: ",k.designator||"(empty)"]}),xe&&i.jsx("button",{onClick:()=>{const se=[...v,...p].filter(ut=>o.has(ut.id)&&ut.componentType===k.componentType),Te=se.length,le=d.filter(ut=>r.has(ut.id)&&ut.type==="pad"&&ut.points.length>0&&ut.points[0].id!==void 0).map(ut=>{const Gt=ut.points[0].id;if(Gt===void 0)throw new Error("Unexpected undefined id");return{stroke:ut,nodeId:Gt}}).sort((ut,Gt)=>ut.nodeId-Gt.nodeId),_e=le.length>0?le:d.filter(ut=>r.has(ut.id)&&ut.type==="via"&&ut.points.length>0&&ut.points[0].id!==void 0).map(ut=>{const Gt=ut.points[0].id;if(Gt===void 0)throw new Error("Unexpected undefined id");return{stroke:ut,nodeId:Gt}}).sort((ut,Gt)=>ut.nodeId-Gt.nodeId),ve=_e.length;if(ve===0){console.warn("No vias or pads with Node IDs found in selection");return}const De=Math.floor(ve/Te);if(De===0){console.warn(`Not enough ${le.length>0?"pads":"vias"} (${ve}) for ${Te} components`);return}const Xe=Hl(se[0]);if(Xe?.fixedPinCount!==!1){const ut=se[0]?.pinCount??Xe?.defaultPins??De;if(se.every(Et=>(Et.pinCount??Xe?.defaultPins)===ut)||console.warn("Selected components have different pin counts"),De!==ut){const Et=le.length>0?"pads":"vias";console.warn(`Cannot change pin count for ${k.componentType}. Expected ${ut} ${Et} per component, but got ${De}. This component has a fixed pin count.`),$({visible:!0,title:"Cannot Connect Components",message:`${k.componentType} has a fixed pin count of ${ut}. Please select exactly ${ut*Te} ${Et} (${ut} per component).`});return}}const kt=[...se].sort((ut,Gt)=>ut.id.localeCompare(Gt.id)),qt=d.filter(ut=>r.has(ut.id)&&(ut.type==="via"||ut.type==="pad"));kt.forEach((ut,Gt)=>{const Et=Gt*De,ht=Et+De,$t=_e.slice(Et,ht).map(rn=>rn.nodeId.toString()),dn=Mg(ut,$t,qt);ut.layer==="top"?M(rn=>rn.map(kn=>{if(kn.id===ut.id){const Fn={...kn,pinCount:De,pinConnections:$t};if(dn&&(Fn.pinPolarities=dn),kn.pinNames){const Be=kn.pinNames||[];Fn.pinNames=new Array(De).fill("").map((fe,lt)=>lt<Be.length?Be[lt]:"")}return Fn}return kn})):S(rn=>rn.map(kn=>{if(kn.id===ut.id){const Fn={...kn,pinCount:De,pinConnections:$t};if(dn&&(Fn.pinPolarities=dn),kn.pinNames){const Be=kn.pinNames||[];Fn.pinNames=new Array(De).fill("").map((fe,lt)=>lt<Be.length?Be[lt]:"")}return Fn}return kn}))});const ye=le.length>0?"pads":"vias";console.log(`Connected ${Te} components of type ${k.componentType} to ${ve} ${ye} (${De} pins each)`)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:se=>{se.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:se=>{se.currentTarget.style.backgroundColor="#4CAF50"},children:"Connect"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:k.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:k.color})]}),i.jsxs("div",{children:["Size: ",k.size]}),i.jsxs("div",{children:["Pin Count: ",k.pinCount]}),k.componentType==="Resistor"&&i.jsxs(i.Fragment,{children:[k.resistance&&i.jsxs("div",{children:["Resistance: ",k.resistance]}),k.power&&i.jsxs("div",{children:["Power: ",k.power]}),k.tolerance&&i.jsxs("div",{children:["Tolerance: ",k.tolerance]})]}),k.componentType==="Capacitor"&&i.jsxs(i.Fragment,{children:[k.capacitance&&i.jsxs("div",{children:["Capacitance: ",k.capacitance]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.dielectric&&i.jsxs("div",{children:["Dielectric: ",k.dielectric]}),k.tolerance&&i.jsxs("div",{children:["Tolerance: ",k.tolerance]})]}),k.componentType==="Electrolytic Capacitor"&&i.jsxs(i.Fragment,{children:[k.capacitance&&i.jsxs("div",{children:["Capacitance: ",k.capacitance]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.tolerance&&i.jsxs("div",{children:["Tolerance: ",k.tolerance]}),k.polarized!==void 0&&i.jsxs("div",{children:["Polarized: ",k.polarized?"Yes":"No"]}),k.esr&&i.jsxs("div",{children:["ESR: ",k.esr]}),k.temperature&&i.jsxs("div",{children:["Temperature: ",k.temperature]})]}),k.pinConnections&&k.pinConnections.length>0&&(()=>{const se=Xf(k),Te=Hl(k),le=k?.pinNames,_e=Te?.properties?.pinNames,De=_e&&_e.length>0;return i.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600},children:"Pin Connections:"}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin #"}),De&&i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Pin Name"}),se&&i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Polarity"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),i.jsx("tbody",{children:k.pinConnections.map((Xe,st)=>{const kt=k.pinPolarities&&k.pinPolarities.length>st?k.pinPolarities[st]:"",qt=le&&st<le.length?le[st]:"",ye=_e&&st<_e.length?_e[st]:"",ut=ye==="CHIP_DEPENDENT",Gt=qt&&qt.trim()!==""?qt:ut?"":ye;return i.jsxs("tr",{style:{backgroundColor:st%2===0?"#fff":"#f9f9f9"},children:[i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:st+1}),De&&i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",fontSize:"9px",fontStyle:"italic",color:"#555"},children:Gt||"-"}),se&&i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd",textAlign:"center",fontFamily:"monospace",fontWeight:600,color:kt==="+"?"#d32f2f":kt==="-"?"#1976d2":"#999"},children:kt||"-"}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:Xe||"(not connected)"})]},st)})})]})]})})(),"manufacturer"in k&&k.manufacturer&&i.jsxs("div",{children:["Manufacturer: ",k.manufacturer]}),"partNumber"in k&&k.partNumber&&i.jsxs("div",{children:["Part Number: ",k.partNumber]}),k.componentType==="Diode"&&i.jsxs(i.Fragment,{children:[k.diodeType&&i.jsxs("div",{children:["Type: ",k.diodeType]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]}),k.ledColor&&i.jsxs("div",{children:["LED Color: ",k.ledColor]})]}),k.componentType==="Battery"&&i.jsxs(i.Fragment,{children:[k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.capacity&&i.jsxs("div",{children:["Capacity: ",k.capacity]}),k.chemistry&&i.jsxs("div",{children:["Chemistry: ",k.chemistry]})]}),k.componentType==="Fuse"&&i.jsxs(i.Fragment,{children:[k.current&&i.jsxs("div",{children:["Current: ",k.current]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.fuseType&&i.jsxs("div",{children:["Type: ",k.fuseType]})]}),k.componentType==="FerriteBead"&&i.jsxs(i.Fragment,{children:[k.impedance&&i.jsxs("div",{children:["Impedance: ",k.impedance]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]})]}),k.componentType==="Connector"&&i.jsxs(i.Fragment,{children:[k.connectorType&&i.jsxs("div",{children:["Type: ",k.connectorType]}),k.gender&&i.jsxs("div",{children:["Gender: ",k.gender]})]}),k.componentType==="Jumper"&&i.jsx(i.Fragment,{children:k.positions&&i.jsxs("div",{children:["Positions: ",k.positions]})}),k.componentType==="Relay"&&i.jsxs(i.Fragment,{children:[k.coilVoltage&&i.jsxs("div",{children:["Coil Voltage: ",k.coilVoltage]}),k.contactType&&i.jsxs("div",{children:["Contact Type: ",k.contactType]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]})]}),k.componentType==="Inductor"&&i.jsxs(i.Fragment,{children:[k.inductance&&i.jsxs("div",{children:["Inductance: ",k.inductance]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]}),k.resistance&&i.jsxs("div",{children:["DC Resistance: ",k.resistance]})]}),k.componentType==="Speaker"&&i.jsxs(i.Fragment,{children:[k.impedance&&i.jsxs("div",{children:["Impedance: ",k.impedance]}),k.power&&i.jsxs("div",{children:["Power: ",k.power]})]}),k.componentType==="Motor"&&i.jsxs(i.Fragment,{children:[k.motorType&&i.jsxs("div",{children:["Type: ",k.motorType]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]})]}),k.componentType==="PowerSupply"&&i.jsxs(i.Fragment,{children:[k.inputVoltage&&i.jsxs("div",{children:["Input Voltage: ",k.inputVoltage]}),k.outputVoltage&&i.jsxs("div",{children:["Output Voltage: ",k.outputVoltage]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]})]}),k.componentType==="Transistor"&&i.jsxs(i.Fragment,{children:[k.transistorType&&i.jsxs("div",{children:["Type: ",k.transistorType]}),k.polarized!==void 0&&i.jsxs("div",{children:["Polarized: ",k.polarized?"Yes":"No"]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]})]}),k.componentType==="ResistorNetwork"&&i.jsxs(i.Fragment,{children:[k.resistance&&i.jsxs("div",{children:["Resistance: ",k.resistance]}),k.configuration&&i.jsxs("div",{children:["Configuration: ",k.configuration]})]}),k.componentType==="Thermistor"&&i.jsxs(i.Fragment,{children:[k.resistance&&i.jsxs("div",{children:["Resistance: ",k.resistance]}),k.thermistorType&&i.jsxs("div",{children:["Type: ",k.thermistorType]}),k.beta&&i.jsxs("div",{children:["Beta: ",k.beta]})]}),k.componentType==="Switch"&&i.jsxs(i.Fragment,{children:[k.switchType&&i.jsxs("div",{children:["Type: ",k.switchType]}),k.current&&i.jsxs("div",{children:["Current: ",k.current]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage]})]}),k.componentType==="Transformer"&&i.jsxs(i.Fragment,{children:[k.primaryVoltage&&i.jsxs("div",{children:["Primary Voltage: ",k.primaryVoltage]}),k.secondaryVoltage&&i.jsxs("div",{children:["Secondary Voltage: ",k.secondaryVoltage]}),k.power&&i.jsxs("div",{children:["Power: ",k.power]}),k.turns&&i.jsxs("div",{children:["Turns Ratio: ",k.turns]})]}),k.componentType==="TestPoint"&&i.jsx(i.Fragment,{children:k.signal&&i.jsxs("div",{children:["Signal: ",k.signal]})}),k.componentType==="IntegratedCircuit"&&i.jsxs(i.Fragment,{children:[k.datasheet&&(()=>{const se=k.datasheet.trim(),Te=se.match(/^https?:\/\//)?se:`https://${se}`;return i.jsxs("div",{children:["Datasheet URL:"," ",i.jsx("a",{href:Te,target:"_blank",rel:"noopener noreferrer",style:{color:"#0066cc",textDecoration:"underline"},children:se})]})})(),k.datasheetFileName&&(()=>{const Te=k.datasheetFileName.split("/").pop();return i.jsxs("div",{children:["Datasheet File:"," ",i.jsxs("span",{style:{color:"#666",fontStyle:"italic"},title:"Re-choose the datasheet file in Component Properties to open it",children:[Te," (re-choose file to open)"]})]})})()]}),k.componentType==="VacuumTube"&&i.jsx(i.Fragment,{children:k.tubeType&&i.jsxs("div",{children:["Type: ",k.tubeType]})}),k.componentType==="VariableResistor"&&i.jsxs(i.Fragment,{children:[k.vrType&&i.jsxs("div",{children:["Type: ",k.vrType]}),k.resistance&&i.jsxs("div",{children:["Resistance: ",k.resistance]}),k.power&&i.jsxs("div",{children:["Power: ",k.power]}),k.taper&&i.jsxs("div",{children:["Taper: ",k.taper]})]}),k.componentType==="Crystal"&&i.jsxs(i.Fragment,{children:[k.frequency&&i.jsxs("div",{children:["Frequency: ",k.frequency]}),k.loadCapacitance&&i.jsxs("div",{children:["Load Capacitance: ",k.loadCapacitance]}),k.tolerance&&i.jsxs("div",{children:["Tolerance: ",k.tolerance]})]}),k.componentType==="GenericComponent"&&i.jsxs(i.Fragment,{children:[k.genericType&&i.jsxs("div",{children:["Type: ",k.genericType]}),k.voltage&&i.jsxs("div",{children:["Voltage: ",k.voltage," ",k.voltageUnit||"V"]}),k.current&&i.jsxs("div",{children:["Current: ",k.current," ",k.currentUnit||"A"]}),k.power&&i.jsxs("div",{children:["Power: ",k.power]}),k.frequency&&i.jsxs("div",{children:["Frequency: ",k.frequency]}),k.model&&i.jsxs("div",{children:["Model: ",k.model]})]}),i.jsx("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid #eee",fontSize:"10px",color:"#999"},children:i.jsxs("div",{children:["Position: x=",k.x.toFixed(2),", y=",k.y.toFixed(2)]})})]})]},k.id)})})(),r.size>0&&d.filter(xe=>r.has(xe.id)&&xe.type==="via"&&xe.points.length>0).map(xe=>{const k=xe.points[0],A=xe.viaType||(k.id!==void 0?F(k.id,T):"Via");return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A})]}),ae&&i.jsx("button",{onClick:()=>{ae(xe.id,k.x,k.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:V=>{V.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:V=>{V.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[k.id&&i.jsxs("div",{children:["Node ID: ",k.id]}),i.jsx("div",{children:"Layer: Top and Bottom"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{children:["Position: x=",k.x.toFixed(2),", y=",k.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id)}),r.size>0&&d.filter(xe=>r.has(xe.id)&&xe.type==="pad"&&xe.points.length>0).map(xe=>{const k=xe.points[0],A=xe.padType||(k.id!==void 0?_(k.id,T):"Pad");return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A})]}),ae&&i.jsx("button",{onClick:()=>{ae(xe.id,k.x,k.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:V=>{V.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:V=>{V.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[k.id&&i.jsxs("div",{children:["Node ID: ",k.id]}),i.jsxs("div",{children:["Layer: ",xe.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{children:["Position: x=",k.x.toFixed(2),", y=",k.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id)}),r.size>0&&d.filter(xe=>r.has(xe.id)&&xe.type==="testPoint"&&xe.points.length>0).map(xe=>{const k=xe.points[0],A=k.id!==void 0?N(k.id,T):"Test Point";return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:A})]}),ae&&i.jsx("button",{onClick:()=>{ae(xe.id,k.x,k.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:V=>{V.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:V=>{V.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[k.id&&i.jsxs("div",{children:["Node ID: ",k.id]}),i.jsxs("div",{children:["Layer: ",xe.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{children:["Position: x=",k.x.toFixed(2),", y=",k.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id)}),r.size>0&&d.filter(xe=>r.has(xe.id)&&xe.type==="trace").map(xe=>{const k=xe.points.length>0?xe.points.reduce((V,W)=>V+W.x,0)/xe.points.length:0,A=xe.points.length>0?xe.points.reduce((V,W)=>V+W.y,0)/xe.points.length:0;return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe.type||"unknown"})]}),ae&&xe.points.length>0&&i.jsx("button",{onClick:()=>{ae(xe.id,k,A)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:V=>{V.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:V=>{V.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[xe.points.length>0&&i.jsxs("div",{style:{marginTop:"8px",marginBottom:"8px"},children:[i.jsxs("div",{style:{marginBottom:"4px",fontWeight:600},children:["Points: ",xe.points.length]}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px",border:"1px solid #ddd"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f0f0f0"},children:[i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Point #"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"x"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"y"}),i.jsx("th",{style:{padding:"4px 8px",textAlign:"left",border:"1px solid #ddd",fontWeight:600},children:"Node ID"})]})}),i.jsx("tbody",{children:xe.points.map((V,W)=>i.jsxs("tr",{style:{backgroundColor:W%2===0?"#fff":"#f9f9f9"},children:[i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:W}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:V.x.toFixed(2)}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:V.y.toFixed(2)}),i.jsx("td",{style:{padding:"4px 8px",border:"1px solid #ddd"},children:V.id||"(none)"})]},W))})]})]}),i.jsxs("div",{style:{marginTop:"4px"},children:["Layer: ",xe.layer]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id)}),s.size>0&&b.filter(xe=>s.has(xe.id)).map(xe=>{const k=T.find(A=>A.id===xe.powerBusId);return i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe.type||(k?`${k.name} Power Node`:"Power Node")})]}),E&&i.jsx("button",{onClick:()=>{E(xe.id,xe.x,xe.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:A=>{A.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:A=>{A.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[i.jsxs("div",{children:["Node ID: ",xe.pointId||"(not assigned)"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{children:["Layer: ",xe.layer]}),i.jsxs("div",{children:["Power Bus: ",k?.name||xe.powerBusId||"(unknown)"]}),i.jsxs("div",{children:["Position: x=",xe.x.toFixed(2),", y=",xe.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id)}),l.size>0&&m.filter(xe=>l.has(xe.id)).map(xe=>i.jsxs("div",{style:{marginTop:"16px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",minHeight:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type:"}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:xe.type||"Ground Node"})]}),q&&i.jsx("button",{onClick:()=>{q(xe.id,xe.x,xe.y)},style:{padding:"2px 8px",fontSize:"10px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap",marginLeft:"8px"},onMouseEnter:k=>{k.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:k=>{k.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),i.jsxs("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px"},children:[i.jsxs("div",{children:["Node ID: ",xe.pointId||"(not assigned)"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("span",{children:"Color:"}),i.jsx("div",{style:{width:"16px",height:"16px",backgroundColor:xe.color,border:"1px solid #ccc",borderRadius:2}}),i.jsx("span",{children:xe.color})]}),i.jsxs("div",{children:["Size: ",xe.size]}),i.jsxs("div",{children:["Position: x=",xe.x.toFixed(2),", y=",xe.y.toFixed(2)]}),i.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#666",whiteSpace:"nowrap",flexShrink:0},children:"Notes:"}),i.jsx("input",{type:"text",value:xe.notes||"",readOnly:!0,onClick:ee,placeholder:"Click to edit notes...",maxLength:200,style:{flex:1,padding:"4px 6px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#f9f9f9",color:"#333",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0}})]})]})]},xe.id))]})}),i.jsx("div",{onMouseDown:de,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]}),i.jsx(Ux,{visible:U.visible,title:U.title,message:U.message,onClose:()=>$({visible:!1,title:"",message:""})})]})},$o=500,I5=({visible:n,selectedIds:r,selectedComponentIds:o,selectedPowerIds:s,selectedGroundIds:l,drawingStrokes:d,componentsTop:v,componentsBottom:p,powers:b,grounds:m,powerBuses:T,onClose:D,setComponentsTop:M,setComponentsBottom:S,setDrawingStrokes:F,setPowerSymbols:_,setGroundSymbols:N,determineViaType:g,determinePadType:ae,determineTestPointType:E,position:q,isDragging:re,onDragStart:J})=>{const[Y,ee]=I.useState(new Map),U=I.useRef(""),[$,H]=I.useState(()=>{const le=localStorage.getItem("notesDialogSize");if(le)try{return JSON.parse(le)}catch{return{width:400,height:window.innerHeight*.8}}return{width:400,height:window.innerHeight*.8}}),[R,Z]=I.useState(!1),[G,we]=I.useState({x:0,y:0,width:0,height:0}),te=()=>[...Array.from(r).sort(),...Array.from(o).sort(),...Array.from(s).sort(),...Array.from(l).sort()].join(",");I.useEffect(()=>{if(!n)return;const le=te();le!==U.current&&(U.current=le,ee(_e=>{const ve=new Map;return[...v,...p].filter(De=>o.has(De.id)).forEach(De=>{const Xe=_e.get(De.id);ve.set(De.id,Xe!==void 0?Xe:De.notes||"")}),d.filter(De=>r.has(De.id)).forEach(De=>{const Xe=_e.get(De.id);ve.set(De.id,Xe!==void 0?Xe:De.notes||"")}),b.filter(De=>s.has(De.id)).forEach(De=>{const Xe=_e.get(De.id);ve.set(De.id,Xe!==void 0?Xe:De.notes||"")}),m.filter(De=>l.has(De.id)).forEach(De=>{const Xe=_e.get(De.id);ve.set(De.id,Xe!==void 0?Xe:De.notes||"")}),ve}))},[n,r,o,s,l,d,v,p,b,m]),I.useEffect(()=>{if(!R)return;const le=ve=>{const De=ve.clientX-G.x,Xe=ve.clientY-G.y,st=Math.max(300,Math.min(window.innerWidth-20,G.width+De)),kt=Math.max(200,Math.min(window.innerHeight-20,G.height+Xe)),qt={width:st,height:kt};H(qt),localStorage.setItem("notesDialogSize",JSON.stringify(qt))},_e=()=>{Z(!1)};return document.addEventListener("mousemove",le),document.addEventListener("mouseup",_e),()=>{document.removeEventListener("mousemove",le),document.removeEventListener("mouseup",_e)}},[R,G]);const de=le=>{le.preventDefault(),le.stopPropagation(),Z(!0),we({x:le.clientX,y:le.clientY,width:$.width,height:$.height})};if(!n)return null;const Ce=q?{position:"fixed",left:`${q.x}px`,top:`${q.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${$.width}px`,height:`${$.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:re?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",paddingRight:"20px",paddingTop:"80px",zIndex:1e4,pointerEvents:"none"},Re={padding:"20px",overflow:"auto",flex:1},xe=d.filter(le=>r.has(le.id)).length,k=[...v,...p].filter(le=>o.has(le.id)).length,A=b.filter(le=>s.has(le.id)).length,V=m.filter(le=>l.has(le.id)).length,W=xe+k+A+V,se=(le,_e)=>{const ve=_e.length>$o?_e.substring(0,$o):_e;ee(De=>{const Xe=new Map(De);return Xe.set(le,ve),Xe})},Te=()=>{M(le=>le.map(_e=>{if(o.has(_e.id)&&Y.has(_e.id)){const ve=Y.get(_e.id)||"";return{..._e,notes:ve.trim()===""?void 0:ve.trim()}}return _e})),S(le=>le.map(_e=>{if(o.has(_e.id)&&Y.has(_e.id)){const ve=Y.get(_e.id)||"";return{..._e,notes:ve.trim()===""?void 0:ve.trim()}}return _e})),F(le=>le.map(_e=>{if(r.has(_e.id)&&Y.has(_e.id)){const ve=Y.get(_e.id)||"";return{..._e,notes:ve.trim()===""?null:ve.trim()}}return _e})),_(le=>le.map(_e=>{if(s.has(_e.id)&&Y.has(_e.id)){const ve=Y.get(_e.id)||"";return{..._e,notes:ve.trim()===""?null:ve.trim()}}return _e})),N(le=>le.map(_e=>{if(l.has(_e.id)&&Y.has(_e.id)){const ve=Y.get(_e.id)||"";return{..._e,notes:ve.trim()===""?null:ve.trim()}}return _e}))};return i.jsx("div",{style:Ce,children:i.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",...q?{}:{backgroundColor:"#fff",borderRadius:8,minWidth:"300px",width:`${$.width}px`,height:`${$.height}px`,maxHeight:`${window.innerHeight-20}px`,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",pointerEvents:"auto"}},children:[i.jsxs("div",{onMouseDown:le=>{const _e=le.target;_e.tagName==="BUTTON"||_e.closest("button")||q&&J(le)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:re?"grabbing":q?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Notes (N)"}),i.jsx("button",{onClick:D,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:Re,children:i.jsxs("div",{style:{margin:0,padding:0,backgroundColor:"#f5f5f5",borderRadius:4,fontSize:"12px",fontFamily:"monospace",maxHeight:"calc(80vh - 100px)",overflow:"auto",color:"#000"},children:[i.jsx("div",{style:{padding:"12px 16px",backgroundColor:W>0?"#e8e8e8":"#fff3cd",borderBottom:"2px solid #ccc",fontSize:"13px",fontWeight:600,color:W>0?"#333":"#856404",marginBottom:"8px"},children:W>0?`${W} Object${W!==1?"s":""} Selected`:"Zero Objects Selected"}),W===0?i.jsx("div",{style:{padding:"20px",textAlign:"center",color:"#666"},children:"No objects selected. Select one or more objects to add or edit notes."}):i.jsxs(i.Fragment,{children:[[...v,...p].filter(le=>o.has(le.id)).map(le=>{const _e=Y.get(le.id)||"",ve=_e.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsxs("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:[Wl(le.componentType),le.designator&&le.designator.trim()?` (${le.designator.trim()})`:""]})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("textarea",{value:_e,onChange:De=>se(le.id,De.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:$o,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:ve>=$o?"#d32f2f":"#666",textAlign:"right"},children:[ve," / ",$o]})]})]},le.id)}),d.filter(le=>r.has(le.id)&&le.type==="via"&&le.points.length>0).map(le=>{const _e=le.points[0],ve=le.viaType||(_e.id!==void 0?g(_e.id,T):"Via"),De=Y.get(le.id)||"",Xe=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:ve})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:_e.id&&i.jsxs("div",{children:["Node ID: ",_e.id]})}),i.jsx("textarea",{value:De,onChange:st=>se(le.id,st.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:$o,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Xe>=$o?"#d32f2f":"#666",textAlign:"right"},children:[Xe," / ",$o]})]})]},le.id)}),d.filter(le=>r.has(le.id)&&le.type==="pad"&&le.points.length>0).map(le=>{const _e=le.points[0],ve=le.padType||(_e.id!==void 0?ae(_e.id,T):"Pad"),De=Y.get(le.id)||"",Xe=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:ve})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:_e.id&&i.jsxs("div",{children:["Node ID: ",_e.id]})}),i.jsx("textarea",{value:De,onChange:st=>se(le.id,st.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:$o,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Xe>=$o?"#d32f2f":"#666",textAlign:"right"},children:[Xe," / ",$o]})]})]},le.id)}),d.filter(le=>r.has(le.id)&&le.type==="testPoint"&&le.points.length>0).map(le=>{const _e=le.points[0],ve=_e.id!==void 0?E(_e.id,T):"Test Point",De=Y.get(le.id)||"",Xe=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:ve})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:_e.id&&i.jsxs("div",{children:["Node ID: ",_e.id]})}),i.jsx("textarea",{value:De,onChange:st=>se(le.id,st.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:$o,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Xe>=$o?"#d32f2f":"#666",textAlign:"right"},children:[Xe," / ",$o]})]})]},le.id)}),d.filter(le=>r.has(le.id)&&le.type==="trace").map(le=>{const _e=Y.get(le.id)||"",ve=_e.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:le.type||"unknown"})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("textarea",{value:_e,onChange:De=>se(le.id,De.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:$o,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:ve>=$o?"#d32f2f":"#666",textAlign:"right"},children:[ve," / ",$o]})]})]},le.id)}),b.filter(le=>s.has(le.id)).map(le=>{const _e=T.find(st=>st.id===le.powerBusId),ve=le.type||(_e?`${_e.name} Power Node`:"Power Node"),De=Y.get(le.id)||"",Xe=De.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:ve})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:i.jsxs("div",{children:["Node ID: ",le.pointId||"(not assigned)"]})}),i.jsx("textarea",{value:De,onChange:st=>se(le.id,st.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:$o,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:Xe>=$o?"#d32f2f":"#666",textAlign:"right"},children:[Xe," / ",$o]})]})]},le.id)}),m.filter(le=>l.has(le.id)).map(le=>{const _e=le.type||"Ground Node",ve=Y.get(le.id)||"",De=ve.length;return i.jsxs("div",{style:{marginTop:"8px",padding:0,backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{backgroundColor:"#000",marginBottom:"8px",display:"flex",alignItems:"center",padding:"8px 12px",minHeight:"32px"},children:[i.jsx("label",{style:{fontSize:"11px",color:"#fff",marginRight:"8px"},children:"Type: "}),i.jsx("div",{style:{color:"#fff",padding:"4px 8px",fontSize:"12px",fontWeight:500},children:_e})]}),i.jsxs("div",{style:{padding:"8px"},children:[i.jsx("div",{style:{fontSize:"11px",color:"#666",marginBottom:"4px"},children:i.jsxs("div",{children:["Node ID: ",le.pointId||"(not assigned)"]})}),i.jsx("textarea",{value:ve,onChange:Xe=>se(le.id,Xe.target.value),placeholder:"Enter notes (max 200 characters)...",maxLength:$o,style:{width:"100%",minHeight:"50px",padding:"8px",fontSize:"11px",fontFamily:"sans-serif",backgroundColor:"#fff",color:"#000",border:"1px solid #ccc",borderRadius:4,resize:"vertical",boxSizing:"border-box"}}),i.jsxs("div",{style:{marginTop:"4px",fontSize:"10px",color:De>=$o?"#d32f2f":"#666",textAlign:"right"},children:[De," / ",$o]})]})]},le.id)}),i.jsxs("div",{style:{marginTop:"20px",padding:"12px",display:"flex",justifyContent:"flex-end",gap:"8px",borderTop:"1px solid #ddd"},children:[i.jsx("button",{onClick:D,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#757575",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="#616161"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="#757575"},children:"Close"}),i.jsx("button",{onClick:Te,style:{padding:"8px 16px",fontSize:"12px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500},onMouseEnter:le=>{le.currentTarget.style.backgroundColor="#1976D2"},onMouseLeave:le=>{le.currentTarget.style.backgroundColor="#2196F3"},children:"Save"})]})]})]})}),i.jsx("div",{onMouseDown:de,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})})},M5=({visible:n,projectNotes:r,setProjectNotes:o,projectMetadata:s,setProjectMetadata:l,onClose:d,position:v,isDragging:p,onDragStart:b})=>{const[m,T]=I.useState([]),[D,M]=I.useState({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),[S,F]=I.useState(null),[_,N]=I.useState(null),g=I.useRef(new Map),[ae,E]=I.useState({width:Math.min(window.innerWidth*.85,1400),height:window.innerHeight*.7}),[q,re]=I.useState(!1),[J,Y]=I.useState({x:0,y:0,width:0,height:0}),[ee,U]=I.useState("");I.useEffect(()=>{n&&(T([...r]),M({...s}),(!s.date||s.date.trim()==="")&&M(A=>({...A,date:new Date().toISOString().split("T")[0]})),F(null),N(null),U(""))},[n,r,s]);const $=ee.trim()===""?m:m.filter(A=>{const V=ee.toLowerCase(),W=A.name.toLowerCase().includes(V),se=A.value.toLowerCase().includes(V);return W||se});I.useEffect(()=>{if(!q)return;const A=W=>{const se=W.clientX-J.x,Te=W.clientY-J.y,le=Math.max(400,Math.min(window.innerWidth-20,J.width+se)),_e=Math.max(300,Math.min(window.innerHeight-20,J.height+Te));E({width:le,height:_e})},V=()=>{re(!1)};return document.addEventListener("mousemove",A),document.addEventListener("mouseup",V),()=>{document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",V)}},[q,J]);const H=A=>{A.preventDefault(),A.stopPropagation(),re(!0),Y({x:A.clientX,y:A.clientY,width:ae.width,height:ae.height})};if(!n)return null;const R=()=>{const A={name:"",value:"",checked:!1};T([...m,A]),F(m.length),N("name")},Z=A=>{const V=m.filter((W,se)=>se!==A);T(V),S===A?(F(null),N(null)):S!==null&&S>A&&F(S-1)},G=()=>{const A=m.filter(V=>V.name.trim()!==""||V.value.trim()!=="");o(A),l(D),d()},we=()=>{T([...r]),M({...s}),F(null),N(null),d()},te=(A,V,W)=>{const se=[...m];se[A]={...se[A],[V]:W},T(se)},de=(A,V)=>{const W=[...m];W[A]={...W[A],checked:V},T(W)},Ce=(A,V,W)=>{A.stopPropagation();const se=A.currentTarget,Te=se.selectionStart,le=se.value.length,_e=se.selectionStart!==se.selectionEnd;if(!(A.key==="Enter"&&A.altKey)){if(A.key==="ArrowRight"&&!A.ctrlKey&&!A.shiftKey&&!A.altKey){if(Te===le&&!_e&&W==="name"){A.preventDefault();const ve=`${V}-value`,De=g.current.get(ve);De&&(De.focus(),De.setSelectionRange(0,0))}return}if(A.key==="ArrowLeft"&&!A.ctrlKey&&!A.shiftKey&&!A.altKey){if(Te===0&&!_e&&W==="value"){A.preventDefault();const ve=`${V}-name`,De=g.current.get(ve);De&&(De.focus(),De.setSelectionRange(De.value.length,De.value.length))}return}if(A.key==="ArrowDown"&&!A.ctrlKey&&!A.shiftKey&&!A.altKey){if(A.preventDefault(),V<m.length-1){const ve=`${V+1}-${W}`,De=g.current.get(ve);if(De){De.focus();const Xe=Math.min(Te,De.value.length);De.setSelectionRange(Xe,Xe)}}else{const ve=m.length;R(),setTimeout(()=>{const De=`${ve}-${W}`,Xe=g.current.get(De);Xe&&(Xe.focus(),Xe.setSelectionRange(0,0))},0)}return}if(A.key==="ArrowUp"&&!A.ctrlKey&&!A.shiftKey&&!A.altKey){if(A.preventDefault(),V>0){const ve=`${V-1}-${W}`,De=g.current.get(ve);if(De){De.focus();const Xe=Math.min(Te,De.value.length);De.setSelectionRange(Xe,Xe)}}return}if(A.key==="Enter"&&!A.altKey&&!A.shiftKey){if(A.preventDefault(),W==="name"){const ve=`${V}-value`,De=g.current.get(ve);De&&(De.focus(),De.setSelectionRange(0,0))}else if(W==="value")if(V<m.length-1){const ve=`${V+1}-name`,De=g.current.get(ve);De&&(De.focus(),De.setSelectionRange(0,0))}else{const ve=m.length;R(),setTimeout(()=>{const De=`${ve}-name`,Xe=g.current.get(De);Xe&&(Xe.focus(),Xe.setSelectionRange(0,0))},0)}return}if(A.key==="Tab"&&!A.shiftKey){if(A.preventDefault(),W==="name"){const ve=`${V}-value`,De=g.current.get(ve);De&&(De.focus(),De.select())}else if(W==="value")if(V<m.length-1){const ve=`${V+1}-name`,De=g.current.get(ve);De&&(De.focus(),De.select())}else{const ve=m.length;R(),setTimeout(()=>{const De=`${ve}-name`,Xe=g.current.get(De);Xe&&Xe.focus()},0)}return}if(A.key==="Tab"&&A.shiftKey){if(A.preventDefault(),W==="value"){const ve=`${V}-name`,De=g.current.get(ve);De&&(De.focus(),De.select())}else if(W==="name"&&V>0){const ve=`${V-1}-value`,De=g.current.get(ve);De&&(De.focus(),De.select())}return}}},Re=(A,V)=>{F(A),N(V)},xe=()=>{},k={position:"fixed",top:v?.y??100,left:v?.x??(window.innerWidth-ae.width)/2,width:`${ae.width}px`,height:`${ae.height}px`,backgroundColor:"#fff",borderRadius:8,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:p?"grabbing":"default",overflow:"hidden"};return i.jsxs("div",{style:k,children:[i.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #e0e0e0",background:"#888",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"move",userSelect:"none"},onMouseDown:b,children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Project Notes / TODO List (L)"}),i.jsx("button",{onClick:we,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),i.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f9f9f9",display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"12px",alignItems:"center",flexShrink:0},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Product Name:"}),i.jsx("input",{type:"text",value:D.productName,onChange:A=>M({...D,productName:A.target.value}),placeholder:"Enter product name",style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Product Version:"}),i.jsx("input",{type:"text",value:D.productVersion,onChange:A=>M({...D,productVersion:A.target.value}),placeholder:"Enter version",style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Manufacturer:"}),i.jsx("input",{type:"text",value:D.manufacturer,onChange:A=>M({...D,manufacturer:A.target.value}),placeholder:"Enter manufacturer",style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333"},children:"Date:"}),i.jsx("input",{type:"date",value:D.date,onChange:A=>M({...D,date:A.target.value}),style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"12px",color:"#000",background:"#fff",outline:"none"}})]})]}),i.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f5f5f5",display:"flex",gap:"8px",alignItems:"center",flexShrink:0},children:[i.jsx("input",{type:"text",value:ee,onChange:A=>U(A.target.value),onKeyDown:A=>{A.key==="Enter"&&A.preventDefault()},placeholder:"Search notes...",style:{flex:1,padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",color:"#000",background:"#fff",outline:"none"}}),i.jsx("button",{onClick:()=>{ee.trim()!==""&&U("")},style:{padding:"6px 16px",background:ee.trim()!==""?"#4CAF50":"#888",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:500,whiteSpace:"nowrap"},children:ee.trim()!==""?"Clear":"Search"})]}),i.jsxs("div",{className:"project-notes-content",style:{padding:0,flex:1,overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",minHeight:0,scrollbarWidth:"thin",scrollbarColor:"#888 #f0f0f0"},children:[i.jsxs("div",{style:{border:"none",borderTop:"1px solid #ccc",borderRadius:0,overflow:"visible",marginBottom:"16px",backgroundColor:"#e0e0e0",flexShrink:0},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",backgroundColor:"#e0e0e0",borderBottom:"1px solid #ccc",position:"sticky",top:0,zIndex:10},children:[i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center",color:"#000"},children:i.jsx("label",{className:"radio-label",style:{margin:0,cursor:"default"},children:i.jsx("input",{type:"checkbox",disabled:!0,style:{opacity:.5}})})}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Item"}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",borderRight:"1px solid #ccc",color:"#000"},children:"Notes"}),i.jsx("div",{style:{padding:"8px 12px",fontWeight:600,fontSize:"12px",color:"#000"}})]}),i.jsx("div",{children:m.length===0?i.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:'No notes. Click "Add Note" to create one.'}):$.length===0?i.jsxs("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:['No matches found for "',ee,'".']}):$.map(A=>{const V=m.findIndex(W=>W===A);return i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"40px 1fr 3fr auto",borderBottom:"1px solid #ccc",backgroundColor:"#fff"},children:[i.jsx("div",{style:{padding:"8px 12px",borderRight:"1px solid #ccc",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("label",{className:"radio-label",style:{margin:0,cursor:"pointer"},children:i.jsx("input",{type:"checkbox",checked:A.checked||!1,onChange:W=>de(V,W.target.checked)})})}),i.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:i.jsx("textarea",{ref:W=>{W?g.current.set(`${V}-name`,W):g.current.delete(`${V}-name`)},value:A.name,onChange:W=>te(V,"name",W.target.value),onFocus:()=>Re(V,"name"),onBlur:xe,onKeyDown:W=>Ce(W,V,"name"),placeholder:"Item name...",rows:1,style:{width:"100%",padding:"4px 6px",border:S===V&&_==="name"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:W=>{const se=W.target;se.style.height="auto",se.style.height=`${se.scrollHeight}px`}})}),i.jsx("div",{style:{padding:"4px",borderRight:"1px solid #ccc"},children:i.jsx("textarea",{ref:W=>{W?g.current.set(`${V}-value`,W):g.current.delete(`${V}-value`)},value:A.value,onChange:W=>te(V,"value",W.target.value),onFocus:()=>Re(V,"value"),onBlur:xe,onKeyDown:W=>Ce(W,V,"value"),placeholder:"Notes...",rows:1,style:{width:"100%",padding:"4px 6px",border:S===V&&_==="value"?"2px solid #0b5fff":"1px solid transparent",borderRadius:3,fontSize:"12px",backgroundColor:"#fff",color:"#000",fontFamily:"inherit",resize:"none",minHeight:"24px",lineHeight:"1.4",overflow:"hidden",outline:"none",boxSizing:"border-box"},onInput:W=>{const se=W.target;se.style.height="auto",se.style.height=`${se.scrollHeight}px`}})}),i.jsx("div",{style:{padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("button",{onClick:()=>Z(V),style:{background:"#f44336",color:"#fff",border:"none",borderRadius:3,padding:"4px 8px",cursor:"pointer",fontSize:"11px"},title:"Delete note",children:"Delete"})})]},V)})})]}),i.jsx("div",{style:{padding:"16px",flexShrink:0},children:i.jsx("button",{onClick:R,style:{background:"#888",color:"#fff",border:"none",borderRadius:4,padding:"8px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500,alignSelf:"flex-start"},children:"+ Add Note"})})]}),i.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px",flexShrink:0},children:[i.jsx("button",{onClick:we,style:{background:"#f5f5f5",color:"#000",border:"1px solid #ddd",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px"},children:"Cancel"}),i.jsx("button",{onClick:G,style:{background:"#0b5fff",color:"#fff",border:"none",borderRadius:4,padding:"6px 16px",cursor:"pointer",fontSize:"12px",fontWeight:500},children:"Save"})]}),i.jsx("div",{onMouseDown:H,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:10001},title:"Drag to resize"})]})},B5=({visible:n,drawingStrokes:r,onClose:o,onFindTestPoint:s,position:l,isDragging:d,onDragStart:v,determineTestPointType:p,powerBuses:b})=>{const[m,T]=I.useState("");if(I.useEffect(()=>{n&&T("")},[n]),!n)return null;const D=r.filter(_=>_.type==="testPoint"&&_.points.length>0),M=m.trim()===""?D:D.filter(_=>(_.notes||"").toLowerCase().includes(m.toLowerCase())),S=l?{position:"fixed",left:`${l.x}px`,top:`${l.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"150px",maxWidth:"500px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:d?"grabbing":"default"}:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},F={padding:"20px",overflow:"auto",flex:1};return i.jsxs("div",{style:S,children:[i.jsxs("div",{onMouseDown:_=>{const N=_.target;N.tagName==="BUTTON"||N.closest("button")||l&&v(_)},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:d?"grabbing":l?"grab":"default",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Test Points"}),i.jsx("button",{onClick:o,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0",backgroundColor:"#f5f5f5",display:"flex",gap:"8px",alignItems:"center",flexShrink:0},children:[i.jsx("input",{type:"text",value:m,onChange:_=>T(_.target.value),onKeyDown:_=>{_.key==="Enter"&&_.preventDefault()},placeholder:"Search test point notes...",style:{flex:1,padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",color:"#000",background:"#fff",outline:"none"}}),i.jsx("button",{onClick:()=>{m.trim()!==""&&T("")},style:{padding:"6px 16px",background:m.trim()!==""?"#4CAF50":"#888",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"13px",fontWeight:500,whiteSpace:"nowrap"},children:m.trim()!==""?"Clear":"Search"})]}),i.jsx("div",{style:F,children:D.length===0?i.jsx("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:"No test points found."}):M.length===0?i.jsxs("div",{style:{padding:"24px",textAlign:"center",color:"#999",fontSize:"13px"},children:['No matches found for "',m,'".']}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:M.map(_=>{const N=_.points[0],g=N.id!==void 0?p(N.id,b):"Test Point",ae=g.includes("(")?g.substring(0,g.indexOf("(")).trim():g;return i.jsxs("div",{style:{padding:"12px",backgroundColor:"#fff",borderRadius:4,border:"1px solid #ddd"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0},children:i.jsx("path",{d:"M 12 5 L 19 12 L 12 19 L 5 12 Z",fill:"#FFD700",stroke:"#000",strokeWidth:"1.5"})}),i.jsx("div",{style:{fontSize:"12px",fontWeight:500,color:"#000"},children:ae})]}),s&&i.jsx("button",{onClick:()=>{s(_.id,N.x,N.y)},style:{padding:"4px 12px",fontSize:"11px",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:500,whiteSpace:"nowrap"},onMouseEnter:E=>{E.currentTarget.style.backgroundColor="#45a049"},onMouseLeave:E=>{E.currentTarget.style.backgroundColor="#4CAF50"},children:"Find"})]}),_.notes&&_.notes.trim()!==""?i.jsx("div",{style:{fontSize:"11px",color:"#666",marginTop:"8px",padding:"8px",backgroundColor:"#f5f5f5",borderRadius:"3px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:_.notes}):i.jsx("div",{style:{fontSize:"11px",color:"#999",fontStyle:"italic",marginTop:"8px"},children:"No notes"}),i.jsxs("div",{style:{fontSize:"10px",color:"#999",marginTop:"8px"},children:["Layer: ",_.layer," | Position: (",N.x.toFixed(2),", ",N.y.toFixed(2),")"]})]},_.id)})})})]})},O5=({visible:n,dimensions:r,onSave:o,onClose:s})=>{const[l,d]=I.useState(""),[v,p]=I.useState(""),[b,m]=I.useState("inches");I.useEffect(()=>{n&&r?(d(r.width.toString()),p(r.height.toString()),m(r.unit)):n&&(d(""),p(""),m("inches"))},[n,r]);const T=()=>{const M=parseFloat(l),S=parseFloat(v);if(isNaN(M)||M<=0){alert("Please enter a valid width greater than 0");return}if(isNaN(S)||S<=0){alert("Please enter a valid height greater than 0");return}o({width:M,height:S,unit:b}),s()},D=()=>{s()};return n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:M=>{M.target===M.currentTarget&&D()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"320px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #444"},onClick:M=>M.stopPropagation(),children:[i.jsx("h3",{style:{margin:"0 0 20px 0",color:"#fff",fontSize:"18px",fontWeight:600},children:"Board Dimensions"}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Width"}),i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("input",{type:"number",step:"0.001",min:"0.001",value:l,onChange:M=>d(M.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),i.jsxs("select",{value:b,onChange:M=>m(M.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"inches",children:"inches"}),i.jsx("option",{value:"mm",children:"mm"})]})]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#ddd",fontSize:"14px"},children:"Height"}),i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("input",{type:"number",step:"0.001",min:"0.001",value:v,onChange:M=>p(M.target.value),style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px"},placeholder:"0.000"}),i.jsxs("select",{value:b,onChange:M=>m(M.target.value),style:{padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:4,color:"#fff",fontSize:"14px",cursor:"pointer"},children:[i.jsx("option",{value:"inches",children:"inches"}),i.jsx("option",{value:"mm",children:"mm"})]})]})]}),i.jsx("div",{style:{marginBottom:"12px",padding:"10px",background:"#1f1f24",borderRadius:4,fontSize:"12px",color:"#bbb"},children:"This information will be used to convert pixel coordinates to real-world measurements."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx("button",{onClick:D,style:{padding:"8px 16px",background:"#444",color:"#fff",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px"},children:"Cancel"}),i.jsx("button",{onClick:T,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save"})]})]})}):null},U5=({visible:n,onClose:r,topImage:o,bottomImage:s,selectedImageForTransform:l,setSelectedImageForTransform:d,transformMode:v,setTransformMode:p,updateImageTransform:b,resetImageTransform:m,setCurrentTool:T,isGrayscale:D,setIsGrayscale:M,areImagesLocked:S})=>{const[F,_]=I.useState(null),[N,g]=I.useState(!1),ae=I.useRef({x:0,y:0}),E=I.useRef(null);I.useEffect(()=>{n&&F===null&&_({x:window.innerWidth-320-20,y:80})},[n,F]),I.useEffect(()=>{n||_(null)},[n]);const q=I.useCallback(W=>{if(E.current){const se=E.current.getBoundingClientRect();ae.current={x:W.clientX-se.left,y:W.clientY-se.top},g(!0)}},[]);if(I.useEffect(()=>{if(!N)return;const W=Te=>{const le=Te.clientX-ae.current.x,_e=Te.clientY-ae.current.y,ve=E.current?.offsetWidth||320,De=E.current?.offsetHeight||600,Xe=Math.max(0,Math.min(le,window.innerWidth-ve)),st=Math.max(0,Math.min(_e,window.innerHeight-De));_({x:Xe,y:st})},se=()=>{g(!1)};return document.addEventListener("mousemove",W),document.addEventListener("mouseup",se),()=>{document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",se)}},[N]),!n)return null;const re=o!==null,J=s!==null,Y=re||J,ee=re&&J,U=l||(re?"top":J?"bottom":null),$=()=>U==="top"&&o?o.brightness??100:U==="bottom"&&s?s.brightness??100:U==="both"&&o?o.brightness??100:100,H=()=>U==="top"&&o?o.contrast??100:U==="bottom"&&s?s.contrast??100:U==="both"&&o?o.contrast??100:100,R=$(),Z=H(),G=!Y||S,we=()=>{if(!(!U||G))if(U==="both"){const W=!o?.flipX;b("both",{flipX:W})}else{const W=U==="top"?o?.flipX||!1:s?.flipX||!1;b(U,{flipX:!W})}},te=()=>{if(!(!U||G))if(U==="both"){const W=!o?.flipY;b("both",{flipY:W})}else{const W=U==="top"?o?.flipY||!1:s?.flipY||!1;b(U,{flipY:!W})}},de=W=>{G||(U&&d(U),p(W),T("transform"))},Ce=W=>{!U||G||b(U,{brightness:W})},Re=W=>{!U||G||b(U,{contrast:W})},xe=()=>{G||(U&&d(U),T("transform"),M(!D))},k=()=>{G||(T("transform"),m())},A=(W,se=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:W?"#666":"#f2f2f2",background:se?"#3a3a42":"transparent",border:"none",borderRadius:4,cursor:W?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"}),V=(W,se)=>({display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",color:W?"#666":"#f2f2f2",cursor:W?"not-allowed":"pointer",fontSize:"13px",background:se?"#3a3a42":"transparent",borderRadius:4,transition:"background 0.15s"});return i.jsxs("div",{ref:E,style:{position:"fixed",top:F?.y??80,left:F?.x??window.innerWidth-340,backgroundColor:"#2b2b31",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24",zIndex:10001},children:[i.jsxs("div",{onMouseDown:q,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 16px",background:"linear-gradient(to bottom, #3a3a42, #2b2b31)",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottom:"1px solid #1f1f24",cursor:N?"grabbing":"grab",userSelect:"none"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("span",{style:{color:"#888",fontSize:"14px"},children:""}),i.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#f2f2f2"},children:"Transform Images"})]}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",color:"#888",fontSize:"16px",cursor:"pointer",padding:"2px 6px",lineHeight:1,borderRadius:4},onMouseEnter:W=>{W.currentTarget.style.background="#444",W.currentTarget.style.color="#fff"},onMouseLeave:W=>{W.currentTarget.style.background="transparent",W.currentTarget.style.color="#888"},children:""})]}),i.jsxs("div",{style:{padding:"16px"},children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",fontWeight:500},children:"Apply to:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[i.jsxs("label",{style:V(!re,U==="top"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:U==="top",onChange:()=>d("top"),disabled:!re,style:{accentColor:"#6b9fff"}}),"Top Image",!re&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),i.jsxs("label",{style:V(!J,U==="bottom"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:U==="bottom",onChange:()=>d("bottom"),disabled:!J,style:{accentColor:"#6b9fff"}}),"Bottom Image",!J&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(not loaded)"})]}),i.jsxs("label",{style:V(!ee,U==="both"),children:[i.jsx("input",{type:"radio",name:"imageSelection",checked:U==="both",onChange:()=>d("both"),disabled:!ee,style:{accentColor:"#6b9fff"}}),"Both Images",!ee&&i.jsx("span",{style:{fontSize:"11px",color:"#666",marginLeft:"auto"},children:"(need both)"})]})]})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("button",{onClick:we,disabled:G,style:A(G),onMouseEnter:W=>!G&&(W.currentTarget.style.background="#3a3a42"),onMouseLeave:W=>W.currentTarget.style.background="transparent",children:"Horizontal Flip"}),i.jsx("button",{onClick:te,disabled:G,style:A(G),onMouseEnter:W=>!G&&(W.currentTarget.style.background="#3a3a42"),onMouseLeave:W=>W.currentTarget.style.background="transparent",children:"Vertical Flip"})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsx("div",{style:{marginBottom:"12px"},children:["nudge","scale","rotate","slant","keystone"].map(W=>i.jsxs("button",{onClick:()=>de(W),disabled:G,style:A(G,v===W),onMouseEnter:se=>!G&&v!==W&&(se.currentTarget.style.background="#3a3a42"),onMouseLeave:se=>v!==W&&(se.currentTarget.style.background="transparent"),children:[v===W?" ":"","Mode: ",W.charAt(0).toUpperCase()+W.slice(1)]},W))}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[i.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Brightness"}),i.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[R,"%"]})]}),i.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:R,onChange:W=>Ce(parseInt(W.target.value,10)),disabled:G,style:{width:"100%",cursor:G?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[i.jsx("label",{style:{color:"#f2f2f2",fontSize:"13px",fontWeight:500},children:"Contrast"}),i.jsxs("span",{style:{color:"#888",fontSize:"12px",minWidth:"45px",textAlign:"right"},children:[Z,"%"]})]}),i.jsx("input",{type:"range",min:"0",max:"200",step:"1",value:Z,onChange:W=>Re(parseInt(W.target.value,10)),disabled:G,style:{width:"100%",cursor:G?"not-allowed":"pointer",accentColor:"#6b9fff"}})]}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsx("div",{style:{marginBottom:"12px"},children:i.jsxs("button",{onClick:xe,disabled:G,style:A(G,D),onMouseEnter:W=>!G&&!D&&(W.currentTarget.style.background="#3a3a42"),onMouseLeave:W=>!D&&(W.currentTarget.style.background="transparent"),children:[D?" ":"","Grayscale Mode"]})}),i.jsx("div",{style:{height:1,background:"#444",margin:"16px 0"}}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[i.jsx("button",{onClick:k,disabled:G,style:{padding:"8px 16px",background:G?"#444":"#555",color:G?"#777":"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:G?"not-allowed":"pointer",fontSize:"13px",fontWeight:500},children:"Reset Transform"}),i.jsx("button",{onClick:r,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:W=>W.currentTarget.style.background="#3a8ee6",onMouseLeave:W=>W.currentTarget.style.background="#4a9eff",children:"Close"})]}),S&&i.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:"#3d2b2b",border:"1px solid #5a3a3a",borderRadius:4,fontSize:"12px",color:"#e88"},children:" Images are locked. Unlock via Images  Lock Images to make changes."})]})]})},F5=({visible:n,onClose:r,topImage:o,bottomImage:s,setTopImage:l,setBottomImage:d,componentsTop:v,componentsBottom:p,setComponentsTop:b,setComponentsBottom:m,drawingStrokes:T,setDrawingStrokes:D,powerSymbols:M,groundSymbols:S,setPowerSymbols:F,setGroundSymbols:_,canvasRef:N,isBottomView:g,setIsBottomView:ae,originalTopFlipX:E,setOriginalTopFlipX:q,originalBottomFlipX:re,setOriginalBottomFlipX:J,originalTopFlipY:Y,setOriginalTopFlipY:ee,originalBottomFlipY:U,setOriginalBottomFlipY:$,cameraWorldCenter:H,setCameraWorldCenter:R,viewScale:Z,viewRotation:G,setViewRotation:we,viewFlipX:te,setViewFlipX:de,contentBorder:Ce,setTransparency:Re})=>{const[xe,k]=I.useState(null),[A,V]=I.useState(!1),W=I.useRef({x:0,y:0}),se=I.useRef(null),Te=I.useCallback((st,kt,qt,ye)=>{const ut=window.innerWidth,Gt=window.innerHeight,Et=10,ht=Math.max(Et,Math.min(st,ut-qt-Et)),Qe=Math.max(Et,Math.min(kt,Gt-ye-Et));return{x:ht,y:Qe}},[]);I.useEffect(()=>{if(n&&xe===null){const st=localStorage.getItem("transformAllDialogPosition"),kt=320,qt=400,ye=20,ut=150;let Gt;if(st)try{const Et=JSON.parse(st);Gt=Te(Et.x,Et.y,kt,qt)}catch{Gt=Te(window.innerWidth-kt-ye,ut,kt,qt)}else Gt=Te(window.innerWidth-kt-ye,ut,kt,qt);k(Gt)}},[n,xe,Te]);const le=I.useCallback(st=>{if(se.current){const kt=se.current.getBoundingClientRect();W.current={x:st.clientX-kt.left,y:st.clientY-kt.top},V(!0)}},[]);I.useEffect(()=>{if(!A)return;const st=qt=>{const ye=qt.clientX-W.current.x,ut=qt.clientY-W.current.y,Gt=se.current?.offsetWidth||320,Et=se.current?.offsetHeight||400,ht=Te(ye,ut,Gt,Et);k(ht),localStorage.setItem("transformAllDialogPosition",JSON.stringify(ht))},kt=()=>{V(!1)};return document.addEventListener("mousemove",st),document.addEventListener("mouseup",kt),()=>{document.removeEventListener("mousemove",st),document.removeEventListener("mouseup",kt)}},[A,Te]);const _e=I.useCallback(()=>{g||(de(!0),ae(!0),Re(100))},[g,de,ae,Re]),ve=I.useCallback(()=>{g&&(de(!1),ae(!1),Re(0))},[g,de,ae,Re]),De=I.useCallback(st=>{we(kt=>Lg(kt,st))},[we,Lg]);if(!n)return null;const Xe=(st=!1)=>({display:"block",width:"100%",textAlign:"left",padding:"8px 12px",color:st?"#999":"#222",background:"transparent",border:"none",borderRadius:4,cursor:st?"not-allowed":"pointer",fontSize:"13px",transition:"background 0.15s"});return i.jsxs("div",{ref:se,style:{position:"fixed",top:xe?.y??150,left:xe?.x??window.innerWidth-340,backgroundColor:"#fff",borderRadius:8,minWidth:"320px",maxWidth:"400px",maxHeight:"calc(100vh - 100px)",overflowY:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10001,display:"flex",flexDirection:"column"},children:[i.jsxs("div",{onMouseDown:le,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:A?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Change Perspective"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{padding:"20px",overflow:"auto",flex:1},children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"View:"}),i.jsx("button",{onClick:g?ve:_e,style:Xe(!1),onMouseEnter:st=>st.currentTarget.style.background="#f0f0f0",onMouseLeave:st=>st.currentTarget.style.background="transparent",children:g?"Switch to Top View":"Switch to Bottom View"}),i.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Left/Right Arrow Keys"})]}),i.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("div",{style:{fontSize:"12px",color:"#666",marginBottom:"8px",fontWeight:500},children:"Rotate (clockwise):"}),i.jsx("button",{onClick:()=>De(90),style:Xe(),onMouseEnter:st=>st.currentTarget.style.background="#f0f0f0",onMouseLeave:st=>st.currentTarget.style.background="transparent",children:"Rotate 90"}),i.jsx("button",{onClick:()=>De(180),style:Xe(),onMouseEnter:st=>st.currentTarget.style.background="#f0f0f0",onMouseLeave:st=>st.currentTarget.style.background="transparent",children:"Rotate 180"}),i.jsx("button",{onClick:()=>De(270),style:Xe(),onMouseEnter:st=>st.currentTarget.style.background="#f0f0f0",onMouseLeave:st=>st.currentTarget.style.background="transparent",children:"Rotate 270"}),i.jsx("div",{style:{fontSize:"10px",color:"#999",marginTop:"6px",fontStyle:"italic"},children:"Shortcut: Shift-Up/Down Arrow Keys"})]}),i.jsx("div",{style:{height:1,background:"#e0e0e0",margin:"16px 0"}}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:i.jsx("button",{onClick:r,style:{padding:"8px 16px",background:"#4a9eff",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"13px",fontWeight:500},onMouseEnter:st=>st.currentTarget.style.background="#3a8ee6",onMouseLeave:st=>st.currentTarget.style.background="#4a9eff",children:"Close"})})]})]})},Oy=({visible:n,title:r,message:o,onClose:s,type:l="info",onShowResponse:d})=>{if(!n)return null;const v=l==="success"?"#4CAF50":"#2196F3",p=l==="success"?"#4CAF50":"#2196F3",b=l==="success"?"":"";return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:m=>{m.target===m.currentTarget&&s()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"90vw",maxHeight:"90vh",width:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:`2px solid ${p}`,display:"flex",flexDirection:"column"},onClick:m=>m.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",gap:"12px",flexShrink:0},children:[i.jsx("div",{style:{fontSize:"24px",color:v},children:b}),i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:r})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.5",whiteSpace:"pre-wrap",wordWrap:"break-word",overflowY:"auto",maxHeight:"60vh",paddingRight:"8px",flex:1},children:o}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[d&&i.jsx("button",{onClick:()=>{d(),s()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Show Response"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})]})]})})},E5=({component:n,componentEditor:r,componentDefinition:o,setComponentEditor:s,areComponentsLocked:l,componentsTop:d,componentsBottom:v,setComponentsTop:p,setComponentsBottom:b,uploadedDatasheetFile:m,setUploadedDatasheetFile:T})=>{if(!n||!n.id||!n.componentType||typeof n.pinCount!="number")return console.error("[ComponentTypeFields] Component missing required properties:",{comp:n,hasId:!!n?.id,hasComponentType:!!n?.componentType,componentType:n?.componentType,pinCount:n?.pinCount,pinCountType:typeof n?.pinCount}),null;const M=(o||r?.componentDefinition||Hl(n))?.fields,S=n.componentType,F=S==="IntegratedCircuit"||S==="Semiconductor",_=S==="Semiconductor",N=S==="IntegratedCircuit";if(M&&M.length>0&&!N){const g=(E,q,re)=>re?E==="capacitance"||E==="resistance"||E==="voltage"||E==="current"?"80px":E==="power"||E==="inductance"||E==="impedance"||E==="esr"||E==="ripple"||E==="leakageCurrent"?"70px":"80px":E==="tolerance"||E==="pinCount"?"60px":E==="partNumber"||E==="manufacturer"?"150px":E==="description"||E==="operatingTemperature"?"180px":q==="string"&&!E.includes("Unit")?"150px":"120px",ae=E=>{const q=n.componentType,re=q==="IntegratedCircuit"||q==="Semiconductor";if(re&&E.name==="datasheet"||re&&(E.name==="manufacturer"||E.name==="partNumber")||E.name==="description")return null;const J=E.name,Y=`${E.name}Unit`,ee=r[J]??n[J]??E.defaultValue??"",U=r[Y]??n[Y]??(E.units&&E.defaultUnit?E.defaultUnit:""),$=G=>{s(te=>te&&{...te,[J]:G})},H=G=>{s(te=>te&&{...te,[Y]:G})},R=!!(E.units&&E.units.length>0),Z=g(E.name,E.type,R);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsxs("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:[E.label,":"]}),E.type==="enum"?i.jsx("select",{value:ee,onChange:G=>$(G.target.value),disabled:l,style:{width:Z,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:(E.enumValues||[]).map(G=>i.jsx("option",{value:G,children:G},G))}):i.jsx("input",{type:"text",value:ee,onChange:G=>$(G.target.value),disabled:l,style:{width:Z,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:R?"8px":"0"},placeholder:E.defaultValue!==void 0?String(E.defaultValue):""}),R&&E.units&&i.jsx("select",{value:U||E.defaultUnit||E.units[0],onChange:G=>H(G.target.value),disabled:l,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,flexShrink:0},children:E.units.map(G=>i.jsx("option",{value:G,children:G},G))})]},E.name)};if(!_)return i.jsx(i.Fragment,{children:M.map(ae).filter(Boolean)})}return F?i.jsxs(i.Fragment,{children:[n.componentType==="Resistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:g=>s({...r,resistance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||hn("resistance"),onChange:g=>s({...r,resistanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:g=>s({...r,power:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"5%",onChange:g=>s({...r,tolerance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.05%",children:"0.05%"}),i.jsx("option",{value:"0.1%",children:"0.1%"}),i.jsx("option",{value:"0.25%",children:"0.25%"}),i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),n.componentType==="Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${n.id}`,type:"text",value:r.capacitance||"",onChange:g=>s({...r,capacitance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:r.capacitanceUnit||hn("capacitance"),onChange:g=>s({...r,capacitanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("capacitance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||hn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-dielectric-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Dielectric:"}),i.jsxs("select",{id:`component-dielectric-${n.id}`,value:r.dielectric||"Ceramic",onChange:g=>s({...r,dielectric:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Ceramic",children:"Ceramic"}),i.jsx("option",{value:"Tantalum",children:"Tantalum"}),i.jsx("option",{value:"Film",children:"Film"}),i.jsx("option",{value:"Polyester",children:"Polyester"}),i.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),i.jsx("option",{value:"Mica",children:"Mica"}),i.jsx("option",{value:"Paper",children:"Paper"}),i.jsx("option",{value:"Glass",children:"Glass"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"10%",onChange:g=>s({...r,tolerance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),n.componentType==="Film Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${n.id}`,type:"text",value:r.capacitance||"",onChange:g=>s({...r,capacitance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:r.capacitanceUnit||hn("capacitance"),onChange:g=>s({...r,capacitanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("capacitance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||hn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-filmtype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Film Type:"}),i.jsxs("select",{id:`component-filmtype-${n.id}`,value:r.filmType||"Polyester",onChange:g=>s({...r,filmType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Polyester",children:"Polyester"}),i.jsx("option",{value:"Polypropylene",children:"Polypropylene"}),i.jsx("option",{value:"Polyethylene",children:"Polyethylene"}),i.jsx("option",{value:"Polystyrene",children:"Polystyrene"}),i.jsx("option",{value:"Polycarbonate",children:"Polycarbonate"}),i.jsx("option",{value:"PTFE",children:"PTFE (Teflon)"}),i.jsx("option",{value:"PPS",children:"PPS (Polyphenylene Sulfide)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"10%",onChange:g=>s({...r,tolerance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]})]}),n.componentType==="Electrolytic Capacitor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacitance:"}),i.jsx("input",{id:`component-capacitance-${n.id}`,type:"text",value:r.capacitance||"",onChange:g=>s({...r,capacitance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsxs("select",{value:r.capacitanceUnit||"F",onChange:g=>s({...r,capacitanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:[i.jsx("option",{value:"pF",children:"pF"}),i.jsx("option",{value:"nF",children:"nF"}),i.jsx("option",{value:"F",children:"F"}),i.jsx("option",{value:"mF",children:"mF"}),i.jsx("option",{value:"F",children:"F"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 25"}),i.jsx("select",{value:r.voltageUnit||hn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"20%",onChange:g=>s({...r,tolerance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},children:[i.jsx("option",{value:"0.5%",children:"0.5%"}),i.jsx("option",{value:"1%",children:"1%"}),i.jsx("option",{value:"2%",children:"2%"}),i.jsx("option",{value:"5%",children:"5%"}),i.jsx("option",{value:"10%",children:"10%"}),i.jsx("option",{value:"20%",children:"20%"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-polarized-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarized:"}),i.jsx("input",{id:`component-polarized-${n.id}`,type:"checkbox",checked:Xf(n),disabled:!0,style:{opacity:.6,cursor:"not-allowed"},title:"Polarized is a fixed property determined by component type"})]})]}),n.componentType==="Inductor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-inductance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Inductance:"}),i.jsx("input",{id:`component-inductance-${n.id}`,type:"text",value:r.inductance||"",onChange:g=>s({...r,inductance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.inductanceUnit||hn("inductance"),onChange:g=>s({...r,inductanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("inductance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||hn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"DC Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:g=>s({...r,resistance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.resistanceUnit||"",onChange:g=>s({...r,resistanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Diode"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-diodetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Diode Type:"}),i.jsxs("select",{id:`component-diodetype-${n.id}`,value:r.diodeType||"Standard",onChange:g=>s({...r,diodeType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Standard",children:"Standard"}),i.jsx("option",{value:"Zener",children:"Zener"}),i.jsx("option",{value:"LED",children:"LED"}),i.jsx("option",{value:"Schottky",children:"Schottky"}),i.jsx("option",{value:"Infrared",children:"Infrared"}),i.jsx("option",{value:"Photodiode",children:"Photodiode"}),i.jsx("option",{value:"Other",children:"Other"})]})]}),r.diodeType==="LED"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-ledcolor-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"LED Color:"}),i.jsxs("select",{id:`component-ledcolor-${n.id}`,value:r.ledColor||"",onChange:g=>s({...r,ledColor:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"",children:"Select..."}),i.jsx("option",{value:"Red",children:"Red"}),i.jsx("option",{value:"Green",children:"Green"}),i.jsx("option",{value:"Blue",children:"Blue"}),i.jsx("option",{value:"Yellow",children:"Yellow"}),i.jsx("option",{value:"Orange",children:"Orange"}),i.jsx("option",{value:"White",children:"White"}),i.jsx("option",{value:"RGB",children:"RGB"}),i.jsx("option",{value:"IR",children:"IR (Infrared)"}),i.jsx("option",{value:"UV",children:"UV (Ultraviolet)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||hn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||hn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Battery"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 3.7"}),i.jsx("select",{value:r.voltageUnit||"V",onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-capacity-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Capacity:"}),i.jsx("input",{id:`component-capacity-${n.id}`,type:"text",value:r.capacity||"",onChange:g=>s({...r,capacity:g.target.value}),disabled:l,style:{width:"120px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 2000mAh"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-chemistry-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Chemistry:"}),i.jsxs("select",{id:`component-chemistry-${n.id}`,value:r.chemistry||"Li-ion",onChange:g=>s({...r,chemistry:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Li-ion",children:"Li-ion"}),i.jsx("option",{value:"LiPo",children:"LiPo"}),i.jsx("option",{value:"NiMH",children:"NiMH"}),i.jsx("option",{value:"NiCd",children:"NiCd"}),i.jsx("option",{value:"Alkaline",children:"Alkaline"}),i.jsx("option",{value:"Lead-Acid",children:"Lead-Acid"}),i.jsx("option",{value:"Lithium",children:"Lithium"}),i.jsx("option",{value:"Zinc-Carbon",children:"Zinc-Carbon"})]})]})]}),n.componentType==="Fuse"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 5"}),i.jsx("select",{value:r.currentUnit||"A",onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 250"}),i.jsx("select",{value:r.voltageUnit||"V",onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-fusetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Fuse Type:"}),i.jsxs("select",{id:`component-fusetype-${n.id}`,value:r.fuseType||"Fast-blow",onChange:g=>s({...r,fuseType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Fast-blow",children:"Fast-blow"}),i.jsx("option",{value:"Slow-blow",children:"Slow-blow"}),i.jsx("option",{value:"Time-delay",children:"Time-delay"}),i.jsx("option",{value:"Resettable",children:"Resettable"}),i.jsx("option",{value:"Cartridge",children:"Cartridge"}),i.jsx("option",{value:"Glass",children:"Glass"}),i.jsx("option",{value:"Ceramic",children:"Ceramic"})]})]})]}),n.componentType==="Relay"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-coilvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Coil Voltage:"}),i.jsx("input",{id:`component-coilvoltage-${n.id}`,type:"text",value:r.coilVoltage||"",onChange:g=>s({...r,coilVoltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.coilVoltageUnit||hn("voltage"),onChange:g=>s({...r,coilVoltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-contacttype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Contact Type:"}),i.jsxs("select",{id:`component-contacttype-${n.id}`,value:r.contactType||"SPST",onChange:g=>s({...r,contactType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"SPST",children:"SPST (Single Pole Single Throw)"}),i.jsx("option",{value:"SPDT",children:"SPDT (Single Pole Double Throw)"}),i.jsx("option",{value:"DPST",children:"DPST (Double Pole Single Throw)"}),i.jsx("option",{value:"DPDT",children:"DPDT (Double Pole Double Throw)"}),i.jsx("option",{value:"3PDT",children:"3PDT (3 Pole Double Throw)"}),i.jsx("option",{value:"4PDT",children:"4PDT (4 Pole Double Throw)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.currentUnit||hn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Motor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-motortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Motor Type:"}),i.jsxs("select",{id:`component-motortype-${n.id}`,value:r.motorType||"DC",onChange:g=>s({...r,motorType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"DC",children:"DC Motor"}),i.jsx("option",{value:"Stepper",children:"Stepper Motor"}),i.jsx("option",{value:"Servo",children:"Servo Motor"}),i.jsx("option",{value:"Brushless",children:"Brushless DC"}),i.jsx("option",{value:"AC",children:"AC Motor"}),i.jsx("option",{value:"Synchronous",children:"Synchronous"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.voltageUnit||hn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||hn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Switch"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-switchtype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Switch Type:"}),i.jsxs("select",{id:`component-switchtype-${n.id}`,value:r.switchType||"Toggle",onChange:g=>s({...r,switchType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Toggle",children:"Toggle"}),i.jsx("option",{value:"Push-button",children:"Push-button"}),i.jsx("option",{value:"Slide",children:"Slide"}),i.jsx("option",{value:"Rotary",children:"Rotary"}),i.jsx("option",{value:"DIP",children:"DIP Switch"}),i.jsx("option",{value:"Momentary",children:"Momentary"}),i.jsx("option",{value:"Latching",children:"Latching"}),i.jsx("option",{value:"Reed",children:"Reed Switch"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 5"}),i.jsx("select",{value:r.currentUnit||hn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 250"}),i.jsx("select",{value:r.voltageUnit||hn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="FerriteBead"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-impedance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),i.jsx("input",{id:`component-impedance-${n.id}`,type:"text",value:r.impedance||"",onChange:g=>s({...r,impedance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 100"}),i.jsx("select",{value:r.impedanceUnit||hn("impedance"),onChange:g=>s({...r,impedanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("impedance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||hn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Connector"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-connectortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Connector Type:"}),i.jsx("input",{id:`component-connectortype-${n.id}`,type:"text",value:r.connectorType||"",onChange:g=>s({...r,connectorType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., USB-A, HDMI"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-gender-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Gender:"}),i.jsxs("select",{id:`component-gender-${n.id}`,value:r.gender||"N/A",onChange:g=>s({...r,gender:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Male",children:"Male"}),i.jsx("option",{value:"Female",children:"Female"}),i.jsx("option",{value:"N/A",children:"N/A"})]})]})]}),n.componentType==="Jumper"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-positions-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Positions:"}),i.jsx("input",{id:`component-positions-${n.id}`,type:"number",min:"2",value:r.positions||3,onChange:g=>s({...r,positions:parseInt(g.target.value)||3}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"}})]})}),n.componentType==="Speaker"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-impedance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Impedance:"}),i.jsx("input",{id:`component-impedance-${n.id}`,type:"text",value:r.impedance||"",onChange:g=>s({...r,impedance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 8"}),i.jsx("select",{value:r.impedanceUnit||hn("impedance"),onChange:g=>s({...r,impedanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("impedance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:g=>s({...r,power:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]})]}),n.componentType==="PowerSupply"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-inputvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Input Voltage:"}),i.jsx("input",{id:`component-inputvoltage-${n.id}`,type:"text",value:r.inputVoltage||"",onChange:g=>s({...r,inputVoltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 120"}),i.jsx("select",{value:r.inputVoltageUnit||hn("voltage"),onChange:g=>s({...r,inputVoltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-outputvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Output Voltage:"}),i.jsx("input",{id:`component-outputvoltage-${n.id}`,type:"text",value:r.outputVoltage||"",onChange:g=>s({...r,outputVoltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.outputVoltageUnit||hn("voltage"),onChange:g=>s({...r,outputVoltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||hn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="Transistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-transistortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Transistor Type:"}),i.jsxs("select",{id:`component-transistortype-${n.id}`,value:r.transistorType||"BJT",onChange:g=>s({...r,transistorType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"BJT",children:"BJT (Bipolar Junction Transistor)"}),i.jsx("option",{value:"FET",children:"FET (Field Effect Transistor)"}),i.jsx("option",{value:"MOSFET",children:"MOSFET"}),i.jsx("option",{value:"IGBT",children:"IGBT"}),i.jsx("option",{value:"JFET",children:"JFET"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-polarity-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Polarity:"}),i.jsxs("select",{id:`component-polarity-${n.id}`,value:r.polarity||"NPN",onChange:g=>s({...r,polarity:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"NPN",children:"NPN"}),i.jsx("option",{value:"PNP",children:"PNP"}),i.jsx("option",{value:"N-Channel",children:"N-Channel"}),i.jsx("option",{value:"P-Channel",children:"P-Channel"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||hn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||hn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(g=>i.jsx("option",{value:g,children:g},g))})]})]}),n.componentType==="ResistorNetwork"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:g=>s({...r,resistance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||hn("resistance"),onChange:g=>s({...r,resistanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-configuration-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Configuration:"}),i.jsx("input",{id:`component-configuration-${n.id}`,type:"text",value:r.configuration||"",onChange:g=>s({...r,configuration:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., Isolated, Bussed"})]})]}),n.componentType==="Thermistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:g=>s({...r,resistance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||hn("resistance"),onChange:g=>s({...r,resistanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-thermistortype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Thermistor Type:"}),i.jsxs("select",{id:`component-thermistortype-${n.id}`,value:r.thermistorType||"NTC",onChange:g=>s({...r,thermistorType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"NTC",children:"NTC (Negative Temperature Coefficient)"}),i.jsx("option",{value:"PTC",children:"PTC (Positive Temperature Coefficient)"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-beta-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Beta ():"}),i.jsx("input",{id:`component-beta-${n.id}`,type:"text",value:r.beta||"",onChange:g=>s({...r,beta:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 3950"})]})]}),n.componentType==="Transformer"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-primaryvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Primary Voltage:"}),i.jsx("input",{id:`component-primaryvoltage-${n.id}`,type:"text",value:r.primaryVoltage||"",onChange:g=>s({...r,primaryVoltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 120"}),i.jsx("select",{value:r.primaryVoltageUnit||hn("voltage"),onChange:g=>s({...r,primaryVoltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-secondaryvoltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Secondary Voltage:"}),i.jsx("input",{id:`component-secondaryvoltage-${n.id}`,type:"text",value:r.secondaryVoltage||"",onChange:g=>s({...r,secondaryVoltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 12"}),i.jsx("select",{value:r.secondaryVoltageUnit||hn("voltage"),onChange:g=>s({...r,secondaryVoltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:g=>s({...r,power:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-turns-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Turns Ratio:"}),i.jsx("input",{id:`component-turns-${n.id}`,type:"text",value:r.turns||"",onChange:g=>s({...r,turns:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 10:1"})]})]}),n.componentType==="TestPoint"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-signal-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Signal:"}),i.jsx("input",{id:`component-signal-${n.id}`,type:"text",value:r.signal||"",onChange:g=>s({...r,signal:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., VCC, GND, CLK"})]})}),(n.componentType==="IntegratedCircuit"||n.componentType==="Semiconductor")&&i.jsxs(i.Fragment,{children:[_&&M&&M.length>0&&(()=>{const g=(J,Y,ee)=>ee?"80px":J==="partNumber"||J==="manufacturer"?"150px":J==="description"||J==="operatingTemperature"?"180px":Y==="string"&&!J.includes("Unit")?"150px":"120px",ae=J=>{if(J.name==="datasheet"||J.name==="description"||J.name==="operatingTemperature"||_&&(J.name==="manufacturer"||J.name==="partNumber")||J.name==="icType"||_&&!J.name)return null;const Y=J.name,ee=`${J.name}Unit`,U=r[Y]??n[Y]??J.defaultValue??"",$=r[ee]??n[ee]??(J.units&&J.defaultUnit?J.defaultUnit:""),H=we=>{s({...r,[Y]:we})},R=we=>{s({...r,[ee]:we})},Z=!!(J.units&&J.units.length>0),G=g(J.name,J.type,Z);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsxs("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:[J.label,":"]}),J.type==="enum"?i.jsx("select",{value:U,onChange:we=>H(we.target.value),disabled:l,style:{width:G,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:(J.enumValues||[]).map(we=>i.jsx("option",{value:we,children:we},we))}):i.jsx("input",{type:"text",value:U,onChange:we=>H(we.target.value),disabled:l,style:{width:G,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:Z?"8px":"0"},placeholder:J.defaultValue!==void 0?String(J.defaultValue):""}),Z&&J.units&&i.jsx("select",{value:$||J.defaultUnit||J.units[0],onChange:we=>R(we.target.value),disabled:l,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,flexShrink:0},children:J.units.map(we=>i.jsx("option",{value:we,children:we},we))})]},J.name)},E=M.map(ae).filter(Boolean),q=_?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-ictype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"IC Type:"}),i.jsxs("select",{id:`component-ictype-${n.id}`,value:r.icType||"Other",onChange:J=>s({...r,icType:J.target.value}),disabled:l,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),i.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),i.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),i.jsx("option",{value:"Logic",children:"Logic"}),i.jsx("option",{value:"Memory",children:"Memory"}),i.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),i.jsx("option",{value:"Timer",children:"Timer"}),i.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),i.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),i.jsx("option",{value:"Comparator",children:"Comparator"}),i.jsx("option",{value:"Transceiver",children:"Transceiver"}),i.jsx("option",{value:"Driver",children:"Driver"}),i.jsx("option",{value:"Amplifier",children:"Amplifier"}),i.jsx("option",{value:"Other",children:"Other"})]})]},"icType"):null,re=E.findIndex(J=>J?.key==="manufacturer");return re>=0&&q?E.splice(re+1,0,q):q&&E.push(q),E})(),N&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-ictype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"IC Type:"}),i.jsxs("select",{id:`component-ictype-${n.id}`,value:r.icType||"Other",onChange:g=>s({...r,icType:g.target.value}),disabled:l,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},children:[i.jsx("option",{value:"Op-Amp",children:"Op-Amp"}),i.jsx("option",{value:"Microcontroller",children:"Microcontroller"}),i.jsx("option",{value:"Microprocessor",children:"Microprocessor"}),i.jsx("option",{value:"Logic",children:"Logic"}),i.jsx("option",{value:"Memory",children:"Memory"}),i.jsx("option",{value:"Voltage Regulator",children:"Voltage Regulator"}),i.jsx("option",{value:"Timer",children:"Timer"}),i.jsx("option",{value:"ADC",children:"ADC (Analog-to-Digital)"}),i.jsx("option",{value:"DAC",children:"DAC (Digital-to-Analog)"}),i.jsx("option",{value:"Comparator",children:"Comparator"}),i.jsx("option",{value:"Transceiver",children:"Transceiver"}),i.jsx("option",{value:"Driver",children:"Driver"}),i.jsx("option",{value:"Amplifier",children:"Amplifier"}),i.jsx("option",{value:"Other",children:"Other"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-packagetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Package Type:"}),i.jsxs("select",{id:`component-packagetype-${n.id}`,value:r.packageType||"",onChange:g=>s({...r,packageType:g.target.value}),disabled:l,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},children:[i.jsx("option",{value:"",children:"-- Select --"}),i.jsx("option",{value:"DIP",children:"DIP"}),i.jsx("option",{value:"PDIP",children:"PDIP"}),i.jsx("option",{value:"SOIC",children:"SOIC"}),i.jsx("option",{value:"QFP",children:"QFP"}),i.jsx("option",{value:"LQFP",children:"LQFP"}),i.jsx("option",{value:"TQFP",children:"TQFP"}),i.jsx("option",{value:"BGA",children:"BGA"}),i.jsx("option",{value:"SSOP",children:"SSOP"}),i.jsx("option",{value:"TSOP",children:"TSOP"}),i.jsx("option",{value:"Various",children:"Various"}),i.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),n.componentType==="VacuumTube"&&i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tubetype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tube Type:"}),i.jsx("input",{id:`component-tubetype-${n.id}`,type:"text",value:r.tubeType||"",onChange:g=>s({...r,tubeType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 12AX7, 6L6"})]})}),n.componentType==="VariableResistor"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-vrtype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"VR Type:"}),i.jsxs("select",{id:`component-vrtype-${n.id}`,value:r.vrType||"Potentiometer",onChange:g=>s({...r,vrType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Potentiometer",children:"Potentiometer"}),i.jsx("option",{value:"Rheostat",children:"Rheostat"}),i.jsx("option",{value:"Trimmer",children:"Trimmer"}),i.jsx("option",{value:"Varistor",children:"Varistor"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-resistance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Resistance:"}),i.jsx("input",{id:`component-resistance-${n.id}`,type:"text",value:r.resistance||"",onChange:g=>s({...r,resistance:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 10"}),i.jsx("select",{value:r.resistanceUnit||hn("resistance"),onChange:g=>s({...r,resistanceUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("resistance").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsxs("select",{id:`component-power-${n.id}`,value:r.power||"1/4",onChange:g=>s({...r,power:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"12px"},children:[i.jsx("option",{value:"1/20",children:"1/20 W"}),i.jsx("option",{value:"1/16",children:"1/16 W"}),i.jsx("option",{value:"1/10",children:"1/10 W"}),i.jsx("option",{value:"1/8",children:"1/8 W"}),i.jsx("option",{value:"1/4",children:"1/4 W"}),i.jsx("option",{value:"1/2",children:"1/2 W"}),i.jsx("option",{value:"1",children:"1 W"}),i.jsx("option",{value:"2",children:"2 W"}),i.jsx("option",{value:"3",children:"3 W"}),i.jsx("option",{value:"5",children:"5 W"}),i.jsx("option",{value:"10",children:"10 W"}),i.jsx("option",{value:"25",children:"25 W"}),i.jsx("option",{value:"50",children:"50 W"}),i.jsx("option",{value:"100",children:"100 W"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-taper-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Taper:"}),i.jsxs("select",{id:`component-taper-${n.id}`,value:r.taper||"Linear",onChange:g=>s({...r,taper:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Linear",children:"Linear"}),i.jsx("option",{value:"Logarithmic",children:"Logarithmic"}),i.jsx("option",{value:"Audio",children:"Audio"})]})]})]}),n.componentType==="Crystal"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-frequency-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),i.jsx("input",{id:`component-frequency-${n.id}`,type:"text",value:r.frequency||"",onChange:g=>s({...r,frequency:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 16.000 MHz"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-loadcapacitance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Load Capacitance:"}),i.jsx("input",{id:`component-loadcapacitance-${n.id}`,type:"text",value:r.loadCapacitance||"",onChange:g=>s({...r,loadCapacitance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 18pF"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-tolerance-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Tolerance:"}),i.jsxs("select",{id:`component-tolerance-${n.id}`,value:r.tolerance||"10ppm",onChange:g=>s({...r,tolerance:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"10ppm",children:"10ppm"}),i.jsx("option",{value:"20ppm",children:"20ppm"}),i.jsx("option",{value:"30ppm",children:"30ppm"}),i.jsx("option",{value:"50ppm",children:"50ppm"}),i.jsx("option",{value:"100ppm",children:"100ppm"})]})]})]}),n.componentType==="GenericComponent"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-generictype-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Type:"}),i.jsxs("select",{id:`component-generictype-${n.id}`,value:n.genericType||"Attenuator",onChange:g=>s({...r,genericType:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},children:[i.jsx("option",{value:"Attenuator",children:"Attenuator"}),i.jsx("option",{value:"CircuitBreaker",children:"Circuit Breaker"}),i.jsx("option",{value:"Thermocouple",children:"Thermocouple"}),i.jsx("option",{value:"Tuner",children:"Tuner"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-voltage-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Voltage:"}),i.jsx("input",{id:`component-voltage-${n.id}`,type:"text",value:r.voltage||"",onChange:g=>s({...r,voltage:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 50"}),i.jsx("select",{value:r.voltageUnit||hn("voltage"),onChange:g=>s({...r,voltageUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("voltage").map(g=>i.jsx("option",{value:g,children:g},g))})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-current-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Current:"}),i.jsx("input",{id:`component-current-${n.id}`,type:"text",value:r.current||"",onChange:g=>s({...r,current:g.target.value}),disabled:l,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1},placeholder:"e.g., 1"}),i.jsx("select",{value:r.currentUnit||hn("current"),onChange:g=>s({...r,currentUnit:g.target.value}),disabled:l,style:{padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,width:"60px",marginRight:"12px"},children:nr("current").map(g=>i.jsx("option",{value:g,children:g},g))})]}),n.genericType==="Tuner"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-frequency-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Frequency:"}),i.jsx("input",{id:`component-frequency-${n.id}`,type:"text",value:r.frequency||"",onChange:g=>s({...r,frequency:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 100MHz"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-power-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Power:"}),i.jsx("input",{id:`component-power-${n.id}`,type:"text",value:r.power||"",onChange:g=>s({...r,power:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"e.g., 1W"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-model-${n.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"90px",flexShrink:0},children:"Model:"}),i.jsx("input",{id:`component-model-${n.id}`,type:"text",value:r.model||"",onChange:g=>s({...r,model:g.target.value}),disabled:l,style:{flex:1,padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:l?.6:1,marginRight:"8px"},placeholder:"Part number or model"})]})]})]}):i.jsx("div",{style:{padding:"8px",background:"#fff3cd",border:"1px solid #ffeeba",borderRadius:4,color:"#856404",marginBottom:"8px",fontSize:"11px"},children:"Component definition missing for this instance. Using legacy fields. Please ensure the component has a definition in componentDefinitions.json and a valid componentDefinitionKey."})},Fx=()=>{if(typeof window<"u"){const n=sessionStorage.getItem("geminiApiKey");if(n&&n.trim())return n.trim()}return null},q5=()=>{if(typeof window<"u"){const n=localStorage.getItem("geminiModel");if(n)return n}return"gemini-2.5-flash-lite"},V5=()=>{const n=Fx(),r=q5();return n?`https://generativelanguage.googleapis.com/v1/models/${r}:generateContent?key=${n}`:null},H5=n=>{const r=Kg[n];return!r||!r.prefix||r.prefix.length<1?"?":r.prefix[0].substring(0,1).toUpperCase()},W5=({componentEditor:n,componentDefinition:r,setComponentEditor:o,componentsTop:s,componentsBottom:l,setComponentsTop:d,setComponentsBottom:v,connectingPin:p,setConnectingPin:b,componentDialogPosition:m,setComponentDialogPosition:T,isDraggingDialog:D,setIsDraggingDialog:M,dialogDragOffset:S,setDialogDragOffset:F,areComponentsLocked:_,setSelectedComponentIds:N,setNotesDialogVisible:g,projectDirHandle:ae,showGeminiSettingsDialog:E=!1,onGeminiSettingsDialogClose:q,onFindComponent:re})=>{const[J,Y]=I.useState(!1),[ee,U]=I.useState(null),[$,H]=I.useState(!1),[R,Z]=I.useState(!1),[G,we]=I.useState(null),[te,de]=I.useState(!1),[Ce,Re]=I.useState(!1),[xe,k]=I.useState(""),[A,V]=I.useState(()=>typeof window<"u"&&sessionStorage.getItem("geminiApiKey")||""),[W,se]=I.useState(()=>typeof window<"u"&&localStorage.getItem("geminiModel")||"gemini-2.5-flash-lite"),[Te,le]=I.useState(()=>typeof window<"u"?!!sessionStorage.getItem("geminiApiKey"):!1);I.useEffect(()=>{if(E){if(typeof window<"u"){const fe=sessionStorage.getItem("geminiApiKey"),lt=localStorage.getItem("geminiModel");fe&&V(fe),lt&&se(lt),le(!!fe)}const Be=setTimeout(()=>{Z(!0)},0);return()=>clearTimeout(Be)}},[E]),I.useEffect(()=>{typeof window<"u"&&le(!!sessionStorage.getItem("geminiApiKey")||!!A.trim())},[A]),I.useEffect(()=>{if(n){const fe=(n.layer==="top"?s:l).find(lt=>lt.id===n.id);if(fe){const lt=fe.customGeminiPrompt;k(lt||"")}}},[n?.id,s,l]);const _e=()=>{A.trim()?(typeof window<"u"&&(sessionStorage.setItem("geminiApiKey",A.trim()),localStorage.setItem("geminiModel",W)),le(!0),ht({visible:!0,title:"API Key and Model Saved",message:`API key and model (${W}) saved! You can now use the "Extract Datasheet Information" feature. Note: The API key will be cleared when you close the browser tab.`,type:"success"})):(typeof window<"u"&&(sessionStorage.removeItem("geminiApiKey"),localStorage.setItem("geminiModel",W)),le(!1),ht({visible:!0,title:"API Key Removed",message:"API key removed. Model preference saved.",type:"info"}))},ve=()=>{typeof window<"u"&&sessionStorage.removeItem("geminiApiKey"),V(""),le(!1),ht({visible:!0,title:"API Key Removed",message:"API key has been removed from browser session storage. You will need to enter it again to use AI features.",type:"info"})},De=()=>{const Be=n?.designator?.trim().toUpperCase();if(!Be)return;const lt=[...s,...l].filter($e=>$e.designator?.trim().toUpperCase()===Be);if(lt.length===0)return;if(re&&lt.length>0){const $e=lt[0];re($e.id,$e.x,$e.y)}const it=new Set(lt.map($e=>$e.id));N(it)},Xe=Be=>`You are analyzing an electronic component datasheet PDF. Extract pin information, component properties, a datasheet summary, IC type, and pin count, then return the data as a JSON object.

Requirements:
1. Return a JSON object with three sections: "pins", "properties", and "summary"
2. First, determine the total number of pins (pinCount) for this component from the datasheet. This should be a positive integer representing the total number of pins/pads on the component.
3. For pins, extract information for ALL pins found in the datasheet (not just a subset). For each pin, provide:
   - pinNumber: The pin number (1, 2, 3, etc.)
   - pinName: The signal name (e.g., VCC, GND, IN+, OUT, etc.). Use the exact name from the datasheet.
   - pinDescription: A brief description of the pin's function (optional, can be empty string)
   - pinType: The pin type (optional): "input", "output", "bidirectional", "power", "ground", "no_connect", or "passive". Only include if clearly identifiable from the datasheet.
   - alternateFunctions: An array of alternate function names for this pin (optional, only if the pin has multiple functions). For example, a microcontroller GPIO pin might have ["SPI_MOSI", "I2C_SDA"] as alternate functions.
4. For component properties, extract the following information if available in the datasheet:
${Be.map(fe=>fe.hasUnits?`   - ${fe.name}: The ${fe.label.toLowerCase()} value (as a number) and ${fe.name}Unit: The unit (one of: ${fe.units.join(", ")})`:fe.type==="enum"?`   - ${fe.name}: The ${fe.label.toLowerCase()} (as a string)`:`   - ${fe.name}: The ${fe.label.toLowerCase()} (as a string or number, depending on the field type)`).join(`
`)}
5. For IC Type (icType), determine the type of integrated circuit from the datasheet. Choose from: "Op-Amp", "Microcontroller", "Microprocessor", "Logic", "Memory", "Voltage Regulator", "Timer", "ADC", "DAC", "Comparator", "Transceiver", "Driver", "Amplifier", or "Other". If it's clearly an op amp, use "Op-Amp". If it's clearly a microcontroller, use "Microcontroller", etc.
6. For Package Type (packageType), determine the package type from the datasheet. Choose from: "DIP", "PDIP", "SOIC", "QFP", "LQFP", "TQFP", "BGA", "SSOP", "TSOP", "Various", or "Other". If multiple package types are mentioned in the datasheet, use "Various". If it's a plastic DIP, use "PDIP". If it's a standard DIP, use "DIP".
7. For pin count (pinCount), determine the total number of pins/pads on the component from the datasheet. This should be a positive integer. Include this in the properties section.
8. For datasheet summary (datasheetSummary), provide a concise summary (2-4 sentences) of the introductory information from the datasheet, including what the component is, its main purpose, and key features mentioned in the introduction or overview section.
9. Only include properties that are actually found in the datasheet - do not make up values
10. For numeric fields with units, extract both the numeric value and the appropriate unit
11. Return ONLY valid JSON, no additional text, explanations, or markdown formatting

Example JSON format:
{
  "pins": [
    {"pinNumber": 1, "pinName": "VCC", "pinDescription": "Power supply positive", "pinType": "power"},
    {"pinNumber": 2, "pinName": "GND", "pinDescription": "Ground", "pinType": "ground"},
    {"pinNumber": 3, "pinName": "IN+", "pinDescription": "Non-inverting input", "pinType": "input"},
    {"pinNumber": 4, "pinName": "IN-", "pinDescription": "Inverting input", "pinType": "input"},
    {"pinNumber": 5, "pinName": "OUT", "pinDescription": "Output", "pinType": "output"},
    {"pinNumber": 6, "pinName": "GPIO1", "pinDescription": "General purpose I/O", "pinType": "bidirectional", "alternateFunctions": ["SPI_MOSI", "I2C_SDA"]}
  ],
  "properties": {
    "partNumber": "LM358",
    "manufacturer": "Texas Instruments",
    "voltage": 36,
    "voltageUnit": "V",
    "description": "Dual operational amplifier",
    "icType": "Op-Amp",
    "packageType": "PDIP",
    "pinCount": 5
  },
  "summary": {
    "datasheetSummary": "The LM358 is a dual operational amplifier featuring low power consumption and wide supply voltage range. It is designed for single supply operation from 3V to 32V or dual supplies from 1.5V to 16V. The device offers high gain bandwidth product and low input offset voltage."
  }
}

Analyze the attached PDF datasheet and extract the information according to the requirements above.`,[st,kt]=I.useState(()=>{const Be=localStorage.getItem("componentDialogSize");if(Be)try{return JSON.parse(Be)}catch{return{width:350,height:window.innerHeight*.4}}return{width:350,height:window.innerHeight*.4}}),[qt,ye]=I.useState(!1),[ut,Gt]=I.useState({x:0,y:0,width:0,height:0}),[Et,ht]=I.useState({visible:!1,title:"",message:"",type:"info"}),Qe=At.useMemo(()=>{if(!n||!n.visible)return null;let Be=s.find(fe=>fe.id===n.id);return Be||(Be=l.find(fe=>fe.id===n.id)),Be||null},[n,s,l]);At.useEffect(()=>{if(!Qe){U(null);return}const Be=Qe.id,fe=Qe.componentType,lt=Qe.componentType;if(!fe){console.error("[ComponentEditor useEffect] Component missing componentType:",{comp:Qe,componentId:Be}),U(null);return}if(fe==="IntegratedCircuit"||lt==="Semiconductor"){const it=Qe;U(null),n&&o({...n,datasheetFileName:it.datasheetFileName||void 0})}else U(null)},[Qe?.id,Qe?.componentType,Qe?.datasheetFileName]),I.useEffect(()=>{if(!qt)return;const Be=lt=>{const it=lt.clientX-ut.x,$e=lt.clientY-ut.y,at=Math.max(350,Math.min(window.innerWidth-20,ut.width+it)),Ot=Math.max(200,Math.min(window.innerHeight-20,ut.height+$e)),Vt={width:at,height:Ot};kt(Vt),localStorage.setItem("componentDialogSize",JSON.stringify(Vt))},fe=()=>{ye(!1)};return document.addEventListener("mousemove",Be),document.addEventListener("mouseup",fe),()=>{document.removeEventListener("mousemove",Be),document.removeEventListener("mouseup",fe)}},[qt,ut]);const $t=Be=>{Be.preventDefault(),Be.stopPropagation(),ye(!0),Gt({x:Be.clientX,y:Be.clientY,width:st.width,height:st.height})};if(!n||!n.visible)return i.jsxs(i.Fragment,{children:[R&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:Be=>{Be.target===Be.currentTarget&&(Z(!1),q?.())},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"500px",maxWidth:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Be=>Be.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"Google Gemini API Configuration"}),i.jsx("button",{onClick:()=>{Z(!1),q?.()},style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsxs("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#fff"},children:"Benefits of Adding Your API Key:"}),i.jsx("p",{style:{margin:"0 0 16px 0"},children:"Extract datasheet information for components  avoiding manual data entry"}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Enter Your API Key:"}),i.jsx("input",{type:"password",value:A,onChange:Be=>V(Be.target.value),placeholder:"Paste your Gemini API key here",style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box"},autoFocus:!0})]}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Select Gemini Model:"}),i.jsxs("select",{value:W,onChange:Be=>se(Be.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:[i.jsx("option",{value:"gemini-2.5-flash-lite",children:"gemini-2.5-flash-lite (Lightweight, Fast)"}),i.jsx("option",{value:"gemini-2.5-flash",children:"gemini-2.5-flash (Fast, Balanced)"}),i.jsx("option",{value:"gemini-2.5-pro",children:"gemini-2.5-pro (High Quality, Slower)"}),i.jsx("option",{value:"gemini-1.5-flash",children:"gemini-1.5-flash (Legacy Fast)"}),i.jsx("option",{value:"gemini-1.5-pro",children:"gemini-1.5-pro (Legacy High Quality)"})]}),i.jsx("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px",lineHeight:"1.4"},children:"Choose the model based on your needs: Flash models are faster and use fewer tokens, while Pro models provide higher quality responses."})]}),i.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"#1f1f24",borderRadius:"4px",border:"1px solid #444"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#fff",fontSize:"13px"},children:"Storage & Security Information:"}),i.jsxs("p",{style:{margin:"0 0 8px 0",color:"#ddd",fontSize:"12px",lineHeight:"1.5"},children:["Your API key will be stored in your browser's ",i.jsx("strong",{children:"sessionStorage"})," under the key ",i.jsx("code",{style:{background:"#2b2b31",padding:"2px 4px",borderRadius:"2px",color:"#4CAF50"},children:"'geminiApiKey'"}),"."]}),i.jsx("p",{style:{margin:"0 0 8px 0",color:"#4CAF50",fontSize:"12px",lineHeight:"1.5",fontWeight:600},children:" Session-Based Security:"}),i.jsxs("ul",{style:{margin:"0 0 8px 0",paddingLeft:"20px",color:"#ddd",fontSize:"12px",lineHeight:"1.5"},children:[i.jsx("li",{children:"API key is automatically cleared when you close the browser tab"}),i.jsx("li",{children:"Not persisted across browser sessions"}),i.jsx("li",{children:"Reduces risk of key exposure from persistent storage"})]}),i.jsx("p",{style:{margin:"0 0 8px 0",color:"#ffaa00",fontSize:"12px",lineHeight:"1.5",fontWeight:600},children:" Security Notes:"}),i.jsxs("ul",{style:{margin:"0 0 8px 0",paddingLeft:"20px",color:"#ddd",fontSize:"12px",lineHeight:"1.5"},children:[i.jsx("li",{children:"sessionStorage is accessible via browser DevTools"}),i.jsx("li",{children:"Do not use on shared or public computers"}),i.jsx("li",{children:"The key is stored in plain text (not encrypted)"})]}),i.jsx("p",{style:{margin:"0",color:"#aaa",fontSize:"11px",lineHeight:"1.4",fontStyle:"italic"},children:"For maximum security, consider using API key restrictions in Google Cloud Console and regularly rotating your keys."})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:ve,disabled:!Te,style:{padding:"8px 16px",background:Te?"#d32f2f":"#444",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:Te?"pointer":"not-allowed",fontSize:"14px",fontWeight:600,opacity:Te?1:.5},title:Te?"Remove API key from browser session storage":"No API key stored",children:"Remove API Key"}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx("button",{onClick:()=>{Z(!1),q?.()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Cancel"}),i.jsx("button",{onClick:()=>{_e(),Z(!1),q?.()},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save API Key"})]})]})]})}),i.jsx(Oy,{visible:Et.visible,title:Et.title,message:Et.message,type:Et.type,onClose:()=>{ht({visible:!1,title:"",message:"",type:"info"})},onShowResponse:Et.onShowResponse})]});if(!Qe)return console.error("[ComponentEditor] Component not found:",{componentId:n.id,componentsTopCount:s.length,componentsBottomCount:l.length}),null;if(!Qe.id||!Qe.componentType||typeof Qe.pinCount!="number")return console.error("[ComponentEditor] Component missing required properties:",{componentId:Qe.id,hasComponentType:!!Qe.componentType,componentType:Qe.componentType,pinCount:Qe.pinCount,pinCountType:typeof Qe.pinCount,component:Qe}),null;let dn="top";s.find(Be=>Be.id===n.id)||(dn="bottom"),n.layer!==dn&&o({...n,layer:dn});const rn=Be=>{const fe={...Be};console.log("[ComponentEditor] updateComponent - Entry:",{componentId:Be.id,componentType:Be.componentType});const lt=n.designator?.trim()||"";fe.designator=lt,fe.x=n.x,fe.y=n.y,fe.layer=n.layer,fe.orientation=n.orientation??0;const it=lt.length>0?lt.charAt(0).toUpperCase():H5(Be.componentType);if(fe.abbreviation=it,n.manufacturer!==void 0&&(fe.manufacturer=n.manufacturer?.trim()||void 0),n.partNumber!==void 0&&(fe.partNumber=n.partNumber?.trim()||void 0),n.pinCount!==Be.pinCount){fe.pinCount=n.pinCount;const $e=Be.pinConnections||[];if(fe.pinConnections=new Array(n.pinCount).fill("").map((at,Ot)=>Ot<$e.length?$e[Ot]:""),Be.pinPolarities){const at=Be.pinPolarities||[];fe.pinPolarities=new Array(n.pinCount).fill("").map((Ot,Vt)=>Vt<at.length?at[Vt]:"")}if(Be.pinData&&Array.isArray(Be.pinData)){const at=Be.pinData;fe.pinData=new Array(n.pinCount).fill(null).map((Ot,Vt)=>Vt<at.length&&at[Vt]?at[Vt]:{name:""})}if(Be.pinNames){const at=Be.pinNames||[];fe.pinNames=new Array(n.pinCount).fill("").map((Ot,Vt)=>Vt<at.length?at[Vt]:"")}}else fe.pinConnections=Be.pinConnections||[],Be.pinPolarities&&(fe.pinPolarities=Be.pinPolarities),Be.pinData&&(fe.pinData=Be.pinData),Be.pinNames&&(fe.pinNames=Be.pinNames);return Be.componentType==="Resistor"?(fe.resistance=n.resistance!==void 0?n.resistance:void 0,fe.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,fe.power=n.power?`${n.power}W`:void 0,fe.tolerance=n.tolerance!==void 0?n.tolerance:void 0):Be.componentType==="Capacitor"?(fe.capacitance=n.capacitance!==void 0?n.capacitance:void 0,fe.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,fe.tolerance=n.tolerance!==void 0?n.tolerance:void 0,fe.dielectric=n.dielectric!==void 0?n.dielectric:void 0):Be.componentType==="Electrolytic Capacitor"?(fe.capacitance=n.capacitance!==void 0?n.capacitance:void 0,fe.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,fe.tolerance=n.tolerance!==void 0?n.tolerance:void 0,fe.esr=n.esr!==void 0?n.esr:void 0,fe.esrUnit=n.esrUnit!==void 0?n.esrUnit:void 0,fe.temperature=n.temperature!==void 0?n.temperature:void 0):Be.componentType==="Film Capacitor"?(fe.capacitance=n.capacitance!==void 0?n.capacitance:void 0,fe.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,fe.tolerance=n.tolerance!==void 0?n.tolerance:void 0,fe.filmType=n.filmType||void 0):Be.componentType==="Diode"?(fe.diodeType=n.diodeType||Be.diodeType||"Standard",fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,fe.current=n.current!==void 0?n.current:void 0,fe.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,fe.ledColor=n.ledColor!==void 0?n.ledColor:void 0):Be.componentType==="Battery"?(fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,fe.capacity=n.capacity!==void 0?n.capacity:void 0,fe.capacityUnit=n.capacityUnit!==void 0?n.capacityUnit:void 0,fe.chemistry=n.chemistry!==void 0?n.chemistry:void 0):Be.componentType==="Fuse"?(fe.current=n.current!==void 0?n.current:void 0,fe.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,fe.fuseType=n.fuseType!==void 0?n.fuseType:void 0):Be.componentType==="FerriteBead"?(fe.impedance=n.impedance!==void 0?n.impedance:void 0,fe.impedanceUnit=n.impedanceUnit!==void 0?n.impedanceUnit:void 0,fe.current=n.current!==void 0?n.current:void 0,fe.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):Be.componentType==="Connector"?(fe.connectorType=n.connectorType||void 0,fe.gender=n.gender||void 0):Be.componentType==="Jumper"?fe.positions=n.positions||void 0:Be.componentType==="Relay"?(fe.coilVoltage=n.coilVoltage!==void 0?n.coilVoltage:void 0,fe.coilVoltageUnit=n.coilVoltageUnit!==void 0?n.coilVoltageUnit:void 0,fe.contactType=n.contactType!==void 0?n.contactType:void 0,fe.current=n.current!==void 0?n.current:void 0,fe.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):Be.componentType==="Inductor"?(fe.inductance=n.inductance!==void 0?n.inductance:void 0,fe.inductanceUnit=n.inductanceUnit!==void 0?n.inductanceUnit:void 0,fe.current=n.current!==void 0?n.current:void 0,fe.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,fe.resistance=n.resistance!==void 0?n.resistance:void 0,fe.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0):Be.componentType==="Speaker"?(fe.impedance=n.impedance!==void 0?n.impedance:void 0,fe.impedanceUnit=n.impedanceUnit!==void 0?n.impedanceUnit:void 0,fe.power=n.power?`${n.power}W`:void 0):Be.componentType==="Motor"?(fe.motorType=n.motorType!==void 0?n.motorType:void 0,fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,fe.current=n.current!==void 0?n.current:void 0,fe.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):Be.componentType==="PowerSupply"?(fe.inputVoltage=n.inputVoltage!==void 0?n.inputVoltage:void 0,fe.inputVoltageUnit=n.inputVoltageUnit!==void 0?n.inputVoltageUnit:void 0,fe.outputVoltage=n.outputVoltage!==void 0?n.outputVoltage:void 0,fe.outputVoltageUnit=n.outputVoltageUnit!==void 0?n.outputVoltageUnit:void 0,fe.current=n.current!==void 0?n.current:void 0,fe.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):Be.componentType==="Transistor"?(fe.transistorType=n.transistorType!==void 0?n.transistorType:void 0,fe.polarity=n.polarity!==void 0?n.polarity:void 0,fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,fe.current=n.current!==void 0?n.current:void 0,fe.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0):Be.componentType==="ResistorNetwork"?(fe.resistance=n.resistance!==void 0?n.resistance:void 0,fe.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,fe.configuration=n.configuration||void 0):Be.componentType==="Thermistor"?(fe.resistance=n.resistance!==void 0?n.resistance:void 0,fe.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,fe.thermistorType=n.thermistorType||void 0,fe.beta=n.beta||void 0):Be.componentType==="Switch"?(fe.switchType=n.switchType!==void 0?n.switchType:void 0,fe.current=n.current!==void 0?n.current:void 0,fe.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0):Be.componentType==="Transformer"?(fe.primaryVoltage=n.primaryVoltage!==void 0?n.primaryVoltage:void 0,fe.primaryVoltageUnit=n.primaryVoltageUnit!==void 0?n.primaryVoltageUnit:void 0,fe.secondaryVoltage=n.secondaryVoltage!==void 0?n.secondaryVoltage:void 0,fe.secondaryVoltageUnit=n.secondaryVoltageUnit!==void 0?n.secondaryVoltageUnit:void 0,fe.power=n.power?`${n.power}W`:void 0,fe.turns=n.turns||void 0):Be.componentType==="TestPoint"?fe.signal=n.signal||void 0:Be.componentType==="Film Capacitor"?(fe.capacitance=n.capacitance!==void 0?n.capacitance:void 0,fe.capacitanceUnit=n.capacitanceUnit!==void 0?n.capacitanceUnit:void 0,fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,fe.tolerance=n.tolerance!==void 0?n.tolerance:void 0,fe.filmType=n.filmType||void 0):Be.componentType==="IntegratedCircuit"||Be.componentType==="Semiconductor"?(fe.description=n.description?.trim()||void 0,Be.componentType==="Semiconductor"&&(fe.componentType="IntegratedCircuit"),fe.icType=n.icType||void 0,fe.manufacturer=n.manufacturer?.trim()||void 0,fe.partNumber=n.partNumber?.trim()||void 0,fe.operatingTemperature=n.operatingTemperature?.trim()||void 0,fe.packageType=n.packageType||void 0,n.datasheetFileName?fe.datasheetFileName=n.datasheetFileName:fe.datasheetFileName=void 0):fe.description=n.description?.trim()||void 0,Be.componentType==="VacuumTube"?fe.tubeType=n.tubeType||void 0:Be.componentType==="VariableResistor"?(fe.vrType=n.vrType!==void 0?n.vrType:void 0,fe.resistance=n.resistance!==void 0?n.resistance:void 0,fe.resistanceUnit=n.resistanceUnit!==void 0?n.resistanceUnit:void 0,fe.power=n.power?`${n.power}W`:void 0,fe.taper=n.taper||void 0):Be.componentType==="Crystal"?(fe.frequency=n.frequency!==void 0?n.frequency:void 0,fe.loadCapacitance=n.loadCapacitance!==void 0?n.loadCapacitance:void 0,fe.tolerance=n.tolerance!==void 0?n.tolerance:void 0):Be.componentType==="GenericComponent"&&(fe.genericType=n.genericType||"Attenuator",fe.voltage=n.voltage!==void 0?n.voltage:void 0,fe.voltageUnit=n.voltageUnit!==void 0?n.voltageUnit:void 0,fe.current=n.current!==void 0?n.current:void 0,fe.currentUnit=n.currentUnit!==void 0?n.currentUnit:void 0,fe.power=n.power||void 0,fe.frequency=n.frequency||void 0,fe.model=n.model||void 0),fe},kn=()=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Be=s.find(it=>it.id===n.id),fe=l.find(it=>it.id===n.id),lt=Be||fe;if(lt){lt.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - Before updateComponent call:",{componentDatasheet:lt.datasheet,editorDatasheet:n.datasheet,editorDatasheetType:typeof n.datasheet,editorDatasheetLength:n.datasheet?.length,fullEditor:n}),console.log("[ComponentEditor] handleSave - componentEditor state before update:",{resistance:n.resistance,resistanceUnit:n.resistanceUnit,capacitance:n.capacitance,capacitanceUnit:n.capacitanceUnit,componentType:lt.componentType});const it=rn(lt);console.log("[ComponentEditor] handleSave - updatedComp after save:",{resistance:it.resistance,resistanceUnit:it.resistanceUnit,capacitance:it.capacitance,capacitanceUnit:it.capacitanceUnit,componentType:it.componentType}),lt.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] handleSave - After updateComponent call:",{updatedComponentDatasheet:it.datasheet,updatedComponentDatasheetType:typeof it.datasheet});const $e=lt.layer,at=n.layer;$e!==at?$e==="top"?(d(Ot=>Ot.filter(Vt=>Vt.id!==n.id)),v(Ot=>[...Ot,it])):(v(Ot=>Ot.filter(Vt=>Vt.id!==n.id)),d(Ot=>[...Ot,it])):at==="top"?d(Ot=>{const Vt=Ot.map(Ft=>Ft.id===n.id?(console.log("[ComponentEditor] Updating component in top array - datasheet:",it.datasheet),(it.componentType==="Resistor"||it.componentType==="Capacitor")&&console.log("[ComponentEditor] Updated component values:",{resistance:it.resistance,resistanceUnit:it.resistanceUnit,capacitance:it.capacitance,capacitanceUnit:it.capacitanceUnit}),it):Ft),jt=Vt.find(Ft=>Ft.id===n.id);return jt&&(jt.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",jt.datasheet),(jt.componentType==="Resistor"||jt.componentType==="Capacitor")&&console.log("[ComponentEditor] After state update - component values in array:",{resistance:jt.resistance,resistanceUnit:jt.resistanceUnit,capacitance:jt.capacitance,capacitanceUnit:jt.capacitanceUnit})),Vt}):v(Ot=>{const Vt=Ot.map(Ft=>Ft.id===n.id?(console.log("[ComponentEditor] Updating component in bottom array - datasheet:",it.datasheet),(it.componentType==="Resistor"||it.componentType==="Capacitor")&&console.log("[ComponentEditor] Updated component values:",{resistance:it.resistance,resistanceUnit:it.resistanceUnit,capacitance:it.capacitance,capacitanceUnit:it.capacitanceUnit}),it):Ft),jt=Vt.find(Ft=>Ft.id===n.id);return jt&&(jt.componentType==="IntegratedCircuit"&&console.log("[ComponentEditor] After state update - component datasheet in array:",jt.datasheet),(jt.componentType==="Resistor"||jt.componentType==="Capacitor")&&console.log("[ComponentEditor] After state update - component values in array:",{resistance:jt.resistance,resistanceUnit:jt.resistanceUnit,capacitance:jt.capacitance,capacitanceUnit:jt.capacitanceUnit})),Vt})}else if(console.warn(`Component ${n.id} not found in either layer array`),n.layer==="top"){const it=l.find($e=>$e.id===n.id);if(it){const $e=rn(it);v(at=>at.filter(Ot=>Ot.id!==n.id)),d(at=>[...at,$e])}}else{const it=s.find($e=>$e.id===n.id);if(it){const $e=rn(it);d(at=>at.filter(Ot=>Ot.id!==n.id)),v(at=>[...at,$e])}}o(null),b(null)},Fn=async()=>{const Be=Fx(),fe=V5();if(!Be||!fe){Z(!0);return}const lt=Qe?.datasheetFileName;if(!ee&&(!ae||!lt)){ht({visible:!0,title:"Datasheet Required",message:"Please choose a datasheet file before extracting information.",type:"info"});return}Y(!0);try{let it,$e;if(ee)it=await ee.arrayBuffer(),$e=ee.size;else if(ae&&lt){const Rt=lt.split("/");let Ht=ae;for(let pn=0;pn<Rt.length-1;pn++){const An=Rt[pn];try{Ht=await Ht.getDirectoryHandle(An)}catch{const $n=An==="datasheets"?"Datasheets":An==="Datasheets"?"datasheets":An;try{Ht=await Ht.getDirectoryHandle($n)}catch{throw new Error(`Directory '${An}' not found in project folder.`)}}}const Bt=await(await Ht.getFileHandle(Rt[Rt.length-1])).getFile();it=await Bt.arrayBuffer(),$e=Bt.size}else throw new Error("No datasheet file available");const at=20*1024*1024;if($e>at){const Rt=($e/1048576).toFixed(2);throw new Error(`PDF file is too large (${Rt} MB). Maximum file size is 20 MB. Please use a smaller file or split the datasheet.`)}const Ot=await new Promise((Rt,Ht)=>{const tt=new Blob([it],{type:"application/pdf"}),Bt=new FileReader;Bt.onloadend=()=>{const An=Bt.result.split(",")[1];if(!An){Ht(new Error("Failed to extract base64 data from FileReader result"));return}Rt(An)},Bt.onerror=()=>Ht(new Error("FileReader failed to read PDF file")),Bt.readAsDataURL(tt)}),jt=(n.layer==="top"?s:l).find(Rt=>Rt.id===n.id);if(!jt)throw new Error("Component not found");const ln=((r||Hl(jt))?.fields||[]).filter(Rt=>Rt.name!=="datasheet").map(Rt=>({name:Rt.name,label:Rt.label,type:Rt.type,hasUnits:!!(Rt.units&&Rt.units.length>0),units:Rt.units||[]}));let mt;const cn=jt.customGeminiPrompt;cn&&cn.trim()?mt=cn:mt=Xe(ln);const _t=await fetch(fe,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:mt},{inlineData:{mimeType:"application/pdf",data:Ot}}]}]})});if(!_t.ok){const Rt=await _t.text();let Ht=`Gemini API error: ${_t.status} ${_t.statusText}`;try{const tt=JSON.parse(Rt);if(tt.error&&tt.error.message){let Bt=tt.error.message;Bt.length>500&&(Bt=Bt.replace(/"([A-Za-z0-9+/]{100,})"/g,(pn,An)=>`"[Base64 data truncated - ${An.length} characters]"`)),Ht+=`.

${Bt}`}if(tt.error&&tt.error.details){let Bt=JSON.stringify(tt.error.details,null,2);Bt=Bt.replace(/"([A-Za-z0-9+/]{100,})"/g,(pn,An)=>`"[Base64 data truncated - ${An.length} characters]"`),Ht+=`

Details:
${Bt}`}}catch{Rt.length>1e3?Ht+=`.

${Rt.substring(0,1e3)}... [truncated]`:Ht+=`.

${Rt}`}throw new Error(Ht)}const Yt=await _t.json();let gn="";if(Yt.candidates&&Yt.candidates[0]){if(Yt.candidates[0].finishReason&&Yt.candidates[0].finishReason!=="STOP")throw new Error(`Gemini API response blocked: ${Yt.candidates[0].finishReason}`);if(Yt.candidates[0].content&&Yt.candidates[0].content.parts){const Rt=Yt.candidates[0].content.parts;Rt&&Rt[0]&&Rt[0].text&&(gn=Rt[0].text.trim())}}if(!gn)throw we(null),new Error("No response text from Gemini API. The API may have returned an empty response.");we(gn),gn=gn.replace(/^```[\w]*\n?/gm,"").replace(/\n?```$/gm,"");let bn;try{bn=JSON.parse(gn)}catch(Rt){throw new Error(`Failed to parse JSON response from Gemini API: ${Rt instanceof Error?Rt.message:"Unknown error"}`)}if(!bn||typeof bn!="object")throw new Error("Invalid JSON response from Gemini API: expected an object");let ir=n.pinCount;if(bn.properties&&typeof bn.properties=="object"&&bn.properties.pinCount){const Rt=parseInt(String(bn.properties.pinCount),10);!isNaN(Rt)&&Rt>0&&(ir=Rt)}else if(bn.pins&&Array.isArray(bn.pins)){let Rt=0;for(const Ht of bn.pins)if(Ht&&typeof Ht=="object"&&Ht.pinNumber){const tt=parseInt(String(Ht.pinNumber),10);!isNaN(tt)&&tt>Rt&&(Rt=tt)}Rt>0&&(ir=Rt)}const Dn=new Array(ir).fill(null).map(()=>({name:""}));let Cr=0;if(bn.pins&&Array.isArray(bn.pins)){for(const Rt of bn.pins)if(Rt&&typeof Rt=="object"&&Rt.pinNumber&&Rt.pinName){const Ht=parseInt(String(Rt.pinNumber),10);if(!isNaN(Ht)&&Ht>=1&&Ht<=ir){const tt=Ht-1;Dn[tt]={name:String(Rt.pinName).trim(),type:Rt.pinType&&String(Rt.pinType).trim()?String(Rt.pinType).trim():void 0,alternate_functions:Rt.alternateFunctions&&Array.isArray(Rt.alternateFunctions)&&Rt.alternateFunctions.length>0?Rt.alternateFunctions.map(Bt=>String(Bt).trim()).filter(Bt=>Bt!==""):void 0},Cr++}}}if(Cr===0)throw new Error("Could not parse any pin information from the JSON response.");const Mr=Dn.map(Rt=>Rt.name),Xt={...n};let mr=0;const Ti=[];if(ir!==n.pinCount&&(Xt.pinCount=ir,Ti.push({label:"Pin Count",value:String(ir)}),mr++),bn.properties&&typeof bn.properties=="object"){const Rt=bn.properties;for(const Ht of ln)if(Rt.hasOwnProperty(Ht.name)){const tt=Rt[Ht.name];if(tt!=null&&tt!==""){let Bt="";if(Ht.hasUnits){Xt[Ht.name]=String(tt);const pn=`${Ht.name}Unit`;let An="";if(Rt.hasOwnProperty(pn)){const yn=String(Rt[pn]).trim();Ht.units.includes(yn)?(Xt[pn]=yn,An=yn):Ht.units.length>0&&(Xt[pn]=Ht.units[0],An=Ht.units[0])}else Ht.units.length>0&&(Xt[pn]=Ht.units[0],An=Ht.units[0]);Bt=`${tt} ${An}`.trim()}else Xt[Ht.name]=String(tt),Bt=String(tt);Ti.push({label:Ht.label,value:Bt}),mr++}}if(Rt.hasOwnProperty("icType")&&Rt.icType){const Ht=String(Rt.icType).trim();["Op-Amp","Microcontroller","Microprocessor","Logic","Memory","Voltage Regulator","Timer","ADC","DAC","Comparator","Transceiver","Driver","Amplifier","Other"].includes(Ht)&&(Xt.icType=Ht,Ti.push({label:"IC Type",value:Ht}),mr++)}if(Rt.hasOwnProperty("packageType")&&Rt.packageType){const Ht=String(Rt.packageType).trim(),tt=["DIP","PDIP","SOIC","QFP","LQFP","TQFP","BGA","SSOP","TSOP","Various","Other"];let Bt=Ht;if(Ht.toUpperCase()==="PDIP"||Ht.toUpperCase()==="DIP")Ht.includes(",")||Ht.includes(" or ")||Ht.includes(" and ")?Bt="Various":Ht.toUpperCase().includes("PDIP")?Bt="PDIP":Bt="DIP";else if(tt.includes(Ht))Bt=Ht;else if(Ht.includes(",")||Ht.includes(" or ")||Ht.includes(" and "))Bt="Various";else{const pn=Ht.toUpperCase();pn.includes("LQFP")?Bt="LQFP":pn.includes("TQFP")?Bt="TQFP":pn.includes("QFP")?Bt="QFP":pn.includes("SOIC")?Bt="SOIC":pn.includes("BGA")?Bt="BGA":pn.includes("SSOP")?Bt="SSOP":pn.includes("TSOP")?Bt="TSOP":Bt="Other"}(tt.includes(Bt)||Bt==="Various")&&(Xt.packageType=Bt,Ti.push({label:"Package Type",value:Bt}),mr++)}}let Ln="";if(bn.summary&&typeof bn.summary=="object"&&bn.summary.datasheetSummary&&(Ln=String(bn.summary.datasheetSummary).trim(),Ln)){Xt.notes=Ln;const Rt=Ln.length>100?Ln.substring(0,100)+"...":Ln;Ti.push({label:"Notes",value:Rt}),mr++}if(o(Xt),jt){const Rt=jt.pinConnections||[],Ht=new Array(ir).fill("").map((qi,Br)=>Br<Rt.length?Rt[Br]:""),tt=jt.pinPolarities||[],Bt=new Array(ir).fill("").map((qi,Br)=>Br<tt.length?tt[Br]:""),pn=[...Dn];for(;pn.length<ir;)pn.push({name:""});const An=pn.map(qi=>qi.name),yn={...jt,pinData:pn,pinNames:An,pinCount:ir,pinConnections:Ht,pinPolarities:Bt,...Ln&&{notes:Ln}};n.layer==="top"?d(qi=>qi.map(Br=>Br.id===n.id?yn:Br)):v(qi=>qi.map(Br=>Br.id===n.id?yn:Br));const $n=Mr.filter(qi=>qi.length>0).length;let li=`Extracted ${$n} pin name${$n!==1?"s":""}`;ir!==n.pinCount&&(li+=" and pin count"),mr>0&&(li+=` and ${mr} propert${mr===1?"y":"ies"}`),li+=" from datasheet.",Ti.length>0&&(li+=`

Extracted Properties:`,Ti.forEach(qi=>{li+=`
   ${qi.label}: ${qi.value}`}));const vi=[];Mr.forEach((qi,Br)=>{qi&&qi.trim()&&vi.push(`Pin ${Br+1}: ${qi.trim()}`)}),vi.length>0&&(li+=`

Pin Names:`,li+=`
  `+vi.join(", ")),ht({visible:!0,title:"Extraction Complete",message:li,type:"success"}),we(null)}}catch(it){console.error("Error fetching pin names:",it),ht({visible:!0,title:"Extraction Failed",message:`Failed to extract information: ${it instanceof Error?it.message:"Unknown error"}. Please enter pin names manually.`,type:"info",onShowResponse:G?()=>de(!0):void 0})}finally{Y(!1)}};return i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        @keyframes heartbeat {
          0%, 100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.8);
          }
          50% {
            transform: scale(1.15);
            box-shadow: 0 0 0 8px rgba(76, 175, 80, 0);
          }
        }
        .fetch-pin-names-pulse {
          animation: heartbeat 0.8s ease-in-out infinite;
        }
      `}),i.jsxs("div",{"data-component-editor-dialog":!0,onClick:Be=>{if(p&&p.componentId===Qe.id){const fe=Be.target;(fe.tagName==="BUTTON"||fe.tagName==="INPUT"||fe.closest("button")||fe.closest("input"))&&Be.stopPropagation()}},style:{position:"fixed",top:m?`${m.y}px`:"90px",left:m?`${m.x}px`:`${window.innerWidth-280}px`,transform:"none",background:p&&p.componentId===Qe.id?"rgba(255, 255, 255, 0.95)":"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"350px",width:`${st.width}px`,height:`${st.height}px`,maxHeight:`${window.innerHeight-20}px`,display:"flex",flexDirection:"column",pointerEvents:"auto",cursor:D?"grabbing":"default"},children:[i.jsxs("div",{onMouseDown:Be=>{const fe=Be.target;fe.tagName==="BUTTON"||fe.tagName==="INPUT"||fe.closest("button")||fe.closest("input")||m&&(F({x:Be.clientX-m.x,y:Be.clientY-m.y}),M(!0),Be.preventDefault())},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:D?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h3",{style:{margin:0,fontSize:"13px",color:"#fff",fontWeight:600},children:"Component Properties"}),i.jsx("button",{onClick:()=>{o(null),b(null)},style:{background:"transparent",border:"none",fontSize:"15px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:[(()=>{const Be=r||Hl(Qe);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Category:"}),i.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"11px",color:"#000"},children:Be?.category||"N/A"})]})})(),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Type:"}),i.jsx("div",{style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"11px",color:"#000"},children:(()=>{const Be=r||Hl(Qe);return Be?.displayName?Qe.componentType==="Capacitor"&&!Be.displayName.toLowerCase().includes("capacitor")?`${Be.displayName} Capacitor`:Be.displayName:Qe.componentType==="GenericComponent"&&Qe.genericType?Wl(Qe.genericType):Qe.componentType==="Diode"&&Qe.diodeType&&Qe.diodeType!=="Standard"?Wl(Qe.diodeType):Qe.componentType==="VariableResistor"&&Qe.vrType&&Qe.vrType!=="Potentiometer"?Wl(Qe.vrType):Qe.componentType==="Capacitor"&&Qe.dielectric==="Tantalum"?"Tantalum Capacitor":Qe.componentType==="Capacitor"&&Qe.capacitorType==="Electrolytic"?"Electrolytic Capacitor":Qe.componentType==="Capacitor"&&Qe.capacitorType==="Film"?"Film Capacitor":Wl(Qe.componentType)})()})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-layer-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Layer:"}),i.jsxs("select",{id:`component-layer-${Qe.id}`,name:`component-layer-${Qe.id}`,value:n.layer,onChange:Be=>o({...n,layer:Be.target.value}),disabled:_,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1},children:[i.jsx("option",{value:"top",children:"Top"}),i.jsx("option",{value:"bottom",children:"Bottom"})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-designator-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Designator:"}),i.jsx("input",{id:`component-designator-${Qe.id}`,name:`component-designator-${Qe.id}`,type:"text",value:n.designator||"",onChange:Be=>{const fe=Be.target.value,lt=fe.length>0?fe.charAt(0).toUpperCase():n.abbreviation;o({...n,designator:fe,abbreviation:lt})},disabled:_,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",fontFamily:"monospace",textTransform:"uppercase",opacity:_?.6:1},placeholder:"e.g., U2, R7, C1",onKeyDown:Be=>{Be.key==="Enter"&&!_&&(Be.preventDefault(),De())}}),i.jsx("button",{onClick:De,disabled:_||!n.designator?.trim(),style:{padding:"4px 12px",background:_||!n.designator?.trim()?"#ccc":"linear-gradient(90deg, #7B68EE 0%, #6A5ACD 100%)",color:"#fff",border:"none",borderRadius:"4px",fontSize:"11px",fontWeight:600,cursor:_||!n.designator?.trim()?"not-allowed":"pointer",opacity:_||!n.designator?.trim()?.6:1,textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)",whiteSpace:"nowrap"},title:"Find all components with this designator",children:"Find"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-orientation-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Orientation:"}),i.jsxs("select",{id:`component-orientation-${Qe.id}`,name:`component-orientation-${Qe.id}`,value:n.orientation??0,onChange:Be=>{const fe=parseInt(Be.target.value)||0;if(o({...n,orientation:fe}),!_){const it=(n.layer==="top"?s:l).find($e=>$e.id===n.id);if(it){const $e={...it,orientation:fe};n.layer==="top"?d(at=>at.map(Ot=>Ot.id===n.id?$e:Ot)):v(at=>at.map(Ot=>Ot.id===n.id?$e:Ot))}}},disabled:_,style:{width:"70px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1},children:[i.jsx("option",{value:"0",children:"0"}),i.jsx("option",{value:"90",children:"90"}),i.jsx("option",{value:"180",children:"180"}),i.jsx("option",{value:"270",children:"270"})]})]}),(Qe.componentType==="IntegratedCircuit"||Qe.componentType==="Semiconductor")&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-datasheet-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Datasheet:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px",flex:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexWrap:"wrap",flex:1},children:[i.jsx("input",{id:`component-datasheet-file-${Qe.id}`,type:"file",accept:".pdf",onChange:async Be=>{const fe=Be.target.files?.[0]||null;if(fe){U(fe);let lt=fe.name;if(ae)try{let it;try{it=await ae.getDirectoryHandle("datasheets",{create:!0})}catch(Ot){console.error("Failed to get/create datasheets directory:",Ot),it=ae}const at=await(await it.getFileHandle(fe.name,{create:!0})).createWritable();await at.write(await fe.arrayBuffer()),await at.close(),lt=it===ae?fe.name:`datasheets/${fe.name}`}catch(it){console.error("Failed to copy datasheet to project directory:",it)}o({...n,datasheetFileName:lt})}else U(null),o({...n,datasheetFileName:void 0})},disabled:_,style:{position:"absolute",width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",zIndex:-1}}),i.jsx("label",{htmlFor:`component-datasheet-file-${Qe.id}`,style:{display:"inline-block",padding:"2px 6px",background:_?"#ccc":"#4CAF50",border:"none",borderRadius:2,fontSize:"11px",color:"#fff",cursor:_?"not-allowed":"pointer",opacity:_?.6:1,whiteSpace:"nowrap",flex:"0 0 auto"},children:"Choose File"}),(()=>{const Be=Qe?.datasheetFileName,fe=ee?.name||(Be?Be.split("/").pop():null),lt=!!ee;return fe?lt?i.jsx("a",{href:"#",onClick:it=>{it.preventDefault(),it.stopPropagation();try{const $e=ee,at=URL.createObjectURL($e),Ot=window.open(at,"_blank","noopener,noreferrer");if(!Ot||Ot.closed){URL.revokeObjectURL(at);const Vt=document.createElement("a"),jt=URL.createObjectURL($e);Vt.href=jt,Vt.target="_blank",Vt.rel="noopener noreferrer",document.body.appendChild(Vt),Vt.click(),document.body.removeChild(Vt)}}catch($e){console.error("Error opening datasheet:",$e),alert("Failed to open datasheet file.")}},style:{fontSize:"11px",color:"#0066cc",whiteSpace:"nowrap",textDecoration:"underline",cursor:"pointer",flex:"0 0 auto"},title:"Click to open PDF in new window",children:fe}):i.jsxs("span",{style:{fontSize:"11px",color:"#666",flex:"0 0 auto",fontStyle:"italic"},title:"Re-choose the datasheet file to open it",children:[fe," (re-choose file to open)"]}):i.jsx("span",{style:{fontSize:"11px",color:"#666",flex:"0 0 auto"},children:"No file chosen"})})()]}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:i.jsx("button",{onClick:()=>{if(n&&Qe){const fe=(n.layer==="top"?s:l).find(lt=>lt.id===n.id);if(fe){const $e=((r||Hl(fe))?.fields||[]).filter(Ot=>Ot.name!=="datasheet").map(Ot=>({name:Ot.name,label:Ot.label,type:Ot.type,hasUnits:!!(Ot.units&&Ot.units.length>0),units:Ot.units||[]})),at=fe.customGeminiPrompt;if(at&&at.trim())k(at);else{const Ot=Xe($e);k(Ot)}}}Re(!0)},disabled:_,style:{padding:"3px 8px",fontSize:"11px",background:_?"#ccc":"#0066cc",color:"#fff",border:"none",borderRadius:"3px",cursor:_?"not-allowed":"pointer",opacity:_?.6:1,fontWeight:600,whiteSpace:"nowrap",transition:"background 0.2s"},title:"View and edit the AI prompt that will be sent to Gemini",children:"View/Edit Prompt"})}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px",marginTop:"4px"},children:i.jsx("button",{onClick:Fn,disabled:J||_,className:J?"fetch-pin-names-pulse":"",style:{padding:"3px 8px",fontSize:"11px",background:_?"#ccc":"#4CAF50",color:"#fff",border:"none",borderRadius:"3px",cursor:J||_?"not-allowed":"pointer",opacity:_?.6:1,fontWeight:600,whiteSpace:"nowrap",transition:"background 0.2s"},children:J?"Extracting...":"Extract Datasheet Information"})})]})]}),(Qe.componentType==="IntegratedCircuit"||Qe.componentType==="Semiconductor")&&i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0",fontSize:"11px",fontWeight:600,color:"#000",marginBottom:"4px"},children:"IC Properties:"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-manufacturer-ic-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Manufacturer:"}),i.jsx("input",{id:`component-manufacturer-ic-${Qe.id}`,type:"text",value:n.manufacturer||"",onChange:Be=>o({...n,manufacturer:Be.target.value}),disabled:_,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-partnumber-ic-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Part Number:"}),i.jsx("input",{id:`component-partnumber-ic-${Qe.id}`,type:"text",value:n.partNumber||"",onChange:Be=>o({...n,partNumber:Be.target.value}),disabled:_,style:{width:"150px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"6px"},children:[i.jsx("label",{htmlFor:`component-pincount-ic-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Pin Count:"}),i.jsx("input",{id:`component-pincount-ic-${Qe.id}`,name:`component-pincount-ic-${Qe.id}`,type:"number",min:"1",value:n.pinCount,onChange:Be=>{const fe=Math.max(1,parseInt(Be.target.value)||1);o({...n,pinCount:fe})},onBlur:Be=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const fe=Math.max(1,parseInt(Be.target.value)||1),it=(n.layer==="top"?s:l).find($e=>$e.id===n.id);if(it&&fe!==it.pinCount){const $e=it.pinConnections||[],at=new Array(fe).fill("").map((Ft,tn)=>tn<$e.length?$e[tn]:""),Ot=it.pinPolarities||[],Vt=it.pinPolarities?new Array(fe).fill("").map((Ft,tn)=>tn<Ot.length?Ot[tn]:""):void 0,jt={...it,pinCount:fe,pinConnections:at,...Vt!==void 0&&{pinPolarities:Vt}};n.layer==="top"?d(Ft=>Ft.map(tn=>tn.id===n.id?jt:tn)):v(Ft=>Ft.map(tn=>tn.id===n.id?jt:tn)),o({...n,pinCount:fe})}},disabled:_,style:{width:"80px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]})]})]}),i.jsx(E5,{component:Qe,componentEditor:n,componentDefinition:r,setComponentEditor:o,areComponentsLocked:_,componentsTop:s,componentsBottom:l,uploadedDatasheetFile:ee,setUploadedDatasheetFile:U,setComponentsTop:d,setComponentsBottom:v}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-description-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Description:"}),i.jsx("input",{id:`component-description-${Qe.id}`,name:`component-description-${Qe.id}`,type:"text",value:n.description||"",onChange:Be=>{o({...n,description:Be.target.value})},disabled:_,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"",title:n.description||""})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-notes-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Notes:"}),i.jsx("input",{id:`component-notes-${Qe.id}`,name:`component-notes-${Qe.id}`,type:"text",readOnly:!0,value:Qe.notes||"",onClick:()=>{_||(N(new Set([Qe.id])),g(!0))},disabled:_,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1,cursor:_?"not-allowed":"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"Click to edit notes...",title:Qe.notes||"Click to edit notes..."})]}),(Qe.componentType==="IntegratedCircuit"||Qe.componentType==="Semiconductor")&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-operatingTemperature-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Operating Temperature:"}),i.jsx("input",{id:`component-operatingTemperature-${Qe.id}`,name:`component-operatingTemperature-${Qe.id}`,type:"text",value:n.operatingTemperature||"",onChange:Be=>{o({...n,operatingTemperature:Be.target.value})},disabled:_,style:{width:"180px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"",title:n.operatingTemperature||""})]}),Qe.componentType!=="IntegratedCircuit"&&Qe.componentType!=="Semiconductor"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-pincount-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Pin Count:"}),i.jsx("input",{id:`component-pincount-${Qe.id}`,name:`component-pincount-${Qe.id}`,type:"number",min:"1",value:n.pinCount,onChange:Be=>{const fe=Math.max(1,parseInt(Be.target.value)||1);o({...n,pinCount:fe})},onBlur:Be=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const fe=Math.max(1,parseInt(Be.target.value)||1),it=(n.layer==="top"?s:l).find($e=>$e.id===n.id);if(it&&fe!==it.pinCount){const $e=it.pinConnections||[],at=new Array(fe).fill("").map((Ft,tn)=>tn<$e.length?$e[tn]:""),Ot=it.pinPolarities||[],Vt=it.pinPolarities?new Array(fe).fill("").map((Ft,tn)=>tn<Ot.length?Ot[tn]:""):void 0,jt={...it,pinCount:fe,pinConnections:at,...Vt!==void 0&&{pinPolarities:Vt}};n.layer==="top"?d(Ft=>Ft.map(tn=>tn.id===n.id?jt:tn)):v(Ft=>Ft.map(tn=>tn.id===n.id?jt:tn)),o({...n,pinCount:fe})}},disabled:_,style:{width:"60px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-x-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"X:"}),i.jsx("input",{id:`component-x-${Qe.id}`,name:`component-x-${Qe.id}`,type:"number",value:n.x.toFixed(2),onChange:Be=>{const fe=parseFloat(Be.target.value)||0;o({...n,x:fe})},disabled:_,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{htmlFor:`component-y-${Qe.id}`,style:{fontSize:"11px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"110px",flexShrink:0},children:"Y:"}),i.jsx("input",{id:`component-y-${Qe.id}`,name:`component-y-${Qe.id}`,type:"number",value:n.y.toFixed(2),onChange:Be=>{const fe=parseFloat(Be.target.value)||0;o({...n,y:fe})},disabled:_,style:{width:"90px",padding:"2px 3px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,fontSize:"11px",color:"#000",opacity:_?.6:1}})]}),i.jsxs("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid #e0e0e0"},children:[i.jsx("label",{style:{display:"block",fontSize:"11px",fontWeight:600,color:"#333",marginBottom:"2px"},children:"Pin Connections:"}),p&&p.componentId===Qe.id&&i.jsxs("div",{style:{padding:"2px 3px",background:"#fff3cd",border:"1px solid #ffc107",borderRadius:2,marginBottom:"2px",fontSize:"11px",color:"#856404"},children:["Pin ",p.pinIndex+1," selected. Click on a via or pad to connect."]}),(()=>{const Be=Xf(Qe),lt=(n.layer==="top"?s:l).find(_t=>_t.id===n.id),it=lt?.pinData,$e=lt?.pinNames,Ot=(r||Hl(Qe))?.properties?.pinNames,Vt=Ot&&Ot.length>0,jt=Vt&&Ot.includes("CHIP_DEPENDENT"),Ft=Vt&&!jt,tn=jt,ln=Vt,mt=it&&it.some(_t=>_t&&_t.type&&_t.type.trim()!==""),cn=it&&it.some(_t=>_t&&_t.alternate_functions&&_t.alternate_functions.length>0);return i.jsx("div",{children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"11px",marginTop:"2px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"1px solid #ddd",background:"#f5f5f5"},children:[i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"20px"}}),i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"40px"},children:"Pin"}),ln&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"70px"},children:"Pin Name"}),mt&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"80px"},children:"Type"}),cn&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"120px"},children:"Alt Functions"}),Be&&i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333",width:"50px"},children:"Polarity"}),i.jsx("th",{style:{padding:"2px 4px",textAlign:"left",fontWeight:600,fontSize:"11px",color:"#333"},children:"Node ID"})]})}),i.jsx("tbody",{children:Array.from({length:n.pinCount},(_t,Yt)=>{const gn=lt?.pinConnections&&lt.pinConnections.length>Yt?lt.pinConnections[Yt]:"",fn=lt?.pinPolarities&&lt.pinPolarities.length>Yt&&lt.pinPolarities[Yt]||"",bn=it&&Yt<it.length&&it[Yt]?it[Yt]:null,ir=bn?.name||($e&&Yt<$e.length?$e[Yt]:""),Dn=Ot&&Yt<Ot.length?Ot[Yt]:"",Cr=Dn==="CHIP_DEPENDENT",Mr=ir&&ir.trim()!==""?ir:Cr?"":Dn,Xt=bn?.type,mr=bn?.alternate_functions,Ti=p&&p.componentId===Qe.id&&p.pinIndex===Yt;return i.jsxs("tr",{style:{cursor:_?"not-allowed":"pointer",background:Ti?"#e6f0ff":gn?"#d4edda":"#fff",borderBottom:"1px solid #eee"},onClick:Ln=>{if(Ln.target.tagName!=="SELECT"){if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}b(Ti?null:{componentId:Qe.id,pinIndex:Yt})}},title:gn?`Connected to: ${gn}`:"Select this pin, then click on a via or pad to connect",children:[i.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:i.jsx("input",{id:`pin-radio-${Qe.id}-${Yt}`,name:`pin-radio-${Qe.id}`,type:"radio",checked:!!Ti,onChange:()=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}b(Ti?null:{componentId:Qe.id,pinIndex:Yt})},disabled:_,style:{margin:0,cursor:_?"not-allowed":"pointer",opacity:_?.6:1,width:"10px",height:"10px"}})}),i.jsx("td",{style:{padding:"2px 4px",color:"#333",fontWeight:Ti?600:400,fontFamily:"monospace"},children:Yt+1}),(Ft||tn)&&i.jsx("td",{style:{padding:"2px 4px",textAlign:"left"},children:Ft?i.jsx("select",{value:Mr||"",onChange:Ln=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Rt=Ln.target.value,tt=(n.layer==="top"?s:l).find(Bt=>Bt.id===n.id);if(tt){const pn=[...tt.pinNames||(Ot?[...Ot]:[])];for(;pn.length<n.pinCount;)pn.push("");pn[Yt]=Rt;const An={...tt,pinNames:pn};n.layer==="top"?d(yn=>yn.map($n=>$n.id===n.id?An:$n)):v(yn=>yn.map($n=>$n.id===n.id?An:$n))}},disabled:_,onClick:Ln=>Ln.stopPropagation(),onFocus:Ln=>Ln.stopPropagation(),style:{padding:"2px 4px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",cursor:_?"not-allowed":"pointer",opacity:_?.6:1,width:"100%",fontStyle:"italic",minHeight:"18px"},children:Ot&&Ot.length>0?Ot.filter(Ln=>Ln!=="CHIP_DEPENDENT").map((Ln,Rt)=>i.jsx("option",{value:Ln,children:Ln},Rt)):i.jsx("option",{value:"",children:"-"})}):i.jsx("input",{type:"text",value:Mr||"",onChange:Ln=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Rt=Ln.target.value,tt=(n.layer==="top"?s:l).find(Bt=>Bt.id===n.id);if(tt){const Bt=tt.pinData,pn=tt.pinNames||[];let An;for(Bt&&Array.isArray(Bt)?An=[...Bt]:An=pn.map(li=>({name:li}));An.length<n.pinCount;)An.push({name:""});An[Yt]={...An[Yt],name:Rt};const yn=An.map(li=>li.name),$n={...tt,pinData:An,pinNames:yn};n.layer==="top"?d(li=>li.map(vi=>vi.id===n.id?$n:vi)):v(li=>li.map(vi=>vi.id===n.id?$n:vi))}},disabled:_,onClick:Ln=>Ln.stopPropagation(),onFocus:Ln=>Ln.stopPropagation(),placeholder:"Pin name",style:{padding:"1px 2px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",color:"#333",width:"100%",opacity:_?.6:1,cursor:_?"not-allowed":"text"}})}),mt&&i.jsx("td",{style:{padding:"2px 4px",color:"#333",fontSize:"11px"},children:Xt&&Xt.trim()!==""?i.jsx("span",{style:{fontFamily:"monospace",color:"#666"},children:Xt}):i.jsx("span",{style:{color:"#ccc"},children:"-"})}),cn&&i.jsx("td",{style:{padding:"2px 4px",color:"#333",fontSize:"11px"},children:mr&&mr.length>0?i.jsx("span",{style:{fontFamily:"monospace",color:"#666",fontSize:"10px"},children:mr.join(", ")}):i.jsx("span",{style:{color:"#ccc"},children:"-"})}),Be&&i.jsx("td",{style:{padding:"2px 4px",textAlign:"center"},children:gn?i.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:fn==="+"?"#d32f2f":fn==="-"?"#1976d2":"#999"},children:fn||"-"}):i.jsxs("select",{value:fn??"",onChange:Ln=>{if(_){alert("Cannot edit: Components are locked. Unlock components to edit them.");return}const Rt=Ln.target.value,tt=(n.layer==="top"?s:l).find(Bt=>Bt.id===n.id);if(tt){const pn=[...tt.pinPolarities||new Array(tt.pinCount).fill("")];for(;pn.length<tt.pinCount;)pn.push("");pn[Yt]=Rt;const An={...tt,pinPolarities:pn};n.layer==="top"?d(yn=>yn.map($n=>$n.id===n.id?An:$n)):v(yn=>yn.map($n=>$n.id===n.id?An:$n))}},disabled:_,onClick:Ln=>Ln.stopPropagation(),onFocus:Ln=>Ln.stopPropagation(),style:{padding:"1px 2px",fontSize:"11px",border:"1px solid #ddd",borderRadius:2,background:"#fff",cursor:_?"not-allowed":"pointer",opacity:_?.6:1,width:"100%",fontFamily:"monospace",fontWeight:600},children:[i.jsx("option",{value:"",children:"-"}),i.jsx("option",{value:"+",children:"+"}),i.jsx("option",{value:"-",children:"-"})]},`polarity-${Qe.id}-${Yt}-${fn}`)}),i.jsx("td",{style:{padding:"2px 4px",color:gn?"#28a745":"#999",fontWeight:gn?600:400,fontFamily:"monospace"},children:gn||"-"})]},Yt)})})]})})})()]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"6px",padding:"6px",paddingRight:"24px",borderTop:"1px solid #e0e0e0",flexShrink:0},children:[i.jsx("button",{onClick:()=>{o(null),b(null)},disabled:_,style:{padding:"2px 5px",background:_?"#f5f5f5":"#fff",color:_?"#999":"#333",border:"1px solid #ddd",borderRadius:2,cursor:_?"not-allowed":"pointer",fontSize:"11px",opacity:_?.6:1},children:"Cancel"}),i.jsx("button",{onClick:kn,disabled:_,style:{padding:"2px 5px",background:_?"#f5f5f5":"#0b5fff",color:_?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:_?"not-allowed":"pointer",fontSize:"11px",opacity:_?.6:1},children:"Save"})]}),$&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:Be=>{Be.target===Be.currentTarget&&H(!1)},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Be=>Be.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"How to Get a Google Gemini API Key"}),i.jsx("button",{onClick:()=>H(!1),style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:i.jsxs("p",{style:{margin:"0 0 12px 0"},children:["To get a Google Gemini API key, go to"," ",i.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",style:{color:"#4CAF50",textDecoration:"underline"},children:"Google AI Studio (aistudio.google.com/app/apikey)"}),', sign in with your Google account, and click "Get API key" or "Create API key" in the Dashboard to generate a key for a new or existing Google Cloud project, then copy it and store it securely.']})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:i.jsx("button",{onClick:()=>H(!1),style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})})]})}),i.jsx("div",{onMouseDown:$t,style:{position:"absolute",bottom:0,right:0,width:"20px",height:"20px",cursor:"nwse-resize",background:"linear-gradient(135deg, transparent 0%, transparent 40%, #ccc 40%, #ccc 45%, transparent 45%, transparent 55%, #ccc 55%, #ccc 60%, transparent 60%)",zIndex:1001},title:"Drag to resize"})]}),R&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10005},onClick:Be=>{Be.target===Be.currentTarget&&(Z(!1),q?.())},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"500px",maxWidth:"600px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:Be=>Be.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"Google Gemini API Configuration"}),i.jsx("button",{onClick:()=>Z(!1),style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsxs("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"14px",lineHeight:"1.6"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#fff"},children:"Benefits of Adding Your API Key:"}),i.jsx("p",{style:{margin:"0 0 16px 0"},children:"Extract datasheet information for components  avoiding manual data entry"}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Enter Your API Key:"}),i.jsx("input",{type:"password",value:A,onChange:Be=>V(Be.target.value),placeholder:"Paste your Gemini API key here",style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box"},autoFocus:!0})]}),i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"6px",color:"#fff",fontSize:"13px",fontWeight:600},children:"Select Gemini Model:"}),i.jsxs("select",{value:W,onChange:Be=>se(Be.target.value),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #555",borderRadius:"4px",background:"#1f1f24",color:"#fff",boxSizing:"border-box",cursor:"pointer"},children:[i.jsx("option",{value:"gemini-2.5-flash-lite",children:"gemini-2.5-flash-lite (Lightweight, Fast)"}),i.jsx("option",{value:"gemini-2.5-flash",children:"gemini-2.5-flash (Fast, Balanced)"}),i.jsx("option",{value:"gemini-2.5-pro",children:"gemini-2.5-pro (High Quality, Slower)"}),i.jsx("option",{value:"gemini-1.5-flash",children:"gemini-1.5-flash (Legacy Fast)"}),i.jsx("option",{value:"gemini-1.5-pro",children:"gemini-1.5-pro (Legacy High Quality)"})]}),i.jsx("p",{style:{margin:"6px 0 0 0",color:"#aaa",fontSize:"12px",lineHeight:"1.4"},children:"Choose the model based on your needs: Flash models are faster and use fewer tokens, while Pro models provide higher quality responses."})]}),i.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"#1f1f24",borderRadius:"4px",border:"1px solid #444"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:600,color:"#fff",fontSize:"13px"},children:"Storage & Security Information:"}),i.jsxs("p",{style:{margin:"0 0 8px 0",color:"#ddd",fontSize:"12px",lineHeight:"1.5"},children:["Your API key will be stored in your browser's ",i.jsx("strong",{children:"sessionStorage"})," under the key ",i.jsx("code",{style:{background:"#2b2b31",padding:"2px 4px",borderRadius:"2px",color:"#4CAF50"},children:"'geminiApiKey'"}),"."]}),i.jsx("p",{style:{margin:"0 0 8px 0",color:"#4CAF50",fontSize:"12px",lineHeight:"1.5",fontWeight:600},children:" Session-Based Security:"}),i.jsxs("ul",{style:{margin:"0 0 8px 0",paddingLeft:"20px",color:"#ddd",fontSize:"12px",lineHeight:"1.5"},children:[i.jsx("li",{children:"API key is automatically cleared when you close the browser tab"}),i.jsx("li",{children:"Not persisted across browser sessions"}),i.jsx("li",{children:"Reduces risk of key exposure from persistent storage"})]}),i.jsx("p",{style:{margin:"0 0 8px 0",color:"#ffaa00",fontSize:"12px",lineHeight:"1.5",fontWeight:600},children:" Security Notes:"}),i.jsxs("ul",{style:{margin:"0 0 8px 0",paddingLeft:"20px",color:"#ddd",fontSize:"12px",lineHeight:"1.5"},children:[i.jsx("li",{children:"sessionStorage is accessible via browser DevTools"}),i.jsx("li",{children:"Do not use on shared or public computers"}),i.jsx("li",{children:"The key is stored in plain text (not encrypted)"})]}),i.jsx("p",{style:{margin:"0",color:"#aaa",fontSize:"11px",lineHeight:"1.4",fontStyle:"italic"},children:"For maximum security, consider using API key restrictions in Google Cloud Console and regularly rotating your keys."})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:ve,disabled:!Te,style:{padding:"8px 16px",background:Te?"#d32f2f":"#444",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:Te?"pointer":"not-allowed",fontSize:"14px",fontWeight:600,opacity:Te?1:.5},title:Te?"Remove API key from browser session storage":"No API key stored",children:"Remove API Key"}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx("button",{onClick:()=>{Z(!1),q?.()},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Cancel"}),i.jsx("button",{onClick:()=>{_e(),Z(!1),q?.()},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Save API Key"})]})]})]})}),te&&G&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10006},onClick:Be=>{Be.target===Be.currentTarget&&de(!1)},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"600px",maxWidth:"90vw",maxHeight:"90vh",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"2px solid #2196F3",display:"flex",flexDirection:"column"},onClick:Be=>Be.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px",fontWeight:600},children:"Gemini API Response"}),i.jsx("button",{onClick:()=>{de(!1),we(null)},style:{background:"transparent",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsx("div",{style:{marginBottom:"20px",color:"#ddd",fontSize:"13px",lineHeight:"1.6",overflow:"auto",flex:1,padding:"12px",background:"#1f1f24",borderRadius:"4px",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:"60vh"},children:G}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx("button",{onClick:()=>{navigator.clipboard.writeText(G||""),alert("Response copied to clipboard")},style:{padding:"8px 16px",background:"#555",color:"#fff",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Copy to Clipboard"}),i.jsx("button",{onClick:()=>{de(!1),we(null)},style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Close"})]})]})}),Ce&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},onClick:Be=>{Be.target===Be.currentTarget&&Re(!1)},children:i.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"20px",maxWidth:"90%",maxHeight:"90%",width:"800px",display:"flex",flexDirection:"column",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)"},onClick:Be=>Be.stopPropagation(),children:[i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:600,color:"#333"},children:"AI Prompt Editor"}),i.jsx("p",{style:{margin:"0",fontSize:"13px",color:"#666",lineHeight:"1.5"},children:'This is the prompt that will be sent to Gemini when you click "Extract Datasheet Information". You can customize it for this component. The prompt will be saved with this component and reloaded when you open it again.'}),i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"12px",color:"#888",fontStyle:"italic"},children:'Note: The PDF datasheet will be automatically attached to your prompt when extracting information. You can reference it in your prompt as "the attached PDF" or "the datasheet".'})]}),i.jsx("textarea",{value:xe,onChange:Be=>k(Be.target.value),style:{flex:1,minHeight:"400px",padding:"12px",border:"1px solid #ddd",borderRadius:4,fontSize:"13px",fontFamily:"monospace",resize:"vertical",color:"#000",background:"#fff",lineHeight:"1.5"},placeholder:"Enter your custom prompt here..."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"16px"},children:[i.jsx("button",{onClick:()=>{Re(!1)},style:{padding:"8px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:()=>{if(n&&Qe){const fe=(n.layer==="top"?s:l).find(lt=>lt.id===n.id);if(fe){const lt={...fe,customGeminiPrompt:xe.trim()||void 0};n.layer==="top"?d(it=>it.map($e=>$e.id===n.id?lt:$e)):v(it=>it.map($e=>$e.id===n.id?lt:$e)),o({...n,customGeminiPrompt:xe.trim()||void 0})}}Re(!1)},style:{padding:"8px 16px",background:"#4CAF50",border:"none",borderRadius:4,cursor:"pointer",color:"#fff",fontSize:"14px",fontWeight:600},children:"Save Prompt"})]})]})}),i.jsx(Oy,{visible:Et.visible,title:Et.title,message:Et.message,type:Et.type,onClose:()=>{ht({visible:!1,title:"",message:"",type:"info"}),te||we(null)},onShowResponse:Et.onShowResponse})]})};function $5(n){if(n.baseType)return n.baseType;switch(n.category){case"Capacitors":return"Capacitor";case"Diodes":return"Diode";case"Resistors":return"Resistor";case"Semiconductors":return"Semiconductor";case"Passive Components":return"Passive";case"Power & Energy":return"PowerEnergy";case"Connectors & Switches":return n.type==="Switch"||n.subcategory==="Switch"?"Switch":"Connector";case"Other":return n.type==="Transformer"?"Transformer":"Other";default:return"Other"}}const G5=dh.components,Y5=G5.map(n=>{const r=`${n.category}:${n.subcategory}:${n.type}`,o=$5(n);return{...n,key:r,baseType:o}}),Ex=new Map;Y5.forEach(n=>{Ex.set(n.key,n)});function X5(n){if(n)return Ex.get(n)}const Rg=n=>{const{category:r,subcategory:o,type:s,designator:l}=n;let d,v;switch(r){case"Capacitors":o==="Electrolytic"?d="Electrolytic Capacitor":o==="Film"?d="Film Capacitor":(d="Capacitor",o==="Tantalum"&&(v="Tantalum"));break;case"Diodes":d="Diode",o==="LED"?v="LED":o==="Infrared"?v="Infrared":o==="Photodiode"?v="Photodiode":o==="Schottky"?v="Schottky":o==="Zener"?v="Zener":v="Standard";break;case"Resistors":o==="Network"?(d="ResistorNetwork",v="Network"):o==="Thermistor"?(d="Thermistor",v="Thermistor"):o==="Variable"?(d="VariableResistor",v="Potentiometer"):o==="Varistor"?(d="VariableResistor",v="Varistor"):d="Resistor";break;case"Semiconductors":o==="BJT"||o==="MOSFET"||o==="JFET"?d="Transistor":d="IntegratedCircuit";break;case"Passive Components":s==="Inductor"?d="Inductor":s==="FerriteBead"?d="FerriteBead":d="Crystal";break;case"Power & Energy":o==="Battery"?d="Battery":o==="Power Supply"?d="PowerSupply":d="Fuse";break;case"Connectors & Switches":o==="Connector"?d="Connector":o==="Jumper"?d="Jumper":o==="Switch"?d="Switch":d="Relay";break;case"Other":o==="Transformer"?d="Transformer":o==="Speaker"?d="Speaker":o==="Motor"?d="Motor":o==="Test Point"?d="TestPoint":o==="Vacuum Tube"?d="VacuumTube":(d="GenericComponent",o==="Attenuator"?v="Attenuator":o==="Circuit Breaker"?v="CircuitBreaker":o==="Thermocouple"?v="Thermocouple":o==="Tuner"&&(v="Tuner"));break;default:d="GenericComponent";break}const p=`${r}:${o}:${s}:${l}`,b=`${r}:${o}:${s}`,m=X5(b);return{componentType:d,designator:l,subtype:v,uniqueKey:p,componentDefinition:n,dataDrivenDefinition:m}},qx=Fu.reduce((n,r)=>(n[r.category]||(n[r.category]=[]),n[r.category].push(r),n),{});Object.values(qx).forEach(n=>{n.sort((r,o)=>r.displayName.localeCompare(o.displayName))});const K5=({visible:n,selectedLayer:r,selectedComponentType:o,selectedComponentKey:s,onLayerChange:l,onComponentTypeChange:d,onClose:v})=>{const[p,b]=I.useState(""),[m,T]=I.useState(null),[D,M]=I.useState(!1),S=I.useRef({x:0,y:0}),F=I.useRef(null),_=I.useRef(null);I.useEffect(()=>{if(n&&m===null){const re=document.querySelector(".pcb-canvas");if(re){const J=re.getBoundingClientRect();T({x:J.left,y:J.top})}else T({x:244,y:6})}},[n,m]),I.useEffect(()=>{if(n&&_.current){const re=setTimeout(()=>{_.current?.focus(),_.current?.select()},100);return()=>clearTimeout(re)}},[n]);const N=I.useCallback(re=>{const J=re.target;if(!(J.tagName==="BUTTON"||J.tagName==="INPUT"||J.closest("button")||J.closest("input"))&&F.current){const Y=F.current.getBoundingClientRect();S.current={x:re.clientX-Y.left,y:re.clientY-Y.top},M(!0),re.preventDefault()}},[]);I.useEffect(()=>{if(!D)return;const re=Y=>{const ee=Y.clientX-S.current.x,U=Y.clientY-S.current.y,$=F.current?.offsetWidth||400,H=F.current?.offsetHeight||600,R=Math.max(0,Math.min(ee,window.innerWidth-$)),Z=Math.max(0,Math.min(U,window.innerHeight-H));T({x:R,y:Z})},J=()=>{M(!1)};return document.addEventListener("mousemove",re),document.addEventListener("mouseup",J),()=>{document.removeEventListener("mousemove",re),document.removeEventListener("mouseup",J)}},[D]);const g=I.useMemo(()=>{if(!p.trim())return()=>!0;const re=p.toLowerCase();return J=>!!(J.searchText&&J.searchText.toLowerCase().includes(re)||J.displayName&&J.displayName.toLowerCase().includes(re)||J.description&&J.description.toLowerCase().includes(re)||J.category&&J.category.toLowerCase().includes(re)||J.subcategory&&J.subcategory.toLowerCase().includes(re)||J.designator&&J.designator.toLowerCase().includes(re)||J.type&&J.type.toLowerCase().includes(re)||J.resolvedTypeName&&J.resolvedTypeName.toLowerCase().includes(re))},[p]),ae=I.useMemo(()=>p.trim()?Fu.filter(re=>{const J=Rg(re);return g({category:re.category,type:J.componentType,subcategory:re.subcategory,designator:re.designator,displayName:re.displayName,description:re.description,resolvedTypeName:Wl(J.componentType),searchText:re.searchText})}):Fu,[p,g]);if(!n)return null;const E={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"transparent",display:"flex",alignItems:"flex-start",justifyContent:"flex-end",zIndex:10005,pointerEvents:"none"},q={padding:"20px",overflow:"auto",flex:1};return i.jsx("div",{style:E,onClick:re=>re.stopPropagation(),children:i.jsxs("div",{ref:F,onClick:re=>re.stopPropagation(),style:{position:"fixed",top:m?`${m.y}px`:void 0,left:m?`${m.x}px`:void 0,backgroundColor:"#fff",borderRadius:8,minWidth:"250px",maxWidth:"300px",width:"280px",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:10005,display:"flex",flexDirection:"column",pointerEvents:"auto",transform:"none"},children:[i.jsxs("div",{onMouseDown:N,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:D?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Select Component"}),i.jsx("button",{type:"button",onMouseDown:re=>{re.stopPropagation()},onClick:re=>{re.stopPropagation(),v()},style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:q,children:[i.jsx("div",{style:{marginBottom:"16px"},onClick:re=>re.stopPropagation(),children:i.jsx("input",{ref:_,type:"text",placeholder:"Search by Component Type...",value:p,onChange:re=>b(re.target.value),onClick:re=>re.stopPropagation(),onMouseDown:re=>re.stopPropagation(),style:{width:"100%",padding:"8px 12px",fontSize:"13px",border:"1px solid #ddd",borderRadius:4,color:"#333",backgroundColor:"#fff",boxSizing:"border-box"}})}),i.jsxs("div",{style:{marginBottom:"20px",paddingBottom:"16px",borderBottom:"2px solid #eee"},onClick:re=>re.stopPropagation(),children:[i.jsx("div",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Layer:"}),i.jsxs("div",{style:{display:"flex",gap:"16px"},children:[i.jsxs("label",{onClick:re=>re.stopPropagation(),onMouseDown:re=>re.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[i.jsx("input",{type:"radio",name:"componentLayer",checked:r==="top",onChange:()=>l("top"),onClick:re=>re.stopPropagation(),onMouseDown:re=>re.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:r==="top"?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:r==="top"?"#0066cc":"transparent",position:"relative"}}),"Top"]}),i.jsxs("label",{onClick:re=>re.stopPropagation(),onMouseDown:re=>re.stopPropagation(),style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:"14px",color:"#333"},children:[i.jsx("input",{type:"radio",name:"componentLayer",checked:r==="bottom",onChange:()=>l("bottom"),onClick:re=>re.stopPropagation(),onMouseDown:re=>re.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",accentColor:"#0066cc",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:r==="bottom"?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:r==="bottom"?"#0066cc":"transparent",position:"relative"}}),"Bottom"]})]})]}),i.jsxs("div",{children:[i.jsx("div",{style:{marginBottom:"12px",fontSize:"14px",fontWeight:600,color:"#333"},children:"Component Type:"}),i.jsx("div",{style:{maxHeight:"calc(80vh - 280px)",overflowY:"auto"},children:p.trim()?ae.length>0?ae.map(re=>{const J=Rg(re),Y=J.uniqueKey||`${re.category}:${re.subcategory}:${re.type}:${re.designator}`,ee=s===Y,U=`${re.designator} - ${re.displayName}`;return i.jsxs("label",{onClick:$=>{$.stopPropagation(),d(J.componentType,Y,J)},onMouseDown:$=>$.stopPropagation(),style:{display:"flex",alignItems:"center",width:"100%",maxWidth:"100%",textAlign:"left",padding:"8px 12px",marginBottom:"4px",background:ee?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333",boxSizing:"border-box",overflow:"hidden"},children:[i.jsx("input",{type:"radio",name:"componentType-search",checked:ee,onChange:()=>d(J.componentType,Y,J),onClick:$=>$.stopPropagation(),onMouseDown:$=>$.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:ee?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:ee?"#0066cc":"transparent",position:"relative",flexShrink:0}}),i.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,minWidth:0},children:i.jsx("strong",{children:U})})]},Y)}):i.jsxs("div",{style:{padding:"12px",color:"#666",fontSize:"12px",textAlign:"center"},children:['No matches found for "',p,'"']}):Object.entries(qx).map(([re,J])=>J.length===0?null:i.jsxs("div",{style:{marginBottom:"12px"},children:[i.jsx("div",{style:{fontSize:"13px",fontWeight:600,color:"#333",padding:"6px 8px",marginBottom:"4px",backgroundColor:"#f5f5f5",borderRadius:4},children:re}),i.jsx("div",{style:{marginLeft:"8px"},children:J.map(Y=>{const ee=Rg(Y),U=ee.uniqueKey||`${Y.category}:${Y.subcategory}:${Y.type}:${Y.designator}`,$=s===U,H=`${Y.designator} - ${Y.displayName}`;return i.jsxs("label",{onClick:R=>{R.stopPropagation(),d(ee.componentType,U,ee)},onMouseDown:R=>R.stopPropagation(),style:{display:"flex",alignItems:"center",width:"100%",maxWidth:"100%",textAlign:"left",padding:"6px 12px",marginBottom:"2px",background:$?"#e6f0ff":"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",fontSize:"12px",color:"#333",boxSizing:"border-box",overflow:"hidden"},children:[i.jsx("input",{type:"radio",name:`componentType-${re}`,checked:$,onChange:()=>d(ee.componentType,U,ee),onMouseDown:R=>R.stopPropagation(),style:{marginRight:"8px",width:"14px",height:"14px",cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",border:$?"1.5px solid #0066cc":"1.5px solid #999",borderRadius:"50%",backgroundColor:$?"#0066cc":"transparent",position:"relative",flexShrink:0}}),i.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,minWidth:0},children:H})]},U)})})]},re))})]})]})]})})},Z5=({visible:n,onClose:r,powerBuses:o,setPowerBuses:s,editingPowerBusId:l,setEditingPowerBusId:d,powers:v})=>{const[p,b]=I.useState(null),[m,T]=I.useState(!1),[D,M]=I.useState(null),S=I.useRef(null);I.useEffect(()=>{n&&!p&&b({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[n,p]),I.useEffect(()=>{if(!m)return;const q=J=>{p&&D&&b({x:J.clientX-D.x,y:J.clientY-D.y})},re=()=>{T(!1),M(null)};return window.addEventListener("mousemove",q),window.addEventListener("mouseup",re),()=>{window.removeEventListener("mousemove",q),window.removeEventListener("mouseup",re)}},[m,p,D]);const F=o.filter(q=>q.id!==l),_=o.find(q=>q.id===l);if(!n)return null;const N=[...F].sort((q,re)=>{const J=U=>{const $=U.match(/([+-]?)(\d+\.?\d*)/);if($){const H=$[1]||"+",R=parseFloat($[2]);return{absValue:Math.abs(R),isNegative:H==="-"}}return{absValue:1/0,isNegative:!1}},Y=J(q.voltage),ee=J(re.voltage);return Y.absValue!==ee.absValue?Y.absValue-ee.absValue:Y.isNegative!==ee.isNegative?Y.isNegative?-1:1:0}),g=_?[...N,_]:N,ae=()=>{const q={id:`powerbus-${Date.now()}-${Math.random()}`,name:"New Power Bus",voltage:"+0.0",color:"#ff0000"};s(re=>[...re,q]),d(q.id)},E=q=>{const re=q.target;re.tagName==="BUTTON"||re.tagName==="INPUT"||re.closest("button")||re.closest("input")||p&&(M({x:q.clientX-p.x,y:q.clientY-p.y}),T(!0),q.preventDefault())};return i.jsxs("div",{ref:S,style:{position:"fixed",top:p?`${p.y}px`:"50%",left:p?`${p.x}px`:"50%",transform:p?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:m?"grabbing":"default"},children:[i.jsxs("div",{onMouseDown:E,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:m?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Power Buses"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:g.map(q=>{const re=o.find(U=>U.id===q.id)||q,J=o.findIndex(U=>U.id===q.id),Y=o.some(U=>U.name===re.name&&U.id!==q.id),ee=o.some(U=>U.voltage===re.voltage&&U.id!==q.id);return i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),i.jsx("input",{type:"text",value:re.name,onChange:U=>{const $=U.target.value;if(!o.some(R=>R.name===$&&R.id!==q.id)){const R=[...o];J>=0&&(R[J]={...re,name:$},s(R))}},placeholder:"e.g., +5VDC",style:{flex:1,padding:"2px 3px",border:Y?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Value:"}),i.jsx("input",{type:"text",inputMode:"decimal",value:re.voltage,onChange:U=>{const $=U.target.value;if($===""||/^[+-]?\d*\.?\d*$/.test($)){const H=[...o];J>=0&&(H[J]={...re,voltage:$},s(H))}},onBlur:U=>{const $=U.target.value.trim();if($==="")return;const H=parseFloat($);if(!isNaN(H)){const R=H>=0?"+":"-",Z=Math.abs(H),G=`${R}${Z.toFixed(1).replace(/\.?0+$/,"")}`,we=[...o];J>=0&&(we[J]={...re,voltage:G},s(we))}},placeholder:"e.g., +5.0",style:{flex:1,padding:"2px 3px",border:ee?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})]}),i.jsx("input",{type:"color",value:re.color,onChange:U=>{const $=[...o];J>=0&&($[J]={...re,color:U.target.value},s($))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),i.jsx("button",{onClick:()=>{const U=v.filter($=>$.powerBusId===q.id);if(U.length>0){alert(`Cannot delete: ${U.length} power node(s) are using this bus. Remove or reassign them first.`);return}s($=>$.filter(H=>H.id!==q.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]})},q.id)})}),i.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[i.jsx("button",{onClick:ae,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Power Bus"}),i.jsx("button",{onClick:r,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},J5=({visible:n,onClose:r,groundBuses:o,setGroundBuses:s,editingGroundBusId:l,setEditingGroundBusId:d,grounds:v})=>{const[p,b]=I.useState(null),[m,T]=I.useState(!1),[D,M]=I.useState(null),S=I.useRef(null);I.useEffect(()=>{n&&!p&&b({x:window.innerWidth/2-140,y:window.innerHeight/2-200})},[n,p]),I.useEffect(()=>{if(!m)return;const q=J=>{p&&D&&b({x:J.clientX-D.x,y:J.clientY-D.y})},re=()=>{T(!1),M(null)};return window.addEventListener("mousemove",q),window.addEventListener("mouseup",re),()=>{window.removeEventListener("mousemove",q),window.removeEventListener("mouseup",re)}},[m,p,D]);const F=o.filter(q=>q.id!==l),_=o.find(q=>q.id===l);if(!n)return null;const N=[...F].sort((q,re)=>q.name.localeCompare(re.name)),g=_?[...N,_]:N,ae=()=>{const q={id:`groundbus-${Date.now()}-${Math.random()}`,name:"New Ground Bus",color:"#000000"};s(re=>[...re,q]),d(q.id)},E=q=>{const re=q.target;re.tagName==="BUTTON"||re.tagName==="INPUT"||re.closest("button")||re.closest("input")||p&&(M({x:q.clientX-p.x,y:q.clientY-p.y}),T(!0),q.preventDefault())};return i.jsxs("div",{ref:S,style:{position:"fixed",top:p?`${p.y}px`:"50%",left:p?`${p.x}px`:"50%",transform:p?"none":"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"280px",maxWidth:"320px",maxHeight:"80vh",display:"flex",flexDirection:"column",cursor:m?"grabbing":"default"},children:[i.jsxs("div",{onMouseDown:E,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px",borderBottom:"1px solid #e0e0e0",background:"#888",cursor:m?"grabbing":"grab",userSelect:"none",flexShrink:0},children:[i.jsx("h2",{style:{margin:0,fontSize:"12px",color:"#fff",fontWeight:600},children:"Manage Ground Buses"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#fff",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",padding:"6px 20px 6px 6px",overflowY:"auto",flex:1,minHeight:0},children:g.map(q=>{const re=o.find(ee=>ee.id===q.id)||q,J=o.findIndex(ee=>ee.id===q.id),Y=o.some(ee=>ee.name===re.name&&ee.id!==q.id);return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"4px",marginBottom:"4px",background:"#f9f9f9",borderRadius:4,border:"1px solid #e0e0e0"},children:[i.jsx("div",{style:{flex:1,minWidth:0},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("label",{style:{fontSize:"9px",fontWeight:600,color:"#333",whiteSpace:"nowrap",width:"50px",flexShrink:0},children:"Name:"}),i.jsx("input",{type:"text",value:re.name,onChange:ee=>{const U=ee.target.value;if(!o.some(H=>H.name===U&&H.id!==q.id)){const H=[...o];J>=0&&(H[J]={...re,name:U},s(H))}},placeholder:"e.g., GND, Earth",style:{flex:1,padding:"2px 3px",border:Y?"1px solid #ff0000":"1px solid #ddd",borderRadius:2,fontSize:"10px",background:"#f5f5f5",color:"#000"}})]})}),i.jsx("input",{type:"color",value:re.color,onChange:ee=>{const U=[...o];J>=0&&(U[J]={...re,color:ee.target.value},s(U))},style:{width:"24px",height:"24px",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",flexShrink:0},title:"Color"}),i.jsx("button",{onClick:()=>{const ee=v.filter(U=>U.groundBusId===q.id);if(ee.length>0){alert(`Cannot delete: ${ee.length} ground node(s) are using this bus. Remove or reassign them first.`);return}s(U=>U.filter($=>$.id!==q.id))},style:{padding:"2px 6px",background:"#f5f5f5",color:"#333",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"9px",flexShrink:0},children:"Delete"})]},q.id)})}),i.jsxs("div",{style:{padding:"6px",borderTop:"1px solid #e0e0e0",display:"flex",gap:"4px",flexShrink:0},children:[i.jsx("button",{onClick:ae,style:{flex:1,padding:"4px 8px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:2,cursor:"pointer",fontSize:"10px"},children:"+ Add Ground Bus"}),i.jsx("button",{onClick:r,style:{flex:1,padding:"4px 8px",background:"#0b5fff",color:"#fff",border:"none",borderRadius:2,cursor:"pointer",fontSize:"10px",fontWeight:500},children:"Close"})]})]})},Q5=({visible:n,onClose:r,autoAssignDesignators:o,setAutoAssignDesignators:s,useGlobalDesignatorCounters:l,setUseGlobalDesignatorCounters:d})=>n?i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #ddd",borderRadius:6,padding:"16px",zIndex:1e3,minWidth:"300px",maxWidth:"400px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[i.jsx("h2",{style:{margin:0,fontSize:"14px",fontWeight:600,color:"#222"},children:"Manage Designators"}),i.jsx("button",{onClick:r,style:{background:"transparent",border:"none",fontSize:"18px",cursor:"pointer",color:"#666",padding:0,width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333",marginBottom:"12px"},children:[i.jsx("input",{type:"checkbox",checked:o,onChange:v=>{s(v.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),i.jsx("span",{children:"Automatically assign designators"})]}),i.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4",marginBottom:"12px"},children:o?i.jsx("div",{children:"When enabled, new components automatically receive sequential designators (e.g., C1, C2, C3 for Capacitors; R1, R2, R3 for Resistors)."}):i.jsx("div",{children:"When disabled, you must manually assign designators to each component. The designator field will be empty when components are created."})}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",fontSize:"13px",color:"#333"},children:[i.jsx("input",{type:"checkbox",checked:l,onChange:v=>{d(v.target.checked)},style:{width:"16px",height:"16px",cursor:"pointer"}}),i.jsx("span",{children:"Use global designator counters"})]}),i.jsx("div",{style:{marginTop:"8px",padding:"8px",background:"#f5f5f5",borderRadius:4,fontSize:"11px",color:"#666",lineHeight:"1.4"},children:l?i.jsx("div",{children:"When ON, designators continue from global counters across all projects. New components start with the next value from the global counter (e.g., if global counter is C10, new capacitor will be C11)."}):i.jsx("div",{children:"When OFF (default), designators start at 1 for each project. Each project maintains its own independent designator sequence (e.g., C1, C2, C3...)."})})]}),i.jsx("button",{onClick:r,style:{width:"100%",padding:"6px 12px",background:"#f0f0f0",color:"#333",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",fontSize:"12px"},children:"Close"})]}):null,ew=({visible:n,title:r,message:o,onYes:s,onNo:l,onCancel:d,yesButtonRef:v})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10001},onClick:p=>{p.target===p.currentTarget&&d()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:r}),i.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:o}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:d,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"No"}),i.jsx("button",{ref:v,onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},autoFocus:!0,children:"Yes"})]})]})}):null,tw=({visible:n,size:r,onSizeChange:o,onApply:s,onCancel:l})=>{const d=I.useRef(null);if(I.useEffect(()=>{n&&d.current&&(d.current.focus(),d.current.select())},[n]),!n)return null;const v=[2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32];return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:p=>{p.target===p.currentTarget&&l()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:p=>p.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Set Size"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Size (pixels):"}),i.jsx("input",{ref:d,type:"number",min:"1",max:"99",value:r,onChange:p=>{const b=parseInt(p.target.value)||1,m=Math.max(1,Math.min(99,b));o(m)},onKeyDown:p=>{if(p.key==="Enter"?s():p.key==="Escape"&&l(),p.key.length===1&&/[0-9]/.test(p.key)){const b=r.toString();b.length>=2&&d.current?.selectionStart===d.current?.selectionEnd&&d.current?.selectionStart===b.length&&p.preventDefault()}},onInput:p=>{const b=p.target,m=b.value;if(m.length>2){b.value=m.slice(0,2);const T=parseInt(b.value)||1;o(Math.max(1,Math.min(99,T)))}},style:{width:"100%",padding:"8px 12px",marginBottom:"16px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Or select from list:"}),i.jsxs("select",{value:v.includes(r)?r:"",onChange:p=>{const b=parseInt(p.target.value);!isNaN(b)&&b>0&&o(b)},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},children:[i.jsx("option",{value:"",style:{background:"#1f1f24",color:"#f2f2f2"},children:"-- Select --"}),v.map(p=>i.jsxs("option",{value:p,style:{background:"#1f1f24",color:"#f2f2f2"},children:[p," pixels"]},p))]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})})},nw=({visible:n,interval:r,onIntervalChange:o,onApply:s,onCancel:l})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10003},onClick:d=>{d.target===d.currentTarget&&l()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:d=>d.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Auto Save"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),i.jsxs("select",{value:r===null?"disable":(r||5).toString(),onChange:d=>{const v=d.target.value;if(v==="disable")o(null);else{const p=parseFloat(v);!isNaN(p)&&p>0&&o(p)}},style:{width:"100%",padding:"8px 12px",marginBottom:"20px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[i.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),i.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),i.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),i.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),i.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"}),i.jsx("option",{value:"disable",style:{background:"#1f1f24",color:"#f2f2f2"},children:"Disable"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Apply"})]})]})}):null,iw=({visible:n,interval:r,onIntervalChange:o,onEnable:s,onSkip:l})=>n?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10004},onClick:d=>{d.target===d.currentTarget&&l()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:d=>d.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Enable Auto Save?"}),i.jsx("p",{style:{margin:"0 0 20px 0",fontSize:"14px",color:"#e0e0e0",lineHeight:"1.5"},children:"We recommend enabling Auto Save to automatically save your project at regular intervals. This helps protect your work from accidental loss."}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Select time interval:"}),i.jsxs("select",{value:r===null?"disable":(r||5).toString(),onChange:d=>{const v=d.target.value;if(v==="disable")o(null);else{const p=parseFloat(v);!isNaN(p)&&p>0&&o(p)}},style:{width:"100%",padding:"8px 12px",marginBottom:"24px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},autoFocus:!0,children:[i.jsx("option",{value:"1",style:{background:"#1f1f24",color:"#f2f2f2"},children:"1 minute"}),i.jsx("option",{value:"5",style:{background:"#1f1f24",color:"#f2f2f2"},children:"5 minutes"}),i.jsx("option",{value:"10",style:{background:"#1f1f24",color:"#f2f2f2"},children:"10 minutes"}),i.jsx("option",{value:"20",style:{background:"#1f1f24",color:"#f2f2f2"},children:"20 minutes"}),i.jsx("option",{value:"30",style:{background:"#1f1f24",color:"#f2f2f2"},children:"30 minutes"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:l,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Skip"}),i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"Enable Auto Save"})]})]})}):null,rw=({visible:n,projectDirHandle:r,onClose:o,onRestore:s,position:l,isDragging:d=!1,onDragStart:v})=>{const[p,b]=I.useState([]),[m,T]=I.useState(!1),[D,M]=I.useState(null),[S,F]=I.useState(null),_=I.useRef(null);I.useEffect(()=>{if(!n||!r){b([]),M(null),F(null);return}(async()=>{T(!0),F(null);try{let re;try{re=await r.getDirectoryHandle("history")}catch{b([]),T(!1);return}const J=ee=>{const U=ee.match(/_(\d{4})_(\d{2})_(\d{2})-(\d{2})-(\d{2})-(\d{2})\.json$/);if(U){const[,H,R,Z,G,we,te]=U;return new Date(parseInt(H),parseInt(R)-1,parseInt(Z),parseInt(G),parseInt(we),parseInt(te))}const $=ee.match(/_(\d{4})_(\d{2})_(\d{2})_(\d{2})_(\d{2})_(\d{2})\.json$/);if($){const[,H,R,Z,G,we,te]=$;return new Date(parseInt(H),parseInt(R)-1,parseInt(Z),parseInt(G),parseInt(we),parseInt(te))}return null},Y=[];for await(const ee of re.keys())if(ee.endsWith(".json"))try{const $=await(await re.getFileHandle(ee)).getFile(),H=J(ee);Y.push({name:ee,lastModified:new Date($.lastModified),size:$.size,timestamp:H||new Date($.lastModified)})}catch(U){console.warn(`Failed to read file ${ee}:`,U)}Y.sort((ee,U)=>U.timestamp.getTime()-ee.timestamp.getTime()),b(Y)}catch(re){console.error("Failed to load history files:",re),F("Failed to load history files. Please try again.")}finally{T(!1)}})()},[n,r]);const N=async()=>{if(D)try{await s(D),o()}catch(q){console.error("Failed to restore file:",q),F("Failed to restore file. Please try again.")}},g=q=>q.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),ae=q=>q<1024?`${q} B`:q<1024*1024?`${(q/1024).toFixed(1)} KB`:`${(q/(1024*1024)).toFixed(1)} MB`;if(!n)return null;const E=l?{position:"fixed",left:`${l.x}px`,top:`${l.y}px`,backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column",cursor:d?"grabbing":"default"}:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"#fff",borderRadius:8,minWidth:"500px",maxWidth:"700px",width:"fit-content",maxHeight:"80%",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",border:"1px solid #ddd",zIndex:1e4,display:"flex",flexDirection:"column"};return i.jsxs("div",{style:E,children:[i.jsxs("div",{onMouseDown:v,style:{backgroundColor:"#f5f5f5",padding:"12px 16px",borderBottom:"1px solid #ddd",borderRadius:"8px 8px 0 0",cursor:d?"grabbing":"move",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h2",{style:{margin:0,fontSize:"16px",fontWeight:600,color:"#000"},children:"PastTime"}),i.jsx("button",{onClick:o,style:{background:"transparent",border:"none",fontSize:"20px",cursor:"pointer",color:"#666",padding:"0 4px",lineHeight:1},title:"Close",children:""})]}),i.jsxs("div",{style:{padding:"16px",display:"flex",flexDirection:"column",flex:1,minHeight:0},children:[S&&i.jsx("div",{style:{padding:"12px",backgroundColor:"#fee",color:"#c00",borderRadius:4,marginBottom:"12px"},children:S}),m?i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"Loading history files..."}):p.length===0?i.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#666"},children:"No history files found."}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{marginBottom:"12px",color:"#333",fontSize:"14px"},children:"Select a file to restore:"}),i.jsx("div",{ref:_,style:{border:"1px solid #ddd",borderRadius:4,overflowY:"auto",maxHeight:"400px",backgroundColor:"#fafafa"},children:p.map((q,re)=>i.jsxs("div",{onClick:()=>M(q.name),style:{padding:"12px 16px",borderBottom:re<p.length-1?"1px solid #eee":"none",backgroundColor:D===q.name?"#e6f0ff":"transparent",cursor:"pointer",transition:"background-color 0.1s"},onMouseEnter:J=>{D!==q.name&&(J.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:J=>{D!==q.name&&(J.currentTarget.style.backgroundColor="transparent")},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"4px"},children:[i.jsx("div",{style:{fontWeight:600,color:"#000",fontSize:"13px",wordBreak:"break-word",flex:1},children:q.name}),i.jsx("div",{style:{color:"#666",fontSize:"12px",marginLeft:"12px",whiteSpace:"nowrap"},children:ae(q.size)})]}),i.jsx("div",{style:{color:"#666",fontSize:"12px"},children:g(q.lastModified)})]},q.name))})]})]}),i.jsxs("div",{style:{padding:"12px 16px",borderTop:"1px solid #ddd",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx("button",{onClick:o,style:{padding:"6px 16px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"13px"},children:"Cancel"}),i.jsx("button",{onClick:N,disabled:!D||m,style:{padding:"6px 16px",background:D&&!m?"#0066cc":"#ccc",border:"none",borderRadius:4,cursor:D&&!m?"pointer":"not-allowed",color:"#fff",fontSize:"13px",fontWeight:500},children:"Restore"})]})]})},ow=()=>i.jsxs("svg",{width:"45",height:"30",viewBox:"0 0 45 30",style:{marginLeft:"8px",flexShrink:0},children:[i.jsx("rect",{x:"8",y:"4",width:"29",height:"14",rx:"2",ry:"2",fill:"#000"}),i.jsx("rect",{x:"10",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"14.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"19",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"23.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"28",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"32.5",y:"18",width:"2.5",height:"6",rx:"0.5",fill:"#000"})]}),aw=()=>i.jsxs("svg",{width:"40",height:"30",viewBox:"0 0 40 30",style:{marginLeft:"8px",flexShrink:0},children:[i.jsx("rect",{x:"2",y:"11",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"14.5",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"18",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"7",y:"6",width:"26",height:"18",rx:"2",ry:"2",fill:"#000"}),i.jsx("rect",{x:"13",y:"10",width:"14",height:"10",rx:"1.5",ry:"1.5",fill:"#fff"}),i.jsx("circle",{cx:"14.5",cy:"11.5",r:"1",fill:"#000"}),i.jsx("rect",{x:"33",y:"11",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"33",y:"14.5",width:"5",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"33",y:"18",width:"5",height:"2.5",rx:"0.5",fill:"#000"})]}),sw=()=>i.jsxs("svg",{width:"35",height:"35",viewBox:"0 0 35 35",style:{marginLeft:"8px",flexShrink:0},children:[i.jsx("rect",{x:"12",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"16.25",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"20.5",y:"2",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"12",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"16.25",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"2",y:"20.5",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"6",y:"6",width:"23",height:"23",fill:"#000"}),i.jsx("rect",{x:"29",y:"12",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"29",y:"16.25",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"29",y:"20.5",width:"4",height:"2.5",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"12",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"16.25",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"}),i.jsx("rect",{x:"20.5",y:"29",width:"2.5",height:"4",rx:"0.5",fill:"#000"})]}),Vx=({rotate:n=0})=>{const s=n!==0?`rotate(${n} 20 20)`:"";return i.jsx("svg",{width:"40",height:"40",viewBox:"0 0 40 40",style:{marginLeft:"8px",flexShrink:0},children:i.jsxs("g",{transform:s,children:[i.jsx("rect",{x:"8",y:"10",width:"24",height:"20",rx:"2",ry:"2",fill:"#555"}),i.jsx("rect",{x:"2",y:"12",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"2",y:"18",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"2",y:"24",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"32",y:"12",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"32",y:"18",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"32",y:"24",width:"6",height:"3",rx:"1",ry:"1",fill:"#555"}),i.jsx("rect",{x:"12",y:"14",width:"16",height:"12",rx:"1.5",ry:"1.5",fill:"#fff"}),i.jsx("circle",{cx:"14",cy:"16",r:"1.5",fill:"#555"})]})})},lw=()=>i.jsx(Vx,{rotate:0}),cw=()=>i.jsx(Vx,{rotate:90}),uw=({visible:n,isPad:r,onConfirm:o,onClose:s})=>{const[l,d]=I.useState("linear"),[v,p]=I.useState("vertical-edges"),[b,m]=I.useState("8"),[T,D]=I.useState("");I.useEffect(()=>{n&&(d("linear"),p("vertical-edges"),m("8"),D(""))},[n]);const M=(_,N)=>{const g=_.trim();if(g==="")return{valid:!1,error:"Number of pins is required."};const ae=parseInt(g,10);return isNaN(ae)?{valid:!1,error:"Please enter a valid number."}:ae<1?{valid:!1,error:"Number of pins must be >= 1."}:N==="linear"?ae!==Math.floor(ae)||ae<=0?{valid:!1,error:"Linear arrangement requires a positive integer."}:{valid:!0,error:"",numPins:ae}:N==="twoSided"?ae!==Math.floor(ae)||ae<=0?{valid:!1,error:"2-sided arrangement requires a positive integer."}:ae%2!==0?{valid:!1,error:"2-sided components must have an even number of pins."}:{valid:!0,error:"",numPins:ae}:N==="fourSided"?ae!==Math.floor(ae)||ae<=0?{valid:!1,error:"4-sided arrangement requires a positive integer."}:ae%4!==0?{valid:!1,error:"4-sided components must have a number of pins divisible by 4."}:{valid:!0,error:"",numPins:ae}:{valid:!0,error:"",numPins:ae}},S=_=>{let N=_===""?"":_.replace(/[^\d]/g,"");m(N);const g=M(N,l);g.error?D(g.error):D("")},F=I.useCallback(()=>{const _=M(b,l);if(!_.valid||_.numPins===void 0){D(_.error||"Invalid number of pins.");return}D(""),o({numPins:_.numPins,type:l,...l==="twoSided"?{twoSidedOrientation:v}:{}})},[b,l,v,o]);return I.useEffect(()=>{if(!n)return;const _=N=>{N.key==="Enter"&&!N.shiftKey&&!N.ctrlKey&&!N.altKey&&!N.metaKey&&(N.preventDefault(),F())};return window.addEventListener("keydown",_),()=>{window.removeEventListener("keydown",_)}},[n,F]),n?i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        .number-input-large-spinners::-webkit-inner-spin-button,
        .number-input-large-spinners::-webkit-outer-spin-button {
          opacity: 1;
          height: 20px;
          width: 20px;
          cursor: pointer;
        }
        .number-input-large-spinners::-webkit-inner-spin-button {
          margin-right: 4px;
        }
      `}),i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:_=>{_.target===_.currentTarget&&s()},children:i.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",minWidth:"320px",maxWidth:"380px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},onClick:_=>_.stopPropagation(),children:[i.jsxs("h2",{style:{marginTop:0,marginBottom:"20px",color:"#222",fontSize:"18px"},children:[r?"Pad Pattern":"Via Pattern"," Placement"]}),i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Arrangement:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"linear",checked:l==="linear",onChange:_=>{const N=_.target.value;d(N);const g=M(b,N);g.error?D(g.error):D("")},style:{marginRight:"8px"}}),i.jsx("span",{style:{color:"#222"},children:"Linear (1 side)"}),i.jsx(ow,{})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"twoSided",checked:l==="twoSided",onChange:_=>{const N=_.target.value;d(N);const g=M(b,N);g.error?D(g.error):D("")},style:{marginRight:"8px"}}),i.jsx("span",{style:{color:"#222"},children:"2-Sided"}),i.jsx(aw,{})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"fourSided",checked:l==="fourSided",onChange:_=>{const N=_.target.value;d(N);const g=M(b,N);g.error?D(g.error):D("")},style:{marginRight:"8px"}}),i.jsx("span",{style:{color:"#222"},children:"4-Sided"}),i.jsx(sw,{})]})]})]}),l==="twoSided"&&i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Orientation:"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"vertical-edges",checked:v==="vertical-edges",onChange:_=>p(_.target.value),style:{marginRight:"8px"}}),i.jsxs("span",{style:{color:"#222"},children:["Vertical ",r?"Pads":"Vias"," (left & right)"]}),i.jsx(lw,{})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[i.jsx("input",{type:"radio",value:"horizontal-edges",checked:v==="horizontal-edges",onChange:_=>p(_.target.value),style:{marginRight:"8px"}}),i.jsxs("span",{style:{color:"#222"},children:["Horizontal ",r?"Pads":"Vias"," (top & bottom)"]}),i.jsx(cw,{})]})]})]}),i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",color:"#222",fontWeight:500},children:"Number of Pins:"}),i.jsx("input",{type:"number",min:l==="linear"?1:l==="twoSided"?2:4,step:l==="linear"?1:l==="twoSided"?2:4,value:b,onChange:_=>S(_.target.value),onBlur:()=>{const _=M(b,l);_.valid?D(""):D(_.error)},style:{width:"80px",padding:"6px 24px 6px 6px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",color:"#000",background:"#fff"},className:"number-input-large-spinners"}),T&&i.jsx("div",{style:{color:"#d32f2f",fontSize:"12px",marginTop:"4px"},children:T})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",marginTop:"20px"},children:[i.jsx("button",{onClick:s,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:F,style:{padding:"8px 16px",background:"#4CAF50",color:"#fff",border:"1px solid #45a049",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:600},children:"OK"})]})]})})]}):null};function dw(n,r){const o={x:n.x,y:n.y},s={x:r.x,y:r.y},l={x:s.x,y:o.y},d={x:o.x,y:s.y};return{corner1:o,corner2:l,corner3:s,corner4:d}}function fw(n){if(n.numPins<1)throw new Error("Number of pins must be >= 1.");if(n.type==="twoSided"){if(n.numPins%2!==0)throw new Error("2-sided components must have an even number of pins.");if(!n.twoSidedOrientation)throw new Error("Orientation required for 2-sided components.")}if(n.type==="fourSided"&&n.numPins%4!==0)throw new Error("4-sided components must have N divisible by 4.");if(Math.abs(n.point1.x-n.point2.x)<.001||Math.abs(n.point1.y-n.point2.y)<.001)throw new Error("Area must have non-zero width and height.")}function pw(n,r){const o=[],{corner1:s,corner2:l,corner3:d,corner4:v}=r,p=Math.abs(l.x-s.x),b=Math.abs(d.y-l.y);if(p>b){const m=(s.y+v.y)/2,T=Math.min(s.x,l.x),D=Math.max(s.x,l.x),M=D-T,S=n.numPins>1?M/(n.numPins-1):0,F=Math.hypot(s.x-T,s.y-m),_=Math.hypot(s.x-D,s.y-m),N=F<_;if(n.numPins===1)o.push({pinNumber:1,x:(T+D)/2,y:m});else for(let g=1;g<=n.numPins;g++){const ae=N?T+(g-1)*S:D-(g-1)*S;o.push({pinNumber:g,x:ae,y:m})}}else{const m=(s.x+l.x)/2,T=Math.min(s.y,l.y),D=Math.max(d.y,v.y),M=D-T,S=n.numPins>1?M/(n.numPins-1):0,F=Math.hypot(s.x-m,s.y-T),_=Math.hypot(s.x-m,s.y-D),N=F<_;if(n.numPins===1)o.push({pinNumber:1,x:m,y:(T+D)/2});else for(let g=1;g<=n.numPins;g++){const ae=N?T+(g-1)*S:D-(g-1)*S;o.push({pinNumber:g,x:m,y:ae})}}return o}function hw(n,r){const o=[],{corner1:s,corner2:l,corner3:d,corner4:v}=r,p=n.type==="fourSided"?n.numPins/4:n.numPins/2,b=Math.min(s.x,l.x,d.x,v.x),m=Math.min(s.y,l.y,d.y,v.y),T=Math.abs(s.y-m)<.001,D=Math.abs(s.x-b)<.001,M=T?D?"TopLeft":"TopRight":D?"BottomLeft":"BottomRight",S=Math.max(s.x,l.x,d.x,v.x),F=Math.max(s.y,l.y,d.y,v.y),_=(R,Z,G=.001)=>{const we=[s,l,d,v];for(const te of we)if(Math.abs(te.x-R)<G&&Math.abs(te.y-Z)<G)return te;return null},N=_(b,m)||s,g=_(S,m)||l,ae=_(S,F)||d,E=_(b,F)||v,q={start:N,end:E,name:"Left",direction:"Down"},re={start:E,end:ae,name:"Bottom",direction:"Right"},J={start:ae,end:g,name:"Right",direction:"Up"},Y={start:g,end:N,name:"Top",direction:"Left"};let ee;const U=[];if(M==="TopLeft"?(ee=q,U.push(q,re,J,Y)):M==="BottomLeft"?(ee=re,U.push(re,J,Y,q)):M==="BottomRight"?(ee=J,U.push(J,Y,q,re)):(ee=Y,U.push(Y,q,re,J)),n.type==="twoSided"){if(n.twoSidedOrientation==="vertical-edges"){if(M!=="TopLeft"&&M!=="BottomRight")throw new Error(`Invalid Pin 1 location for Left/Right orientation. Pin 1 is at ${M}, but must be at Top-Left or Bottom-Right.`)}else if(M!=="TopRight"&&M!=="BottomLeft")throw new Error(`Invalid Pin 1 location for Top/Bottom orientation. Pin 1 is at ${M}, but must be at Top-Right or Bottom-Left.`)}const $=[];n.type==="fourSided"?$.push(...U):n.twoSidedOrientation==="vertical-edges"?ee===q?$.push(q,J):$.push(J,q):ee===Y?$.push(Y,re):$.push(re,Y);let H=1;for(const R of $){const Z=Math.hypot(R.end.x-R.start.x,R.end.y-R.start.y),G=n.type==="fourSided"?Z/(p+1):p>1?Z/(p-1):0,we=[];if(n.type==="fourSided")if(R.direction==="Down")for(let te=1;te<=p;te++)we.push({x:R.start.x,y:R.start.y+te*G});else if(R.direction==="Right")for(let te=1;te<=p;te++)we.push({x:R.start.x+te*G,y:R.start.y});else if(R.direction==="Up")for(let te=1;te<=p;te++)we.push({x:R.start.x,y:R.start.y-te*G});else for(let te=1;te<=p;te++)we.push({x:R.start.x-te*G,y:R.start.y});else if(p===1){const te=(R.start.x+R.end.x)/2,de=(R.start.y+R.end.y)/2;we.push({x:te,y:de})}else if(R.direction==="Down")for(let te=0;te<p;te++)we.push({x:R.start.x,y:R.start.y+te*G});else if(R.direction==="Right")for(let te=0;te<p;te++)we.push({x:R.start.x+te*G,y:R.start.y});else if(R.direction==="Up")for(let te=0;te<p;te++)we.push({x:R.start.x,y:R.start.y-te*G});else for(let te=0;te<p;te++)we.push({x:R.start.x-te*G,y:R.start.y});if(R===ee){let te=0,de=1/0;for(let Re=0;Re<we.length;Re++){const xe=Math.hypot(we[Re].x-s.x,we[Re].y-s.y);xe<de&&(de=xe,te=Re)}const Ce=Math.hypot(R.start.x-s.x,R.start.y-s.y);if(de<Ce&&te>0){const Re=we.slice(0,te),xe=we.slice(te);we.length=0,we.push(...xe,...Re)}}for(const te of we)o.push({pinNumber:H++,x:te.x,y:te.y})}return o}function gw(n){fw(n);const r=dw(n.point1,n.point2);return n.type==="linear"?pw(n,r):hw(n,r)}function yw(){const[n,r]=I.useState([]),[o,s]=I.useState(!1),[l,d]=I.useState([]),[v,p]=I.useState(null),[b,m]=I.useState("trace"),[T,D]=I.useState("top"),M=I.useRef([]),S=I.useRef(0),F=I.useRef(!1),_=I.useCallback(()=>{s(!0),d([]),M.current=[]},[]),N=I.useCallback(()=>{s(!1),d([]),M.current=[]},[]),g=I.useCallback(E=>{d(q=>[...q,E]),M.current=[...M.current,E]},[]),ae=I.useCallback(E=>{r(q=>[...q,E]),d([]),M.current=[]},[]);return{drawingStrokes:n,setDrawingStrokes:r,isDrawing:o,setIsDrawing:s,currentStroke:l,setCurrentStroke:d,tracePreviewMousePos:v,setTracePreviewMousePos:p,drawingMode:b,setDrawingMode:m,selectedDrawingLayer:T,setSelectedDrawingLayer:D,currentStrokeRef:M,lastTraceClickTimeRef:S,isDoubleClickingTraceRef:F,startDrawing:_,stopDrawing:N,addPointToStroke:g,finishStroke:ae}}function xw(){const[n,r]=I.useState(new Set),[o,s]=I.useState(!1),[l,d]=I.useState(new Set),[v,p]=I.useState(new Set),[b,m]=I.useState(new Set),T=I.useCallback(()=>{r(new Set),d(new Set),p(new Set),m(new Set)},[]),D=I.useCallback((F,_="stroke")=>{_==="stroke"?r(N=>new Set([...N,F])):_==="component"?d(N=>new Set([...N,F])):_==="power"?p(N=>new Set([...N,F])):_==="ground"&&m(N=>new Set([...N,F]))},[]),M=I.useCallback((F,_="stroke")=>{_==="stroke"?r(N=>{const g=new Set(N);return g.delete(F),g}):_==="component"?d(N=>{const g=new Set(N);return g.delete(F),g}):_==="power"?p(N=>{const g=new Set(N);return g.delete(F),g}):_==="ground"&&m(N=>{const g=new Set(N);return g.delete(F),g})},[]),S=I.useCallback((F,_="stroke")=>{_==="stroke"?r(F):_==="component"?d(F):_==="power"?p(F):_==="ground"&&m(F)},[]);return{selectedIds:n,setSelectedIds:r,isSelecting:o,setIsSelecting:s,selectedComponentIds:l,setSelectedComponentIds:d,selectedPowerIds:v,setSelectedPowerIds:p,selectedGroundIds:b,setSelectedGroundIds:m,clearSelection:T,addToSelection:D,removeFromSelection:M,setSelection:S}}function mw(){const[n,r]=I.useState(null),[o,s]=I.useState(!1),[l,d]=I.useState(null),[v,p]=I.useState("nudge"),b=I.useCallback((T,D)=>{r(T),s(!0),d(D)},[]),m=I.useCallback(()=>{s(!1),r(null),d(null)},[]);return{selectedImageForTransform:n,setSelectedImageForTransform:r,isTransforming:o,setIsTransforming:s,transformStartPos:l,setTransformStartPos:d,transformMode:v,setTransformMode:p,startTransform:b,stopTransform:m}}function bw(){const[n,r]=I.useState(null),[o,s]=I.useState(null),[l,d]=I.useState("overlay"),[v,p]=I.useState(50),[b,m]=I.useState(!1),[T,D]=I.useState(2e3),[M,S]=I.useState(!1),F=I.useCallback(g=>{r(g)},[]),_=I.useCallback(g=>{s(g)},[]),N=I.useCallback(()=>{r(null),s(null)},[]);return{topImage:n,setTopImage:r,bottomImage:o,setBottomImage:s,currentView:l,setCurrentView:d,transparency:v,setTransparency:p,isTransparencyCycling:b,setIsTransparencyCycling:m,transparencyCycleSpeed:T,setTransparencyCycleSpeed:D,isGrayscale:M,setIsGrayscale:S,loadTopImage:F,loadBottomImage:_,clearImages:N}}function vw(){const[n,r]=I.useState(1),[o,s]=I.useState({x:0,y:0}),[l,d]=I.useState(0),[v,p]=I.useState(!1),[b,m]=I.useState(!1),[T,D]=I.useState(!1),M=I.useCallback(()=>{r(1),s({x:0,y:0}),d(0),p(!1)},[]),S=I.useCallback((E=1.2)=>{r(q=>q*E)},[]),F=I.useCallback((E=1.2)=>{r(q=>q/E)},[]),_=I.useCallback(E=>{r(E)},[]),N=I.useCallback((E,q,re)=>{const J=E/re,Y=q/re;s(ee=>({x:ee.x-J,y:ee.y-Y}))},[]),g=I.useCallback((E,q)=>{s({x:E,y:q})},[]),ae=I.useCallback((E,q)=>({x:E-o.x*n,y:q-o.y*n}),[o,n]);return{viewScale:n,setViewScale:r,cameraWorldCenter:o,setCameraWorldCenter:s,viewRotation:l,setViewRotation:d,viewFlipX:v,setViewFlipX:p,isShiftConstrained:b,setIsShiftConstrained:m,showBothLayers:T,setShowBothLayers:D,resetView:M,zoomIn:S,zoomOut:F,setZoom:_,pan:N,setCameraCenter:g,getViewPan:ae}}function ww(){const[n,r]=I.useState(()=>[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),[o,s]=I.useState(()=>[{id:"groundbus-circuit",name:"GND",color:"#000000"}]),[l,d]=I.useState([]),[v,p]=I.useState([]),[b,m]=I.useState(null),[T,D]=I.useState(null),M=I.useCallback(J=>{r(Y=>[...Y,J])},[]),S=I.useCallback((J,Y)=>{r(ee=>ee.map(U=>U.id===J?{...U,...Y}:U))},[]),F=I.useCallback(J=>{r(Y=>Y.filter(ee=>ee.id!==J)),d(Y=>Y.filter(ee=>ee.powerBusId!==J))},[]),_=I.useCallback(J=>{d(Y=>[...Y,J])},[]),N=I.useCallback(J=>{d(Y=>Y.filter(ee=>ee.id!==J))},[]),g=I.useCallback(J=>{p(Y=>[...Y,J])},[]),ae=I.useCallback(J=>{p(Y=>Y.filter(ee=>ee.id!==J))},[]),E=I.useCallback(J=>{s(Y=>[...Y,J])},[]),q=I.useCallback((J,Y)=>{s(ee=>ee.map(U=>U.id===J?{...U,...Y}:U))},[]),re=I.useCallback(J=>{s(Y=>Y.filter(ee=>ee.id!==J)),p(Y=>Y.filter(ee=>ee.groundBusId===J))},[]);return{powerBuses:n,setPowerBuses:r,groundBuses:o,setGroundBuses:s,powerSymbols:l,setPowerSymbols:d,groundSymbols:v,setGroundSymbols:p,powerEditor:b,setPowerEditor:m,groundEditor:T,setGroundEditor:D,addPowerBus:M,updatePowerBus:S,removePowerBus:F,addPowerSymbol:_,removePowerSymbol:N,addGroundSymbol:g,removeGroundSymbol:ae,addGroundBus:E,updateGroundBus:q,removeGroundBus:re}}const Ni={brushColor:"#008080",brushSize:6,topTraceColor:"#AA4499",bottomTraceColor:"#F781BF",topTraceSize:6,bottomTraceSize:6,viaSize:18,viaColor:"#ff0000",topPadColor:"#0072B2",bottomPadColor:"#56B4E9",topPadSize:18,bottomPadSize:18,topTestPointColor:"#FFFF00",bottomTestPointColor:"#FFFF00",topTestPointSize:18,bottomTestPointSize:18,topComponentColor:"#8C564B",bottomComponentColor:"#9C755F",topComponentSize:18,bottomComponentSize:18,componentConnectionColor:"#E69F00",componentConnectionSize:3};function Sw(){const[n,r]=I.useState(Ni.brushColor),[o,s]=I.useState(Ni.brushSize),[l,d]=I.useState(Ni.topTraceColor),[v,p]=I.useState(Ni.bottomTraceColor),[b,m]=I.useState(Ni.topTraceSize),[T,D]=I.useState(Ni.bottomTraceSize),[M,S]=I.useState(Ni.topPadColor),[F,_]=I.useState(Ni.bottomPadColor),[N,g]=I.useState(Ni.topPadSize),[ae,E]=I.useState(Ni.bottomPadSize),[q,re]=I.useState(Ni.topTestPointColor),[J,Y]=I.useState(Ni.bottomTestPointColor),[ee,U]=I.useState(Ni.topTestPointSize),[$,H]=I.useState(Ni.bottomTestPointSize),[R,Z]=I.useState(Ni.topComponentColor),[G,we]=I.useState(Ni.bottomComponentColor),[te,de]=I.useState(Ni.topComponentSize),[Ce,Re]=I.useState(Ni.bottomComponentSize),[xe,k]=I.useState(Ni.componentConnectionColor),[A,V]=I.useState(Ni.componentConnectionSize),W=I.useCallback(()=>{r(Ni.brushColor),s(Ni.brushSize),d(Ni.topTraceColor),p(Ni.bottomTraceColor),m(Ni.topTraceSize),D(Ni.bottomTraceSize),S(Ni.topPadColor),_(Ni.bottomPadColor),g(Ni.topPadSize),E(Ni.bottomPadSize),re(Ni.topTestPointColor),Y(Ni.bottomTestPointColor),U(Ni.topTestPointSize),H(Ni.bottomTestPointSize),Z(Ni.topComponentColor),we(Ni.bottomComponentColor),de(Ni.topComponentSize),Re(Ni.bottomComponentSize),k(Ni.componentConnectionColor),V(Ni.componentConnectionSize)},[]),se=I.useCallback(ve=>{ve.brushColor!==void 0&&r(ve.brushColor),ve.brushSize!==void 0&&s(ve.brushSize),ve.topTraceColor!==void 0&&d(ve.topTraceColor),ve.bottomTraceColor!==void 0&&p(ve.bottomTraceColor),ve.topTraceSize!==void 0&&m(ve.topTraceSize),ve.bottomTraceSize!==void 0&&D(ve.bottomTraceSize),ve.topPadColor!==void 0&&S(ve.topPadColor),ve.bottomPadColor!==void 0&&_(ve.bottomPadColor),ve.topPadSize!==void 0&&g(ve.topPadSize),ve.bottomPadSize!==void 0&&E(ve.bottomPadSize),ve.topTestPointColor!==void 0&&re(ve.topTestPointColor),ve.bottomTestPointColor!==void 0&&Y(ve.bottomTestPointColor),ve.topTestPointSize!==void 0&&U(ve.topTestPointSize),ve.bottomTestPointSize!==void 0&&H(ve.bottomTestPointSize),ve.topComponentColor!==void 0&&Z(ve.topComponentColor),ve.bottomComponentColor!==void 0&&we(ve.bottomComponentColor),ve.topComponentSize!==void 0&&de(ve.topComponentSize),ve.bottomComponentSize!==void 0&&Re(ve.bottomComponentSize),ve.componentConnectionColor!==void 0&&k(ve.componentConnectionColor),ve.componentConnectionSize!==void 0&&V(ve.componentConnectionSize)},[]),Te=I.useCallback((ve,De,Xe)=>{},[]),le=I.useCallback((ve,De,Xe)=>{},[]),_e=I.useCallback(()=>({brushColor:n,brushSize:o,topTraceColor:l,bottomTraceColor:v,topTraceSize:b,bottomTraceSize:T,viaSize:Ni.viaSize,viaColor:Ni.viaColor,topPadColor:M,bottomPadColor:F,topPadSize:N,bottomPadSize:ae,topTestPointColor:q,bottomTestPointColor:J,topTestPointSize:ee,bottomTestPointSize:$,topComponentColor:R,bottomComponentColor:G,topComponentSize:te,bottomComponentSize:Ce,componentConnectionColor:xe,componentConnectionSize:A}),[n,o,l,v,b,T,M,F,N,ae,q,J,ee,$,R,G,te,Ce,xe,A]);return{brushColor:n,setBrushColor:r,brushSize:o,setBrushSize:s,topTraceColor:l,setTopTraceColor:d,bottomTraceColor:v,setBottomTraceColor:p,topTraceSize:b,setTopTraceSize:m,bottomTraceSize:T,setBottomTraceSize:D,topPadColor:M,setTopPadColor:S,bottomPadColor:F,setBottomPadColor:_,topPadSize:N,setTopPadSize:g,bottomPadSize:ae,setBottomPadSize:E,topTestPointColor:q,setTopTestPointColor:re,bottomTestPointColor:J,setBottomTestPointColor:Y,topTestPointSize:ee,setTopTestPointSize:U,bottomTestPointSize:$,setBottomTestPointSize:H,topComponentColor:R,setTopComponentColor:Z,bottomComponentColor:G,setBottomComponentColor:we,topComponentSize:te,setTopComponentSize:de,bottomComponentSize:Ce,setBottomComponentSize:Re,componentConnectionColor:xe,setComponentConnectionColor:k,componentConnectionSize:A,setComponentConnectionSize:V,resetToDefaults:W,loadFromProject:se,getCurrentSettings:_e,saveDefaultSize:Te,saveDefaultColor:le}}function jw(n,r,o,s,l,d,v,p,b,m,T,D,M,S,F,_,N,g,ae,E,q,re,J,Y,ee){const[U,$]=I.useState(()=>n()),H=I.useRef(null),R=I.useRef(s),Z=I.useRef(l),G=I.useCallback(de=>r==="draw"&&o==="trace"?de.get("trace"):r==="draw"&&o==="via"?de.get("via"):r==="draw"&&o==="pad"?de.get("pad"):r==="component"?de.get("component"):r==="power"?de.get("power"):r==="ground"?de.get("ground"):null,[r,o]);I.useEffect(()=>{$(de=>{const Ce=G(de),Re=Ce?.id||null,xe=H.current,k=new Map(de);if(xe&&xe!==Re){const A=de.get(xe);A&&k.set(xe,{...A,settings:{color:R.current,size:Z.current}})}if(Ce&&Re!==xe)if(r==="draw"&&o==="trace"){const A=re||"top",V=A==="top"?d:v,W=A==="top"?p:b;R.current=V,Z.current=W,k.set("trace",{...Ce,settings:{color:V,size:W}})}else if(r==="draw"&&o==="pad"){const A=J||"top",V=A==="top"?m:T,W=A==="top"?D:M;R.current=V,Z.current=W,k.set("pad",{...Ce,settings:{color:V,size:W}})}else if(r==="component"){const A=ee||"top",V=A==="top"?g:ae,W=A==="top"?E:q;R.current=V,Z.current=W,k.set("component",{...Ce,settings:{color:V,size:W}})}else R.current=Ce.settings.color,Z.current=Ce.settings.size;return H.current=Re,k})},[r,o,d,v,p,b,m,T,D,M,g,ae,E,q,re,J,ee,G]);const we=I.useCallback((de,Ce)=>{$(Re=>{const xe=new Map(Re),k=xe.get(de);return k&&xe.set(de,{...k,settings:Ce}),xe})},[]),te=I.useCallback((de,Ce,Re)=>{$(xe=>{const k=new Map(xe),A=k.get(de);if(A){const V=new Map(A.layerSettings);V.set(Ce,Re),k.set(de,{...A,layerSettings:V})}return k})},[]);return{toolRegistry:U,setToolRegistry:$,updateToolSettings:we,updateToolLayerSettings:te,getCurrentToolDef:G}}function Tw(n){const{currentTool:r,drawingMode:o,traceToolLayer:s,padToolLayer:l,testPointToolLayer:d,componentToolLayer:v}=n,[p,b]=I.useState(0),m=I.useCallback(()=>r==="draw"&&o==="via"?"via":r==="draw"&&o==="pad"?l==="bottom"?"padBottom":"padTop":r==="draw"&&o==="testPoint"?d==="bottom"?"testPointBottom":"testPointTop":r==="draw"&&o==="trace"?s==="bottom"?"traceBottom":"traceTop":r==="component"?v==="bottom"?"componentBottom":"componentTop":r==="power"?"power":r==="ground"?"ground":null,[r,o,l,d,s,v]),T=I.useCallback(()=>{const F=m();if(F){const _=Un.get(F);return{currentTool:r,drawingMode:o,layer:r==="draw"&&o==="pad"?l||"top":r==="draw"&&o==="testPoint"?d||"top":r==="draw"&&o==="trace"?s||"top":r==="component"?v||"top":void 0,toolInstanceId:F,color:_.color,size:_.size}}return{currentTool:r,drawingMode:o,layer:void 0,toolInstanceId:null,color:"#000000",size:10}},[r,o,l,d,s,v,m]);I.useEffect(()=>{const F=m();return F?Un.subscribe(F,()=>{b(N=>N+1)}):void 0},[m]);const D=T(),M=I.useCallback(F=>{const _=m();_&&Un.setColor(_,F)},[m]),S=I.useCallback(F=>{const _=m();_&&Un.setSize(_,F)},[m]);return{toolState:D,setColor:M,setSize:S,getCurrentToolInstanceId:m}}function Cw(){const[n,r]=I.useState(!1),[o,s]=I.useState(!1),[l,d]=I.useState(!1),[v,p]=I.useState(!1),[b,m]=I.useState(!1),[T,D]=I.useState(!1),[M,S]=I.useState(!1),[F,_]=I.useState(!1),N=I.useCallback(()=>{r(!0),s(!0),d(!0),p(!0),m(!0),D(!0),S(!0),_(!0)},[]),g=I.useCallback(()=>{r(!1),s(!1),d(!1),p(!1),m(!1),D(!1),S(!1),_(!1)},[]);return{areImagesLocked:n,setAreImagesLocked:r,areViasLocked:o,setAreViasLocked:s,arePadsLocked:l,setArePadsLocked:d,areTestPointsLocked:v,setAreTestPointsLocked:p,areTracesLocked:b,setAreTracesLocked:m,areComponentsLocked:T,setAreComponentsLocked:D,areGroundNodesLocked:M,setAreGroundNodesLocked:S,arePowerNodesLocked:F,setArePowerNodesLocked:_,lockAll:N,unlockAll:g}}function Nw(){const[n,r]=I.useState(null),[o,s]=I.useState({visible:!1,size:6}),[l,d]=I.useState({visible:!1,interval:5}),[v,p]=I.useState({visible:!1,source:null,interval:5}),[b,m]=I.useState({visible:!1,text:""}),[T,D]=I.useState({visible:!1,title:"",message:""}),[M,S]=I.useState({visible:!1}),[F,_]=I.useState({visible:!1}),[N,g]=I.useState({visible:!1,projectName:"",locationPath:"",locationHandle:null}),[ae,E]=I.useState({visible:!1,filename:"",locationPath:"",locationHandle:null}),[q,re]=I.useState(!1),[J,Y]=I.useState(!0),[ee,U]=I.useState(!1);return{openMenu:n,setOpenMenu:r,setSizeDialog:o,setSetSizeDialog:s,autoSaveDialog:l,setAutoSaveDialog:d,autoSavePromptDialog:v,setAutoSavePromptDialog:p,debugDialog:b,setDebugDialog:m,errorDialog:T,setErrorDialog:D,newProjectDialog:M,setNewProjectDialog:S,openProjectDialog:F,setOpenProjectDialog:_,newProjectSetupDialog:N,setNewProjectSetupDialog:g,saveAsDialog:ae,setSaveAsDialog:E,showColorPicker:q,setShowColorPicker:re,showWelcomeDialog:J,setShowWelcomeDialog:Y,transformImagesDialogVisible:ee,setTransformImagesDialogVisible:U}}function kw(){const[n,r]=I.useState(!1),[o,s]=I.useState(1),[l,d]=I.useState(null),[v,p]=I.useState(""),[b,m]=I.useState(""),[T,D]=I.useState(null),[M,S]=I.useState("pcb_project"),[F,_]=I.useState([]),[N,g]=I.useState(-1),ae=I.useRef(null),E=I.useRef(!1),q=I.useRef(!1);return{autoSaveEnabled:n,setAutoSaveEnabled:r,autoSaveInterval:o,setAutoSaveInterval:s,autoSaveDirHandle:l,setAutoSaveDirHandle:d,autoSaveBaseName:v,setAutoSaveBaseName:p,currentProjectFilePath:b,setCurrentProjectFilePath:m,projectDirHandle:T,setProjectDirHandle:D,projectName:M,setProjectName:S,autoSaveFileHistory:F,setAutoSaveFileHistory:_,currentFileIndex:N,setCurrentFileIndex:g,autoSaveIntervalRef:ae,hasChangesSinceLastAutoSaveRef:E,prevAutoSaveEnabledRef:q}}function Aw(){const[n,r]=I.useState(null),o=I.useRef(!1),s=I.useCallback((p,b,m,T,D)=>{if(o.current)return;const M={drawingStrokes:JSON.parse(JSON.stringify(p)),componentsTop:JSON.parse(JSON.stringify(b)),componentsBottom:JSON.parse(JSON.stringify(m)),powerSymbols:JSON.parse(JSON.stringify(T)),groundSymbols:JSON.parse(JSON.stringify(D))};r(M)},[]),l=I.useCallback(()=>{if(!n)return null;o.current=!0;const p=n;return r(null),setTimeout(()=>{o.current=!1},100),p},[n]),d=n!==null,v=I.useCallback(()=>{r(null)},[]);return{saveSnapshot:s,undo:l,canUndo:d,clearSnapshot:v}}function zw(){const r=bw(),{topImage:o,setTopImage:s,bottomImage:l,setBottomImage:d,currentView:v,setCurrentView:p,transparency:b,setTransparency:m,isTransparencyCycling:T,setIsTransparencyCycling:D,transparencyCycleSpeed:M,setTransparencyCycleSpeed:S,isGrayscale:F,setIsGrayscale:_}=r,[N,g]=I.useState("none"),[ae,E]=I.useState(()=>{const c=localStorage.getItem("bomExportFormat");return c==="json"||c==="pdf"?c:"pdf"});At.useEffect(()=>{localStorage.setItem("bomExportFormat",ae)},[ae]);const[q,re]=I.useState(()=>{const c=localStorage.getItem("netlistExportFormat");return c==="kicad"||c==="protel"||c==="spice"||c==="pads"?c:"kicad"});At.useEffect(()=>{localStorage.setItem("netlistExportFormat",q)},[q]);const J=Sw(),{brushColor:Y,setBrushColor:ee,brushSize:U,setBrushSize:$,topTraceColor:H,setTopTraceColor:R,bottomTraceColor:Z,setBottomTraceColor:G,topTraceSize:we,setTopTraceSize:te,bottomTraceSize:de,setBottomTraceSize:Ce,topPadColor:Re,setTopPadColor:xe,bottomPadColor:k,setBottomPadColor:A,topPadSize:V,setTopPadSize:W,bottomPadSize:se,setBottomPadSize:Te,topTestPointColor:le,setTopTestPointColor:_e,bottomTestPointColor:ve,setBottomTestPointColor:De,topTestPointSize:Xe,setTopTestPointSize:st,bottomTestPointSize:kt,setBottomTestPointSize:qt,topComponentColor:ye,setTopComponentColor:ut,bottomComponentColor:Gt,setBottomComponentColor:Et,topComponentSize:ht,setTopComponentSize:Qe,bottomComponentSize:$t,setBottomComponentSize:dn,componentConnectionColor:rn,setComponentConnectionColor:kn,componentConnectionSize:Fn,setComponentConnectionSize:Be,saveDefaultSize:fe,saveDefaultColor:lt}=J,it=yw(),{drawingStrokes:$e,setDrawingStrokes:at,isDrawing:Ot,setIsDrawing:Vt,currentStroke:jt,setCurrentStroke:Ft,tracePreviewMousePos:tn,setTracePreviewMousePos:ln,drawingMode:mt,setDrawingMode:cn,selectedDrawingLayer:_t,setSelectedDrawingLayer:Yt,currentStrokeRef:gn,lastTraceClickTimeRef:fn,isDoubleClickingTraceRef:bn}=it,ir=mw(),{selectedImageForTransform:Dn,setSelectedImageForTransform:Cr,isTransforming:Mr,setIsTransforming:Xt,transformStartPos:mr,setTransformStartPos:Ti,transformMode:Ln,setTransformMode:Rt}=ir,Ht=vw(),{viewScale:tt,setViewScale:Bt,viewRotation:pn,setViewRotation:An,viewFlipX:yn,setViewFlipX:$n,cameraWorldCenter:li,setCameraWorldCenter:vi,resetView:qi,isShiftConstrained:Br,setIsShiftConstrained:Ja,showBothLayers:Qa,setShowBothLayers:Ia,setCameraCenter:Go,getViewPan:Ca}=Ht,[di,To]=I.useState("top"),[Gn,gs]=I.useState("top"),[fi,Uo]=I.useState("top"),[Di,_s]=I.useState("top"),es=At.useRef("top"),ts=At.useRef("top"),ys=At.useRef("top"),Pr=At.useRef("top");At.useEffect(()=>{es.current=di},[di]),At.useEffect(()=>{ts.current=Gn},[Gn]),At.useEffect(()=>{ys.current=fi},[fi]),At.useEffect(()=>{Pr.current=Di},[Di]);const Gs=Tw({currentTool:N,drawingMode:mt,traceToolLayer:di,padToolLayer:Gn,testPointToolLayer:fi,componentToolLayer:Di}),{toolState:br}=Gs,Ii=jw(z5,N,mt,Y,U,H,Z,we,de,Re,k,V,se,le,ve,Xe,kt,ye,Gt,ht,$t,di,Gn,fi,Di),{toolRegistry:pi,setToolRegistry:dr,getCurrentToolDef:ns,updateToolSettings:Gl,updateToolLayerSettings:po}=Ii,io=At.useRef(null),Vi=At.useRef(Y),Yo=At.useRef(U);At.useEffect(()=>{dr(c=>{const x=ns(c),z=x?.id||null,B=io.current,K=new Map(c);if(B&&B!==z){const ne=c.get(B);ne&&K.set(B,{...ne,settings:{color:Vi.current,size:Yo.current}})}if(x&&z!==B)if(N==="draw"&&mt==="trace"){const ne=di||"top",P=ne==="top"?H:Z,Ne=ne==="top"?we:de;ee(P),$(Ne),Vi.current=P,Yo.current=Ne;const be=new Map(x.layerSettings);be.set("top",{color:H,size:we}),be.set("bottom",{color:Z,size:de}),K.set("trace",{...x,settings:{color:P,size:Ne},layerSettings:be})}else if(N==="draw"&&mt==="pad"){const ne=Gn||"top",P=ne==="top"?Re:k,Ne=ne==="top"?V:se;ee(P),$(Ne),Vi.current=P,Yo.current=Ne;const be=new Map(x.layerSettings);be.set("top",{color:Re,size:V}),be.set("bottom",{color:k,size:se}),K.set("pad",{...x,settings:{color:P,size:Ne},layerSettings:be})}else if(N==="draw"&&mt==="testPoint"){const ne=fi||"top",P=ne==="top"?le:ve,Ne=ne==="top"?Xe:kt;ee(P),$(Ne),Vi.current=P,Yo.current=Ne;const be=new Map(x.layerSettings);be.set("top",{color:le,size:Xe}),be.set("bottom",{color:ve,size:kt}),K.set("testPoint",{...x,settings:{color:P,size:Ne},layerSettings:be})}else if(N==="component"){const ne=Di||"top",P=ne==="top"?ye:Gt,Ne=ne==="top"?ht:$t;ee(P),$(Ne),Vi.current=P,Yo.current=Ne;const be=new Map(x.layerSettings);be.set("top",{color:ye,size:ht}),be.set("bottom",{color:Gt,size:$t}),K.set("component",{...x,settings:{color:P,size:Ne},layerSettings:be})}else{const ne=x.settings;ee(ne.color),$(ne.size),Vi.current=ne.color,Yo.current=ne.size}return io.current=z,K})},[N,mt,ns,H,Z,we,de,Re,k,V,se,le,ve,Xe,kt,fi,ye,Gt,ht,$t]),At.useEffect(()=>{const c=pi.get("trace");if(c){const K=c.layerSettings.get("top"),ne=c.layerSettings.get("bottom");K&&(R(K.color),te(K.size)),ne&&(G(ne.color),Ce(ne.size))}const x=pi.get("pad");if(x){const K=x.layerSettings.get("top"),ne=x.layerSettings.get("bottom");K&&(xe(K.color),W(K.size)),ne&&(A(ne.color),Te(ne.size))}const z=pi.get("testPoint");if(z){const K=z.layerSettings.get("top"),ne=z.layerSettings.get("bottom");K&&(_e(K.color),st(K.size)),ne&&(De(ne.color),qt(ne.size))}const B=pi.get("component");if(B){const K=B.layerSettings.get("top"),ne=B.layerSettings.get("bottom");K&&(ut(K.color),Qe(K.size)),ne&&(Et(ne.color),dn(ne.size))}},[]),At.useEffect(()=>{dr(c=>{const x=new Map(c),z=c.get("trace");if(z){const Ne=new Map(z.layerSettings);Ne.set("top",{color:H,size:we}),Ne.set("bottom",{color:Z,size:de}),x.set("trace",{...z,layerSettings:Ne})}const B=c.get("pad");if(B){const Ne=new Map(B.layerSettings);Ne.set("top",{color:Re,size:V}),Ne.set("bottom",{color:k,size:se}),x.set("pad",{...B,layerSettings:Ne})}const K=c.get("testPoint");if(K){const Ne=new Map(K.layerSettings);Ne.set("top",{color:le,size:Xe}),Ne.set("bottom",{color:ve,size:kt}),x.set("testPoint",{...K,layerSettings:Ne})}const ne=c.get("component");if(ne){const Ne=new Map(ne.layerSettings);Ne.set("top",{color:ye,size:ht}),Ne.set("bottom",{color:Gt,size:$t}),x.set("component",{...ne,layerSettings:Ne})}const P=c.get("componentConnection");return P&&x.set("componentConnection",{...P,settings:{color:rn,size:Fn}}),x})},[H,Z,we,de,Re,k,V,se,le,ve,Xe,kt,ye,Gt,ht,$t,rn,Fn,dr]),At.useEffect(()=>{dr(c=>{const x=ns(c);if(x)if(N==="draw"&&mt==="trace"){const z=di||"top",B=z==="top"?"traceTop":"traceBottom",K=Un.get(B),ne=K.color,P=K.size;z==="top"?(R(ne),te(P),lt("trace",ne,"top"),fe("trace",P,"top")):(G(ne),Ce(P),lt("trace",ne,"bottom"),fe("trace",P,"bottom"));const Ne=new Map(c),be=new Map(x.layerSettings);return be.set(z,{color:ne,size:P}),Ne.set(x.id,{...x,layerSettings:be,settings:{color:ne,size:P}}),Vi.current=ne,Yo.current=P,Ne}else if(N==="draw"&&mt==="pad"){const z=Gn||"top",B=z==="top"?"padTop":"padBottom",K=Un.get(B),ne=K.color,P=K.size;z==="top"?(xe(ne),W(P),lt("pad",ne,"top"),fe("pad",P,"top")):(A(ne),Te(P),lt("pad",ne,"bottom"),fe("pad",P,"bottom"));const Ne=new Map(c),be=new Map(x.layerSettings);return be.set(z,{color:ne,size:P}),Ne.set(x.id,{...x,layerSettings:be,settings:{color:ne,size:P}}),Vi.current=ne,Yo.current=P,Ne}else if(N==="draw"&&mt==="testPoint"){const z=fi||"top",B=z==="top"?"testPointTop":"testPointBottom",K=Un.get(B),ne=K.color,P=K.size;z==="top"?(_e(ne),st(P),lt("testPoint",ne,"top"),fe("testPoint",P,"top")):(De(ne),qt(P),lt("testPoint",ne,"bottom"),fe("testPoint",P,"bottom"));const Ne=new Map(c),be=new Map(x.layerSettings);return be.set(z,{color:ne,size:P}),Ne.set(x.id,{...x,layerSettings:be,settings:{color:ne,size:P}}),Vi.current=ne,Yo.current=P,Ne}else if(N==="component"){const z=Di||"top",B=z==="top"?"componentTop":"componentBottom",K=Un.get(B),ne=K.color,P=K.size;z==="top"?(ut(ne),Qe(P),lt("component",ne,"top"),fe("component",P,"top")):(Et(ne),dn(P),lt("component",ne,"bottom"),fe("component",P,"bottom"));const Ne=new Map(c),be=new Map(x.layerSettings);return be.set(z,{color:ne,size:P}),Ne.set(x.id,{...x,layerSettings:be,settings:{color:ne,size:P}}),Vi.current=ne,Yo.current=P,Ne}else{const z=new Map(c);return z.set(x.id,{...x,settings:{color:Y,size:U}}),Vi.current=Y,Yo.current=U,z}return c})},[Y,U,N,mt,di,Gn,fi,Di,ns,lt,fe,Yd,R,G,te,Ce,xe,A,W,Te,_e,De,st,qt,ut,Et,Qe,dn]),At.useEffect(()=>{if(N==="draw"&&mt==="trace"){const c=di;Yt(c),ee(c==="top"?H:Z),$(c==="top"?we:de),c==="top"?(Er(!0),ds(!0)):(bo(!0),Li(!0)),Rl(!0)}else Rl(!1)},[N,mt,di,H,Z,we,de]),At.useEffect(()=>{if(N==="draw"&&mt==="pad"){const c=Gn;Yt(c);const x=Un.get(c==="top"?"padTop":"padBottom");ee(x.color),$(x.size),c==="top"?(Er(!0),oa(!0)):(bo(!0),va(!0)),Su(!0)}else Su(!1)},[N,mt,Gn]),At.useEffect(()=>{if(N==="draw"&&mt==="testPoint"){const c=fi;Yt(c),ee(c==="top"?le:ve),$(c==="top"?Xe:kt),c==="top"?(Er(!0),y(!0)):(bo(!0),L(!0)),Sc(!0)}else Sc(!1)},[N,mt,fi,le,ve,Xe,kt]);const[Yl,ca]=I.useState(!1),[fr,Xl]=I.useState(!1);At.useEffect(()=>{if(N==="component"){const c=Di;Yt(c),ee(c==="top"?ye:Gt),$(c==="top"?ht:$t),c==="top"?(Er(!0),ie(!0)):(bo(!0),ce(!0)),Yl||Td(!0)}else Td(!1),ca(!1)},[N,Di,ye,Gt,ht,$t,Yl]),At.useEffect(()=>{if(N==="component"){const c=Di;Yt(c),ee(c==="top"?ye:Gt),$(c==="top"?ht:$t)}},[Di,N,ye,Gt,ht,$t]),At.useEffect(()=>{br.toolInstanceId&&(ee(br.color),$(br.size))},[br.toolInstanceId,br.color,br.size,ee,$,N,mt]);const[Or,ki]=I.useState(void 0),[,rl]=I.useState([]),[,Ma]=I.useState([]),[,Fo]=I.useState([]),[,xs]=I.useState([]),[Na,Xo]=I.useState([]),[$r,pr]=I.useState([]),[ms,Ba]=I.useState([]),[Ys,zn]=I.useState([]),Tt=I.useRef(null),Qn=At.useMemo(()=>{const c=Tt.current;if(!c)return{x:0,y:0};const x=(c.width-10)/2,z=(c.height-10)/2;return Ca(x,z)},[Tt.current?.width,Tt.current?.height,li,tt,Ca]),Oa=At.useCallback(c=>{const x=Tt.current;if(!x)return;const z=(x.width-10)/2,B=(x.height-10)/2,K=Ca(z,B),ne=typeof c=="function"?c(K):c,P=(z-ne.x)/tt,Ne=(B-ne.y)/tt;vi({x:P,y:Ne})},[Ca,tt,vi]),ua=xw(),{selectedIds:vn,setSelectedIds:jn,isSelecting:ol,setIsSelecting:Eo,selectedComponentIds:En,setSelectedComponentIds:mn,selectedPowerIds:Ai,setSelectedPowerIds:xn,selectedGroundIds:wi,setSelectedGroundIds:Tn}=ua,Ko=T2(),{componentsTop:Jt,setComponentsTop:ri,componentsBottom:Qt,setComponentsBottom:Si,componentEditor:Ua,setComponentEditor:Fa,connectingPin:ro,setConnectingPin:ka,componentDialogPosition:bs,setComponentDialogPosition:is,isDraggingDialog:Xs,setIsDraggingDialog:Zc,dialogDragOffset:vs,setDialogDragOffset:Jc,openComponentEditor:j}=Ko,Q=ww(),{powerBuses:pe,setPowerBuses:Me,groundBuses:qe,setGroundBuses:xt,powerSymbols:vt,setPowerSymbols:Wt,groundSymbols:Zt,setGroundSymbols:on,powerEditor:qn,setPowerEditor:ci}=Q,Gr=Aw(),{saveSnapshot:Mi,undo:vr,clearSnapshot:wr}=Gr;At.useEffect(()=>{N==="power"?(_i(!1),pe.length>1?en&&pe.some(x=>x.id===en)?Sn(!1):(Sn(!0),en!==null&&hi(null)):pe.length===1?(hi(pe[0].id),Sn(!1)):(Sn(!0),hi(null))):Sn(!1)},[N,pe]),At.useEffect(()=>{N==="ground"?(Sn(!1),qe.length>1?ur&&qe.some(x=>x.id===ur)?_i(!1):(_i(!0),ur!==null&&$i(null)):qe.length===1?($i(qe[0].id),_i(!1)):(_i(!0),$i(null))):_i(!1)},[N,qe]),At.useEffect(()=>{N!=="power"&&N!=="ground"&&(Sn(!1),_i(!1))},[N]);const Co=Cw(),{areImagesLocked:Ki,setAreImagesLocked:da,areViasLocked:Nr,setAreViasLocked:fa,arePadsLocked:pa,setArePadsLocked:ws,areTestPointsLocked:Zo,setAreTestPointsLocked:Aa,areTracesLocked:oo,setAreTracesLocked:ha,areComponentsLocked:Hi,setAreComponentsLocked:za,areGroundNodesLocked:ho,setAreGroundNodesLocked:rs,arePowerNodesLocked:Wi,setArePowerNodesLocked:Yr}=Co,wl=Nw(),{openMenu:Dc,setOpenMenu:Ds,setSizeDialog:Pa,setSetSizeDialog:os,autoSaveDialog:Ks,setAutoSaveDialog:No,autoSavePromptDialog:as,setAutoSavePromptDialog:ao,debugDialog:qo,setDebugDialog:Ur,errorDialog:Rs,setErrorDialog:Jo,newProjectDialog:Zs,setNewProjectDialog:Ea,setOpenProjectDialog:Kl,newProjectSetupDialog:ei,setNewProjectSetupDialog:Ss,saveAsDialog:Bi,setSaveAsDialog:Qo,showColorPicker:Vo,setShowColorPicker:ga,transformImagesDialogVisible:Rc,setTransformImagesDialogVisible:Js}=wl,Sl=kw(),[jl,go]=I.useState(!1),[Tl,Ho]=I.useState(!1),[qa,rr]=I.useState(!1),[ss,Ri]=I.useState(null),[Oi,or]=I.useState(null),[yo,ls]=I.useState(null),[Qs,xc]=I.useState(null),[Qc,qu]=I.useState(null),{autoSaveEnabled:Va,setAutoSaveEnabled:so,autoSaveInterval:Cl,setAutoSaveInterval:ko,autoSaveDirHandle:Ls,setAutoSaveDirHandle:xo,autoSaveBaseName:Ao,setAutoSaveBaseName:Xr,currentProjectFilePath:ya,setCurrentProjectFilePath:Zi,projectDirHandle:oi,setProjectDirHandle:kr,projectName:Kr,setProjectName:zo,autoSaveFileHistory:al,setAutoSaveFileHistory:Ha,currentFileIndex:ea,setCurrentFileIndex:Fr,autoSaveIntervalRef:zi,hasChangesSinceLastAutoSaveRef:Ci,prevAutoSaveEnabledRef:Lc}=Sl,lr=I.useRef(Ls),Zr=I.useRef(Ao),sl=I.useRef(ya),Jr=I.useRef([]),cs=I.useRef(-1),ta=I.useRef(null),ll=I.useRef(!1);At.useEffect(()=>{lr.current=Ls},[Ls]),At.useEffect(()=>{Zr.current=Ao},[Ao]),At.useEffect(()=>{sl.current=ya},[ya]),At.useEffect(()=>{Jr.current=al},[al]),At.useEffect(()=>{cs.current=ea},[ea]),At.useEffect(()=>{ll.current||(ta.current=oi)},[oi]);const eu=I.useRef(null),js=I.useRef(null),us=I.useRef(null),cl=I.useRef(null),Ic=I.useRef(null),Nl=I.useRef(null),Ts=I.useRef(null),[na,Wa]=I.useState(!1),mo=I.useRef(null),Po=I.useRef(null),[_a,tu]=I.useState(!1),[kl,Cs]=I.useState({}),[Vu,cr]=I.useState(!1),Ar=I.useCallback(()=>{const c=Tt.current;if(!c)return null;const x=c.width-10,z=c.height-10;let B=1/0,K=1/0,ne=-1/0,P=-1/0,Ne=!1;if(o){const Oe=o,Ue=(Oe.width||0)/2,Ze=(Oe.height||0)/2;B=Math.min(B,Oe.x-Ue),K=Math.min(K,Oe.y-Ze),ne=Math.max(ne,Oe.x+Ue),P=Math.max(P,Oe.y+Ze),Ne=!0}if(l){const Oe=l,Ue=(Oe.width||0)/2,Ze=(Oe.height||0)/2;B=Math.min(B,Oe.x-Ue),K=Math.min(K,Oe.y-Ze),ne=Math.max(ne,Oe.x+Ue),P=Math.max(P,Oe.y+Ze),Ne=!0}if(!Ne)return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:1,viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0};const be=ne-B,Le=P-K,Ie=.1,Ae=be*(1+2*Ie),ge=Le*(1+2*Ie),me=Ae>0?x/Ae:1,Se=ge>0?z/ge:1;return{pcbReferenceX:0,pcbReferenceY:0,x:0,y:0,zoom:Math.min(me,Se,1),viewRotation:0,viewFlipX:!1,isBottomView:!1,transparency:0,showTopImage:!0,showBottomImage:!0,showViasLayer:!0,showTopTracesLayer:!0,showBottomTracesLayer:!0,showTopPadsLayer:!0,showBottomPadsLayer:!0,showTopTestPointsLayer:!0,showBottomTestPointsLayer:!0,showTopComponents:!0,showBottomComponents:!0,showPowerLayer:!0,showGroundLayer:!0,showConnectionsLayer:!0}},[o,l]);At.useEffect(()=>{const c=Ar();c&&Cs(x=>x[0]?x:{...x,0:c})},[o,l,Ar]);const Vn=I.useRef(null),[ia,Qr]=I.useState(!1),[xa,ma]=I.useState(null),[Mc,ba]=I.useState(null),[_r,mc]=I.useState({width:960,height:600}),yu=I.useRef(null),Bc=I.useRef(null),xu=I.useRef(null),ul=I.useRef(null),el=I.useRef(null),Al=I.useRef(null),Ns=I.useRef(null),[ks,Er]=I.useState(!0),[$a,bo]=I.useState(!0),[Zl,ra]=I.useState(!1),[vo,Ga]=I.useState(!0),[Da,ds]=I.useState(!0),[Ra,Li]=I.useState(!0),[_o,oa]=I.useState(!0),[Wo,va]=I.useState(!0),[f,y]=I.useState(!0),[C,L]=I.useState(!0),[X,ie]=I.useState(!0),[oe,ce]=I.useState(!0),[he,je]=I.useState(!0),Pe=vt,Ee=Zt,[ke,He]=I.useState(!1),[Je,bt]=I.useState(null),[et,yt]=I.useState(!1),[wt,It]=I.useState(void 0),[zt,wn]=I.useState(!1),[un,Sn]=I.useState(!1),[en,hi]=I.useState(null),[zr,Pn]=I.useState(new Set),Ut=I.useCallback(()=>{jn(new Set),mn(new Set),xn(new Set),Tn(new Set),Pn(new Set)},[jn,mn,xn,Tn,Pn]),[Kt,ar]=I.useState(!1),[Xn,gi]=I.useState(null),[Ji,_i]=I.useState(!1),[ur,$i]=I.useState(null),[Dr,eo]=I.useState(!0),[Sr,ii]=I.useState(!1),[Gi,hr]=I.useState(!1),ai=I.useRef({}),[Qi,ji]=I.useState(!0),[yi,Yi]=I.useState(!0),[Ui,Rr]=I.useState(!0),[lo,jr]=I.useState(!1),[si,Do]=I.useState(null),[qr,Bn]=I.useState(!1),[In,Fi]=I.useState(null),[La,co]=I.useState(!1),[Ro,to]=I.useState(null),[dl,zl]=I.useState(!1),[bc,Tr]=I.useState(null),[vc,fl]=I.useState([]),[Oc,Ya]=I.useState({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),[Hu,pl]=I.useState(!1),[Jl,Ql]=I.useState(null),[Lo,Vr]=I.useState(!1),[ec,hl]=I.useState(null),[tc,nc]=I.useState(!1),[Xa,ic]=I.useState(null),[rc,Uc]=I.useState(!1),[wc,tl]=I.useState(null),[Wu,gl]=I.useState(!1),[mu,oc]=I.useState(!1),[Pl,$u]=I.useState(null),[nu,Gu]=I.useState(!1),[ac,bu]=I.useState(null),[sc,iu]=I.useState(!1),lc=I.useRef(null),As=I.useRef(!1),fs=I.useRef(null),Is=I.useRef(!1),cc=I.useRef(!1);At.useEffect(()=>{lc.current=Pl},[Pl]),At.useEffect(()=>{As.current=nu},[nu]),At.useEffect(()=>{fs.current=ac},[ac]),At.useEffect(()=>{Is.current=sc},[sc]),At.useEffect(()=>{cc.current=mu},[mu]);const[vu,Ms]=I.useState(null),[vd,Bs]=I.useState(!1);At.useEffect(()=>{pe.length===0&&Me([{id:"default-3v3",name:"+3.3V",voltage:"+3.3VDC",color:"#ff6600"},{id:"default-5v",name:"+5V",voltage:"+5VDC",color:"#ff0000"}])},[pe.length,Me]);const Ka=I.useCallback((c,x)=>{const z=Pe.find(K=>K.pointId===c);if(z){const K=x.find(P=>P.id===z.powerBusId);return`Via (${K?K.voltage:z.type||"Power Node"})`}const B=Ee.find(K=>K.pointId===c);return B?`Via (${B.type||"Ground"})`:"Via"},[Pe,Ee]),_l=I.useCallback((c,x)=>{const z=Pe.find(K=>K.pointId===c);if(z){const K=x.find(P=>P.id===z.powerBusId);return`Pad (${K?K.voltage:z.type||"Power Node"})`}const B=Ee.find(K=>K.pointId===c);return B?`Pad (${B.type||"Ground"})`:"Pad"},[Pe,Ee]),yl=I.useCallback((c,x)=>{const z=Pe.find(K=>K.pointId===c);if(z){const K=x.find(P=>P.id===z.powerBusId);return`Test Point (${K?K.voltage:z.type||"Power Node"})`}const B=Ee.find(K=>K.pointId===c);return B?`Test Point (${B.type||"Ground"})`:"Test Point"},[Pe,Ee]),mh=I.useCallback(()=>{const c=$e.filter(x=>x.type==="via").map(x=>x.id);jn(new Set(c)),mn(new Set),xn(new Set),Tn(new Set),Pn(new Set)},[$e,jn,mn,xn,Tn]),Zf=I.useCallback(()=>{const c=$e.filter(x=>x.type==="trace").map(x=>x.id);jn(new Set(c)),mn(new Set),xn(new Set),Tn(new Set),Pn(new Set)},[$e,jn,mn,xn,Tn]),Jf=I.useCallback(()=>{const c=$e.filter(x=>x.type==="pad").map(x=>x.id);jn(new Set(c)),mn(new Set),xn(new Set),Tn(new Set),Pn(new Set)},[$e,jn,mn,xn,Tn]),Qf=I.useCallback(()=>{const c=[...Jt,...Qt].map(x=>x.id);mn(new Set(c)),jn(new Set),xn(new Set),Tn(new Set),Pn(new Set)},[Jt,Qt,mn,jn,xn,Tn]),ep=I.useCallback(()=>{const c=[...Jt,...Qt].filter(x=>{const z=x.pinConnections||[];return!(z.length>0&&z.length===x.pinCount&&z.every(K=>K&&K.trim()!==""))}).map(x=>x.id);mn(new Set(c)),jn(new Set),xn(new Set),Tn(new Set),Pn(new Set),Ur({visible:!0,text:""})},[Jt,Qt,mn,jn,xn,Tn,Ur]),tp=I.useCallback(()=>{const c=new Set;let x=0;for(const z of[...Jt,...Qt]){const B=z.pinConnections||[];for(const K of B)if(K&&K.trim()!==""){const ne=parseInt(K.trim(),10);if(!isNaN(ne)&&ne>0){const P=`${z.id}:${ne}`;c.add(P),x++}}}if(console.log(`Component connections: ${x} connection lines found`),c.size===0){console.log("No component connections found - components may not have pins connected"),alert("No component connections found. Please connect component pins to vias or pads first.");return}Pn(c),jn(new Set),mn(new Set),xn(new Set),Tn(new Set),console.log(`Selected ${c.size} component connection lines`)},[Jt,Qt,jn,mn,xn,Tn]),wd=I.useCallback(()=>{qa?($n(!1),rr(!1),m(0)):($n(!0),rr(!0),m(100))},[qa,$n,rr,m]),rf=I.useCallback(c=>{An(x=>Lg(x,c))},[An]),Dl=I.useCallback((c,x)=>{const z=Tt.current;if(!z)return;const B=z.width-10,K=z.height-10,ne=B/2,P=K/2,Ne=ne-c*tt,be=P-x*tt;Oa({x:Ne,y:be})},[tt,Oa]),Sd=I.useCallback((c,x,z)=>{Dl(x,z),mn(new Set([c])),jn(new Set),xn(new Set),Tn(new Set),Pn(new Set)},[Dl,mn,jn,xn,Tn]),np=I.useCallback((c,x,z)=>{Dl(x,z),jn(new Set([c])),mn(new Set),xn(new Set),Tn(new Set),Pn(new Set)},[Dl,jn,mn,xn,Tn]),ip=I.useCallback((c,x,z)=>{Dl(x,z),xn(new Set([c])),jn(new Set),mn(new Set),Tn(new Set),Pn(new Set)},[Dl,xn,jn,mn,Tn]),bh=I.useCallback((c,x,z)=>{Dl(x,z),Tn(new Set([c])),jn(new Set),mn(new Set),xn(new Set),Pn(new Set)},[Dl,Tn,jn,mn,xn]),of=I.useCallback((c,x,z)=>{Dl(x,z),jn(new Set([c])),mn(new Set),xn(new Set),Tn(new Set),Pn(new Set)},[Dl,jn,mn,xn,Tn]),rp=At.useMemo(()=>{const c=new Set(Pe.map(z=>z.powerBusId).filter(z=>typeof z=="string"&&z.length>0)),x=pe.filter(z=>c.has(z.id)).map(z=>z.name);return Array.from(new Set(x)).sort()},[Pe,pe]),op=At.useMemo(()=>{const c=new Set(Ee.map(z=>z.groundBusId).filter(z=>typeof z=="string"&&z.length>0)),x=qe.filter(z=>c.has(z.id)).map(z=>z.name);return Array.from(new Set(x)).sort()},[Ee,qe]),af=I.useCallback(()=>{const c=Pe.map(x=>x.id);xn(new Set(c)),jn(new Set),mn(new Set),Tn(new Set),Pn(new Set)},[Pe,xn,jn,mn,Tn]),ap=I.useCallback(()=>{const c=Ee.map(x=>x.id);Tn(new Set(c)),jn(new Set),mn(new Set),xn(new Set),Pn(new Set)},[Ee,Tn,jn,mn,xn]),sp=I.useCallback(c=>{const x=pe.filter(B=>B.name===c).map(B=>B.id);if(x.length===0)return;const z=Pe.filter(B=>B.powerBusId&&x.includes(B.powerBusId)).map(B=>B.id);xn(new Set(z)),jn(new Set),mn(new Set),Tn(new Set)},[pe,Pe,xn,jn,mn,Tn]),vh=I.useCallback(c=>{const x=qe.filter(B=>B.name===c).map(B=>B.id);if(x.length===0)return;const z=Ee.filter(B=>B.groundBusId&&x.includes(B.groundBusId)).map(B=>B.id);Tn(new Set(z)),jn(new Set),mn(new Set),xn(new Set)},[qe,Ee,Tn,jn,mn,xn]);I.useCallback(c=>{switch(c.componentType){case"Resistor":case"ResistorNetwork":case"Thermistor":case"VariableResistor":if("resistance"in c&&c.resistance&&"resistanceUnit"in c&&c.resistanceUnit)return`${c.resistance} ${c.resistanceUnit}`;break;case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":if("capacitance"in c&&c.capacitance&&"capacitanceUnit"in c&&c.capacitanceUnit)return`${c.capacitance} ${c.capacitanceUnit}`;break;case"Inductor":if("inductance"in c&&c.inductance&&"inductanceUnit"in c&&c.inductanceUnit)return`${c.inductance} ${c.inductanceUnit}`;break;case"Battery":if("voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit)return`${c.voltage} ${c.voltageUnit}`;break;case"Diode":if("voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit)return`${c.voltage} ${c.voltageUnit}`;break;case"Fuse":if("current"in c&&c.current&&"currentUnit"in c&&c.currentUnit)return`${c.current} ${c.currentUnit}`;break;case"FerriteBead":if("impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit)return`${c.impedance} ${c.impedanceUnit}`;break;case"Relay":if("coilVoltage"in c&&c.coilVoltage&&"coilVoltageUnit"in c&&c.coilVoltageUnit)return`${c.coilVoltage} ${c.coilVoltageUnit}`;break;case"Speaker":if("impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit)return`${c.impedance} ${c.impedanceUnit}`;break;case"Motor":if("voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit)return`${c.voltage} ${c.voltageUnit}`;break;case"PowerSupply":if("outputVoltage"in c&&c.outputVoltage&&"outputVoltageUnit"in c&&c.outputVoltageUnit)return`${c.outputVoltage} ${c.outputVoltageUnit}`;break;case"Transistor":if("partNumber"in c&&c.partNumber)return c.partNumber;break;case"IntegratedCircuit":if("partNumber"in c&&c.partNumber)return c.partNumber;break}return null},[]);const wh=I.useCallback(c=>{const x=[];switch(c.componentType){case"Capacitor":case"Electrolytic Capacitor":case"Film Capacitor":"capacitance"in c&&c.capacitance&&"capacitanceUnit"in c&&c.capacitanceUnit&&x.push(`Capacitance: ${c.capacitance} ${c.capacitanceUnit}`),"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&x.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"dielectric"in c&&c.dielectric&&x.push(`Dielectric: ${c.dielectric}`);break;case"Resistor":case"ResistorNetwork":case"Thermistor":"resistance"in c&&c.resistance&&"resistanceUnit"in c&&c.resistanceUnit&&x.push(`Resistance: ${c.resistance} ${c.resistanceUnit}`),"power"in c&&c.power&&x.push(`Power: ${c.power}`),"tolerance"in c&&c.tolerance&&x.push(`Tolerance: ${c.tolerance}`);break;case"VariableResistor":"resistance"in c&&c.resistance&&"resistanceUnit"in c&&c.resistanceUnit&&x.push(`Resistance: ${c.resistance} ${c.resistanceUnit}`),"vrType"in c&&c.vrType&&x.push(`Type: ${c.vrType}`),"power"in c&&c.power&&x.push(`Power: ${c.power}`),"taper"in c&&c.taper&&x.push(`Taper: ${c.taper}`);break;case"Inductor":"inductance"in c&&c.inductance&&"inductanceUnit"in c&&c.inductanceUnit&&x.push(`Inductance: ${c.inductance} ${c.inductanceUnit}`),"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&x.push(`Current: ${c.current} ${c.currentUnit}`),"tolerance"in c&&c.tolerance&&x.push(`Tolerance: ${c.tolerance}`);break;case"Battery":"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&x.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"capacity"in c&&c.capacity&&"capacityUnit"in c&&c.capacityUnit&&x.push(`Capacity: ${c.capacity} ${c.capacityUnit}`);break;case"Diode":"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&x.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&x.push(`Current: ${c.current} ${c.currentUnit}`);break;case"Fuse":"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&x.push(`Current: ${c.current} ${c.currentUnit}`),"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&x.push(`Voltage: ${c.voltage} ${c.voltageUnit}`);break;case"FerriteBead":"impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit&&x.push(`Impedance: ${c.impedance} ${c.impedanceUnit}`),"current"in c&&c.current&&"currentUnit"in c&&c.currentUnit&&x.push(`Current: ${c.current} ${c.currentUnit}`);break;case"Relay":"coilVoltage"in c&&c.coilVoltage&&"coilVoltageUnit"in c&&c.coilVoltageUnit&&x.push(`Coil Voltage: ${c.coilVoltage} ${c.coilVoltageUnit}`),"contactRating"in c&&c.contactRating&&x.push(`Contact Rating: ${c.contactRating}`);break;case"Speaker":"impedance"in c&&c.impedance&&"impedanceUnit"in c&&c.impedanceUnit&&x.push(`Impedance: ${c.impedance} ${c.impedanceUnit}`),"power"in c&&c.power&&x.push(`Power: ${c.power}`);break;case"Motor":"voltage"in c&&c.voltage&&"voltageUnit"in c&&c.voltageUnit&&x.push(`Voltage: ${c.voltage} ${c.voltageUnit}`),"speed"in c&&c.speed&&"speedUnit"in c&&c.speedUnit&&x.push(`Speed: ${c.speed} ${c.speedUnit}`);break;case"PowerSupply":"outputVoltage"in c&&c.outputVoltage&&"outputVoltageUnit"in c&&c.outputVoltageUnit&&x.push(`Output Voltage: ${c.outputVoltage} ${c.outputVoltageUnit}`),"outputCurrent"in c&&c.outputCurrent&&"outputCurrentUnit"in c&&c.outputCurrentUnit&&x.push(`Output Current: ${c.outputCurrent} ${c.outputCurrentUnit}`);break;case"Transistor":"partNumber"in c&&c.partNumber&&x.push(`Part Number: ${c.partNumber}`),"transistorType"in c&&c.transistorType&&x.push(`Type: ${c.transistorType}`);break;case"Crystal":"frequency"in c&&c.frequency&&x.push(`Frequency: ${c.frequency}`),"loadCapacitance"in c&&c.loadCapacitance&&x.push(`Load Capacitance: ${c.loadCapacitance}`),"tolerance"in c&&c.tolerance&&x.push(`Tolerance: ${c.tolerance}`);break;case"VacuumTube":"tubeType"in c&&c.tubeType&&x.push(`Tube Type: ${c.tubeType}`),"partNumber"in c&&c.partNumber&&x.push(`Part Number: ${c.partNumber}`);break}return x},[]),[wu,Rl]=I.useState(!1),Fc=I.useRef(null),[ru,Su]=I.useState(!1),[jd,Sc]=I.useState(!1),ju=I.useRef(null),ou=I.useRef(null),Yu=I.useRef(null),Tu=I.useRef(null),[sf,Td]=I.useState(!1),[Ll,jc]=I.useState(null),[lp,cp]=I.useState(null),[Tc,Cd]=I.useState(null),Nd=At.useRef(null),kd=At.useRef(null),Ad=At.useRef(null),Xu=I.useRef(null),zd=I.useRef(null),Cu=I.useRef(null),aa=I.useRef(null),wa=I.useRef(null),Pd=I.useRef(null),[up,dp]=I.useState(null),[Os,Ku]=I.useState(null),[Il,Zu]=I.useState(!1),[au,fp]=I.useState(null),[Ml,Ju]=I.useState(null);At.useEffect(()=>{kd.current=Tc},[Tc]),At.useEffect(()=>{Ad.current=Ll},[Ll]);const lf=I.useCallback(async(c,x)=>{if(!x)throw new Error("No project directory available. Please create or open a project before loading images. The project directory is needed to store image files.");try{let z;try{z=await x.getDirectoryHandle("images",{create:!0})}catch(ne){throw new Error(`Failed to create images directory in project folder. This may be due to insufficient permissions. Please ensure you have write access to the project directory. Error details: ${ne.message}`)}const B=c.name,K=`images/${B}`;try{const P=await(await z.getFileHandle(B,{create:!0})).createWritable();return await P.write(c),await P.close(),console.log(`Image copied to project directory: ${K}`),K}catch(ne){throw new Error(`Failed to copy image file "${B}" to project images directory. The file may be locked by another application, or there may be insufficient disk space. Please try again or check your disk space. Error details: ${ne.message}`)}}catch(z){throw z instanceof Error&&z.message.includes("No project directory")||z instanceof Error&&z.message.includes("Failed to")?z:new Error(`An unexpected error occurred while copying the image to the project directory. This may be due to file system permissions or disk space issues. Please try again. Technical details: ${z.message}`)}},[]),cf=I.useCallback(async(c,x)=>{try{const z=c.name.toLowerCase(),K=[".png",".jpg",".jpeg"].some(Se=>z.endsWith(Se)),P=["image/png","image/jpeg","image/jpg"].includes(c.type);if(!K&&!P){alert(`Error: Unsupported image format.

The software only accepts PNG and JPEG image files.

File selected: ${c.name}
File type: ${c.type||"unknown"}

Please select a .png, .jpg, or .jpeg image file.`);return}let Ne;if(oi)try{Ne=await lf(c,oi)}catch(Se){const ze=Se instanceof Error?Se.message:"Unknown error occurred while copying image to project directory.";alert(`Error: ${ze}

The image could not be loaded. Please ensure you have a project open and have write permissions to the project directory.`);return}else{if(!confirm(`Warning: No project directory is currently open. The image will be loaded, but you must create or open a project and save it before the image will be stored in the project directory.

Do you want to continue loading the ${x==="top"?"top":"bottom"} image?`))return;Ne=c.name}const be=await createImageBitmap(c),Le=URL.createObjectURL(c),Ie=Tt.current;let Ae=0,ge=0;Ie&&(Ae=li.x,ge=li.y);const me={url:Le,name:c.name,width:be.width,height:be.height,filePath:Ne,x:Ae,y:ge,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,bitmap:be};x==="top"?s(me):d(me)}catch(z){const B=z instanceof Error?z.message:"Unknown error occurred while loading the image.";alert(`Error: Failed to load image file "${c.name}".

${B}

Please ensure the file is a valid image format (PNG, JPEG, etc.) and is not corrupted.`),console.error("Failed to load image",z)}},[li,tt,oi,lf]),pp=I.useCallback(c=>{c.stopPropagation(),c.preventDefault();const x=Tt.current;if(!x)return;document.activeElement!==x&&x.focus();const z=x.getBoundingClientRect(),B=x.width/z.width,K=x.height/z.height,ne=c.nativeEvent.offsetX,P=c.nativeEvent.offsetY,Ne=typeof ne=="number"?ne:c.clientX-z.left,be=typeof P=="number"?P:c.clientY-z.top,Le=Ne*B,Ie=be*K,Ae=Le-5,ge=Ie-5,me=Of(Ae,ge,Qn,tt,pn,yn),Se=me.x,ze=me.y;if(As.current&&N==="select"){iu(!0),bu({start:{x:Se,y:ze},end:{x:Se,y:ze}});return}if(N==="center"){cr(!0),Vn.current&&clearTimeout(Vn.current),Vn.current=setTimeout(()=>{cr(!1),g("select"),ki(void 0)},2e3);return}if(N==="select"){if(ro){let Ve=1/0,ct=null,gt=null;const Mt=Math.max(6/tt,4),_n=[...Jt,...Qt].find(ti=>ti.id===ro.componentId)?.layer||"top";for(const ti of $e)if((ti.type==="via"||ti.type==="pad")&&ti.points.length>0){if(ti.type==="pad"&&(ti.layer||"top")!==_n)continue;const Hn=ti.points[0],Kn=Math.max(1,ti.size/2),Zn=Math.hypot(Hn.x-Se,Hn.y-ze),On=Math.max(Kn,Mt);Zn<=On&&Zn<Ve&&(Ve=Zn,ct=Hn.id??null,gt=ti)}if(gt?(console.log(`
[PIN CONNECTION] Found via!`),console.log(`  Stroke ID: ${gt.id}`),console.log(`  Point ID: ${ct}`),console.log(`  Point coordinates: x=${gt.points[0].x.toFixed(2)}, y=${gt.points[0].y.toFixed(2)}`),console.log(`  Click coordinates: x=${Se.toFixed(2)}, y=${ze.toFixed(2)}`),console.log(`  Distance: ${Ve.toFixed(2)}`),console.log(`  Via size: ${gt.size}, radius: ${Math.max(1,gt.size/2)}`)):(console.log(`
[PIN CONNECTION] No via found!`),console.log(`  Click coordinates: x=${Se.toFixed(2)}, y=${ze.toFixed(2)}`),console.log(`  Hit tolerance: ${Mt.toFixed(2)}`),console.log(`  Total vias in drawingStrokes: ${$e.filter(ti=>ti.type==="via").length}`)),ct!=null){console.log(`
[PIN CONNECTION] Proceeding with connection...`),console.log(`  bestPointId is valid: ${ct} (type: ${typeof ct})`);const ti=String(ct),Hn=ro.pinIndex,Kn=ro.componentId;console.log(`
=== PIN CONNECTION START ===`),console.log(`Connecting pin ${Hn} (Pin ${Hn+1}) of component ${Kn} to point ID ${ti}`);const Zn=Jt.find(Dt=>Dt.id===Kn),On=Qt.find(Dt=>Dt.id===Kn);Zn?(console.log("Component found in TOP layer"),ri(Dt=>{const Mn=Dt.find(Jn=>Jn.id===Kn);if(!Mn)return console.error(`Component ${Kn} not found in TOP layer during update!`),Dt;console.log("BEFORE update: pinConnections =",Mn.pinConnections);const gr=Mn.pinConnections||[],fo=gr.length>0?[...gr]:new Array(Mn.pinCount).fill("");let tr;if(fo.length!==Mn.pinCount){tr=new Array(Mn.pinCount).fill("");for(let Jn=0;Jn<Math.min(fo.length,Mn.pinCount);Jn++)tr[Jn]=fo[Jn]||""}else tr=[...fo];tr[Hn]=ti,console.log(`Updating pin ${Hn} with value: ${ti}`),console.log("New pinConnections array:",tr);const So=Dt.map(Jn=>Jn.id===Kn?{...Jn,pinConnections:tr}:Jn),Mo=So.find(Jn=>Jn.id===Kn);return console.log("AFTER update: pinConnections =",Mo?.pinConnections),console.log(`Pin ${Hn} value: ${Mo?.pinConnections[Hn]}`),console.log(`=== PIN CONNECTION COMPLETE (TOP) ===
`),So})):On?(console.log("Component found in BOTTOM layer"),Si(Dt=>{const Mn=Dt.find(Jn=>Jn.id===Kn);if(!Mn)return console.error(`Component ${Kn} not found in BOTTOM layer during update!`),Dt;console.log("BEFORE update: pinConnections =",Mn.pinConnections);const gr=Mn.pinConnections||[],fo=gr.length>0?[...gr]:new Array(Mn.pinCount).fill("");let tr;if(fo.length!==Mn.pinCount){tr=new Array(Mn.pinCount).fill("");for(let Jn=0;Jn<Math.min(fo.length,Mn.pinCount);Jn++)tr[Jn]=fo[Jn]||""}else tr=[...fo];tr[Hn]=ti,console.log(`Updating pin ${Hn} with value: ${ti}`),console.log("New pinConnections array:",tr);const So=Dt.map(Jn=>Jn.id===Kn?{...Jn,pinConnections:tr}:Jn),Mo=So.find(Jn=>Jn.id===Kn);return console.log("AFTER update: pinConnections =",Mo?.pinConnections),console.log(`Pin ${Hn} value: ${Mo?.pinConnections[Hn]}`),console.log(`=== PIN CONNECTION COMPLETE (BOTTOM) ===
`),So})):(console.error(`Component ${Kn} not found in either TOP or BOTTOM layer!`),console.log("Available TOP components:",Jt.map(Dt=>Dt.id)),console.log("Available BOTTOM components:",Qt.map(Dt=>Dt.id))),setTimeout(()=>{ka(null)},0);return}else ka(null)}const Oe=10,Ue=(()=>{for(const Ve of Jt)if(Se>=Ve.x-Oe&&Se<=Ve.x+Oe&&ze>=Ve.y-Oe&&ze<=Ve.y+Oe)return{layer:"top",comp:Ve};for(const Ve of Qt)if(Se>=Ve.x-Oe&&Se<=Ve.x+Oe&&ze>=Ve.y-Oe&&ze<=Ve.y+Oe)return{layer:"bottom",comp:Ve};return null})();if(Ue){const{comp:Ve}=Ue;c.shiftKey?mn(ct=>{const gt=new Set(ct);return gt.has(Ve.id)?gt.delete(Ve.id):gt.add(Ve.id),gt}):(mn(new Set([Ve.id])),jn(new Set),xn(new Set),Tn(new Set));return}const Ze=Math.max(6/tt,4);let pt=null;for(const Ve of Pe){const ct=Math.max(6,Ve.size/2),gt=ct*.8,Mt=ct+gt,an=Math.hypot(Ve.x-Se,Ve.y-ze),_n=Math.abs(Se-Ve.x)<=Ze&&Math.abs(ze-Ve.y)<=Mt,ti=Math.abs(ze-Ve.y)<=Ze&&Math.abs(Se-Ve.x)<=Mt;if(an<=Math.max(ct,Ze)||_n||ti){pt=Ve;break}}if(pt){c.shiftKey?xn(Ve=>{const ct=new Set(Ve);return ct.has(pt.id)?ct.delete(pt.id):ct.add(pt.id),ct}):(xn(new Set([pt.id])),jn(new Set),mn(new Set),Tn(new Set));return}let Ct=null;for(const Ve of Ee){const ct=Math.max(6,(Ve.size||18)/2),gt=ct*.8,Mt=ct+gt,an=Math.hypot(Ve.x-Se,Ve.y-ze),_n=Math.abs(Se-Ve.x)<=Ze&&Math.abs(ze-Ve.y)<=Mt,ti=Math.abs(ze-Ve.y)<=Ze&&Math.abs(Se-Ve.x)<=Mt;if(an<=Math.max(ct,Ze)||_n||ti){Ct=Ve;break}}if(Ct){c.shiftKey?Tn(Ve=>{const ct=new Set(Ve);return ct.has(Ct.id)?ct.delete(Ct.id):ct.add(Ct.id),ct}):(Tn(new Set([Ct.id])),jn(new Set),mn(new Set),xn(new Set));return}const dt=Math.max(6/tt,4/tt),Ge=Math.max(dt,.5);let Ye=null;for(const Ve of $e)if((Ve.type==="via"||Ve.type==="pad"||Ve.type==="testPoint")&&Ve.points.length>0){let ct=!1;if(Ve.type==="via"?ct=vo:Ve.type==="pad"?ct=(Ve.layer||"top")==="top"?_o:Wo:Ve.type==="testPoint"&&(ct=(Ve.layer||"top")==="top"?f:C),!ct)continue;const gt=Ve.points[0],Mt=Math.max(1,Ve.size/2);if(Math.hypot(gt.x-Se,gt.y-ze)<=Math.max(Mt,Ge)){Ye=Ve;break}}if(Ye){c.shiftKey?jn(Ve=>{const ct=new Set(Ve);return ct.has(Ye.id)?ct.delete(Ye.id):ct.add(Ye.id),ct}):(jn(new Set([Ye.id])),mn(new Set),xn(new Set),Tn(new Set),Pn(new Set));return}c.shiftKey||(jn(new Set),mn(new Set),xn(new Set),Tn(new Set),Pn(new Set)),Eo(!0),fp({x:Se,y:ze,shiftKey:c.shiftKey}),Ju({x:Se,y:ze,width:0,height:0});return}else if(N==="magnify"){const Oe=c.shiftKey?.5:2,Ue=Math.max(.25,Math.min(8,tt*Oe));Go(Se,ze),Bt(Ue);return}else if(N==="pan"){const Oe={topImageX:o?.x??0,topImageY:o?.y??0,bottomImageX:l?.x??0,bottomImageY:l?.y??0,componentsTop:Object.fromEntries(Jt.map(Ue=>[Ue.id,{x:Ue.x,y:Ue.y}])),componentsBottom:Object.fromEntries(Qt.map(Ue=>[Ue.id,{x:Ue.x,y:Ue.y}])),powerSymbols:Object.fromEntries(vt.map(Ue=>[Ue.id,{x:Ue.x,y:Ue.y}])),groundSymbols:Object.fromEntries(Zt.map(Ue=>[Ue.id,{x:Ue.x,y:Ue.y}])),drawingStrokes:$e.map(Ue=>({points:Ue.points.map(Ze=>({x:Ze.x,y:Ze.y}))})),vias:Na.map(Ue=>({x:Ue.x,y:Ue.y})),pads:$r.map(Ue=>({x:Ue.x,y:Ue.y}))};mo.current={startCX:Ae,startCY:ge,panX:Qn.x,panY:Qn.y,objectStartPositions:Oe},Po.current={startClientX:c.clientX,startClientY:c.clientY,panX:Qn.x,panY:Qn.y,objectStartPositions:Oe},Wa(!0);return}else if(N==="draw"){const Oe=(pt,Ct)=>{let Lt=1/0,dt=null;const Ge=10/tt,Ye=tt>20?Math.max(Ge,1e-4):tt>10?Math.max(Ge,.001):Math.max(Ge,.01);for(const gt of $e)if(gt.type==="via"){const Mt=gt.points[0],an=Math.hypot(Mt.x-pt,Mt.y-Ct);an<=Ye&&an<Lt&&(Lt=an,dt=Mt)}else if(gt.type==="pad"){const Mt=gt.points[0],an=Math.hypot(Mt.x-pt,Mt.y-Ct);an<=Ye&&an<Lt&&(Lt=an,dt=Mt)}for(const gt of Pe)if(gt.pointId!==void 0){const Mt=Math.hypot(gt.x-pt,gt.y-Ct);Mt<=Ye&&Mt<Lt&&(Lt=Mt,dt={x:gt.x,y:gt.y,id:gt.pointId})}for(const gt of Ee)if(gt.pointId!==void 0){const Mt=Math.hypot(gt.x-pt,gt.y-Ct);Mt<=Ye&&Mt<Lt&&(Lt=Mt,dt={x:gt.x,y:gt.y,id:gt.pointId})}const ct=sr(dt??{x:pt,y:Ct});return{x:ct.x,y:ct.y,nodeId:dt?.id}};if(mt==="via"){const pt=Un.get("via"),Ct=pt.color,Lt=pt.size,sn=Il?{x:sr({x:Se,y:ze}).x,y:sr({x:Se,y:ze}).y}:((gt,Mt)=>{let an=1/0,_n=null;const Hn=10/tt,Kn=tt>10?Math.max(Hn,.001):Math.max(Hn,.01);for(const Dt of $e)if(Dt.type==="via"||Dt.type==="pad"){const Mn=Dt.points[0],gr=Math.hypot(Mn.x-gt,Mn.y-Mt);gr<=Kn&&gr<an&&(an=gr,_n=Mn)}for(const Dt of Pe)if(Dt.pointId!==void 0){const Mn=Math.hypot(Dt.x-gt,Dt.y-Mt);Mn<=Kn&&Mn<an&&(an=Mn,_n={x:Dt.x,y:Dt.y,id:Dt.pointId})}for(const Dt of Ee)if(Dt.pointId!==void 0){const Mn=Math.hypot(Dt.x-gt,Dt.y-Mt);Mn<=Kn&&Mn<an&&(an=Mn,_n={x:Dt.x,y:Dt.y,id:Dt.pointId})}const On=sr(_n??{x:gt,y:Mt});return{x:On.x,y:On.y,nodeId:_n?.id}})(Se,ze),Ge=sn.nodeId??pc(),Ye=Ka(Ge,pe),Ve={id:Ge,x:sn.x,y:sn.y};Mi($e,Jt,Qt,vt,Zt);const ct={id:`${Date.now()}-via`,points:[Ve],color:Ct,size:Lt,layer:_t,type:"via",viaType:Ye};at(gt=>[...gt,ct]),_t==="top"?rl(gt=>[...gt,ct.id]):Ma(gt=>[...gt,ct.id]);return}if(mt==="pad"){if(!Gn)return;const Ct=Il?{x:sr({x:Se,y:ze}).x,y:sr({x:Se,y:ze}).y}:((ct,gt)=>{let Mt=1/0,an=null;const ti=10/tt,Hn=tt>10?Math.max(ti,.001):Math.max(ti,.01);for(const On of $e)if(On.type==="via"||On.type==="pad"||On.type==="testPoint"){const Dt=On.points[0],Mn=Math.hypot(Dt.x-ct,Dt.y-gt);Mn<=Hn&&Mn<Mt&&(Mt=Mn,an=Dt)}for(const On of Pe)if(On.pointId!==void 0){const Dt=Math.hypot(On.x-ct,On.y-gt);Dt<=Hn&&Dt<Mt&&(Mt=Dt,an={x:On.x,y:On.y,id:On.pointId})}for(const On of Ee)if(On.pointId!==void 0){const Dt=Math.hypot(On.x-ct,On.y-gt);Dt<=Hn&&Dt<Mt&&(Mt=Dt,an={x:On.x,y:On.y,id:On.pointId})}const Zn=sr(an??{x:ct,y:gt});return{x:Zn.x,y:Zn.y,nodeId:an?.id}})(Se,ze),Lt=Ct.nodeId??pc(),dt=_l(Lt,pe),sn=Y||(Gn==="top"?Re:k),Ge=U||(Gn==="top"?V:se),Ye={id:Lt,x:Ct.x,y:Ct.y};Mi($e,Jt,Qt,vt,Zt);const Ve={id:`${Date.now()}-pad`,points:[Ye],color:sn,size:Ge,layer:Gn,type:"pad",padType:dt};at(ct=>[...ct,Ve]);return}if(mt==="testPoint"){if(!fi)return;const Ct=Il?{x:sr({x:Se,y:ze}).x,y:sr({x:Se,y:ze}).y}:((gt,Mt)=>{let an=1/0,_n=null;const ti=15;for(const Zn of $e)if(Zn.type==="via"||Zn.type==="pad"||Zn.type==="testPoint"){const On=Zn.points[0],Dt=Math.hypot(On.x-gt,On.y-Mt);Dt<=ti&&Dt<an&&(an=Dt,_n=On)}for(const Zn of Pe)if(Zn.pointId!==void 0){const On=Math.hypot(Zn.x-gt,Zn.y-Mt);On<=ti&&On<an&&(an=On,_n={x:Zn.x,y:Zn.y,id:Zn.pointId})}for(const Zn of Ee)if(Zn.pointId!==void 0){const On=Math.hypot(Zn.x-gt,Zn.y-Mt);On<=ti&&On<an&&(an=On,_n={x:Zn.x,y:Zn.y,id:Zn.pointId})}const Kn=sr(_n??{x:gt,y:Mt});return{x:Kn.x,y:Kn.y,nodeId:_n?.id}})(Se,ze),Lt=Ct.nodeId??pc(),dt=yl(Lt,pe),sn=dt.includes("Power")?"power":dt.includes("Ground")?"ground":dt.includes("Signal")?"signal":"unknown",Ge=sr({x:Ct.x,y:Ct.y}),Ye=Y||(fi==="top"?le:ve),Ve=U||(fi==="top"?Xe:kt);Mi($e,Jt,Qt,vt,Zt);const ct={id:`${Date.now()}-testPoint`,points:[{id:Lt,x:Ge.x,y:Ge.y}],color:Ye,size:Ve,layer:fi,type:"testPoint",testPointType:sn};at(gt=>[...gt,ct]);return}if(bn.current)return;const Ue=mt==="trace"&&!Il?Oe(Se,ze):{x:sr({x:Se,y:ze}).x,y:sr({x:Se,y:ze}).y},Ze=Ue.nodeId!==void 0?{id:Ue.nodeId,x:Ue.x,y:Ue.y}:{x:Ue.x,y:Ue.y};Ft(pt=>pt.length===0?[Ze]:[...pt,Ze]),fn.current=Date.now(),ln(null),Vt(!1),Ja(!1)}else if(N==="erase"){if($e.some(Ue=>Ue.layer===_t&&(Ue.type==="via"&&Nr||Ue.type==="pad"&&pa||Ue.type==="testPoint"&&Zo||Ue.type==="trace"&&oo))){const Ue=[];Nr&&$e.some(Ze=>Ze.layer===_t&&Ze.type==="via")&&Ue.push("vias"),pa&&$e.some(Ze=>Ze.layer===_t&&Ze.type==="pad")&&Ue.push("pads"),Zo&&$e.some(Ze=>Ze.layer===_t&&Ze.type==="testPoint")&&Ue.push("test points"),oo&&$e.some(Ze=>Ze.layer===_t&&Ze.type==="trace")&&Ue.push("traces"),Ue.length>0&&alert(`Cannot erase: ${Ue.join(", ")} are locked on the ${_t} layer. Unlock them to erase.`)}Vt(!0),Ft([{id:pc(),x:Se,y:ze}]),console.log("Starting erase at:",Se,ze,"selectedDrawingLayer:",_t,"total strokes:",$e.length)}else if(N==="transform"&&Dn){if(Ki){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}Xt(!0),Ti({x:Se,y:ze})}else if(N==="component"){if(!Ad.current)return;const Oe=sr({x:Se,y:ze}),Ze=(Pr.current||"top")==="top"?"componentTop":"componentBottom",pt=Un.get(Ze),Ct=pt.color,Lt=pt.size,dt=[...Jt,...Qt];let sn;if(Sr?sn=Uf():sn={...ai.current},!Pr.current)return;const Ge=kd.current?.dataDrivenDefinition;if(!Ge){console.error("[Component Creation] Missing dataDrivenDefinition metadata for selected component.");return}let Ye;try{Ye=w2({definition:Ge,layer:Pr.current,x:Oe.x,y:Oe.y,color:Ct,size:Lt,existingComponents:dt,counters:Dr?sn:{}})}catch(Ve){console.error("[Component Creation] Error creating component with v2 runtime:",Ve);return}if(Ye.abbreviation=Dg(Ad.current),Dr&&Ye.designator){const Ve=Ye.designator.match(/^([A-Za-z]+)(\d+)$/);if(Ve){const ct=Ve[1],gt=parseInt(Ve[2],10);if(Sr){const Mt=Uf();m1(ct,gt,Mt)}else ai.current[ct]=Math.max(ai.current[ct]||0,gt)}}Mi($e,Jt,Qt,vt,Zt),Pr.current==="top"?(ie(!0),ri(Ve=>[...Ve,Ye])):(ce(!0),Si(Ve=>[...Ve,Ye]));return}else if(N==="power"){if(!en)return;const Ue=Il?{x:sr({x:Se,y:ze}).x,y:sr({x:Se,y:ze}).y}:((pt,Ct)=>{let Lt=1/0,dt=null;const Ge=10/tt,Ye=tt>20?Math.max(Ge,1e-4):tt>10?Math.max(Ge,.001):Math.max(Ge,.01);for(const gt of $e)if(gt.type==="via"||gt.type==="pad"){const Mt=gt.points[0],an=Math.hypot(Mt.x-pt,Mt.y-Ct);an<=Ye&&an<Lt&&(Lt=an,dt=Mt)}else if(gt.type==="trace")for(const Mt of gt.points){const an=Math.hypot(Mt.x-pt,Mt.y-Ct);an<=Ye&&an<Lt&&(Lt=an,dt=Mt)}const ct=sr(dt??{x:pt,y:Ct});return{x:ct.x,y:ct.y,nodeId:dt?.id}})(Se,ze),Ze=pe.find(pt=>pt.id===en);if(Ze){const pt=Ue.nodeId??pc(),Ct=`${Ze.voltage} Power Node`;if(Ee.find(sn=>sn.pointId===pt)){Jo({visible:!0,title:"Node ID Conflict",message:`Cannot place power node: A ground node already exists at this Node ID (${pt}). Power and ground nodes cannot share the same Node ID.`});return}Mi($e,Jt,Qt,vt,Zt);const dt={id:`power-${Date.now()}-${Math.random()}`,x:Ue.x,y:Ue.y,color:"#ff0000",size:U,powerBusId:Ze.id,layer:_t,type:Ct,pointId:pt};if(Wt(sn=>[...sn,dt]),Ue.nodeId!==void 0){const sn=Ka(Ue.nodeId,pe),Ge=_l(Ue.nodeId,pe),Ye=yl(Ue.nodeId,pe),Ve=Ye.includes("Power")?"power":Ye.includes("Ground")?"ground":Ye.includes("Signal")?"signal":"unknown";at(ct=>ct.map(gt=>gt.type==="via"&&gt.points.length>0&&gt.points[0].id===Ue.nodeId?{...gt,viaType:sn}:gt.type==="pad"&&gt.points.length>0&&gt.points[0].id===Ue.nodeId?{...gt,padType:Ge}:gt.type==="testPoint"&&gt.points.length>0&&gt.points[0].id===Ue.nodeId?{...gt,testPointType:Ve}:gt))}}return}else if(N==="ground"){if(ur===null){if(qe.length===0){Jo({visible:!0,title:"No Ground Bus",message:"No ground buses are defined. Please create a ground bus first using Tools  Manage Ground Buses."});return}_i(!0);return}const Oe=qe.find(Ue=>Ue.id===ur);if(Oe){const Ze=Il?{x:sr({x:Se,y:ze}).x,y:sr({x:Se,y:ze}).y}:((sn,Ge)=>{let Ye=1/0,Ve=null;const gt=10/tt,Mt=tt>20?Math.max(gt,1e-4):tt>10?Math.max(gt,.001):Math.max(gt,.01);for(const ti of $e)if(ti.type==="via"||ti.type==="pad"){const Hn=ti.points[0],Kn=Math.hypot(Hn.x-sn,Hn.y-Ge);Kn<=Mt&&Kn<Ye&&(Ye=Kn,Ve=Hn)}else if(ti.type==="trace")for(const Hn of ti.points){const Kn=Math.hypot(Hn.x-sn,Hn.y-Ge);Kn<=Mt&&Kn<Ye&&(Ye=Kn,Ve=Hn)}const _n=sr(Ve??{x:sn,y:Ge});return{x:_n.x,y:_n.y,nodeId:Ve?.id}})(Se,ze),pt=Ze.nodeId??pc(),Ct=`${Oe.name} Ground Node`,Lt=Pe.find(sn=>sn.pointId===pt);if(Lt){Jo({visible:!0,title:"Node ID Conflict",message:`Cannot place ground node: A power node (${Lt.type||"Power Node"}) already exists at this Node ID (${pt}). Power and ground nodes cannot share the same Node ID.`});return}Mi($e,Jt,Qt,vt,Zt);const dt={id:`gnd-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,x:Ze.x,y:Ze.y,color:Oe.color,size:U||pi.get("ground")?.settings.size||18,groundBusId:Oe.id,layer:_t,type:Ct,pointId:pt};if(on(sn=>[...sn,dt]),Ze.nodeId!==void 0){const sn=Ka(Ze.nodeId,pe),Ge=_l(Ze.nodeId,pe);at(Ye=>Ye.map(Ve=>Ve.type==="via"&&Ve.points.length>0&&Ve.points[0].id===Ze.nodeId?{...Ve,viaType:sn}:Ve.type==="pad"&&Ve.points.length>0&&Ve.points[0].id===Ze.nodeId?{...Ve,padType:Ge}:Ve))}}return}},[N,Dn,U,Y,mt,_t,$e,tt,Qn.x,Qn.y,pn,yn,Il,en,ur,pe,qe,Ll,pi,Gn,di,fi,Pe,Ee,Ka,_l,yl,vo,_o,Wo]),uf=I.useCallback(c=>{if(N!=="magnify")return;c.preventDefault();const x=Tt.current;if(!x)return;const z=x.getBoundingClientRect(),B=x.width/z.width,K=x.height/z.height,ne=c.nativeEvent.offsetX,P=c.nativeEvent.offsetY,Ne=typeof ne=="number"?ne:c.clientX-z.left,be=typeof P=="number"?P:c.clientY-z.top,Le=Ne*B,Ie=be*K,Ae=Le-5,ge=Ie-5,me=Of(Ae,ge,Qn,tt,pn,yn),Se=me.x,ze=me.y,Oe=1.2,Ue=1/Oe,Ze=c.deltaY<0?Oe:Ue,pt=Math.max(.25,Math.min(8,tt*Ze));Go(Se,ze),Bt(pt)},[N,tt,Qn.x,Qn.y,pn,yn]),df=I.useCallback(c=>{if(N==="draw"&&mt==="trace"){bn.current=!0;let Ze=jt;if(Ze.length>1){const pt=[Ze[0]];for(let Ct=1;Ct<Ze.length;Ct++){const Lt=pt[pt.length-1],dt=Ze[Ct];(Math.abs(Lt.x-dt.x)>.001||Math.abs(Lt.y-dt.y)>.001)&&pt.push(dt)}Ze=pt}if(Ze.length>=1){Mi($e,Jt,Qt,vt,Zt);const pt=di||"top",Ct=pt==="top"?"traceTop":"traceBottom",Lt=Un.get(Ct),dt={id:`${Date.now()}-trace`,points:Ze,color:Lt.color,size:Lt.size,layer:pt,type:"trace"};at(sn=>[...sn,dt]),pt==="top"?Fo(sn=>[...sn,dt.id]):xs(sn=>[...sn,dt.id]),Ft([]),ln(null),setTimeout(()=>{bn.current=!1},300);return}}const x=Tt.current;if(!x)return;const z=x.getBoundingClientRect(),B=x.width/z.width,K=x.height/z.height,ne=c.nativeEvent.offsetX,P=c.nativeEvent.offsetY,Ne=typeof ne=="number"?ne:c.clientX-z.left,be=typeof P=="number"?P:c.clientY-z.top,Le=Ne*B,Ie=be*K,Ae=Le-5,ge=Ie-5,me=Of(Ae,ge,Qn,tt,pn,yn),Se=me.x,ze=me.y,Oe=Math.max(8/tt,4),Ue=(()=>{for(const Ze of $e)if(Ze.type==="testPoint"&&Ze.points.length>0){const pt=Ze.points[0],Ct=Math.hypot(pt.x-Se,pt.y-ze),Lt=(Ze.size||18)/2;if(Ct<=Lt+Oe)return Ze}return null})();if(Ue){jn(new Set([Ue.id])),mn(new Set),xn(new Set),Tn(new Set),co(!0);return}if(N==="select"||N==="component"){const pt=(()=>{for(const dt of Jt)if(Se>=dt.x-10&&Se<=dt.x+10&&ze>=dt.y-10&&ze<=dt.y+10)return{layer:"top",comp:dt};for(const dt of Qt)if(Se>=dt.x-10&&Se<=dt.x+10&&ze>=dt.y-10&&ze<=dt.y+10)return{layer:"bottom",comp:dt};return null})(),Ct=Math.max(6/tt,4);let Lt=null;for(const dt of Pe){const sn=Math.max(6,dt.size/2),Ge=sn*.8,Ye=sn+Ge,Ve=Math.hypot(dt.x-Se,dt.y-ze),ct=Math.abs(Se-dt.x)<=Ct&&Math.abs(ze-dt.y)<=Ye,gt=Math.abs(ze-dt.y)<=Ct&&Math.abs(Se-dt.x)<=Ye;if(Ve<=Math.max(sn,Ct)||ct||gt){Lt=dt;break}}if(Lt){xn(new Set([Lt.id])),ci({visible:!0,id:Lt.id,layer:Lt.layer,x:Lt.x,y:Lt.y,size:Lt.size,color:Lt.color,powerBusId:Lt.powerBusId});return}if(pt){const{layer:dt,comp:sn}=pt;j(sn,dt)}}},[N,mt,Y,U,_t,Jt,Qt,Pe,tt,Qn.x,Qn.y,pn,yn,Ll,Il,$e,Dn,na,up,ro,pi,jt,di,H,Z,we,de,co,jn,mn,xn,Tn,j]),Nu=I.useCallback(()=>{const c=gn.current;if(N==="draw"&&mt==="trace"&&c.length>=2){let x=[c[0]];for(let P=1;P<c.length;P++){const Ne=x[x.length-1],be=c[P];(Math.abs(Ne.x-be.x)>.001||Math.abs(Ne.y-be.y)>.001)&&x.push(be)}const z=di||"top",B=z==="top"?"traceTop":"traceBottom",K=Un.get(B),ne={id:`${Date.now()}-trace`,points:x,color:K.color,size:K.size,layer:z,type:"trace"};Mi($e,Jt,Qt,vt,Zt),at(P=>[...P,ne]),z==="top"?Fo(P=>[...P,ne.id]):xs(P=>[...P,ne.id]),Ft([]),ln(null)}else if(N==="draw"&&mt==="trace"&&c.length===1){const x=di||"top",z=x==="top"?"traceTop":"traceBottom",B=Un.get(z),K={id:`${Date.now()}-trace-dot`,points:c,color:B.color,size:B.size,layer:x,type:"trace"};at(ne=>[...ne,K]),x==="top"?Fo(ne=>[...ne,K.id]):xs(ne=>[...ne,K.id]),Ft([])}},[N,mt,di,H,Z,we,de,at]),ff=I.useCallback((c,x,z)=>{const B=x-c.x,K=z-c.y;if(B===0&&K===0)return{x,y:z};const P=(f2(B,K)%180+180)%180,Ne=[0,45,90];let be=0,Le=1e9;for(const Ie of Ne){const Ae=Math.abs(P-Ie);Ae<Le&&(Le=Ae,be=Ie)}if(be===0)return{x,y:c.y};if(be===90)return{x:c.x,y:z};{const Ie=Math.min(Math.abs(B),Math.abs(K)),Ae=B>=0?1:-1,ge=K>=0?1:-1;return{x:c.x+Ae*Ie,y:c.y+ge*Ie}}},[]),pf=I.useCallback(c=>{const x=Tt.current?.getBoundingClientRect();if(!x)return;const z=c.clientX-x.left,B=c.clientY-x.top,K=Tt.current,ne=K.width/x.width,P=K.height/x.height,Ne=z*ne,be=B*P,Le=Ne-5,Ie=be-5,Ae=Of(Le,Ie,Qn,tt,pn,yn),ge=Ae.x,me=Ae.y;if(Ri({x:ge,y:me}),Is.current&&fs.current&&bu({start:fs.current.start,end:{x:ge,y:me}}),N==="draw"&&mt==="trace"&&jt.length>0){const ze=Il?{x:sr({x:ge,y:me}).x,y:sr({x:ge,y:me}).y}:((Oe,Ue)=>{let Ze=1/0,pt=null;const Lt=10/tt,dt=tt>20?Math.max(Lt,1e-4):tt>10?Math.max(Lt,.001):Math.max(Lt,.01);for(const Ye of $e)if(Ye.type==="via"){const Ve=Ye.points[0],ct=Math.hypot(Ve.x-Oe,Ve.y-Ue);ct<=dt&&ct<Ze&&(Ze=ct,pt=Ve)}else if(Ye.type==="pad"){const Ve=Ye.points[0],ct=Math.hypot(Ve.x-Oe,Ve.y-Ue);ct<=dt&&ct<Ze&&(Ze=ct,pt=Ve)}for(const Ye of Pe)if(Ye.pointId!==void 0){const Ve=Math.hypot(Ye.x-Oe,Ye.y-Ue);Ve<=dt&&Ve<Ze&&(Ze=Ve,pt={x:Ye.x,y:Ye.y,id:Ye.pointId})}for(const Ye of Ee)if(Ye.pointId!==void 0){const Ve=Math.hypot(Ye.x-Oe,Ye.y-Ue);Ve<=dt&&Ve<Ze&&(Ze=Ve,pt={x:Ye.x,y:Ye.y,id:Ye.pointId})}const Ge=sr(pt??{x:Oe,y:Ue});return{x:Ge.x,y:Ge.y,nodeId:pt?.id}})(ge,me);ln({x:ze.x,y:ze.y})}else ln(null);if(ia){const ze=(()=>{for(const Oe of Jt)if(ge>=Oe.x-10&&ge<=Oe.x+10&&me>=Oe.y-10&&me<=Oe.y+10)return{layer:"top",comp:Oe};for(const Oe of Qt)if(ge>=Oe.x-10&&ge<=Oe.x+10&&me>=Oe.y-10&&me<=Oe.y+10)return{layer:"bottom",comp:Oe};return null})();if(ze)ma({component:ze.comp,layer:ze.layer,x:c.clientX,y:c.clientY}),ba(null);else{ma(null);const Oe=Math.max(8/tt,4),Ue=(()=>{for(const Ze of $e)if(Ze.type==="testPoint"&&Ze.points.length>0){const pt=Ze.points[0],Ct=Math.hypot(pt.x-ge,pt.y-me),Lt=(Ze.size||18)/2;if(Ct<=Lt+Oe)return Ze}return null})();ba(Ue?{stroke:Ue,x:c.clientX,y:c.clientY}:null)}}else ma(null),ba(null);if(N==="select"&&ol&&au){const Se=au.x,ze=au.y;Ju({x:Math.min(Se,ge),y:Math.min(ze,me),width:Math.abs(ge-Se),height:Math.abs(me-ze)})}else if(N==="pan"&&na&&mo.current){const{startCX:Se,startCY:ze,objectStartPositions:Oe}=mo.current,Ue=Le-Se,Ze=Ie-ze,pt=y1(Ue,Ze,tt,pn,yn),Ct=pt.x,Lt=pt.y;Oe&&(o&&s({...o,x:Oe.topImageX+Ct,y:Oe.topImageY+Lt}),l&&d({...l,x:Oe.bottomImageX+Ct,y:Oe.bottomImageY+Lt}),ri(Jt.map(dt=>({...dt,x:(Oe.componentsTop?.[dt.id]?.x??dt.x)+Ct,y:(Oe.componentsTop?.[dt.id]?.y??dt.y)+Lt}))),Si(Qt.map(dt=>({...dt,x:(Oe.componentsBottom?.[dt.id]?.x??dt.x)+Ct,y:(Oe.componentsBottom?.[dt.id]?.y??dt.y)+Lt}))),Wt(vt.map(dt=>({...dt,x:(Oe.powerSymbols?.[dt.id]?.x??dt.x)+Ct,y:(Oe.powerSymbols?.[dt.id]?.y??dt.y)+Lt}))),on(Zt.map(dt=>({...dt,x:(Oe.groundSymbols?.[dt.id]?.x??dt.x)+Ct,y:(Oe.groundSymbols?.[dt.id]?.y??dt.y)+Lt}))),at($e.map((dt,sn)=>({...dt,points:dt.points.map((Ge,Ye)=>{const Ve=Oe.drawingStrokes?.[sn]?.points?.[Ye];return{...Ge,x:(Ve?.x??Ge.x)+Ct,y:(Ve?.y??Ge.y)+Lt}})}))),Xo(Na.map((dt,sn)=>{const Ge=Oe.vias?.[sn];return{...dt,x:(Ge?.x??dt.x)+Ct,y:(Ge?.y??dt.y)+Lt}})),pr($r.map((dt,sn)=>{const Ge=Oe.pads?.[sn];return{...dt,x:(Ge?.x??dt.x)+Ct,y:(Ge?.y??dt.y)+Lt}})))}else if(Ot&&jt.length>0){if(N==="draw")if(Br){const Se=jt[0],ze=ff(Se,ge,me),Oe=sr(ze),Ue={id:pc(),x:Oe.x,y:Oe.y};Ft([Se,Ue])}else{const Se=sr({x:ge,y:me});Ft(ze=>[...ze,{id:pc(),x:Se.x,y:Se.y}])}else if(N==="erase"&&(Ft(Se=>[...Se,{id:pc(),x:ge,y:me}]),at(Se=>{const ze=Se.filter(Ue=>{if(Ue.type==="via"&&Nr||Ue.type==="pad"&&pa||Ue.type==="testPoint"&&Zo||Ue.type==="trace"&&oo||Ue.layer!==_t)return!0;const Ze=U/2,pt=ge-Ze,Ct=ge+Ze,Lt=me-Ze,dt=me+Ze,sn=(Ve,ct)=>Ve>=pt&&Ve<=Ct&&ct>=Lt&&ct<=dt,Ge=(Ve,ct,gt,Mt)=>{const Zn=(So,Mo)=>{let Jn=0;return So<pt?Jn|=1:So>Ct&&(Jn|=2),Mo<Lt?Jn|=4:Mo>dt&&(Jn|=8),Jn};let On=Ve,Dt=ct,Mn=gt,gr=Mt,fo=Zn(On,Dt),tr=Zn(Mn,gr);for(;;){if((fo|tr)===0)return!0;if((fo&tr)!==0)return!1;const So=fo!==0?fo:tr;let Mo=0,Jn=0;So&8?(Mo=On+(Mn-On)*(dt-Dt)/(gr-Dt),Jn=dt):So&4?(Mo=On+(Mn-On)*(Lt-Dt)/(gr-Dt),Jn=Lt):So&2?(Jn=Dt+(gr-Dt)*(Ct-On)/(Mn-On),Mo=Ct):(Jn=Dt+(gr-Dt)*(pt-On)/(Mn-On),Mo=pt),So===fo?(On=Mo,Dt=Jn,fo=Zn(On,Dt)):(Mn=Mo,gr=Jn,tr=Zn(Mn,gr))}};let Ye=!1;if(Ue.points.length===1){const Ve=Ue.points[0];Ye=sn(Ve.x,Ve.y)}else for(let Ve=0;Ve<Ue.points.length-1;Ve++){const ct=Ue.points[Ve],gt=Ue.points[Ve+1];if(Ge(ct.x,ct.y,gt.x,gt.y)){Ye=!0;break}}return Ye&&console.log("Erasing stroke at position:",ge,me,"brushSize:",U,"selectedLayer:",_t),!Ye});console.log("Strokes before:",Se.length,"after:",ze.length);const Oe=new Set(ze.map(Ue=>Ue.id));return rl(Ue=>Ue.filter(Ze=>Oe.has(Ze))),Ma(Ue=>Ue.filter(Ze=>Oe.has(Ze))),Fo(Ue=>Ue.filter(Ze=>Oe.has(Ze))),xs(Ue=>Ue.filter(Ze=>Oe.has(Ze))),ze}),Wi||Wt(Se=>{const ze=U/2,Oe=ge-ze,Ue=ge+ze,Ze=me-ze,pt=me+ze,Ct=Lt=>{const dt=Lt.size/2,sn=Lt.x-dt,Ge=Lt.x+dt,Ye=Lt.y-dt,Ve=Lt.y+dt;return!(Ue<sn||Oe>Ge||pt<Ye||Ze>Ve)};return Se.filter(Lt=>!Ct(Lt))}),ho||on(Se=>{const ze=U/2,Oe=ge-ze,Ue=ge+ze,Ze=me-ze,pt=me+ze,Ct=dt=>{const sn=Math.max(6,(dt.size||18)/2),Ge=sn*.8,Ye=sn+Ge,Ve=dt.x-Ye,ct=dt.x+Ye,gt=dt.y-Ye,Mt=dt.y+Ye;return!(Ue<Ve||Oe>ct||pt<gt||Ze>Mt)};return Se.filter(dt=>!Ct(dt))}),!Hi)){const Se=U/2,ze=ge-Se,Oe=ge+Se,Ue=me-Se,Ze=me+Se,pt=Ct=>{const dt=(Ct.size||18)/2,sn=Ct.x-dt,Ge=Ct.x+dt,Ye=Ct.y-dt,Ve=Ct.y+dt;return!(Oe<sn||ze>Ge||Ze<Ye||Ue>Ve)};Mi($e,Jt,Qt,vt,Zt),ri(Ct=>Ct.filter(Lt=>!pt(Lt))),Si(Ct=>Ct.filter(Lt=>!pt(Lt)))}}else if(Mr&&mr&&Dn){if(Ki){Xt(!1),Ti(null);return}const Se=ge-mr.x,ze=me-mr.y;if(Dn==="top"){o&&s(Oe=>Oe?{...Oe,x:Oe.x+Se,y:Oe.y+ze}:null),Ti({x:ge,y:me});return}if(Dn==="bottom"){l&&d(Oe=>Oe?{...Oe,x:Oe.x+Se,y:Oe.y+ze}:null),Ti({x:ge,y:me});return}if(Dn==="both"){o&&s(Oe=>Oe?{...Oe,x:Oe.x+Se,y:Oe.y+ze}:null),l&&d(Oe=>Oe?{...Oe,x:Oe.x+Se,y:Oe.y+ze}:null),Ti({x:ge,y:me});return}}},[Ot,jt,N,U,Mr,mr,Dn,o,l,Br,ff,_t,at,tt,Qn.x,Qn.y,pn,yn,ol,au,Ki,Nr,pa,oo,Wi,ho,Jt,Qt,ri,Si,ia,ma,Il,$e,Pe,Ee,jt,mt,tn,ln,na,mo,Oa,5,Qn,pc,sr,g,cr,Mi,vt,Zt,Ri]),Qu=I.useCallback(()=>{if(Ri(null),As.current&&fs.current&&lc.current&&Is.current){const c=fs.current,x=lc.current,z=Math.abs(c.end.x-c.start.x),B=Math.abs(c.end.y-c.start.y);if(z>=1&&B>=1)try{const ne=gw({numPins:x.numPins,type:x.type,twoSidedOrientation:x.twoSidedOrientation,point1:c.start,point2:c.end}).map(P=>{const Ne=cc.current?(Gn||"top")==="top"?"padTop":"padBottom":"via",be=Un.get(Ne),Le=pc(),Ie=cc.current&&Gn||"top";return{id:Le.toString(),type:cc.current?"pad":"via",points:[{x:P.x,y:P.y,id:Le}],size:be.size,color:be.color,layer:Ie}});at(P=>{const Ne=[...P,...ne];return Mi(Ne,Jt,Qt,vt,Zt),Ne})}catch(K){console.error("IC Placement error:",K),alert(`Error placing ${cc.current?"pads":"vias"}: ${K instanceof Error?K.message:String(K)}`)}Gu(!1),bu(null),$u(null),iu(!1),As.current=!1,fs.current=null,lc.current=null,Is.current=!1,ki(void 0),g("select");return}if(N==="select"&&ol){const c=Ml,x=au;if(Eo(!1),fp(null),Ju(null),c&&x){const K=Math.max(3,5/tt),ne=c.width<K&&c.height<K,P=(Ge,Ye)=>{const Ve=c.x,ct=c.y,gt=c.x+c.width,Mt=c.y+c.height;return Ge>=Ve&&Ge<=gt&&Ye>=ct&&Ye<=Mt},Ne=(Ge,Ye,Ve,ct,gt,Mt,an,_n)=>{const Dt=(Jn,bl)=>{let nl=0;return Jn<gt?nl|=1:Jn>an&&(nl|=2),bl<Mt?nl|=4:bl>_n&&(nl|=8),nl};let Mn=Ge,gr=Ye,fo=Ve,tr=ct,So=Dt(Mn,gr),Mo=Dt(fo,tr);for(;;){if((So|Mo)===0)return!0;if((So&Mo)!==0)return!1;const Jn=So!==0?So:Mo;let bl=0,nl=0;Jn&8?(bl=Mn+(fo-Mn)*(_n-gr)/(tr-gr),nl=_n):Jn&4?(bl=Mn+(fo-Mn)*(Mt-gr)/(tr-gr),nl=Mt):Jn&2?(nl=gr+(tr-gr)*(an-Mn)/(fo-Mn),bl=an):(nl=gr+(tr-gr)*(gt-Mn)/(fo-Mn),bl=gt),Jn===So?(Mn=bl,gr=nl,So=Dt(Mn,gr)):(fo=bl,tr=nl,Mo=Dt(fo,tr))}},be=c.x,Le=c.y,Ie=c.x+c.width,Ae=c.y+c.height,me=Math.max(6/tt,4/tt,.5),Se=(Ge,Ye,Ve,ct,gt,Mt)=>{const an=gt-Ve,_n=Mt-ct;if(an===0&&_n===0)return Math.hypot(Ge-Ve,Ye-ct);const ti=Math.max(0,Math.min(1,((Ge-Ve)*an+(Ye-ct)*_n)/(an*an+_n*_n))),Hn=Ve+ti*an,Kn=ct+ti*_n;return Math.hypot(Ge-Hn,Ye-Kn)},ze=x?.shiftKey===!0,Oe=new Set(ze?Array.from(vn):[]),Ue=new Set(ze?Array.from(En):[]),Ze=new Set(ze?Array.from(Ai):[]),pt=new Set(ze?Array.from(wi):[]),Ct=x?.hitStrokeId;if(Ct){const Ge=$e.find(Ye=>Ye.id===Ct);if(Ge){let Ye=!1;if(Ge.type==="via"||Ge.type==="pad"?Ye=vo:Ye=Ge.layer==="top"?Da:Ra,Ye){ze?jn(Ve=>{const ct=new Set(Ve);return ct.has(Ct)?ct.delete(Ct):ct.add(Ct),ct}):(jn(new Set([Ct])),mn(new Set),xn(new Set),Tn(new Set));return}}}if(ne){let Ge=null;for(const Ye of $e){let Ve=!1;if(Ye.type==="via"?Ve=vo:Ye.type==="pad"?Ve=(Ye.layer||"top")==="top"?_o:Wo:Ye.type==="testPoint"?Ve=(Ye.layer||"top")==="top"?f:C:Ye.type==="trace"?Ve=Ye.layer==="top"?Da:Ra:Ve=!1,!Ve)continue;let ct=1/0;if(Ye.type==="via"||Ye.type==="pad"||Ye.type==="testPoint"){const gt=Ye.points[0],Mt=Math.max(1,Ye.size/2);ct=Math.hypot(gt.x-x.x,gt.y-x.y);const _n=Math.max(6/tt,4/tt,.5);ct<=Math.max(Mt,_n)&&(!Ge||ct<Ge.dist)&&(Ge={id:Ye.id,dist:ct})}else for(let gt=0;gt<Ye.points.length-1;gt++){const Mt=Ye.points[gt],an=Ye.points[gt+1],_n=Se(x.x,x.y,Mt.x,Mt.y,an.x,an.y);if(_n<=Math.max(me,Ye.size/2)){(!Ge||_n<Ge.dist)&&(Ge={id:Ye.id,dist:_n});break}}}Ge&&(ze&&Oe.has(Ge.id)?Oe.delete(Ge.id):Oe.add(Ge.id))}else for(const Ge of $e){let Ye=!1;if(Ge.type==="via"?Ye=vo:Ge.type==="pad"?Ye=(Ge.layer||"top")==="top"?_o:Wo:Ge.type==="testPoint"?Ye=(Ge.layer||"top")==="top"?f:C:Ge.type==="trace"?Ye=Ge.layer==="top"?Da:Ra:Ye=!1,!Ye)continue;let Ve=!1;if(Ge.type==="via"||Ge.type==="pad"||Ge.type==="testPoint"){const ct=Ge.points[0];Ve=P(ct.x,ct.y)}else for(let ct=0;ct<Ge.points.length-1;ct++){const gt=Ge.points[ct],Mt=Ge.points[ct+1];if(Ne(gt.x,gt.y,Mt.x,Mt.y,be,Le,Ie,Ae)||P(gt.x,gt.y)&&P(Mt.x,Mt.y)){Ve=!0;break}}Ve&&(ze&&Oe.has(Ge.id)?Oe.delete(Ge.id):Oe.add(Ge.id))}const Lt=Ge=>{const Ve=Math.max(10,Ge.size||18)/2;return Ge.x-Ve<=Ie&&Ge.x+Ve>=be&&Ge.y-Ve<=Ae&&Ge.y+Ve>=Le};if(ne){const Ge=Ye=>{const ct=Math.max(10,Ye.size||18)/2;return x.x>=Ye.x-ct&&x.x<=Ye.x+ct&&x.y>=Ye.y-ct&&x.y<=Ye.y+ct};X&&Jt.forEach(Ye=>{Ge(Ye)&&(ze&&Ue.has(Ye.id)?Ue.delete(Ye.id):Ue.add(Ye.id))}),oe&&Qt.forEach(Ye=>{Ge(Ye)&&(ze&&Ue.has(Ye.id)?Ue.delete(Ye.id):Ue.add(Ye.id))})}else X&&Jt.forEach(Ge=>{Lt(Ge)&&(ze&&Ue.has(Ge.id)?Ue.delete(Ge.id):Ue.add(Ge.id))}),oe&&Qt.forEach(Ge=>{Lt(Ge)&&(ze&&Ue.has(Ge.id)?Ue.delete(Ge.id):Ue.add(Ge.id))});const dt=Ge=>{const Ye=Math.max(6,Ge.size/2),Ve=Ye*.8,ct=Ye+Ve;return Ge.x-ct<=Ie&&Ge.x+ct>=be&&Ge.y-ct<=Ae&&Ge.y+ct>=Le};if(he)if(ne){let Ge=null;for(const Ye of Pe){const Ve=Math.max(6,Ye.size/2),ct=Ve*.8,gt=Ve+ct,Mt=Math.hypot(Ye.x-x.x,Ye.y-x.y),an=Math.abs(x.x-Ye.x)<=me&&Math.abs(x.y-Ye.y)<=gt,_n=Math.abs(x.y-Ye.y)<=me&&Math.abs(x.x-Ye.x)<=gt;if(Mt<=Math.max(Ve,me)||an||_n){const Hn=Math.min(Mt,Math.abs(x.x-Ye.x)+Math.abs(x.y-Ye.y));(!Ge||Hn<Ge.dist)&&(Ge={id:Ye.id,dist:Hn})}}Ge&&(ze&&Ze.has(Ge.id)?Ze.delete(Ge.id):Ze.add(Ge.id))}else Pe.forEach(Ge=>{dt(Ge)&&(ze&&Ze.has(Ge.id)?Ze.delete(Ge.id):Ze.add(Ge.id))});const sn=Ge=>{const Ye=Math.max(6,(Ge.size||18)/2),Ve=Ye*.8,ct=Ye+Ve;return Ge.x-ct<=Ie&&Ge.x+ct>=be&&Ge.y-ct<=Ae&&Ge.y+ct>=Le};if(Qi)if(ne){let Ge=null;for(const Ye of Ee){const Ve=Math.max(6,(Ye.size||18)/2),ct=Ve*.8,gt=Ve+ct,Mt=Math.hypot(Ye.x-x.x,Ye.y-x.y),an=Math.abs(x.x-Ye.x)<=me&&Math.abs(x.y-Ye.y)<=gt,_n=Math.abs(x.y-Ye.y)<=me&&Math.abs(x.x-Ye.x)<=gt;if(Mt<=Math.max(Ve,me)||an||_n){const Hn=Math.min(Mt,Math.abs(x.x-Ye.x)+Math.abs(x.y-Ye.y));(!Ge||Hn<Ge.dist)&&(Ge={id:Ye.id,dist:Hn})}}Ge&&(ze&&pt.has(Ge.id)?pt.delete(Ge.id):pt.add(Ge.id))}else Ee.forEach(Ge=>{sn(Ge)&&(ze&&pt.has(Ge.id)?pt.delete(Ge.id):pt.add(Ge.id))});jn(Oe),mn(Ue),xn(Ze),Tn(pt)}}if(Ot&&jt.length>0){if(N==="draw"&&mt!=="trace"){const c={id:Date.now().toString(),points:jt,color:Y,size:U,layer:_t,type:"trace"};at(x=>[...x,c]),_t==="top"?Fo(x=>[...x,c.id]):xs(x=>[...x,c.id])}Ft([])}na&&(Wa(!1),mo.current=null,Po.current=null),Vt(!1),Xt(!1),Ti(null),Ja(!1)},[Ot,jt,N,Y,U,_t,Ml,au,ol,$e,tt,_a,vn,Pe,Ee,Jt,Qt,En,Ai,wi,vo,Da,Ra,X,oe,he,Qi,Ri]);At.useEffect(()=>{if(!(N==="pan"&&na&&Po.current))return;const c=z=>{const B=Tt.current;if(!B)return;const K=B.getBoundingClientRect(),ne=B.width/K.width,P=B.height/K.height,{startClientX:Ne,startClientY:be,objectStartPositions:Le}=Po.current,Ie=(z.clientX-Ne)*ne,Ae=(z.clientY-be)*P,ge=y1(Ie,Ae,tt,pn,yn),me=ge.x,Se=ge.y;Le&&(o&&s({...o,x:Le.topImageX+me,y:Le.topImageY+Se}),l&&d({...l,x:Le.bottomImageX+me,y:Le.bottomImageY+Se}),ri(Jt.map(ze=>({...ze,x:(Le.componentsTop?.[ze.id]?.x??ze.x)+me,y:(Le.componentsTop?.[ze.id]?.y??ze.y)+Se}))),Si(Qt.map(ze=>({...ze,x:(Le.componentsBottom?.[ze.id]?.x??ze.x)+me,y:(Le.componentsBottom?.[ze.id]?.y??ze.y)+Se}))),Wt(vt.map(ze=>({...ze,x:(Le.powerSymbols?.[ze.id]?.x??ze.x)+me,y:(Le.powerSymbols?.[ze.id]?.y??ze.y)+Se}))),on(Zt.map(ze=>({...ze,x:(Le.groundSymbols?.[ze.id]?.x??ze.x)+me,y:(Le.groundSymbols?.[ze.id]?.y??ze.y)+Se}))),at($e.map((ze,Oe)=>({...ze,points:ze.points.map((Ue,Ze)=>{const pt=Le.drawingStrokes?.[Oe]?.points?.[Ze];return{...Ue,x:(pt?.x??Ue.x)+me,y:(pt?.y??Ue.y)+Se}})}))),Xo(Na.map((ze,Oe)=>{const Ue=Le.vias?.[Oe];return{...ze,x:(Ue?.x??ze.x)+me,y:(Ue?.y??ze.y)+Se}})),pr($r.map((ze,Oe)=>{const Ue=Le.pads?.[Oe];return{...ze,x:(Ue?.x??ze.x)+me,y:(Ue?.y??ze.y)+Se}})))},x=()=>{Wa(!1),mo.current=null,Po.current=null,window.removeEventListener("mousemove",c,!0),window.removeEventListener("mouseup",x,!0)};return window.addEventListener("mousemove",c,!0),window.addEventListener("mouseup",x,!0),()=>{window.removeEventListener("mousemove",c,!0),window.removeEventListener("mouseup",x,!0)}},[N,na,tt,pn,yn,o,l,Jt,Qt,vt,Zt,$e,Na,$r,s,d,ri,Si,Wt,on,at,Xo,pr]);const su=I.useCallback(()=>{const c=Tt.current;if(!c)return;const x=c.getContext("2d");if(!x)return;x.clearRect(0,0,c.width,c.height),x.fillStyle="#000000",x.fillRect(0,0,c.width,c.height),x.fillStyle="#ffffff",x.fillRect(5,5,c.width-10,c.height-10),x.save(),x.beginPath(),x.rect(5,5,c.width-10,c.height-10),x.clip(),x.translate(5,5);const z=(K,ne,P,Ne,be,Le,Ie,Ae)=>{const ge=document.createElement("canvas");ge.width=P,ge.height=Ne;const me=ge.getContext("2d",{willReadFrequently:!0});me.clearRect(0,0,P,Ne),me.drawImage(ne,0,0,P,Ne);let Se=ge;if(Math.abs(be)>1e-6){const ze=ah(be),Oe=Math.max(.2,1-ze),Ue=Math.max(.2,1+ze),Ze=Math.max(Oe,Ue),pt=Math.max(1,Math.ceil(P*Ze)),Ct=document.createElement("canvas");Ct.width=pt,Ct.height=Ne;const Lt=Ct.getContext("2d",{willReadFrequently:!0});Lt.clearRect(0,0,pt,Ne);for(let dt=0;dt<Ne;dt++){const sn=Ne<=1?0:dt/(Ne-1),Ge=Oe*(1-sn)+Ue*sn,Ye=Math.max(1,P*Ge),Ve=(pt-Ye)/2;Lt.drawImage(Se,0,dt,P,1,Ve,dt,Ye,1)}Se=Ct}if(Math.abs(Le)>1e-6){const ze=ah(Le),Oe=Math.max(.2,1-ze),Ue=Math.max(.2,1+ze),Ze=Math.max(Oe,Ue),pt=Math.max(1,Math.ceil(Ne*Ze)),Ct=document.createElement("canvas");Ct.width=Se.width,Ct.height=pt;const Lt=Ct.getContext("2d",{willReadFrequently:!0});Lt.clearRect(0,0,Ct.width,pt);for(let dt=0;dt<Se.width;dt++){const sn=Se.width<=1?0:dt/(Se.width-1),Ge=Oe*(1-sn)+Ue*sn,Ye=Math.max(1,Ne*Ge),Ve=(pt-Ye)/2;Lt.drawImage(Se,dt,0,1,Se.height,dt,Ve,1,Ye)}Se=Ct}K.drawImage(Se,-Ie/2,-Ae/2,Ie,Ae)};x.translate(Qn.x,Qn.y),x.scale(tt,tt),p2(x,pn,yn);{const K=ks&&$a;if(o&&o.bitmap&&ks){const ne=o.bitmap;x.save(),x.globalAlpha=1;const P=[];o.brightness!==void 0&&o.brightness!==100&&P.push(`brightness(${o.brightness}%)`),o.contrast!==void 0&&o.contrast!==100&&P.push(`contrast(${o.contrast}%)`),F&&P.push("grayscale(100%)"),x.filter=P.length>0?P.join(" "):"none",Ig(x,{x:o.x,y:o.y,rotation:o.rotation||0,scale:o.scale||1,flipX:o.flipX||!1,flipY:o.flipY||!1,skewX:o.skewX||0,skewY:o.skewY||0});const Ne=ne.width*1,be=ne.height*1,Le=ne;o.keystoneV&&Math.abs(o.keystoneV)>1e-6||o.keystoneH&&Math.abs(o.keystoneH)>1e-6?z(x,Le,ne.width,ne.height,o.keystoneV||0,o.keystoneH||0,Ne,be):x.drawImage(Le,-Ne/2,-be/2,Ne,be),x.restore()}if(l&&l.bitmap&&$a){const ne=l.bitmap;x.save(),x.globalAlpha=K?b/100:1;const P=[];l.brightness!==void 0&&l.brightness!==100&&P.push(`brightness(${l.brightness}%)`),l.contrast!==void 0&&l.contrast!==100&&P.push(`contrast(${l.contrast}%)`),F&&P.push("grayscale(100%)"),x.filter=P.length>0?P.join(" "):"none",Ig(x,{x:l.x,y:l.y,rotation:l.rotation||0,scale:l.scale||1,flipX:l.flipX||!1,flipY:l.flipY||!1,skewX:l.skewX||0,skewY:l.skewY||0});const Ne=ne.width*1,be=ne.height*1,Le=ne;l.keystoneV&&Math.abs(l.keystoneV)>1e-6||l.keystoneH&&Math.abs(l.keystoneH)>1e-6?z(x,Le,ne.width,ne.height,l.keystoneV||0,l.keystoneH||0,Ne,be):x.drawImage(Le,-Ne/2,-be/2,Ne,be),x.restore()}}if(hp(x),he&&Pe.length>0){const K=ne=>{x.save(),g1(x,ne.x,ne.y,ne.rotation??0,ne.flipX??!1,!1);const P=pe.find(Ae=>Ae.id===ne.powerBusId),Ne=Ai.has(ne.id),be=P?.color||"#ff0000";x.strokeStyle=be,x.lineWidth=Math.max(1,(Ne?3:2)/Math.max(tt,.001)),x.lineCap="round";const Le=Math.max(6,ne.size/2),Ie=Le*.8;if(Ne&&(x.strokeStyle="#0066ff",x.lineWidth=Math.max(1,4/Math.max(tt,.001)),x.beginPath(),x.arc(0,0,Le+Ie+3,0,Za),x.stroke()),x.strokeStyle=be,x.lineWidth=Math.max(1,(Ne?3:2)/Math.max(tt,.001)),x.beginPath(),x.arc(0,0,Le,0,Za),x.stroke(),x.beginPath(),x.moveTo(0,-Le-Ie),x.lineTo(0,Le+Ie),x.stroke(),x.beginPath(),x.moveTo(-Le-Ie,0),x.lineTo(Le+Ie,0),x.stroke(),P){x.fillStyle=be;const Ae=Math.max(10,Le*.8);x.font=`${Ae}px sans-serif`,x.textAlign="center",x.textBaseline="top",x.fillText(P.name,0,Le+Ie+8)}x.restore()};Pe.forEach(K)}if(Qi&&Ee.length>0){const K=ne=>{x.save(),g1(x,ne.x,ne.y,ne.rotation??0,ne.flipX??!1,!1);const P=wi.has(ne.id),Ne=qe.find(Ae=>Ae.id===ne.groundBusId),be=Ne?.color||ne.color||"#000000",Le=ne.groundBusId==="groundbus-earth";let Ie;if(Le){const Ae=Math.max(6,ne.size||18),ge=Ae*.9,me=Ae*.24,Se=Ae*1.6;x.strokeStyle=be,x.lineWidth=Math.max(1,(P?3:2)/Math.max(tt,.001)),x.lineCap="round",P&&(x.strokeStyle="#0066ff",x.lineWidth=Math.max(1,4/Math.max(tt,.001)),x.setLineDash([5,5]),x.strokeRect(-Se/2-3,-3,Se+6,ge+me*2+6),x.setLineDash([])),x.strokeStyle=be,x.lineWidth=Math.max(1,(P?3:2)/Math.max(tt,.001)),x.beginPath(),x.moveTo(0,0),x.lineTo(0,ge),x.stroke();for(let ze=0;ze<3;ze++){const Oe=ge+ze*me,Ue=Se*(1-ze*.25);x.beginPath(),x.moveTo(-Ue/2,Oe),x.lineTo(Ue/2,Oe),x.stroke()}Ie=ge+me*2}else{const Ae=Math.max(6,(ne.size||18)/2),ge=Ae*.8;P&&(x.strokeStyle="#0066ff",x.lineWidth=Math.max(1,4/Math.max(tt,.001)),x.beginPath(),x.arc(0,0,Ae+ge+3,0,Za),x.stroke()),x.strokeStyle=be,x.lineWidth=Math.max(1,(P?3:2)/Math.max(tt,.001)),x.beginPath(),x.arc(0,0,Ae,0,Za),x.stroke(),x.beginPath(),x.moveTo(0,-Ae-ge),x.lineTo(0,Ae+ge),x.stroke(),x.beginPath(),x.moveTo(-Ae-ge,0),x.lineTo(Ae+ge,0),x.stroke(),Ie=Ae+ge}if(Ne){x.fillStyle=be;const Ae=Math.max(10,(ne.size||18)*.5);x.font=`${Ae}px sans-serif`,x.textAlign="center",x.textBaseline="top",x.fillText(Ne.name,0,Ie+8)}x.restore()};Ee.forEach(K)}const B=K=>{const ne=Math.max(10,K.size||18),P=ne/2;x.save(),x.translate(K.x,K.y),h2(x,pn,yn),K.orientation!==void 0&&K.orientation!==0&&x.rotate(gu(K.orientation)),K.flipX&&x.scale(-1,1),K.flipY&&x.scale(1,-1),x.strokeStyle=K.color||"#111",x.lineWidth=Math.max(1,2/Math.max(tt,.001));const Ne=K.pinConnections||[],be=Ne.length>0&&Ne.length===K.pinCount&&Ne.every(Ae=>Ae&&Ae.trim()!=="");x.fillStyle=be?"rgba(178, 223, 138, 0.85)":"rgba(255,255,255,0.85)",x.beginPath(),x.rect(-P,-P,ne,ne),x.fill(),x.stroke();const Le=K.designator?.trim()||"";if(Le){x.fillStyle=K.color||"#111";const Ae=Math.max(6,ne*.35),ge=ne*.9;let me=Ae;x.font=`bold ${me}px sans-serif`;const Se=x.measureText(Le);Se.width>ge&&(me=ge/Se.width*me,me=Math.max(6,me),x.font=`bold ${me}px sans-serif`),x.textAlign="center",x.textBaseline="middle",x.fillText(Le,0,0)}En.has(K.id)&&(x.setLineDash([4,3]),x.strokeStyle="#00bfff",x.lineWidth=1.5,x.strokeRect(-P-3,-P-3,ne+6,ne+6),x.setLineDash([])),x.restore()};if(yi){const K=P=>{const Ne=parseInt(P,10);if(isNaN(Ne))return null;for(const be of $e)if((be.type==="via"||be.type==="pad"||be.type==="testPoint")&&be.points.length>0){const Le=be.points[0];if(Le.id===Ne)return{x:Le.x,y:Le.y}}for(const be of $e)if(be.type==="trace"){for(const Le of be.points)if(Le.id===Ne)return{x:Le.x,y:Le.y}}for(const be of Pe)if(be.pointId===Ne)return{x:be.x,y:be.y};for(const be of Ee)if(be.pointId===Ne)return{x:be.x,y:be.y};return null},ne=P=>{const Ne=P.pinConnections||[],be=Xf(P)&&P.pinPolarities,Ie=Hl(P)?.category==="Semiconductors",Ae=new Map;for(let ge=0;ge<Ne.length;ge++){const me=Ne[ge];if(me&&me.trim()!==""){const Se=me.trim(),ze=Ie&&ge===0,Oe=!!(be&&P.pinPolarities&&ge<P.pinPolarities.length&&P.pinPolarities[ge]==="-"),Ue=Ae.get(Se);Ue!==void 0?Ae.set(Se,{isNegative:Ue.isNegative||Oe,hasPin1:Ue.hasPin1||ze}):Ae.set(Se,{isNegative:Oe,hasPin1:ze})}}for(const[ge,me]of Ae){const{isNegative:Se,hasPin1:ze}=me,Oe=K(ge);if(Oe){const Ue={x:P.x,y:P.y},Ze=parseInt(ge,10),pt=`${P.id}:${Ze}`,Ct=zr.has(pt);x.save(),Ct?(x.strokeStyle="#00bfff",x.lineWidth=Math.max(2,Fn*1.5/Math.max(tt,.001)),x.setLineDash([4,3])):(Se?x.strokeStyle="rgba(0, 0, 0, 0.8)":ze?x.strokeStyle=g2(rn,.4):x.strokeStyle=rn,x.lineWidth=Math.max(1,Fn/Math.max(tt,.001))),x.beginPath(),x.moveTo(Ue.x,Ue.y),x.lineTo(Oe.x,Oe.y),x.stroke(),x.setLineDash([]),x.restore()}}};X&&Jt.forEach(ne),oe&&Qt.forEach(ne)}if(X&&Jt.forEach(B),oe&&Qt.forEach(B),nu&&ac){x.save();const K=ac.start,ne=ac.end,P=Math.min(K.x,ne.x),Ne=Math.min(K.y,ne.y),be=Math.max(K.x,ne.x),Le=Math.max(K.y,ne.y),Ie=be-P,Ae=Le-Ne,ge=Math.max(2,6/Math.max(1e-4,tt));x.strokeStyle="#ff8800",x.fillStyle="rgba(255, 136, 0, 0.2)",x.lineWidth=Math.max(1,2/Math.max(1e-4,tt)),x.setLineDash([ge,ge]),x.beginPath(),x.rect(P,Ne,Ie,Ae),x.fill(),x.stroke(),x.fillStyle="#ff8800",x.beginPath(),x.arc(K.x,K.y,Math.max(3,6/Math.max(1e-4,tt)),0,Math.PI*2),x.fill(),x.setLineDash([]),x.restore()}if(N==="select"&&Ml){x.save();const K=Math.max(2,6/Math.max(1e-4,tt));x.strokeStyle="#00bfff",x.fillStyle="rgba(0, 191, 255, 0.15)",x.lineWidth=Math.max(1,1.5/Math.max(1e-4,tt)),x.setLineDash([K,K]),x.beginPath(),x.rect(Ml.x,Ml.y,Ml.width,Ml.height),x.fill(),x.stroke(),x.setLineDash([]),x.restore()}if(lo){x.save();const K=50,P=2/tt;x.strokeStyle="#FF0000",x.lineWidth=P,x.lineCap="round",x.lineJoin="round",x.beginPath(),x.moveTo(-K,0),x.lineTo(K,0),x.stroke(),x.fillStyle="#FF0000",x.font=`${12/tt}px sans-serif`,x.textAlign="left",x.textBaseline="top",x.fillText("+X",K+2/tt,2/tt),x.textAlign="right",x.fillText("-X",-K-2/tt,2/tt),x.strokeStyle="#0000FF",x.lineWidth=P,x.lineCap="round",x.lineJoin="round",x.beginPath(),x.moveTo(0,-K),x.lineTo(0,K),x.stroke(),x.fillStyle="#0000FF",x.font=`${12/tt}px sans-serif`,x.textAlign="left",x.textBaseline="top",x.fillText("+Y",2/tt,K+2/tt),x.textBaseline="bottom",x.fillText("-Y",2/tt,-K-2/tt),x.restore()}x.restore()},[o,l,b,$e,jt,Ot,N,Y,U,F,Dn,_t,tt,Qn.x,Qn.y,pn,yn,ks,$a,vo,Da,Ra,_o,Wo,f,C,X,oe,Jt,Qt,he,Pe,Qi,Ee,yi,Ml,vn,En,Ai,wi,zr,di,H,Z,we,de,mt,tn,Ki,rn,Fn,Ui,lo,li,nu,ac]);At.useEffect(()=>{const c=()=>{const x=Ic.current;if(!x)return;const z=1.6,B=244,K=12,ne=6,P=12,Ne=x.clientWidth-B-K,be=x.getBoundingClientRect(),Le=window.innerHeight,Ie=be.top,ge=Le-Ie-ne-10,me=Math.min(x.clientHeight-P,ge),Se=Math.floor(me*z),ze=Math.floor(Ne/z);let Oe,Ue;Se<=Ne?(Oe=Se,Ue=me):(Oe=Ne,Ue=ze),Oe=Math.max(600,Oe),Ue=Math.max(375,Ue),Ue=Math.max(355,Ue-20),mc(Ze=>{const pt=Ze.width===0&&Ze.height===0,Ct=Ze.width!==Oe||Ze.height!==Ue;return pt&&Ct&&setTimeout(()=>{vi({x:0,y:0})},0),Ze.width===Oe&&Ze.height===Ue?Ze:{width:Oe,height:Ue}})};return c(),window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[Oa,vi]),At.useEffect(()=>{Ki&&(Mr&&(Xt(!1),Ti(null)),Cr(null))},[Ki,Mr,Xt,Ti,Cr]);const hp=I.useCallback(c=>{if($e.forEach(x=>{if(x.type==="via"||x.type==="pad"||x.type==="testPoint"||x.testPointType!==void 0||x.type!=="trace")return;let z=!1;if(x.layer==="top"?z=Da:x.layer==="bottom"&&(z=Ra),!!z){if(x.points.length===1){const B=x.points[0],K=Math.max(.5,x.size/2);vn.has(x.id)&&(c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.beginPath(),c.arc(B.x,B.y,K+3,0,Za),c.stroke(),c.setLineDash([])),c.fillStyle=x.color,c.beginPath(),c.arc(B.x,B.y,K,0,Za),c.fill()}else if(vn.has(x.id)&&(c.strokeStyle="#00bfff",c.lineWidth=x.size+4,c.lineCap="round",c.lineJoin="round",c.globalAlpha=.6,c.beginPath(),x.points.forEach((B,K)=>{K===0?c.moveTo(B.x,B.y):c.lineTo(B.x,B.y)}),c.stroke(),c.globalAlpha=1),c.strokeStyle=x.color,c.lineWidth=x.size,c.lineCap="round",c.lineJoin="round",c.globalAlpha=1,c.beginPath(),x.points.forEach((B,K)=>{K===0?c.moveTo(B.x,B.y):c.lineTo(B.x,B.y)}),c.stroke(),Ui){c.fillStyle="#000000";for(const B of x.points)c.beginPath(),c.arc(B.x,B.y,x.size/2,0,Za),c.fill()}}}),$e.forEach(x=>{if(x.type==="via"){if(!vo)return}else if(x.type==="pad"){const B=x.layer||"top";if(B==="top"&&!_o||B==="bottom"&&!Wo)return}else if(x.type==="testPoint"){const B=x.layer||"top";if(B==="top"&&!f||B==="bottom"&&!C)return}else return;const z=x.points[0];if(vn.has(x.id)){if(x.type==="via"){const B=Math.max(.5,x.size/2)+3;c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.beginPath(),c.arc(z.x,z.y,B,0,Za),c.stroke(),c.setLineDash([])}else if(x.type==="pad"){const B=Math.max(.5,x.size/2)+3;c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.strokeRect(z.x-B,z.y-B,x.size+6,x.size+6),c.setLineDash([])}else if(x.type==="testPoint"){const B=Math.max(.5,x.size/2)+3;c.strokeStyle="#00bfff",c.lineWidth=2,c.setLineDash([4,3]),c.beginPath(),c.moveTo(z.x,z.y-B),c.lineTo(z.x+B,z.y),c.lineTo(z.x,z.y+B),c.lineTo(z.x-B,z.y),c.closePath(),c.stroke(),c.setLineDash([])}}if(x.type==="via"){const B=Math.max(.5,x.size/2),K=B*.5,ne=B*.7;c.fillStyle=x.color,c.beginPath(),c.arc(z.x,z.y,B,0,Za),c.arc(z.x,z.y,K,0,Za),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(z.x-ne,z.y),c.lineTo(z.x+ne,z.y),c.stroke(),c.beginPath(),c.moveTo(z.x,z.y-ne),c.lineTo(z.x,z.y+ne),c.stroke()}else if(x.type==="pad"){const B=Math.max(.5,x.size/2),K=x.size,ne=K*.5,P=B*.7;c.fillStyle=x.color,c.beginPath(),c.rect(z.x-B,z.y-B,K,K),c.rect(z.x-ne/2,z.y-ne/2,ne,ne),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(z.x-P,z.y),c.lineTo(z.x+P,z.y),c.stroke(),c.beginPath(),c.moveTo(z.x,z.y-P),c.lineTo(z.x,z.y+P),c.stroke()}else if(x.type==="testPoint"){const B=Math.max(.5,x.size/2),K=B*.7;c.fillStyle=x.color||"#FFFF00",c.strokeStyle="#000000",c.lineWidth=2,c.beginPath(),c.moveTo(z.x,z.y-B),c.lineTo(z.x+B,z.y),c.lineTo(z.x,z.y+B),c.lineTo(z.x-B,z.y),c.closePath(),c.fill(),c.stroke(),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(z.x-K,z.y),c.lineTo(z.x+K,z.y),c.stroke(),c.beginPath(),c.moveTo(z.x,z.y-K),c.lineTo(z.x,z.y+K),c.stroke()}}),jt.length>0){const x=_t;let z=!0;if(N==="draw"&&(mt==="via"?z=vo:z=x==="top"?Da:Ra),z)if(N==="draw")if(mt==="via"){const B=jt[jt.length-1],K=Math.max(.5,U/2),ne=K*.5,P=K*.7;c.fillStyle=Y,c.beginPath(),c.arc(B.x,B.y,K,0,Za),c.arc(B.x,B.y,ne,0,Za),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(B.x-P,B.y),c.lineTo(B.x+P,B.y),c.stroke(),c.beginPath(),c.moveTo(B.x,B.y-P),c.lineTo(B.x,B.y+P),c.stroke()}else if(mt==="pad"){const B=jt[jt.length-1],K=Math.max(.5,U/2),ne=U,P=ne*.5,Ne=K*.7;c.fillStyle=Y,c.beginPath(),c.rect(B.x-K,B.y-K,ne,ne),c.rect(B.x-P/2,B.y-P/2,P,P),c.fill("evenodd"),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(B.x-Ne,B.y),c.lineTo(B.x+Ne,B.y),c.stroke(),c.beginPath(),c.moveTo(B.x,B.y-Ne),c.lineTo(B.x,B.y+Ne),c.stroke()}else if(mt==="testPoint"){const B=jt[jt.length-1],K=Math.max(.5,U/2),ne=K*.7;c.fillStyle=Y,c.beginPath(),c.moveTo(B.x,B.y-K),c.lineTo(B.x+K,B.y),c.lineTo(B.x,B.y+K),c.lineTo(B.x-K,B.y),c.closePath(),c.fill(),c.strokeStyle="#808080",c.lineWidth=1,c.beginPath(),c.moveTo(B.x-ne,B.y),c.lineTo(B.x+ne,B.y),c.stroke(),c.beginPath(),c.moveTo(B.x,B.y-ne),c.lineTo(B.x,B.y+ne),c.stroke()}else{const B=di||"top",K=B==="top"?H:Z,ne=B==="top"?we:de;if(jt.length===1){const P=jt[0],Ne=Math.max(.5,ne/2);c.fillStyle=K,c.beginPath(),c.arc(P.x,P.y,Ne,0,Za),c.fill(),tn&&(c.strokeStyle=K,c.lineWidth=ne,c.lineCap="round",c.lineJoin="round",c.globalAlpha=.6,c.beginPath(),c.moveTo(P.x,P.y),c.lineTo(tn.x,tn.y),c.stroke(),c.globalAlpha=1)}else if(c.strokeStyle=K,c.lineWidth=ne,c.lineCap="round",c.lineJoin="round",c.globalAlpha=1,c.beginPath(),jt.forEach((P,Ne)=>{Ne===0?c.moveTo(P.x,P.y):c.lineTo(P.x,P.y)}),c.stroke(),tn&&jt.length>0){const P=jt[jt.length-1];c.globalAlpha=.6,c.beginPath(),c.moveTo(P.x,P.y),c.lineTo(tn.x,tn.y),c.stroke(),c.globalAlpha=1}}else N==="erase"&&(c.strokeStyle="rgba(255, 0, 0, 0.5)",c.lineWidth=U,c.lineCap="round",c.lineJoin="round",c.globalAlpha=.5,c.beginPath(),jt.forEach((B,K)=>{K===0?c.moveTo(B.x,B.y):c.lineTo(B.x,B.y)}),c.stroke())}},[$e,vn,Da,Ra,vo,_o,Wo,f,C,jt,N,mt,Y,U,_t,di,H,Z,we,de,tn,Ui]),ed=I.useCallback((c,x)=>{if(Ki){alert("Cannot transform: Images are locked. Unlock images to transform them.");return}c==="top"&&o?s(z=>z?{...z,...x}:null):c==="bottom"&&l?d(z=>z?{...z,...x}:null):c==="both"&&(o&&s(z=>z?{...z,...x}:null),l&&d(z=>z?{...z,...x}:null))},[o,l,Ki]),hf=I.useCallback(()=>{Dn&&(ed(Dn,{x:0,y:0,scale:1,rotation:0,flipX:!1,flipY:!1,skewX:0,skewY:0,keystoneV:0,keystoneH:0,brightness:100,contrast:100}),_(!1))},[ed,Dn]),Bl=I.useCallback((c=1)=>{if(vn.size>0||En.size>0||Ai.size>0||wi.size>0){if(vn.size>0){const x=$e.filter(ne=>vn.has(ne.id)),z=Nr&&x.some(ne=>ne.type==="via"),B=oo&&x.some(ne=>ne.type==="trace"),K=pa&&x.some(ne=>ne.type==="pad");if(z){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(B){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(K){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}}if(En.size>0&&Hi){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(Ai.size>0&&Wi){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(wi.size>0&&ho){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(at(x=>x.map(z=>{if(vn.has(z.id)){const B=z.size+c;return z.type==="via"?fe("via",B):z.type==="pad"?fe("pad",B):z.type==="trace"&&fe("trace",B,z.layer),{...z,size:B}}return z})),En.size>0){const x=(En.size>0&&Jt.find(z=>En.has(z.id))?.size||18)+c;fe("component",x),ri(z=>z.map(B=>En.has(B.id)?{...B,size:(B.size||18)+c}:B)),Si(z=>z.map(B=>En.has(B.id)?{...B,size:(B.size||18)+c}:B))}if(Ai.size>0){const x=(Pe.find(z=>Ai.has(z.id))?.size||18)+c;fe("power",x),Wt(z=>z.map(B=>Ai.has(B.id)?{...B,size:B.size+c}:B))}if(wi.size>0){const x=(Ee.find(z=>wi.has(z.id))?.size||18)+c;fe("ground",x),on(z=>z.map(B=>wi.has(B.id)?{...B,size:(B.size||18)+c}:B))}}else{let x=null;if(N==="draw"&&mt==="via"?x="via":N==="draw"&&mt==="pad"?x=ts.current==="bottom"?"padBottom":"padTop":N==="draw"&&mt==="testPoint"?x=ys.current==="bottom"?"testPointBottom":"testPointTop":N==="draw"&&mt==="trace"?x=es.current==="bottom"?"traceBottom":"traceTop":N==="component"?x=Pr.current==="bottom"?"componentBottom":"componentTop":N==="power"?x="power":N==="ground"&&(x="ground"),x){const z=Un.get(x),B=Math.min(40,z.size+c);Un.setSize(x,B)}}},[vn,En,Ai,wi,$e,Nr,oo,pa,Zo,Hi,Wi,ho,N,mt,fe]),td=I.useCallback((c=1)=>{if(vn.size>0||En.size>0||Ai.size>0||wi.size>0){if(vn.size>0){const x=$e.filter(P=>vn.has(P.id)),z=Nr&&x.some(P=>P.type==="via"),B=oo&&x.some(P=>P.type==="trace"),K=pa&&x.some(P=>P.type==="pad"),ne=Zo&&x.some(P=>P.type==="testPoint");if(z){alert("Cannot change size: Vias are locked. Unlock vias to change their size.");return}if(B){alert("Cannot change size: Traces are locked. Unlock traces to change their size.");return}if(K){alert("Cannot change size: Pads are locked. Unlock pads to change their size.");return}if(ne){alert("Cannot change size: Test Points are locked. Unlock test points to change their size.");return}}if(En.size>0&&Hi){alert("Cannot change size: Components are locked. Unlock components to change their size.");return}if(Ai.size>0&&Wi){alert("Cannot change size: Power nodes are locked. Unlock power nodes to change their size.");return}if(wi.size>0&&ho){alert("Cannot change size: Ground nodes are locked. Unlock ground nodes to change their size.");return}if(at(x=>x.map(z=>{if(vn.has(z.id)){const B=Math.max(1,z.size-c);return z.type==="via"?fe("via",B):z.type==="pad"?fe("pad",B,z.layer):z.type==="testPoint"?fe("testPoint",B,z.layer):z.type==="trace"&&fe("trace",B,z.layer),{...z,size:B}}return z})),En.size>0){const x=Math.max(12,(En.size>0&&Jt.find(z=>En.has(z.id))?.size||18)-c);fe("component",x),ri(z=>z.map(B=>En.has(B.id)?{...B,size:Math.max(12,(B.size||18)-c)}:B)),Si(z=>z.map(B=>En.has(B.id)?{...B,size:Math.max(12,(B.size||18)-c)}:B))}if(Ai.size>0){const x=Math.max(12,(Pe.find(z=>Ai.has(z.id))?.size||18)-c);fe("power",x),Wt(z=>z.map(B=>Ai.has(B.id)?{...B,size:Math.max(12,B.size-c)}:B))}if(wi.size>0){const x=Math.max(12,(Ee.find(z=>wi.has(z.id))?.size||18)-c);fe("ground",x),on(z=>z.map(B=>wi.has(B.id)?{...B,size:Math.max(12,(B.size||18)-c)}:B))}}else{let x=null;if(N==="draw"&&mt==="via"?x="via":N==="draw"&&mt==="pad"?x=(_t||Gn||"top")==="bottom"?"padBottom":"padTop":N==="draw"&&mt==="testPoint"?x=(_t||fi||"top")==="bottom"?"testPointBottom":"testPointTop":N==="draw"&&mt==="trace"?x=(_t||di||"top")==="bottom"?"traceBottom":"traceTop":N==="component"?x=(_t||Di||"top")==="bottom"?"componentBottom":"componentTop":N==="power"?x="power":N==="ground"&&(x="ground"),x){const z=Un.get(x),B=Math.max(1,z.size-c);Un.setSize(x,B)}}},[vn,En,Ai,wi,$e,Nr,oo,pa,Zo,Hi,Wi,ho,N,mt,_t,Gn,fi,di,Di,fe]),Sh=I.useCallback(()=>{const c=Pa.size;if(vn.size>0||En.size>0||Ai.size>0||wi.size>0){if(vn.size>0){const x=$e.filter(P=>vn.has(P.id)),z=Nr&&x.some(P=>P.type==="via"),B=pa&&x.some(P=>P.type==="pad"),K=oo&&x.some(P=>P.type==="trace"),ne=Zo&&x.some(P=>P.type==="testPoint");if(z||B||K||ne){alert("Cannot change size: selected items are locked.");return}}if(En.size>0&&Hi){alert("Cannot change size: selected components are locked.");return}if(Ai.size>0&&Wi){alert("Cannot change size: selected power nodes are locked.");return}if(wi.size>0&&ho){alert("Cannot change size: selected ground nodes are locked.");return}at(x=>x.map(z=>vn.has(z.id)?(z.type==="via"?(fe("via",c),dr(B=>{const K=new Map(B),ne=K.get("via");return ne&&K.set("via",{...ne,settings:{...ne.settings,size:c}}),K})):z.type==="pad"?(fe("pad",c,z.layer),dr(B=>{const K=new Map(B),ne=K.get("pad");if(ne){const P=new Map(ne.layerSettings);P.set(z.layer,{...P.get(z.layer)||{color:ne.settings.color,size:c},size:c}),K.set("pad",{...ne,layerSettings:P})}return K})):z.type==="testPoint"?(fe("testPoint",c,z.layer),dr(B=>{const K=new Map(B),ne=K.get("testPoint");if(ne){const P=new Map(ne.layerSettings);P.set(z.layer,{...P.get(z.layer)||{color:ne.settings.color,size:c},size:c}),K.set("testPoint",{...ne,layerSettings:P})}return K})):z.type==="trace"&&fe("trace",c,z.layer),{...z,size:c}):z)),En.size>0&&(fe("component",c),ri(x=>x.map(z=>En.has(z.id)?{...z,size:c}:z)),Si(x=>x.map(z=>En.has(z.id)?{...z,size:c}:z))),Ai.size>0&&(fe("power",c),Wt(x=>x.map(z=>Ai.has(z.id)?{...z,size:c}:z))),wi.size>0&&(fe("ground",c),on(x=>x.map(z=>wi.has(z.id)?{...z,size:c}:z)))}else $(c),N==="draw"&&mt==="trace"?_t==="top"?(te(c),fe("trace",c,"top")):(Ce(c),fe("trace",c,"bottom")):N==="draw"&&mt==="via"?fe("via",c):N==="draw"&&mt==="pad"?fe("pad",c,_t):N==="draw"&&mt==="testPoint"?fe("testPoint",c,_t):fe(N==="component"?"component":N==="power"?"power":N==="ground"?"ground":"brush",c);os({visible:!1,size:6})},[Pa.size,vn,En,Ai,wi,$e,Nr,oo,Hi,Wi,ho,N,mt,_t,fe,pi,dr]),gp=I.useCallback(()=>{ao({visible:!1,source:null,interval:5})},[]),Ol=I.useCallback(async(c,x=!1)=>{await Hd(c,Kr,oi,so,ko,xo,Xr,lr,Zr,zi,Ci,No,ao,kr,us,x)},[Kr,oi,so,ko,xo,Xr,lr,Zr,zi,Ci,No,ao,kr,us]),lu=I.useCallback(()=>{Ut(),g("select")},[Ut]),_d=I.useCallback(c=>{if(c.key==="Escape"){const P=document.activeElement;if(P&&(P.tagName==="INPUT"&&P.type==="checkbox"||P.tagName==="INPUT"&&P.type==="radio")){P.blur(),c.preventDefault(),c.stopPropagation();return}}const x=document.activeElement;if(x&&(x.tagName==="INPUT"&&x.type!=="checkbox"&&x.type!=="radio"||x.tagName==="TEXTAREA"||x.isContentEditable))return;const z=cs.current>0;if(z&&c.key!=="m"&&c.key!=="M")return;const B=parseInt(c.key);if(!isNaN(B)&&B>=0&&B<=9){if(c.preventDefault(),c.stopPropagation(),N==="center"&&Vu){if(Vn.current&&(clearTimeout(Vn.current),Vn.current=null),Tt.current){let be=0,Le=0;o?(be=o.x,Le=o.y):l&&(be=l.x,Le=l.y),Cs(Ie=>({...Ie,[B]:{pcbReferenceX:be,pcbReferenceY:Le,x:0,y:0,zoom:tt,viewRotation:pn,viewFlipX:yn,isBottomView:qa,transparency:b,showTopImage:ks,showBottomImage:$a,showViasLayer:vo,showTopTracesLayer:Da,showBottomTracesLayer:Ra,showTopPadsLayer:_o,showBottomPadsLayer:Wo,showTopTestPointsLayer:f,showBottomTestPointsLayer:C,showTopComponents:X,showBottomComponents:oe,showPowerLayer:he,showGroundLayer:Qi,showConnectionsLayer:yi}}))}cr(!1),g("select"),ki(void 0);return}const P=kl[B];if(P){Bt(P.zoom),An(P.viewRotation??0),$n(P.viewFlipX??!1),rr(P.isBottomView??!1),m(P.transparency??50);const Ne=P.pcbReferenceX??P.x??0,be=P.pcbReferenceY??P.y??0;let Le=0,Ie=0;o?(Le=o.x,Ie=o.y):l&&(Le=l.x,Ie=l.y);const Ae=Ne-Le,ge=be-Ie;(Math.abs(Ae)>.001||Math.abs(ge)>.001)&&(o&&s({...o,x:o.x+Ae,y:o.y+ge}),l&&d({...l,x:l.x+Ae,y:l.y+ge}),ri(Jt.map(me=>({...me,x:me.x+Ae,y:me.y+ge}))),Si(Qt.map(me=>({...me,x:me.x+Ae,y:me.y+ge}))),Wt(vt.map(me=>({...me,x:me.x+Ae,y:me.y+ge}))),on(Zt.map(me=>({...me,x:me.x+Ae,y:me.y+ge}))),at($e.map(me=>({...me,points:me.points.map(Se=>({...Se,x:Se.x+Ae,y:Se.y+ge}))}))),Xo(Na.map(me=>({...me,x:me.x+Ae,y:me.y+ge}))),pr($r.map(me=>({...me,x:me.x+Ae,y:me.y+ge})))),vi({x:0,y:0}),Er(P.showTopImage),bo(P.showBottomImage),Ga(P.showViasLayer),ds(P.showTopTracesLayer),Li(P.showBottomTracesLayer),oa(P.showTopPadsLayer),va(P.showBottomPadsLayer),y(P.showTopTestPointsLayer),L(P.showBottomTestPointsLayer),ie(P.showTopComponents),ce(P.showBottomComponents),je(P.showPowerLayer),ji(P.showGroundLayer),Yi(P.showConnectionsLayer)}return}if(c.key==="+"||c.key==="="){c.preventDefault(),c.stopPropagation(),Bl(c.shiftKey?5:1);return}if(c.key==="-"||c.key==="_"){c.preventDefault(),c.stopPropagation(),td(c.shiftKey?5:1);return}const K=c.shiftKey||c.getModifierState("CapsLock"),ne=N==="transform"&&Dn;if(c.key==="ArrowUp"||c.key==="ArrowDown"||c.key==="ArrowLeft"||c.key==="ArrowRight"){if(En.size>0){c.preventDefault(),c.stopPropagation();const P=c.shiftKey?10:1;let Ne=0,be=0;c.key==="ArrowUp"?be=-P:c.key==="ArrowDown"?be=P:c.key==="ArrowLeft"?Ne=-P:c.key==="ArrowRight"&&(Ne=P);for(const Le of En){const Ie=Jt.find(Ae=>Ae.id===Le);if(Ie){const Ae=Ie.x+Ne,ge=Ie.y+be,me=sr({x:Ae,y:ge});ri(Se=>Se.map(ze=>ze.id===Le?{...ze,x:me.x,y:me.y}:ze))}else{const Ae=Qt.find(ge=>ge.id===Le);if(Ae){const ge=Ae.x+Ne,me=Ae.y+be,Se=sr({x:ge,y:me});Si(ze=>ze.map(Oe=>Oe.id===Le?{...Oe,x:Se.x,y:Se.y}:Oe))}}}return}if(K&&!ne&&En.size===0){if(c.key==="ArrowUp"||c.key==="ArrowDown"){c.preventDefault(),c.stopPropagation();const P=c.key==="ArrowUp"?-90:90;rf(P);return}else if(c.key==="ArrowLeft"||c.key==="ArrowRight"){c.preventDefault(),c.stopPropagation(),wd();return}}}if((c.key==="I"||c.key==="i")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;c.preventDefault(),c.stopPropagation();const be=[];vn.size>0,vn.size===0&&En.size===0&&Ai.size===0&&wi.size===0&&be.push(`
No objects selected.`);const Le=be.join(`
`);console.log(Le),Ur({visible:!0,text:Le});return}if((c.key==="N"||c.key==="n")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;c.preventDefault(),c.stopPropagation(),co(!0);return}if((c.key==="L"||c.key==="l")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;c.preventDefault(),c.stopPropagation(),pl(!0);return}if((c.key==="E"||c.key==="e")&&!c.ctrlKey&&!c.shiftKey&&!c.altKey){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;c.preventDefault(),c.stopPropagation(),cs.current<=0&&Ho(!0);return}if(c.key==="O"||c.key==="o"){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;c.preventDefault(),c.stopPropagation();const be=kl[0];if(be){Bt(be.zoom),An(be.viewRotation??0),$n(be.viewFlipX??!1),rr(be.isBottomView??!1),m(be.transparency??50);const Le=be.pcbReferenceX??be.x??0,Ie=be.pcbReferenceY??be.y??0;let Ae=0,ge=0;o?(Ae=o.x,ge=o.y):l&&(Ae=l.x,ge=l.y);const me=Le-Ae,Se=Ie-ge;(Math.abs(me)>.001||Math.abs(Se)>.001)&&(o&&s({...o,x:o.x+me,y:o.y+Se}),l&&d({...l,x:l.x+me,y:l.y+Se}),ri(Jt.map(ze=>({...ze,x:ze.x+me,y:ze.y+Se}))),Si(Qt.map(ze=>({...ze,x:ze.x+me,y:ze.y+Se}))),Wt(vt.map(ze=>({...ze,x:ze.x+me,y:ze.y+Se}))),on(Zt.map(ze=>({...ze,x:ze.x+me,y:ze.y+Se}))),at($e.map(ze=>({...ze,points:ze.points.map(Oe=>({...Oe,x:Oe.x+me,y:Oe.y+Se}))}))),Xo(Na.map(ze=>({...ze,x:ze.x+me,y:ze.y+Se}))),pr($r.map(ze=>({...ze,x:ze.x+me,y:ze.y+Se})))),Er(be.showTopImage),bo(be.showBottomImage),Ga(be.showViasLayer),ds(be.showTopTracesLayer),Li(be.showBottomTracesLayer),oa(be.showTopPadsLayer),va(be.showBottomPadsLayer),y(be.showTopTestPointsLayer),L(be.showBottomTestPointsLayer),ie(be.showTopComponents),ce(be.showBottomComponents),je(be.showPowerLayer),ji(be.showGroundLayer),Yi(be.showConnectionsLayer)}else Bt(1),An(0),$n(!1),rr(!1),m(0);vi({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),p("overlay"),jn(new Set),mn(new Set),xn(new Set),Tn(new Set),g("select");return}if((c.key==="Alt"||c.altKey)&&(Zu(!0),Qr(!0)),c.key==="Escape"){c.preventDefault(),c.stopPropagation(),lu(),Rl(!1),Su(!1),Sc(!1),Sn(!1),ga(!1),dp(null);return}if(c.key==="Enter"&&N==="draw"&&mt==="trace"){Nu();return}if((c.key==="Delete"||c.key==="Backspace")&&(vn.size>0||En.size>0||Ai.size>0||wi.size>0)){if(c.preventDefault(),c.stopPropagation(),Mi($e,Jt,Qt,vt,Zt),vn.size>0){const P=$e.filter(Ae=>vn.has(Ae.id)),Ne=Nr&&P.some(Ae=>Ae.type==="via"),be=oo&&P.some(Ae=>Ae.type==="trace"),Le=pa&&P.some(Ae=>Ae.type==="pad"),Ie=Zo&&P.some(Ae=>Ae.type==="testPoint");Ne?alert("Cannot delete: Vias are locked. Unlock vias to delete them."):be?alert("Cannot delete: Traces are locked. Unlock traces to delete them."):Le?alert("Cannot delete: Pads are locked. Unlock pads to delete them."):Ie?alert("Cannot delete: Test points are locked. Unlock test points to delete them."):(at(Ae=>Ae.filter(ge=>!vn.has(ge.id))),jn(new Set))}En.size>0&&(Hi?alert("Cannot delete: Components are locked. Unlock components to delete them."):(ri(P=>P.filter(Ne=>!En.has(Ne.id))),Si(P=>P.filter(Ne=>!En.has(Ne.id))),mn(new Set))),Ai.size>0&&(Wi?alert("Cannot delete: Power nodes are locked. Unlock power nodes to delete them."):(Wt(P=>P.filter(Ne=>!Ai.has(Ne.id))),xn(new Set))),wi.size>0&&(ho?alert("Cannot delete: Ground nodes are locked. Unlock ground nodes to delete them."):(on(P=>P.filter(Ne=>!wi.has(Ne.id))),Tn(new Set)));return}if((c.key==="z"||c.key==="Z")&&(c.ctrlKey||c.metaKey)&&!c.shiftKey&&!c.altKey){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;c.preventDefault(),c.stopPropagation();const be=vr();if(be){const Le=new Set(be.drawingStrokes.map(me=>me.id));for(const me of $e)if(!Le.has(me.id))for(const Se of me.points)Se.id&&typeof Se.id=="number"&&Vp(Se.id);const Ie=new Set([...be.componentsTop.map(me=>me.id),...be.componentsBottom.map(me=>me.id)]);for(const me of[...Jt,...Qt])if(!Ie.has(me.id)){for(const Se of me.pinConnections)if(Se&&Se.trim()!==""){const ze=parseInt(Se,10);!isNaN(ze)&&ze>0&&Vp(ze)}}const Ae=new Set(be.powerSymbols.map(me=>me.id));for(const me of vt)!Ae.has(me.id)&&me.pointId&&typeof me.pointId=="number"&&Vp(me.pointId);const ge=new Set(be.groundSymbols.map(me=>me.id));for(const me of Zt)!ge.has(me.id)&&me.pointId&&typeof me.pointId=="number"&&Vp(me.pointId);at(be.drawingStrokes),ri(be.componentsTop),Si(be.componentsBottom),Wt(be.powerSymbols),on(be.groundSymbols),Ft([])}return}if((c.key==="c"||c.key==="C")&&(c.ctrlKey||c.metaKey)&&!c.shiftKey&&!c.altKey){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;if(En.size===1){c.preventDefault(),c.stopPropagation();const be=Array.from(En)[0],Le=[...Jt,...Qt].find(Ie=>Ie.id===be);Le&&(Ku(Le),console.log("Component copied:",Le.id,Le.designator))}return}if((c.key==="v"||c.key==="V")&&(c.ctrlKey||c.metaKey)&&!c.shiftKey&&!c.altKey){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;if(Os&&!Hi){c.preventDefault(),c.stopPropagation();const be=[...Jt,...Qt];let Le;Sr?Le=Uf():Le={...ai.current};let Ie;if(Os.designator){const Se=Os.designator.match(/^([A-Za-z]+)(\d+)$/);Se?Ie=Se[1]:Ie=cg(Os.componentType)}else Ie=cg(Os.componentType);const Ae=x2(Ie,be,Le),ge=`${Ie}${Ae}`;if(Sr){const Se=Uf();m1(Ie,Ae,Se)}else ai.current[Ie]=Math.max(ai.current[Ie]||0,Ae);const me={...Os,id:Hy("comp"),designator:ge,pinConnections:new Array(Os.pinCount).fill(""),pinPolarities:Os.pinPolarities?new Array(Os.pinCount).fill(""):void 0,x:Os.x+5,y:Os.y+5};Os.pinNames&&(me.pinNames=[...Os.pinNames]),me.layer==="top"?ri(Se=>[...Se,me]):Si(Se=>[...Se,me]),Ut(),mn(new Set([me.id])),console.log("Component pasted:",me.id,me.designator)}return}if(c.code==="KeyV"&&c.altKey&&!c.ctrlKey&&!c.shiftKey&&!z){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;c.preventDefault(),c.stopPropagation(),oc(!1),gl(!0);return}if(c.code==="KeyP"&&c.altKey&&!c.ctrlKey&&!c.shiftKey&&!z){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;c.preventDefault(),c.stopPropagation(),oc(!0),gl(!0);return}if((c.key==="a"||c.key==="A")&&!c.ctrlKey&&!c.altKey&&!c.shiftKey&&!z){const P=document.activeElement;if(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable))return;if(En.size>0){c.preventDefault(),c.stopPropagation();const be=Array.from(En),Le=be[be.length-1];let Ie=null,Ae=null;Ie=Jt.find(ge=>ge.id===Le)||null,Ie?Ae="top":(Ie=Qt.find(ge=>ge.id===Le)||null,Ie&&(Ae="bottom")),Ie&&Ae&&j(Ie,Ae)}return}if(!c.ctrlKey&&!c.altKey){const P=document.activeElement;if(!(!!P&&(P.tagName==="INPUT"&&P.type!=="range"&&P.type!=="checkbox"&&P.type!=="radio"||P.tagName==="TEXTAREA"||P.isContentEditable)))switch(c.key){case"s":case"S":c.preventDefault(),Ut(),lu();return;case"b":case"B":c.preventDefault(),Ut(),pe.length===1?(hi(pe[0].id),g("power"),Sn(!1),je(!0)):pe.length>1?Sn(!0):(Sn(!0),g("power"),je(!0));return;case"g":case"G":c.preventDefault(),Ut(),qe.length===1?($i(qe[0].id),g("ground"),_i(!1),ji(!0)):qe.length>1?_i(!0):(_i(!0),g("ground"),ji(!0));return;case"v":case"V":c.preventDefault(),Ut(),cn("via"),g("draw"),Ga(!0);return;case"p":case"P":c.preventDefault(),Ut(),cn("pad"),g("draw");return;case"y":case"Y":c.preventDefault(),Ut(),cn("testPoint"),g("draw");return;case"t":case"T":c.preventDefault(),Ut(),cn("trace"),g("draw");return;case"c":case"C":c.preventDefault(),Ut(),g("component"),Nd.current?jc(Nd.current):jc(null);return;case"e":case"E":c.preventDefault(),Ut(),g("erase");return;case"h":case"H":c.preventDefault(),Ut(),g("pan");return;case"x":case"X":c.preventDefault(),Ut(),g("center"),cr(!0),Vn.current&&clearTimeout(Vn.current),Vn.current=setTimeout(()=>{cr(!1),g("select"),ki(void 0)},2e3);return;case"m":case"M":if(!c.ctrlKey){c.preventDefault(),Ut(),tu(!1),g("magnify");return}break}}if(N==="transform"&&Dn){if(!(c.key==="ArrowLeft"||c.key==="ArrowRight"||c.key==="ArrowUp"||c.key==="ArrowDown"))return;c.preventDefault(),c.stopPropagation();const Ne=document.activeElement;if(Ne&&Ne.tagName==="INPUT"){const be=Ne;be.type==="radio"&&be.blur()}if(Ki)return;if(Ln==="nudge"){let be=0,Le=0;switch(c.key){case"ArrowLeft":be=-1;break;case"ArrowRight":be=1;break;case"ArrowUp":Le=-1;break;case"ArrowDown":Le=1;break;default:return}Dn==="top"&&o?s(Ie=>Ie?{...Ie,x:Ie.x+be,y:Ie.y+Le}:null):Dn==="bottom"&&l?d(Ie=>Ie?{...Ie,x:Ie.x+be,y:Ie.y+Le}:null):Dn==="both"&&(o&&s(Ie=>Ie?{...Ie,x:Ie.x+be,y:Ie.y+Le}:null),l&&d(Ie=>Ie?{...Ie,x:Ie.x+be,y:Ie.y+Le}:null))}else if(Ln==="scale"){let be=0;switch(c.key){case"ArrowUp":be=.01;break;case"ArrowDown":be=-.01;break;case"ArrowRight":be=.001;break;case"ArrowLeft":be=-.001;break;default:return}if(Dn==="top"){o&&s(Le=>Le?{...Le,scale:Math.max(.1,Math.min(3,Le.scale+be))}:null);return}if(Dn==="bottom"){l&&d(Le=>Le?{...Le,scale:Math.max(.1,Math.min(3,Le.scale+be))}:null);return}if(Dn==="both"){o&&s(Le=>Le?{...Le,scale:Math.max(.1,Math.min(3,Le.scale+be))}:null),l&&d(Le=>Le?{...Le,scale:Math.max(.1,Math.min(3,Le.scale+be))}:null);return}}else if(Ln==="rotate"){let be=0;switch(c.key){case"ArrowUp":be=1;break;case"ArrowDown":be=-1;break;case"ArrowRight":be=.1;break;case"ArrowLeft":be=-.1;break;default:return}if(Dn==="top"){o&&s(Le=>Le?{...Le,rotation:Le.rotation+be}:null);return}if(Dn==="bottom"){l&&d(Le=>Le?{...Le,rotation:Le.rotation+be}:null);return}if(Dn==="both"){o&&s(Le=>Le?{...Le,rotation:Le.rotation+be}:null),l&&d(Le=>Le?{...Le,rotation:Le.rotation+be}:null);return}}else if(Ln==="slant"){let be=0,Le=0;switch(c.key){case"ArrowUp":Le=-.5;break;case"ArrowDown":Le=.5;break;case"ArrowLeft":be=-.5;break;case"ArrowRight":be=.5;break}if(be!==0||Le!==0){const Ie=gu,Ae=ge=>Math.max(-.7,Math.min(.7,ge));if(Dn==="top"){o&&s(ge=>ge?{...ge,skewX:Ae((ge.skewX||0)+Ie(be)),skewY:Ae((ge.skewY||0)+Ie(Le))}:null);return}if(Dn==="bottom"){l&&d(ge=>ge?{...ge,skewX:Ae((ge.skewX||0)+Ie(be)),skewY:Ae((ge.skewY||0)+Ie(Le))}:null);return}if(Dn==="both"){o&&s(ge=>ge?{...ge,skewX:Ae((ge.skewX||0)+Ie(be)),skewY:Ae((ge.skewY||0)+Ie(Le))}:null),l&&d(ge=>ge?{...ge,skewX:Ae((ge.skewX||0)+Ie(be)),skewY:Ae((ge.skewY||0)+Ie(Le))}:null);return}}}else if(Ln==="keystone"){let be=0,Le=0;switch(c.key){case"ArrowUp":Le=-.5;break;case"ArrowDown":Le=.5;break;case"ArrowLeft":be=-.5;break;case"ArrowRight":be=.5;break}if(be!==0||Le!==0){const Ie=gu,Ae=ge=>Math.max(-.35,Math.min(.35,ge));if(Dn==="top"){o&&s(ge=>ge?{...ge,keystoneH:Ae((ge.keystoneH||0)+Ie(be)),keystoneV:Ae((ge.keystoneV||0)+Ie(Le))}:null);return}if(Dn==="bottom"){l&&d(ge=>ge?{...ge,keystoneH:Ae((ge.keystoneH||0)+Ie(be)),keystoneV:Ae((ge.keystoneV||0)+Ie(Le))}:null);return}if(Dn==="both"){o&&s(ge=>ge?{...ge,keystoneH:Ae((ge.keystoneH||0)+Ie(be)),keystoneV:Ae((ge.keystoneV||0)+Ie(Le))}:null),l&&d(ge=>ge?{...ge,keystoneH:Ae((ge.keystoneH||0)+Ie(be)),keystoneV:Ae((ge.keystoneV||0)+Ie(Le))}:null);return}}}}else{const P=c.target;if(P.tagName==="INPUT"&&P.type==="range"){const Ne=P,be=Number(Ne.value),Le=Number(Ne.min),Ie=Number(Ne.max),Ae=Number(Ne.step)||1;switch(c.key){case"ArrowLeft":c.preventDefault();const ge=Math.max(Le,be-Ae);Ne.value=ge.toString(),Ne.dispatchEvent(new Event("input",{bubbles:!0}));break;case"ArrowRight":c.preventDefault();const me=Math.min(Ie,be+Ae);Ne.value=me.toString(),Ne.dispatchEvent(new Event("input",{bubbles:!0}));break}}}},[N,Dn,Ln,o,l,vn,En,Ai,wi,$e,Jt,Qt,Pe,Ee,pe,mt,Nu,di,H,Z,we,de,lu,ri,Si,vr,at,Wt,on,vt,Zt,wd,rf,kl,tt,pn,yn,qa,b,Bt,An,$n,rr,m,s,d,Xo,pr,vi,p,jn,mn,xn,Tn,g,Na,$r,ks,$a,vo,Da,Ra,_o,Wo,f,C,X,oe,he,Qi,yi,Er,bo,Ga,ds,Li,oa,va,y,L,ie,ce,je,ji,Yi,oc,gl,j]);At.useEffect(()=>{N!=="transform"&&Cr(null)},[N]),At.useEffect(()=>{window.addEventListener("keydown",_d,!0);const c=x=>{x.key==="Alt"&&(Zu(!1),Qr(!1),ma(null))};return window.addEventListener("keyup",c,!0),()=>{window.removeEventListener("keydown",_d,!0),window.removeEventListener("keyup",c,!0)}},[_d,Ai,wi,Wi,Wi,Pe,Ee,Bl,td,lu,En,Jt,Qt,ri,Si,kl,Vu,N]);const uc=I.useCallback(()=>{ai.current={},R("#AA4499"),G("#F781BF"),te(6),Ce(6),lt("trace","#AA4499","top"),lt("trace","#F781BF","bottom"),fe("trace",6,"top"),fe("trace",6,"bottom"),xe("#0072B2"),A("#56B4E9"),W(18),Te(18),lt("pad","#0072B2","top"),lt("pad","#56B4E9","bottom"),fe("pad",18,"top"),fe("pad",18,"bottom"),ut("#6A3D9A"),Et("#9467BD"),Qe(18),dn(18),lt("component","#6A3D9A","top"),lt("component","#9467BD","bottom"),fe("component",18,"top"),fe("component",18,"bottom"),To("top"),ee("#AA4499"),$(6),Me([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),xt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),fe("power",18),fe("ground",18),da(!1),fa(!1),ha(!1),za(!1),rs(!1),Yr(!1),Yt("top"),g("select"),m(50),D(!1),p("overlay"),Hf(),wr()},[lt,fe,wr]),nd=I.useCallback(()=>{kr(null),xo(null),Zi(""),zo(""),so(!1),ko(null),Xr(""),Ha([]),Fr(-1),go(!1),rr(!1),or(null),ls(null),zi.current&&(clearInterval(zi.current),zi.current=null),s(null),d(null),wr(),at([]),Xo([]),pr([]),Ba([]),zn([]),Ft([]),gn.current=[],ri([]),Si([]),Fa(null),ka(null),Wt([]),on([]),ci(null),Me([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),xt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),jn(new Set),mn(new Set),xn(new Set),Tn(new Set),Eo(!1),fl([]),Ya({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),p("overlay"),Bt(1),Go(0,0),Ia(!0),Yt("top"),Cs({}),cr(!1),Vn.current&&(clearTimeout(Vn.current),Vn.current=null),Cr(null),Xt(!1),Ti(null),Rt("nudge"),_(!1),m(50),D(!1),S(2e3),da(!1),fa(!1),ws(!1),Aa(!1),ha(!1),za(!1),rs(!1),Yr(!1),Er(!0),bo(!0),Ga(!0),ds(!0),Li(!0),oa(!0),va(!0),y(!0),L(!0),ie(!0),ce(!0),je(!0),ji(!0),Yi(!0),Rr(!0),g("select"),cn("trace"),To("top"),gs("top"),Uo("top"),_s("top"),es.current="top",ts.current="top",ys.current="top",Pr.current="top",ai.current={},eo(!0),ii(!1),Hf(),Un.initialize(),Ds(null),Ur({visible:!1,text:""}),Jo({visible:!1,title:"",message:""}),Ea({visible:!1}),Kl({visible:!1}),Ss({visible:!1,projectName:"",locationPath:"",locationHandle:null}),Qo({visible:!1,filename:"",locationPath:"",locationHandle:null}),No({visible:!1,interval:null}),ao({visible:!1,source:"new",interval:5}),ga(!1),He(!1),ar(!1),hr(!1),Bs(!1),co(!1),pl(!1),Js(!1),Ho(!1),Ms(null),ma(null),ba(null),Wa(!1),mo.current=null,Po.current=null,Vt(!1),ln(null),fn.current=0,bn.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[]);I.useCallback(()=>{kr(null),xo(null),ta&&(ta.current=null),lr&&(lr.current=null),Zi(""),zo(""),so(!1),ko(null),Xr(""),Ha([]),Fr(-1),Zr&&(Zr.current=""),Ci.current=!1,go(!1),rr(!1),or(null),ls(null),zi.current&&(clearInterval(zi.current),zi.current=null),s(null),d(null),wr(),at([]),Xo([]),pr([]),Ba([]),zn([]),Ft([]),gn.current=[],ri([]),Si([]),Fa(null),ka(null),Wt([]),on([]),ci(null),Me([{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}]),xt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),jn(new Set),mn(new Set),xn(new Set),Tn(new Set),Eo(!1),fl([]),Ya({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),p("overlay"),Bt(1),Go(0,0),Ia(!0),Yt("top"),Cs({}),cr(!1),Vn.current&&(clearTimeout(Vn.current),Vn.current=null),Cr(null),Xt(!1),Ti(null),Rt("nudge"),_(!1),m(50),D(!1),S(2e3),da(!1),fa(!1),ws(!1),Aa(!1),ha(!1),za(!1),rs(!1),Yr(!1),Er(!0),bo(!0),Ga(!0),ds(!0),Li(!0),oa(!0),va(!0),y(!0),L(!0),ie(!0),ce(!0),je(!0),ji(!0),Yi(!0),Rr(!0),g("select"),cn("trace"),To("top"),gs("top"),Uo("top"),_s("top"),es.current="top",ts.current="top",ys.current="top",Pr.current="top",ai.current={},eo(!0),ii(!1),Hf(),Un.initialize(),Ds(null),Ur({visible:!1,text:""}),Jo({visible:!1,title:"",message:""}),Ea({visible:!1}),Kl({visible:!1}),Ss({visible:!1,projectName:"",locationPath:"",locationHandle:null}),Qo({visible:!1,filename:"",locationPath:"",locationHandle:null}),No({visible:!1,interval:null}),ao({visible:!1,source:"new",interval:5}),ga(!1),He(!1),ar(!1),hr(!1),Bs(!1),co(!1),pl(!1),Js(!1),Ms(null),ma(null),ba(null),Wa(!1),mo.current=null,Po.current=null,Vt(!1),ln(null),fn.current=0,bn.current=!1,console.log("Project closed: All state cleared and browser permissions released")},[kr,xo,Zi,zo,so,ko,Xr,Ha,Fr,s,d,at,Ft,Xo,pr,Ba,zn,ri,Si,Fa,ka,Wt,on,ci,Me,xt,jn,mn,xn,Tn,Eo,fl,p,Bt,Oa,Ia,Yt,Cs,cr,Cr,Xt,Ti,Rt,_,m,D,S,da,fa,ws,Aa,ha,za,rs,Yr,Er,bo,Ga,ds,Li,oa,va,y,L,ie,ce,je,ji,Yi,g,cn,To,gs,Uo,_s,eo,ii,Ds,Ur,Jo,Ea,Ss,Qo,No,ao,wr,ga,He,ar,hr,Bs,co,pl,Ms,ma,ba,Wa,Vt,ln]);const er=I.useCallback(()=>{uc(),setTimeout(()=>{Bt(1),vi({x:0,y:0}),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),jn(new Set),mn(new Set),xn(new Set),Tn(new Set)},200)},[uc,Bt,vi]);At.useEffect(()=>{er()},[]),At.useEffect(()=>{if(!qo.visible)return;const c=[];vn.size>0,vn.size===0&&En.size===0&&Ai.size===0&&wi.size===0&&c.push(`
No objects selected.`);const x=c.join(`
`);Ur(z=>({...z,text:x}))},[qo.visible,vn,En,Ai,wi,$e,Jt,Qt,Pe,Ee,pe]),At.useEffect(()=>{const c=x=>{const z=Tt.current;if(z&&!(x.target instanceof Node&&z.contains(x.target))){if(Nu(),wu){const B=Fc.current;(!B||!(x.target instanceof Node)||!B.contains(x.target))&&Rl(!1)}if(Vo){const B=Ns.current;!x.target?.closest('button[title="Color Picker"]')&&(!B||!(x.target instanceof Node)||!B.contains(x.target))&&ga(!1)}}};return document.addEventListener("mousedown",c,!0),()=>document.removeEventListener("mousedown",c,!0)},[Nu,wu,ru,Vo]);const id=c=>{if(!c.current)return{top:0,left:0};const x=c.current.getBoundingClientRect(),z=Ic.current?.getBoundingClientRect();return z?{top:x.top-z.top,left:x.left-z.left+x.width+4}:{top:0,left:0}},gf=I.useCallback(()=>{Fc.current&&Xu.current&&requestAnimationFrame(()=>{if(Fc.current&&Xu.current){const c=id(Xu);Fc.current.style.top=`${c.top}px`,Fc.current.style.left=`${c.left}px`}})},[]),Dd=I.useCallback(()=>{ju.current&&zd.current&&requestAnimationFrame(()=>{if(ju.current&&zd.current){const c=id(zd);ju.current.style.top=`${c.top}px`,ju.current.style.left=`${c.left}px`}})},[]),cu=I.useCallback(()=>{ou.current&&Cu.current&&requestAnimationFrame(()=>{if(ou.current&&Cu.current){const c=id(Cu);ou.current.style.top=`${c.top}px`,ou.current.style.left=`${c.left}px`}})},[]);At.useEffect(()=>{wu&&gf()},[wu,gf]),At.useEffect(()=>{ru&&Dd()},[ru,Dd]),At.useEffect(()=>{jd&&cu()},[jd,cu]),At.useEffect(()=>{if(un&&Yu.current&&wa.current){const c=id(wa);Yu.current.style.top=`${c.top}px`,Yu.current.style.left=`${c.left}px`}},[un]),At.useEffect(()=>{if(Ji&&Tu.current&&Pd.current){const c=id(Pd);Tu.current.style.top=`${c.top}px`,Tu.current.style.left=`${c.left}px`}},[Ji]),At.useEffect(()=>{const c=x=>{if(!ro)return;const z=document.querySelector("[data-component-editor-dialog]");if(z&&x.target instanceof Node&&z.contains(x.target)){const Ge=x.target;if(Ge.tagName==="BUTTON"||Ge.tagName==="INPUT"||Ge.closest("button")||Ge.closest("input"))return}const B=Tt.current;if(!B)return;const K=B.getBoundingClientRect(),ne=x.clientX,P=x.clientY;if(ne<K.left||ne>K.right||P<K.top||P>K.bottom)return;const Ne=B.width/K.width,be=B.height/K.height,Le=ne-K.left,Ie=P-K.top,Ae=Le*Ne,ge=Ie*be,me=Ae-5,Se=ge-5,ze=Of(me,Se,Qn,tt,pn,yn),Oe=ze.x,Ue=ze.y;let Ze=1/0,pt=null,Ct=null;const Lt=Math.max(6/tt,4),sn=[...Jt,...Qt].find(Ge=>Ge.id===ro.componentId)?.layer||"top";for(const Ge of $e)if((Ge.type==="via"||Ge.type==="pad")&&Ge.points.length>0){if(Ge.type==="pad"&&(Ge.layer||"top")!==sn)continue;const Ye=Ge.points[0],Ve=Math.max(1,Ge.size/2),ct=Math.hypot(Ye.x-Oe,Ye.y-Ue),gt=Math.max(Ve,Lt);ct<=gt&&ct<Ze&&(Ze=ct,pt=Ye.id??null,Ct=Ge)}if(pt!=null&&Ct){console.log(`
[PIN CONNECTION - DOCUMENT HANDLER] Found via!`),console.log(`  Point ID: ${pt}`),console.log(`  Connecting pin ${ro.pinIndex+1} of component ${ro.componentId}`);const Ge=String(pt),Ye=ro.pinIndex,Ve=ro.componentId,ct=Jt.find(Mt=>Mt.id===Ve),gt=Qt.find(Mt=>Mt.id===Ve);if(ct){const Mt=$e;ri(an=>{const _n=an.find(Dt=>Dt.id===Ve);if(!_n)return an;const ti=_n.pinConnections||[],Hn=ti.length>0?[...ti]:new Array(_n.pinCount).fill("");let Kn;if(Hn.length!==_n.pinCount){Kn=new Array(_n.pinCount).fill("");for(let Dt=0;Dt<Math.min(Hn.length,_n.pinCount);Dt++)Kn[Dt]=Hn[Dt]||""}else Kn=[...Hn];Kn[Ye]=Ge,console.log(`Updated pin ${Ye} with value: ${Ge}`),console.log("New pinConnections:",Kn);const Zn=an.find(Dt=>Dt.id===Ve),On=Zn?Mg(Zn,Kn,Mt):null;return an.map(Dt=>{if(Dt.id===Ve){const Mn={...Dt,pinConnections:Kn};return On&&(Mn.pinPolarities=On),Mn}return Dt})})}else if(gt){const Mt=$e;Si(an=>{const _n=an.find(Dt=>Dt.id===Ve);if(!_n)return an;const ti=_n.pinConnections||[],Hn=ti.length>0?[...ti]:new Array(_n.pinCount).fill("");let Kn;if(Hn.length!==_n.pinCount){Kn=new Array(_n.pinCount).fill("");for(let Dt=0;Dt<Math.min(Hn.length,_n.pinCount);Dt++)Kn[Dt]=Hn[Dt]||""}else Kn=[...Hn];Kn[Ye]=Ge,console.log(`Updated pin ${Ye} with value: ${Ge}`),console.log("New pinConnections:",Kn);const Zn=an.find(Dt=>Dt.id===Ve),On=Zn?Mg(Zn,Kn,Mt):null;return an.map(Dt=>{if(Dt.id===Ve){const Mn={...Dt,pinConnections:Kn};return On&&(Mn.pinPolarities=On),Mn}return Dt})})}setTimeout(()=>{ka(null)},0)}else console.log("[PIN CONNECTION - DOCUMENT HANDLER] No via found at click location")};if(ro)return document.addEventListener("mousedown",c,!0),()=>document.removeEventListener("mousedown",c,!0)},[ro,Jt,Qt,$e,tt,Qn.x,Qn.y,pn,yn]);const Io=I.useCallback((c,x,z,B)=>{const K=window.innerWidth,ne=window.innerHeight,P=10;let Ne=Math.max(P,Math.min(c,K-z-P)),be=Math.max(P,Math.min(x,ne-B-P));return{x:Ne,y:be}},[]);At.useEffect(()=>{if(!Xs)return;const c=z=>{if(!vs)return;const B={x:z.clientX-vs.x,y:z.clientY-vs.y},K=Io(B.x,B.y,250,window.innerHeight*.4);is(K),localStorage.setItem("componentDialogPosition",JSON.stringify(K))},x=()=>{Zc(!1),Jc(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",x)}},[Xs,vs,Io]),At.useEffect(()=>{if(!qr)return;const c=z=>{if(!In)return;const B={x:z.clientX-In.x,y:z.clientY-In.y},K=Io(B.x,B.y,250,window.innerHeight*.4);Do(K),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(K))},x=()=>{Bn(!1),Fi(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",x)}},[qr,In,Io]),At.useEffect(()=>{if(!dl)return;const c=z=>{if(!bc)return;const B={x:z.clientX-bc.x,y:z.clientY-bc.y};to(B),localStorage.setItem("notesDialogPosition",JSON.stringify(B))},x=()=>{zl(!1),Tr(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",x)}},[dl,bc]),At.useEffect(()=>{if(La&&Ro===null){const c=localStorage.getItem("notesDialogPosition");if(c)try{const x=JSON.parse(c);to(x)}catch{to({x:window.innerWidth-550,y:100})}else to({x:window.innerWidth-550,y:100})}},[La,Ro]),At.useEffect(()=>{if(!Lo)return;const c=z=>{if(!ec)return;const B={x:z.clientX-ec.x,y:z.clientY-ec.y};Ql(B),localStorage.setItem("projectNotesDialogPosition",JSON.stringify(B))},x=()=>{Vr(!1),hl(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",x)}},[Lo,ec]),At.useEffect(()=>{if(!rc)return;const c=z=>{if(!wc)return;const B={x:z.clientX-wc.x,y:z.clientY-wc.y};ic(B),localStorage.setItem("testPointsDialogPosition",JSON.stringify(B))},x=()=>{Uc(!1),tl(null)};return document.addEventListener("mousemove",c),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",x)}},[rc,wc]),At.useEffect(()=>{if(tc&&Xa===null){const c=localStorage.getItem("testPointsDialogPosition");if(c)try{const x=JSON.parse(c);ic(x)}catch{ic({x:100,y:100})}else ic({x:100,y:100})}},[tc,Xa]),At.useEffect(()=>{if(Hu&&Jl===null){const c=localStorage.getItem("projectNotesDialogPosition");if(c)try{const x=JSON.parse(c);Ql(x)}catch{Ql({x:100,y:100})}else Ql({x:100,y:100})}},[Hu,Jl]);const yf=I.useCallback(()=>{pl(!0)},[]),xf=I.useCallback(()=>{nc(!0)},[]);At.useEffect(()=>{if(Ua&&Ua.visible&&bs===null){const c=localStorage.getItem("componentDialogPosition");let x;if(c)try{const z=JSON.parse(c);x=Io(z.x,z.y,250,window.innerHeight*.4),is(x)}catch{x=Io(window.innerWidth-280,90,250,window.innerHeight*.4),is(x)}else x=Io(window.innerWidth-280,90,250,window.innerHeight*.4),is(x)}else!Ua||Ua.visible},[Ua,bs,Io]),At.useEffect(()=>{if(qo.visible&&si===null){const c=localStorage.getItem("detailedInfoDialogPosition");let x;if(c)try{const z=JSON.parse(c);x=Io(z.x,z.y,400,window.innerHeight*.8),Do(x)}catch{x=Io(window.innerWidth-450,90,400,window.innerHeight*.8),Do(x)}else x=Io(window.innerWidth-450,90,400,window.innerHeight*.8),Do(x)}else qo.visible},[qo.visible,si,Io]),At.useEffect(()=>{const c=()=>{if(bs){const x=Io(bs.x,bs.y,250,window.innerHeight*.4);(x.x!==bs.x||x.y!==bs.y)&&(is(x),localStorage.setItem("componentDialogPosition",JSON.stringify(x)))}if(si){const x=Io(si.x,si.y,400,window.innerHeight*.8);(x.x!==si.x||x.y!==si.y)&&(Do(x),localStorage.setItem("detailedInfoDialogPosition",JSON.stringify(x)))}};return window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[bs,si,Io]);const rd=I.useCallback(c=>{switch(c){case"transparency":m(50);break;case"brushSize":$(3);break}},[]),Ul=At.useRef(M);At.useEffect(()=>{Ul.current=M},[M]),At.useEffect(()=>{if(T){Ts.current=performance.now(),m(0);const c=x=>{const z=Ts.current||x,B=Ul.current,K=(x-z)%B/B,ne=1-Math.abs(1-2*K);m(Math.round(ne*100)),Nl.current=requestAnimationFrame(c)};Nl.current=requestAnimationFrame(c)}return()=>{Nl.current&&(cancelAnimationFrame(Nl.current),Nl.current=null)}},[T]),At.useEffect(()=>{if(N==="center"){ki(S2());return}const c=N==="erase"?"erase":N==="magnify"?"magnify":N==="ground"?"ground":N==="power"?"power":N==="component"?"component":N==="draw"?mt==="via"?"via":mt==="pad"?"pad":mt==="testPoint"?"testPoint":"trace":"default";if(c==="default"){ki(void 0);return}const x=tt;let z;if(c==="magnify")z=18;else if(c==="component"){const ge=(Di||"top")==="top"?"componentTop":"componentBottom",Se=Un.get(ge).size||Xg.DEFAULT_SIZE;z=Math.max(16,Math.round(Se*x))}else if(c==="trace"){const ge=(di||"top")==="top"?"traceTop":"traceBottom",Se=Un.get(ge).size||6;z=Math.max(6,Math.round(Se*x))}else if(c==="via"){const ge=Un.get("via").size||6;z=Math.max(6,Math.round(ge*x))}else if(c==="pad"){const ge=(Gn||"top")==="top"?"padTop":"padBottom",Se=Un.get(ge).size||6;z=Math.max(6,Math.round(Se*x))}else if(c==="testPoint"){const ge=(fi||"top")==="top"?"testPointTop":"testPointBottom",Se=Un.get(ge).size||18;z=Math.max(12,Math.round(Se*x))}else c==="power"||c==="ground"?z=Math.max(12,Math.round(U*x)):z=Math.max(6,Math.round(U*x));const K=z+4*2+(c==="magnify"?8:0),ne=document.createElement("canvas");ne.width=K,ne.height=K;const P=ne.getContext("2d");if(!P){ki(void 0);return}const Ne=K/2,be=K/2,Le=z/2;if(P.clearRect(0,0,K,K),c==="via"){const Ae=Le,ge=Le*.5,me=Le*.7,ze=Un.get("via").color;P.fillStyle=ze,P.beginPath(),P.arc(Ne,be,Ae,0,Za),P.arc(Ne,be,ge,0,Za),P.fill("evenodd"),P.strokeStyle="#808080",P.lineWidth=1,P.beginPath(),P.moveTo(Ne-me,be),P.lineTo(Ne+me,be),P.stroke(),P.beginPath(),P.moveTo(Ne,be-me),P.lineTo(Ne,be+me),P.stroke()}else if(c==="pad"){const Ae=Gn==="top"?"padTop":"padBottom",me=Un.get(Ae).color,ze=z/2,Oe=ze*2,Ue=Oe*.5,Ze=ze*.7;P.fillStyle=me,P.beginPath(),P.rect(Ne-ze,be-ze,Oe,Oe),P.rect(Ne-Ue/2,be-Ue/2,Ue,Ue),P.fill("evenodd"),P.strokeStyle="#808080",P.lineWidth=1,P.beginPath(),P.moveTo(Ne-Ze,be),P.lineTo(Ne+Ze,be),P.stroke(),P.beginPath(),P.moveTo(Ne,be-Ze),P.lineTo(Ne,be+Ze),P.stroke()}else if(c==="trace"){const Ae=di==="top"?"traceTop":"traceBottom",me=Un.get(Ae).color;P.fillStyle=me,P.beginPath(),P.arc(Ne,be,Le,0,Za),P.fill()}else if(c==="testPoint"){ki(j2(z));return}else if(c==="erase"){const Ae=U*x,ge=Math.max(Ae*.75,8),me=Math.max(Ae*.5,6),Se=Math.max(Ae*.2,2);P.save(),P.translate(Ne,be),P.rotate(gu(-35)),P.fillStyle="#f5a3b3",P.strokeStyle="#111",P.lineWidth=1.5;const ze=1.5,Oe=-ge/2,Ue=-me/2;P.beginPath(),P.moveTo(Oe+ze,Ue),P.lineTo(Oe+ge-ze,Ue),P.quadraticCurveTo(Oe+ge,Ue,Oe+ge,Ue+ze),P.lineTo(Oe+ge,Ue+me-ze),P.quadraticCurveTo(Oe+ge,Ue+me,Oe+ge-ze,Ue+me),P.lineTo(Oe+ze,Ue+me),P.quadraticCurveTo(Oe,Ue+me,Oe,Ue+me-ze),P.lineTo(Oe,Ue+ze),P.quadraticCurveTo(Oe,Ue,Oe+ze,Ue),P.closePath(),P.fill(),P.stroke(),P.fillStyle="#f18ea4",P.beginPath(),P.rect(-ge/2,me/2-Se,ge,Se),P.fill(),P.restore()}else if(c==="magnify"){const Ae=Le;P.strokeStyle="#111",P.lineWidth=2,P.beginPath(),P.arc(Ne-2,be-2,Ae,0,Za),P.stroke();const ge=Ne+Ae*.6,me=be+Ae*.6,Se=ge+6,ze=me+6;P.beginPath(),P.moveTo(ge,me),P.lineTo(Se,ze),P.stroke(),P.beginPath(),P.moveTo(Ne-6,be-2),P.lineTo(Ne+2,be-2),P.stroke(),_a||(P.beginPath(),P.moveTo(Ne-2,be-6),P.lineTo(Ne-2,be+2),P.stroke())}else if(c==="ground"){const ge=(ur?qe.find(Se=>Se.id===ur):null)?.color||"#000000";if(P.strokeStyle=ge,P.lineWidth=2,P.lineCap="round",ur==="groundbus-earth"){const Se=Le*1.5,ze=Se*.9,Oe=Se*.24,Ue=Se*1.6;P.beginPath(),P.moveTo(Ne,be-ze/2),P.lineTo(Ne,be+ze/2),P.stroke();for(let Ze=0;Ze<3;Ze++){const pt=be+ze/2+Ze*Oe,Ct=Ue*(1-Ze*.25);P.beginPath(),P.moveTo(Ne-Ct/2,pt),P.lineTo(Ne+Ct/2,pt),P.stroke()}}else{const Se=Le*.8;P.beginPath(),P.arc(Ne,be,Le,0,Za),P.stroke(),P.beginPath(),P.moveTo(Ne,be-Le-Se),P.lineTo(Ne,be+Le+Se),P.stroke(),P.beginPath(),P.moveTo(Ne-Le-Se,be),P.lineTo(Ne+Le+Se,be),P.stroke()}}else if(c==="power"){const ge=(en?pe.find(Se=>Se.id===en):null)?.color||"#ff0000";P.strokeStyle=ge,P.lineWidth=2,P.lineCap="round";const me=Le*.8;P.beginPath(),P.arc(Ne,be,Le,0,Za),P.stroke(),P.beginPath(),P.moveTo(Ne,be-Le-me),P.lineTo(Ne,be+Le+me),P.stroke(),P.beginPath(),P.moveTo(Ne-Le-me,be),P.lineTo(Ne+Le+me,be),P.stroke()}else if(c==="component"){const ge=(Di||"top")==="top"?"componentTop":"componentBottom",Se=Un.get(ge).color,ze=z,Oe=ze/2;P.strokeStyle=Se,P.lineWidth=2,P.fillStyle="rgba(255,255,255,0.9)",P.beginPath(),P.rect(Ne-Oe,be-Oe,ze,ze),P.fill(),P.stroke();const Ue=(()=>{const Ze=Tc?.dataDrivenDefinition?.designator??Tc?.componentDefinition?.designator??Tc?.designator;return Ze?Ze.length<=3?Ze:Ze.substring(0,3):Ll?Dg(Ll):"?"})();P.fillStyle=Se,P.font=`bold ${Math.max(8,ze*.35)}px sans-serif`,P.textAlign="center",P.textBaseline="middle",P.fillText(Ue,Ne,be)}const Ie=`url(${ne.toDataURL()}) ${Math.round(Ne)} ${Math.round(be)}, crosshair`;ki(Ie)},[N,mt,Y,U,tt,_a,Ll,Tc,en,ur,pe,qe,pi,di,Gn,fi,Di,br.toolInstanceId]),At.useEffect(()=>{su()},[su]),At.useEffect(()=>{su()},[_r.width,_r.height]),At.useEffect(()=>{vn.size===0&&N==="draw"&&mt==="trace"&&U>=1&&(_t==="top"?te(U):Ce(U))},[U,N,mt,_t,vn]),At.useEffect(()=>{at(c=>c.map(x=>{if(x.type==="via"&&x.points.length>0&&x.points[0].id!==void 0){const z=x.points[0].id,B=Ka(z,pe);if(x.viaType!==B)return{...x,viaType:B}}else if(x.type==="pad"&&x.points.length>0&&x.points[0].id!==void 0){const z=x.points[0].id,B=_l(z,pe);if(x.padType!==B)return{...x,padType:B}}else if(x.type==="testPoint"&&x.points.length>0&&x.points[0].id!==void 0){const z=x.points[0].id,B=yl(z,pe),K=B.includes("Power")?"power":B.includes("Ground")?"ground":B.includes("Signal")?"signal":"unknown";if(x.testPointType!==K)return{...x,testPointType:K}}return x}))},[Pe,Ee,pe,Ka,_l,yl]);const yp=I.useCallback(()=>{const c=Tt.current;if(!c)return;const x=c.toDataURL("image/png"),z=window.open("","_blank");if(!z){alert("Please allow popups to print the canvas.");return}z.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>PCB Drawing</title>
          <style>
            @media print {
              @page {
                margin: 0;
                size: auto;
              }
              body {
                margin: 0;
                padding: 0;
              }
            }
            body {
              margin: 0;
              padding: 20px;
              display: flex;
              justify-content: center;
              align-items: center;
              background: white;
            }
            img {
              max-width: 100%;
              height: auto;
              display: block;
            }
          </style>
        </head>
        <body>
          <img src="${x}" alt="PCB Drawing" onload="window.setTimeout(function() { window.print(); }, 250);" />
        </body>
      </html>
    `),z.document.close()},[]);At.useEffect(()=>{const c=z=>{z.key==="Shift"&&tu(!0)},x=z=>{z.key==="Shift"&&tu(!1)};return window.addEventListener("keydown",c),window.addEventListener("keyup",x),()=>{window.removeEventListener("keydown",c),window.removeEventListener("keyup",x)}},[]);const Rd=I.useCallback(c=>{if(c.size===0)return;const x=Array.from(c).map(z=>String(z));at(z=>z.map(B=>{if(B.type==="trace"){const K=B.points.filter(ne=>ne.id===void 0?!0:!c.has(ne.id));return K.length<2?null:{...B,points:K}}return B}).filter(B=>B!==null)),ri(z=>z.map(B=>{const K=B.pinConnections||[];if(K.some(P=>P&&x.includes(P))){const P=K.map(Ne=>Ne&&x.includes(Ne)?"":Ne);return{...B,pinConnections:P}}return B})),Si(z=>z.map(B=>{const K=B.pinConnections||[];if(K.some(P=>P&&x.includes(P))){const P=K.map(Ne=>Ne&&x.includes(Ne)?"":Ne);return{...B,pinConnections:P}}return B}))},[at,ri,Si]),mf=I.useRef(new Set);At.useEffect(()=>{const c=new Set;for(const z of $e)if((z.type==="via"||z.type==="pad")&&z.points.length>0){const B=z.points[0].id;B!==void 0&&c.add(B)}const x=new Set;for(const z of mf.current)c.has(z)||x.add(z);x.size>0&&Rd(x),mf.current=c},[$e,Rd]),At.useEffect(()=>{at(c=>c.map(x=>{if(x.type==="via"&&x.points.length>0&&x.points[0].id!==void 0){const z=x.points[0].id,B=Ka(z,pe);if(x.viaType!==B)return{...x,viaType:B}}else if(x.type==="pad"&&x.points.length>0&&x.points[0].id!==void 0){const z=x.points[0].id,B=_l(z,pe);if(x.padType!==B)return{...x,padType:B}}else if(x.type==="testPoint"&&x.points.length>0&&x.points[0].id!==void 0){const z=x.points[0].id,B=yl(z,pe),K=B.includes("Power")?"power":B.includes("Ground")?"ground":B.includes("Signal")?"signal":"unknown";if(x.testPointType!==K)return{...x,testPointType:K}}return x}))},[Pe,Ee,pe,Ka,_l,yl]),At.useEffect(()=>{const c=x=>{ul.current&&(ul.current.contains(x.target)||Ds(null))};return document.addEventListener("click",c),()=>document.removeEventListener("click",c)},[]),At.useEffect(()=>{const c=(x,z)=>{const B=x.current;if(!B)return;const K=B.getContext("2d");if(!K)return;const ne=B.width,P=B.height;if(K.clearRect(0,0,ne,P),K.fillStyle="#fff",K.fillRect(0,0,ne,P),z?.bitmap){const Ne=z.bitmap,be=Math.min(ne/Ne.width,P/Ne.height),Le=Math.max(1,Math.floor(Ne.width*be)),Ie=Math.max(1,Math.floor(Ne.height*be)),Ae=Math.floor((ne-Le)/2),ge=Math.floor((P-Ie)/2);K.drawImage(Ne,Ae,ge,Le,Ie)}K.strokeStyle="#ddd",K.lineWidth=1,K.strokeRect(.5,.5,ne-1,P-1)};c(el,o),c(Al,l)},[o,l]),At.useEffect(()=>{const c=[],x=[],z=[],B=[];for(const K of $e)if(K.type==="via"&&K.points.length>=1){const ne=K.points[0],P={id:K.id,pointId:ne.id,x:ne.x,y:ne.y,size:K.size,color:K.color};c.push(P)}else if(K.type==="pad"&&K.points.length>=1){const ne=K.points[0],P={id:K.id,pointId:ne.id,x:ne.x,y:ne.y,size:K.size,color:K.color,layer:K.layer||"top"};x.push(P)}else if(K.type==="trace"&&K.points.length>=2)for(let ne=0;ne<K.points.length-1;ne++){const P=K.points[ne],Ne=K.points[ne+1],be={id:K.id,startPointId:P.id,endPointId:Ne.id,x1:P.x,y1:P.y,x2:Ne.x,y2:Ne.y,size:K.size,color:K.color};K.layer==="top"?z.push(be):B.push(be)}Xo(c),pr(x),Ba(z),zn(B)},[$e]);const ku=I.useRef($e);ku.current=$e;const Fl=I.useCallback(()=>{const x=new Date().toISOString(),z=b1();return{project:{version:1,fileType:"PCB_REVERSE_ENGINEERING_AUTOSAVE",savedAt:x,view:{currentView:v,viewScale:tt,cameraWorldCenter:li,showBothLayers:Qa,selectedDrawingLayer:_t},images:{top:o?{name:o.name,width:o.width,height:o.height,filePath:o.filePath||o.name,x:o.x,y:o.y,scale:o.scale,rotation:o.rotation,flipX:o.flipX,flipY:o.flipY,skewX:o.skewX,skewY:o.skewY,keystoneV:o.keystoneV,keystoneH:o.keystoneH,brightness:o.brightness??100,contrast:o.contrast??100}:null,bottom:l?{name:l.name,width:l.width,height:l.height,filePath:l.filePath||l.name,x:l.x,y:l.y,scale:l.scale,rotation:l.rotation,flipX:l.flipX,flipY:l.flipY,skewX:l.skewX,skewY:l.skewY,keystoneV:l.keystoneV,keystoneH:l.keystoneH,brightness:l.brightness??100,contrast:l.contrast??100}:null},projectDirectoryName:ta.current?ta.current.name||null:oi&&oi.name||null,drawing:{drawingStrokes:ku.current.filter(K=>!(K.type==="trace"&&K.points.length<2)),vias:Na,tracesTop:ms,tracesBottom:Ys,componentsTop:Jt,componentsBottom:Qt,grounds:Ee,powers:Pe},powerBuses:pe,groundBuses:qe,pointIdCounter:sg(),designatorCounters:{...ai.current},autoAssignDesignators:Dr,useGlobalDesignatorCounters:Sr,traceColors:{top:pi.get("trace")?.layerSettings.get("top")?.color||H,bottom:pi.get("trace")?.layerSettings.get("bottom")?.color||Z},traceSizes:{top:pi.get("trace")?.layerSettings.get("top")?.size||we,bottom:pi.get("trace")?.layerSettings.get("bottom")?.size||de},padColors:{top:pi.get("pad")?.layerSettings.get("top")?.color||Re,bottom:pi.get("pad")?.layerSettings.get("bottom")?.color||k},padSizes:{top:pi.get("pad")?.layerSettings.get("top")?.size||V,bottom:pi.get("pad")?.layerSettings.get("bottom")?.size||se},componentColors:{top:pi.get("component")?.layerSettings.get("top")?.color||ye,bottom:pi.get("component")?.layerSettings.get("bottom")?.color||Gt},componentSizes:{top:pi.get("component")?.layerSettings.get("top")?.size||ht,bottom:pi.get("component")?.layerSettings.get("bottom")?.size||$t},testPointColors:{top:pi.get("testPoint")?.layerSettings.get("top")?.color||le,bottom:pi.get("testPoint")?.layerSettings.get("bottom")?.color||ve},testPointSizes:{top:pi.get("testPoint")?.layerSettings.get("top")?.size||Xe,bottom:pi.get("testPoint")?.layerSettings.get("bottom")?.size||kt},componentConnectionColor:rn,componentConnectionSize:Fn,toolLayerDefaults:{trace:di,pad:Gn,testPoint:fi,component:Di},toolSettings:{trace:pi.get("trace")?.settings||{color:"#ff0000",size:6},via:pi.get("via")?.settings||{color:"#ff0000",size:18},pad:pi.get("pad")?.settings||{color:"#ff0000",size:18},component:pi.get("component")?.settings||{color:"#ff0000",size:18},ground:pi.get("ground")?.settings||{color:"#000000",size:18},power:pi.get("power")?.settings||{color:"#ff0000",size:18},erase:pi.get("erase")?.settings||{color:"#f5a3b3",size:18}},locks:{areImagesLocked:Ki,areViasLocked:Nr,arePadsLocked:pa,areTracesLocked:oo,areComponentsLocked:Hi,areGroundNodesLocked:ho,arePowerNodesLocked:Wi},visibility:{showViasLayer:vo,showTopPadsLayer:_o,showBottomPadsLayer:Wo,showTopTracesLayer:Da,showBottomTracesLayer:Ra,showTopComponents:X,showBottomComponents:oe,showPowerLayer:he,showGroundLayer:Qi,showConnectionsLayer:yi,showTraceCornerDots:Ui},autoSave:{enabled:Va,interval:Cl,baseName:Ao},projectInfo:{name:Kr},projectNotes:vc,projectMetadata:Oc,homeViews:kl,toolInstances:Un.getAll()},timestamp:z}},[v,tt,li,Qa,_t,o,l,$e,Na,ms,Ys,Jt,Qt,Ee,pi,Ki,Nr,pa,oo,Hi,ho,Wi,pe,qe,sg,H,Z,we,de,Re,k,V,se,ye,Gt,ht,$t,di,Gn,fi,Di,Va,Cl,Ao,Kr,vo,_o,Wo,Da,Ra,X,oe,he,Qi,yi,Dr,Sr,vc,Oc,kl]),Au=I.useRef(Fl);Au.current=Fl;const xp=I.useRef(Zi);xp.current=Zi;const Cc={setProjectDirHandle:kr,setAutoSaveDirHandle:xo,setCurrentProjectFilePath:Zi,setProjectName:zo,setAutoSaveEnabled:so,setAutoSaveInterval:ko,setAutoSaveBaseName:Xr,setAutoSaveFileHistory:Ha,setCurrentFileIndex:Fr,setHasUnsavedChangesState:go,setTopImage:s,setBottomImage:d,setDrawingStrokes:at,setCurrentStroke:Ft,setVias:Xo,setPads:pr,setTracesTop:Ba,setTracesBottom:zn,setComponentsTop:ri,setComponentsBottom:Si,setComponentEditor:Fa,setConnectingPin:ka,setPowerSymbols:Wt,setGroundSymbols:on,setPowerEditor:ci,setPowerBuses:Me,setGroundBuses:xt,setSelectedIds:jn,setSelectedComponentIds:mn,setSelectedPowerIds:xn,setSelectedGroundIds:Tn,setIsSelecting:Eo,setProjectNotes:fl,setProjectMetadata:Ya,setCurrentView:p,setViewScale:Bt,setCameraCenter:Go,setCameraWorldCenter:vi,setShowBothLayers:Ia,setSelectedDrawingLayer:Yt,setHomeViews:Cs,setIsWaitingForHomeViewKey:cr,setSelectedImageForTransform:Cr,setIsTransforming:Xt,setTransformStartPos:Ti,setTransformMode:Rt,setIsBottomView:rr,setOriginalTopFlipX:or,setOriginalBottomFlipX:ls,setIsGrayscale:_,setTransparency:m,setIsTransparencyCycling:D,setTransparencyCycleSpeed:S,setAreImagesLocked:da,setAreViasLocked:fa,setArePadsLocked:ws,setAreTestPointsLocked:Aa,setAreTracesLocked:ha,setAreComponentsLocked:za,setAreGroundNodesLocked:rs,setArePowerNodesLocked:Yr,setShowTopImage:Er,setShowBottomImage:bo,setShowViasLayer:Ga,setShowTopTracesLayer:ds,setShowBottomTracesLayer:Li,setShowTopPadsLayer:oa,setShowBottomPadsLayer:va,setShowTopTestPointsLayer:y,setShowBottomTestPointsLayer:L,setShowTopComponents:ie,setShowBottomComponents:ce,setShowPowerLayer:je,setShowGroundLayer:ji,setShowConnectionsLayer:Yi,setShowTraceCornerDots:Rr,setCurrentTool:g,setDrawingMode:cn,setTraceToolLayer:To,setPadToolLayer:gs,setTestPointToolLayer:Uo,setComponentToolLayer:_s,setAutoAssignDesignators:eo,setUseGlobalDesignatorCounters:ii,setOpenMenu:Ds,setDebugDialog:Ur,setErrorDialog:Jo,setNewProjectDialog:Ea,setOpenProjectDialog:Kl,setNewProjectSetupDialog:Ss,setSaveAsDialog:Qo,setAutoSaveDialog:No,setAutoSavePromptDialog:ao,setShowColorPicker:ga,setShowPowerBusManager:He,setShowGroundBusManager:ar,setShowDesignatorManager:hr,setShowBoardDimensionsDialog:Bs,setNotesDialogVisible:co,setProjectNotesDialogVisible:pl,setTransformImagesDialogVisible:Js,setTransformAllDialogVisible:Ho,setBoardDimensions:Ms,setHoverComponent:ma,setHoverTestPoint:ba,setIsPanning:Wa,setIsDrawing:Vt,setTracePreviewMousePos:ln,clearSnapshot:wr,projectDirHandleRef:ta,autoSaveDirHandleRef:lr,autoSaveBaseNameRef:Zr,autoSaveIntervalRef:zi,hasChangesSinceLastAutoSaveRef:Ci,currentProjectFilePathRef:sl,autoSaveFileHistoryRef:Jr,currentFileIndexRef:cs,currentStrokeRef:gn,sessionDesignatorCountersRef:ai,traceToolLayerRef:es,padToolLayerRef:ts,testPointToolLayerRef:ys,componentToolLayerRef:Pr,homeViewTimeoutRef:Vn,panStartRef:mo,panClientStartRef:Po,lastTraceClickTimeRef:fn,isDoubleClickingTraceRef:bn},sa=I.useMemo(()=>I2(Cc),[kr,xo,Zi,zo,so,ko,Xr,Ha,Fr,s,d,at,Ft,Xo,pr,Ba,zn,ri,Si,Fa,ka,Wt,on,ci,Me,xt,jn,mn,xn,Tn,Eo,fl,Ya,p,Bt,Go,vi,Ia,Yt,Cs,cr,Cr,Xt,Ti,Rt,rr,or,ls,_,m,D,S,da,fa,ws,Aa,ha,za,rs,Yr,Er,bo,Ga,ds,Li,oa,va,y,L,ie,ce,je,ji,Yi,Rr,g,cn,To,gs,Uo,_s,eo,ii,Ds,Ur,Jo,Ea,Ss,Qo,No,ao,wr,ga,He,ar,hr,Bs,co,pl,Js,Ho,Ms,ma,ba,Wa,Vt,ln,ta,lr,Zr,zi,Ci,sl,Jr,cs,gn,ai,es,ts,ys,Pr,Vn,mo,Po,fn,bn]),Ld=I.useRef(sa),od=I.useCallback(()=>{Ld.current&&Ld.current()},[]),wo=I.useCallback(async()=>{await M2(od)},[od]),bf=I.useCallback(async()=>{const c=lr.current||ta.current,x=Zr.current;!c||!x||await O2(c,x,Ci,ku,at,Au.current,Zi,sl,Ha,Jr,Fr,cs,go,so,zi)},[lr,ta,Zr,Ci,ku,at,Au,Zi,sl,Ha,Jr,Fr,cs,go,so,zi]);us.current=bf;const Ec=I.useCallback(async()=>{const{project:c}=Fl(),x=JSON.stringify(c,null,2),z=new Blob([x],{type:"application/json"});if(oi&&Kr)try{let Le=null;try{Le=await oi.getDirectoryHandle("history",{create:!0})}catch(Oe){console.error("Failed to get/create history directory:",Oe),Le=null}const Ie=Kr.replace(/\.json$/i,""),Ae=hd(Ie),{timestamp:ge}=Fl(),me=`${Ae}_${ge}.json`;if(Le)try{const Oe=[];for await(const Ue of oi.keys())try{if(Ue==="history"||Ue===me)continue;const pt=await(await oi.getFileHandle(Ue)).getFile();if(!Ue.endsWith(".json"))continue;const Ct=await pt.text();try{JSON.parse(Ct).version&&(Oe.push(Ue),console.log(`Save: Found PCB project file in root: ${Ue}`))}catch{continue}}catch{continue}for(const Ue of Oe)try{const Ct=await(await(await oi.getFileHandle(Ue)).getFile()).text(),dt=await(await Le.getFileHandle(Ue,{create:!0})).createWritable();await dt.write(new Blob([Ct],{type:"application/json"})),await dt.close(),await oi.removeEntry(Ue),console.log(`Save: Moved ${Ue} from root to history/`)}catch(Ze){console.warn(`Save: Failed to move ${Ue} to history:`,Ze)}}catch(Oe){console.warn("Save: Error checking for old files in root:",Oe)}const ze=await(await oi.getFileHandle(me,{create:!0})).createWritable();await ze.write(z),await ze.close(),Zi(me),go(!1),Ci.current=!1,console.log(`Project saved successfully: ${Kr}/${me}`),alert(`Project saved successfully!

File: ${me}
Location: ${Kr}`);return}catch(Le){const Ie=Le instanceof Error?Le.message:String(Le);console.error("Failed to save to project directory:",Le),alert(`Failed to save project to directory.

Error: ${Ie}

Please try saving again or use Save As...`),kr(null)}if(Kr&&!oi){const Le=window;if(typeof Le.showDirectoryPicker=="function")try{const Ie=await Le.showDirectoryPicker();kr(Ie);const Ae=`${Kr}.json`,me=await(await Ie.getFileHandle(Ae,{create:!0})).createWritable();await me.write(z),await me.close(),Zi(Ae),go(!1),Ci.current=!1,console.log(`Project saved successfully: ${Ae} in selected directory`),alert(`Project saved successfully!

File: ${Ae}`);return}catch(Ie){if(Ie?.name!=="AbortError"){const Ae=Ie instanceof Error?Ie.message:String(Ie);console.error("Failed to get directory:",Ie),alert(`Failed to select directory.

Error: ${Ae}

Falling back to file picker...`)}}}const B=Le=>String(Le).padStart(2,"0"),K=new Date,P=`pcb_project_${`${K.getFullYear()}_${B(K.getMonth()+1)}_${B(K.getDate())}_${B(K.getHours())}_${B(K.getMinutes())}_${B(K.getSeconds())}`}.json`,Ne=window;if(typeof Ne.showSaveFilePicker=="function")try{const Le=await Ne.showSaveFilePicker({suggestedName:P,types:[{description:"PCB Project",accept:{"application/json":[".json"]}}]}),Ie=await Le.createWritable();await Ie.write(z),await Ie.close();const Ae=Le.name;try{const Se=await Le.getFile();Zi(Se.name)}catch{Zi(Ae)}const me=Ae.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");me&&zo(me);try{const Se=Le.name.replace(/\.json$/i,""),Oe=hd(Se).replace(/[^a-zA-Z0-9_-]/g,"_");Xr(Oe),Ls||console.log("Auto save: Directory handle not set. Will prompt on first auto save.")}catch(Se){console.warn("Could not set up auto save for new file:",Se)}console.log(`Project saved successfully: ${Ae}`),alert(`Project saved successfully!

File: ${Ae}`);return}catch(Le){if(Le?.name==="AbortError")return;const Ie=Le instanceof Error?Le.message:String(Le);console.warn("showSaveFilePicker failed, falling back to download",Le),alert(`File picker unavailable.

Error: ${Ie}

Falling back to browser download...`)}const be=document.createElement("a");be.href=URL.createObjectURL(z),be.download=P,document.body.appendChild(be),be.click(),setTimeout(()=>{URL.revokeObjectURL(be.href),document.body.removeChild(be)},0),console.log(`Project downloaded: ${P}`),alert(`Project downloaded successfully!

File: ${P}

Note: For better project management, use File  New Project or File  Open Project.`)},[Fl,oi,Kr,Zi,kr,go,zo,Xr,Ls,hd]),vf=I.useCallback(c=>{const x=new Wn,z=x.internal.pageSize.getWidth(),B=x.internal.pageSize.getHeight(),K=20;let ne=K;const P=7,Ne=60;x.setFontSize(18),x.setFont("helvetica","bold"),x.text("Bill of Materials",z/2,ne,{align:"center"}),ne+=P*2,x.setFontSize(10),x.setFont("helvetica","normal"),c.projectName&&(x.text(`Project: ${c.projectName}`,K,ne),ne+=P),x.text(`Exported: ${new Date(c.exportedAt).toLocaleString()}`,K,ne),ne+=P,x.text(`Total Components: ${c.totalComponents} | Unique Components: ${c.uniqueComponents}`,K,ne),ne=Ne,x.setFontSize(9),x.setFont("helvetica","bold");const be=[15,50,30,20,25,30,20],Le=["Qty","Component Type","Value","Package","Manufacturer","Part Number","Layer"];let Ie=K;return Le.forEach((ge,me)=>{x.text(ge,Ie,ne),Ie+=be[me]}),ne+=P,x.setLineWidth(.5),x.line(K,ne,z-K,ne),ne+=P*.5,x.setFont("helvetica","normal"),x.setFontSize(8),c.items.forEach(ge=>{const me=Ze=>{ne>B-K-P*Ze&&(x.addPage(),ne=K+P)};me(3),Ie=K,[ge.quantity.toString(),ge.componentType,ge.value||"-",ge.packageType||"-",ge.manufacturer||"-",ge.partNumber||"-",ge.layer].forEach((Ze,pt)=>{const Ct=be[pt]-2,Lt=x.splitTextToSize(Ze,Ct);x.text(Lt[0]||"-",Ie,ne),Ie+=be[pt]}),ne+=P*1.2;const ze=(ge.notes||"").toString().trim(),Oe=ge.datasheet?ge.datasheet.toString().trim():"",Ue=[];if(ze&&Ue.push(`Notes: ${ze}`),Oe&&Ue.push(`Spec Sheet URL: ${Oe}`),Ue.length>0){const Ze=K+be[0]+2,pt=z-K-Ze;Ue.forEach(Ct=>{x.splitTextToSize(Ct,pt).forEach(dt=>{me(2),x.text(dt,Ze,ne),ne+=P*.9})})}me(1),x.setLineWidth(.2),x.line(K,ne,z-K,ne),ne+=P*.5}),x.output("blob")},[]),uo=I.useCallback(async()=>{if(console.log("handleExportBOM called, format:",ae),!oi){alert("Please create or open a project before exporting BOM.");return}try{console.log("Generating BOM data...");const c=R2(Jt,Qt,Kr);console.log("BOM data generated:",c),console.log("Creating/getting BOM directory...");let x;try{x=await oi.getDirectoryHandle("BOM",{create:!0}),console.log("BOM directory obtained")}catch(Ne){console.error("Failed to get/create BOM directory:",Ne),alert("Failed to create BOM directory. See console for details.");return}const z=b1();let B,K;if(ae==="pdf")console.log("Generating PDF..."),B=vf(c),K=`BOM_${z}.pdf`;else{console.log("Generating JSON...");const Ne=JSON.stringify(c,null,2);B=new Blob([Ne],{type:"application/json"}),K=`BOM_${z}.json`}console.log("Saving file:",K);const P=await(await x.getFileHandle(K,{create:!0})).createWritable();await P.write(B),await P.close(),console.log("BOM file saved successfully"),alert(`BOM exported successfully to ${K} in BOM directory!`)}catch(c){console.error("Failed to export BOM:",c),alert(`Failed to export BOM: ${c instanceof Error?c.message:String(c)}. See console for details.`)}},[oi,Jt,Qt,Kr,ae,vf]),Us=I.useCallback(async c=>{if(!oi){alert("Please create or open a project before exporting netlist.");return}const x=c||q;try{const z=[...Jt,...Qt];let B,K,ne;x==="kicad"?(B=A2(z,$e,Pe,Ee,pe),K="KiCad",ne=".net"):x==="protel"?(B=z2(z,$e,Pe,Ee,pe),K="Protel",ne=".net"):x==="spice"?(B=P2(z,$e,Pe,Ee,pe),K="SPICE",ne=".cir"):(B=_2(z,$e,Pe,Ee,pe,qe,Kr),K="PADS",ne=".json");const P=`${Kr}_${K}${ne}`,Ne=x==="pads"?"application/json":"text/plain",be=new Blob([B],{type:Ne});try{const Ae=await(await(await oi.getDirectoryHandle("netlists",{create:!0})).getFileHandle(P,{create:!0})).createWritable();await Ae.write(be),await Ae.close(),alert(`Netlist exported successfully to netlists/${P}!`)}catch(Le){console.warn("File System Access API failed, using download fallback:",Le);const Ie=URL.createObjectURL(be),Ae=document.createElement("a");Ae.href=Ie,Ae.download=P,document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),URL.revokeObjectURL(Ie),alert(`Netlist downloaded as ${P}!`)}}catch(z){console.error("Failed to export netlist:",z),alert(`Failed to export netlist: ${z instanceof Error?z.message:String(z)}. See console for details.`)}},[oi,Jt,Qt,$e,Pe,Ee,pe,Kr,q]);At.useEffect(()=>{zi.current&&(clearInterval(zi.current),zi.current=null);const c=Lc.current;if(Lc.current=Va,Va&&Cl){const x=Cl*60*1e3;(Ls||oi)&&Ao?(console.log(`Auto save: Setting up interval for ${Cl} minute(s) (${x}ms)`),c||(Ci.current=!0,setTimeout(()=>{bf()},100)),zi.current&&(clearInterval(zi.current),zi.current=null),zi.current=window.setInterval(()=>{console.log("Auto save: Interval triggered, calling performAutoSave..."),console.log(`  - hasChangesSinceLastAutoSave: ${Ci.current}`),console.log(`  - dirHandle: ${lr.current?"set":"missing"}`),console.log(`  - baseName: ${Zr.current||"missing"}`),bf()},x),console.log(`Auto save: Interval set up for ${x}ms (${Cl} minutes)`),console.log(`  - Auto save directory handle: ${Ls?"set":"missing"}`),console.log(`  - Project directory handle: ${oi?"set":"missing"}`),console.log(`  - Base name: ${Ao||"missing"}`)):(console.warn(`Auto save: Cannot set up interval - missing directory handle (autoSaveDirHandle: ${!!Ls}, projectDirHandle: ${!!oi}) or base name (${!Ao}). Disabling auto save.`),so(!1),zi.current&&(clearInterval(zi.current),zi.current=null))}else Va||(Lc.current=!1);return()=>{zi.current&&(clearInterval(zi.current),zi.current=null)}},[Va,Cl,Ls,Ao,oi]);const xl=I.useRef(!1),ad=I.useRef(!1),[mp,bp]=At.useState(0);At.useEffect(()=>{const x=Object.keys(Un.getAll()).map(z=>Un.subscribe(z,()=>{bp(B=>B+1)}));return()=>x.forEach(z=>z())},[]),At.useEffect(()=>{if(ad.current){console.log("Change tracking: Skipping - project is being loaded");return}if(Va&&xl.current){xl.current=!1,console.log("Auto save: Skipping change tracking on first run after enable (initial save handled separately)");return}Ci.current=!0,go(!0),console.log("Change detected, marking as unsaved",{autoSaveEnabled:Va,topImage:!!o,bottomImage:!!l,drawingStrokesCount:$e.length,componentsTopCount:Jt.length,componentsBottomCount:Qt.length,powersCount:Pe.length,groundsCount:Ee.length,powerBusesCount:pe.length,projectNotesCount:vc.length,areImagesLocked:Ki,areViasLocked:Nr,areTracesLocked:oo,areComponentsLocked:Hi,areGroundNodesLocked:ho,arePowerNodesLocked:Wi})},[o,l,$e,Jt,Qt,Pe,Ee,pe,vc,H,Z,we,de,Ki,Nr,oo,Hi,ho,Wi,qe,Va,Re,k,V,se,ye,Gt,ht,$t,le,ve,Xe,kt,rn,Fn,di,Dr,Sr,kl,pi,mp]),At.useEffect(()=>{Va?(xl.current=!0,console.log("Auto save: Enabled, marking first run")):xl.current=!1},[Va]),At.useEffect(()=>{Va||(Ci.current=!1)},[Va]);const sd=I.useCallback(()=>!!(o||l||$e.length>0||Jt.length>0||Qt.length>0||Pe.length>0||Ee.length>0),[o,l,$e,Jt,Qt,Pe,Ee]),qc=I.useCallback(()=>{Ss({visible:!0,projectName:"",locationPath:"",locationHandle:null})},[]),Fs=I.useCallback(async()=>{const c=window;if(typeof c.showDirectoryPicker=="function")try{const x=await c.showDirectoryPicker({mode:"readwrite"});Ss(z=>({...z,locationHandle:x,locationPath:x.name||"Selected folder"}))}catch(x){x?.name!=="AbortError"&&(console.error("Failed to get directory:",x),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser like Chrome or Edge.")},[]),ml=I.useCallback(async()=>{const c=ei.projectName.trim();if(!c){alert("Please enter a project name.");return}if(!ei.locationHandle){alert("Please select a location for the project.");return}const x=await B2(c,ei.locationHandle,wo,zo,kr,Zi,ta,Fl,uc,qi,rr,m,async(z,B,K,ne)=>{await Hd(z,B,K,so,ko,xo,Xr,lr,Zr,zi,Ci,No,ao,kr,us,ne)});if(!x.success){x.error&&alert(x.error);return}Ss({visible:!1,projectName:"",locationPath:"",locationHandle:null}),console.log(`New project created successfully: ${x.projectName}/${x.projectFileName}`)},[ei,wo,zo,kr,Zi,ta,Fl,uc,qi,rr,m,Kr,oi,so,ko,xo,Xr,lr,Zr,zi,Ci,No,ao,us]),Id=I.useCallback(()=>{Ss({visible:!1,projectName:"",locationPath:"",locationHandle:null})},[]),Es=I.useCallback(async()=>{const c=window;if(typeof c.showDirectoryPicker=="function")try{const x=await c.showDirectoryPicker();Qo(z=>({...z,locationHandle:x,locationPath:x.name||"Selected folder"}))}catch(x){x?.name!=="AbortError"&&(console.error("Failed to get directory:",x),alert("Failed to select location directory."))}else alert("Directory picker is not supported in this browser. Please use a modern browser that supports the File System Access API.")},[]),wf=I.useCallback(async()=>{const c=Bi.filename.trim();if(!c){alert("Please enter a file name.");return}const z=(c.endsWith(".json")?c:`${c}.json`).replace(/[^a-zA-Z0-9_.-]/g,"_");if(!Bi.locationHandle){alert("Please select a location for the file.");return}const B=Bi.locationHandle;try{const{project:K}=Fl(),ne=JSON.stringify(K,null,2),P=new Blob([ne],{type:"application/json"}),be=await(await B.getFileHandle(z,{create:!0})).createWritable();await be.write(P),await be.close(),Zi(z);const Le=z.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_");Le&&zo(Le),kr(B),go(!1),Ci.current=!1,Qo({visible:!1,filename:"",locationPath:"",locationHandle:null}),Ds(null),console.log(`Project saved as: ${z} in selected directory`)}catch(K){console.error("Failed to save project:",K),alert(`Failed to save project file "${z}". See console for details.`)}},[Bi,Fl]),El=I.useCallback(()=>{Qo({visible:!1,filename:"",locationPath:"",locationHandle:null})},[]),Nc=I.useCallback(async()=>{Ea({visible:!1}),await Ec(),qc(),er()},[Ec,qc,er]),kc=I.useCallback(()=>{Ea({visible:!1}),qc(),er()},[qc,er]),Sf=I.useCallback(()=>{Ea({visible:!1})},[]);At.useEffect(()=>{if(Zs.visible){setTimeout(()=>{yu.current?.focus()},0);const c=x=>{x.key==="Enter"?(x.preventDefault(),Nc()):x.key==="Escape"&&(x.preventDefault(),Ea({visible:!1}))};return window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c)}}},[Zs.visible,Nc]);const ql=I.useCallback(async(c,x)=>{ad.current=!0;try{if(console.log("loadProject: Clearing all existing project data before loading..."),s(null),d(null),at([]),Xo([]),pr([]),Ba([]),zn([]),Ft([]),gn.current=[],ri([]),Si([]),Fa(null),ka(null),Wt([]),on([]),ci(null),jn(new Set),mn(new Set),xn(new Set),Tn(new Set),wr(),c.toolInstances?Un.initializeFromProject(c):Un.initialize(),c.projectInfo&&c.projectInfo.name&&zo(c.projectInfo.name),c.view){if(c.view.currentView&&p(c.view.currentView),c.view.viewScale!=null&&Bt(c.view.viewScale),c.view.cameraWorldCenter)vi(c.view.cameraWorldCenter);else if(c.view.viewPan){const Ie=Tt.current;if(Ie){const Ae=(Ie.width-10)/2,ge=(Ie.height-10)/2,me=c.view.viewScale??1,Se=(Ae-c.view.viewPan.x)/me,ze=(ge-c.view.viewPan.y)/me;vi({x:Se,y:ze})}else vi({x:0,y:0})}c.view.showBothLayers!=null&&Ia(c.view.showBothLayers),c.view.selectedDrawingLayer&&Yt(c.view.selectedDrawingLayer)}if(c.homeViews){const Ie={};for(const[Ae,ge]of Object.entries(c.homeViews)){const me=parseInt(Ae,10),Se=ge;let ze=Se.pcbReferenceX,Oe=Se.pcbReferenceY;(ze===void 0||Oe===void 0)&&(ze=Se.x??0,Oe=Se.y??0),Se.showTopImage===void 0?Ie[me]={pcbReferenceX:ze,pcbReferenceY:Oe,x:0,y:0,zoom:Se.zoom,viewRotation:pn,viewFlipX:yn,isBottomView:qa,transparency:b,showTopImage:ks,showBottomImage:$a,showViasLayer:vo,showTopTracesLayer:Da,showBottomTracesLayer:Ra,showTopPadsLayer:_o,showBottomPadsLayer:Wo,showTopTestPointsLayer:f,showBottomTestPointsLayer:C,showTopComponents:X,showBottomComponents:oe,showPowerLayer:he,showGroundLayer:Qi,showConnectionsLayer:yi}:Ie[me]={...Se,pcbReferenceX:ze,pcbReferenceY:Oe,x:0,y:0,viewRotation:Se.viewRotation??0,viewFlipX:Se.viewFlipX??!1,isBottomView:Se.isBottomView??!1,transparency:Se.transparency??50}}Cs(Ie)}else Cs({});if(c.projectNotes&&Array.isArray(c.projectNotes)?fl(c.projectNotes):fl([]),c.projectMetadata?Ya({productName:c.projectMetadata.productName||"",productVersion:c.projectMetadata.productVersion||"",manufacturer:c.projectMetadata.manufacturer||"",date:c.projectMetadata.date||new Date().toISOString().split("T")[0]}):Ya({productName:"",productVersion:"",manufacturer:"",date:new Date().toISOString().split("T")[0]}),c.traceColors&&(c.traceColors.top&&(R(c.traceColors.top),lt("trace",c.traceColors.top,"top")),c.traceColors.bottom&&(G(c.traceColors.bottom),lt("trace",c.traceColors.bottom,"bottom"))),c.traceSizes){const Ie=c.traceSizes.top!=null&&c.traceSizes.top>0?c.traceSizes.top:6;let Ae=c.traceSizes.bottom!=null&&c.traceSizes.bottom>0?c.traceSizes.bottom:6;Ae<6&&(Ae=6),te(Ie),Ce(Ae),fe("trace",Ie,"top"),fe("trace",Ae,"bottom")}else te(6),Ce(6);if(c.padColors&&(c.padColors.top&&(xe(c.padColors.top),lt("pad",c.padColors.top,"top")),c.padColors.bottom&&(A(c.padColors.bottom),lt("pad",c.padColors.bottom,"bottom"))),c.padSizes){const Ie=c.padSizes.top!=null&&c.padSizes.top>0?c.padSizes.top:18,Ae=c.padSizes.bottom!=null&&c.padSizes.bottom>0?c.padSizes.bottom:18;W(Ie),Te(Ae),fe("pad",Ie,"top"),fe("pad",Ae,"bottom")}if(c.componentColors&&(c.componentColors.top&&(ut(c.componentColors.top),lt("component",c.componentColors.top,"top")),c.componentColors.bottom&&(Et(c.componentColors.bottom),lt("component",c.componentColors.bottom,"bottom"))),c.componentSizes){const Ie=c.componentSizes.top!=null&&c.componentSizes.top>0?c.componentSizes.top:18,Ae=c.componentSizes.bottom!=null&&c.componentSizes.bottom>0?c.componentSizes.bottom:18;Qe(Ie),dn(Ae),fe("component",Ie,"top"),fe("component",Ae,"bottom")}c.toolLayerDefaults?(c.toolLayerDefaults.trace&&To(c.toolLayerDefaults.trace),c.toolLayerDefaults.pad&&gs(c.toolLayerDefaults.pad),c.toolLayerDefaults.testPoint&&Uo(c.toolLayerDefaults.testPoint),c.toolLayerDefaults.component&&_s(c.toolLayerDefaults.component)):c.traceToolLayer&&To(c.traceToolLayer),c.toolSettings&&dr(Ie=>{const Ae=new Map(Ie);if(c.toolSettings.trace){const me=Ae.get("trace");if(me){const Se={...me,settings:c.toolSettings.trace},ze=new Map(me.layerSettings);c.traceSizes&&c.traceColors&&(ze.set("top",{color:c.traceColors.top||me.layerSettings.get("top")?.color||"#AA4499",size:c.traceSizes.top||me.layerSettings.get("top")?.size||6}),ze.set("bottom",{color:c.traceColors.bottom||me.layerSettings.get("bottom")?.color||"#F781BF",size:c.traceSizes.bottom||me.layerSettings.get("bottom")?.size||6})),Ae.set("trace",{...Se,layerSettings:ze})}}if(c.toolSettings.via){const me=Ae.get("via");me&&Ae.set("via",{...me,settings:c.toolSettings.via})}if(c.toolSettings.pad){const me=Ae.get("pad");if(me){const Se={...me,settings:c.toolSettings.pad},ze=new Map(me.layerSettings);c.padSizes&&c.padColors&&(ze.set("top",{color:c.padColors.top||me.layerSettings.get("top")?.color||"#0072B2",size:c.padSizes.top||me.layerSettings.get("top")?.size||18}),ze.set("bottom",{color:c.padColors.bottom||me.layerSettings.get("bottom")?.color||"#56B4E9",size:c.padSizes.bottom||me.layerSettings.get("bottom")?.size||18})),Ae.set("pad",{...Se,layerSettings:ze})}}if(c.toolSettings.component){const me=Ae.get("component");if(me){const Se={...me,settings:c.toolSettings.component},ze=new Map(me.layerSettings);c.componentSizes&&c.componentColors&&(ze.set("top",{color:c.componentColors.top||me.layerSettings.get("top")?.color||"#6A3D9A",size:c.componentSizes.top||me.layerSettings.get("top")?.size||18}),ze.set("bottom",{color:c.componentColors.bottom||me.layerSettings.get("bottom")?.color||"#9467BD",size:c.componentSizes.bottom||me.layerSettings.get("bottom")?.size||18})),Ae.set("component",{...Se,layerSettings:ze})}}if(c.testPointSizes&&c.testPointColors){_e(c.testPointColors.top||le),De(c.testPointColors.bottom||ve),st(c.testPointSizes.top||Xe),qt(c.testPointSizes.bottom||kt);const me=Ae.get("testPoint");if(me){const Se=new Map(me.layerSettings);Se.set("top",{color:c.testPointColors.top||me.layerSettings.get("top")?.color||"#E69F00",size:c.testPointSizes.top||me.layerSettings.get("top")?.size||6}),Se.set("bottom",{color:c.testPointColors.bottom||me.layerSettings.get("bottom")?.color||"#F0E442",size:c.testPointSizes.bottom||me.layerSettings.get("bottom")?.size||6}),Ae.set("testPoint",{...me,layerSettings:Se})}}if(c.componentConnectionColor!==void 0&&kn(c.componentConnectionColor),c.componentConnectionSize!==void 0&&Be(c.componentConnectionSize),c.toolSettings.ground){const me=Ae.get("ground");me&&Ae.set("ground",{...me,settings:c.toolSettings.ground})}if(c.toolSettings.power){const me=Ae.get("power");me&&Ae.set("power",{...me,settings:c.toolSettings.power})}if(c.toolSettings.erase){const me=Ae.get("erase");me&&Ae.set("erase",{...me,settings:c.toolSettings.erase})}const ge=N==="draw"&&mt==="trace"?Ae.get("trace"):N==="draw"&&mt==="via"?Ae.get("via"):N==="draw"&&mt==="pad"?Ae.get("pad"):N==="draw"&&mt==="testPoint"?Ae.get("testPoint"):N==="component"?Ae.get("component"):N==="power"?Ae.get("power"):N==="ground"?Ae.get("ground"):null;if(ge)if(N==="draw"&&mt==="trace"){const me=di||"top",Se=ge.layerSettings.get(me);Se?(ee(Se.color),$(Se.size),me==="top"?(R(Se.color),te(Se.size)):(G(Se.color),Ce(Se.size))):(ee(ge.settings.color),$(ge.settings.size))}else if(N==="draw"&&mt==="pad"){const me=Gn||"top",Se=ge.layerSettings.get(me);Se?(ee(Se.color),$(Se.size),me==="top"?(xe(Se.color),W(Se.size)):(A(Se.color),Te(Se.size))):(ee(ge.settings.color),$(ge.settings.size))}else if(N==="component"){const me=Di||"top",Se=ge.layerSettings.get(me);Se?(ee(Se.color),$(Se.size),me==="top"?(ut(Se.color),Qe(Se.size)):(Et(Se.color),dn(Se.size))):(ee(ge.settings.color),$(ge.settings.size))}else if(N==="draw"&&mt==="testPoint"){const me=fi||"top",Se=ge.layerSettings.get(me);Se?(ee(Se.color),$(Se.size),me==="top"?(_e(Se.color),st(Se.size)):(De(Se.color),qt(Se.size))):(ee(ge.settings.color),$(ge.settings.size))}else ee(ge.settings.color),$(ge.settings.size);return Ae});const z=async(Ie,Ae)=>{if(!Ie)return null;let ge=null,me="",Se=Ie.filePath||Ie.name;if(!Ae){const ze=Ie.name||"image";return alert(`Error: Cannot load image "${ze}" because no project directory is available.

Please ensure you opened the project file from its project directory. The project directory is required to access the image files stored in the images/ subdirectory.`),null}if(Se)try{let ze=Se;!Se.startsWith("images/")&&!Se.startsWith("Images/")?ze=Se:Se.startsWith("Images/")?ze=Se.replace("Images/",""):Se.startsWith("images/")&&(ze=Se.replace("images/",""));let Oe;try{Oe=await Ae.getDirectoryHandle("images")}catch{try{Oe=await Ae.getDirectoryHandle("Images")}catch{throw new Error("Neither 'images' nor 'Images' directory found in project folder.")}}const Ze=await(await Oe.getFileHandle(ze)).getFile();ge=await createImageBitmap(Ze),me=URL.createObjectURL(Ze),console.log(`Loaded image from file path: images/${ze}`),Se.startsWith("images/")||(Se=`images/${Se.replace("Images/","")}`)}catch(ze){const Oe=ze instanceof Error?ze.message:"Unknown error",Ue=Ie.name||"image",Ze=Se.startsWith("images/")||Se.startsWith("Images/")?Se.replace("Images/","images/"):`images/${Se}`;return alert(`Error: Failed to load image "${Ue}" from project directory.

Expected location: ${Ze}

This may occur if:
- The image file was moved or deleted
- The project directory structure was modified
- File permissions are insufficient

Please ensure the image file exists in the images/ subdirectory of your project folder.

Technical details: ${Oe}`),null}else{const ze=Ie.name||"image";return alert(`Error: Image "${ze}" has no file path specified in the project file.

The project file is missing the image file path information. This may indicate the project file is corrupted or was created with an older version of the software.`),null}if(!ge){const ze=Ie.name||"image";return alert(`Error: Could not create image bitmap for "${ze}".

The image file may be corrupted or in an unsupported format. Please ensure the image is a valid PNG, JPEG, or other supported image format.`),null}return{url:me,name:Ie.name??"image",width:Ie.width??ge.width,height:Ie.height??ge.height,filePath:Se,x:Ie.x??0,y:Ie.y??0,scale:Ie.scale??1,rotation:Ie.rotation??0,flipX:!!Ie.flipX,flipY:!!Ie.flipY,skewX:Ie.skewX??0,skewY:Ie.skewY??0,keystoneV:Ie.keystoneV??0,keystoneH:Ie.keystoneH??0,brightness:Ie.brightness??100,contrast:Ie.contrast??100,bitmap:ge}},B=x!==void 0?x:oi,K=await z(c.images?.top,B),ne=await z(c.images?.bottom,B);if(s(K),d(ne),c.pointIdCounter&&typeof c.pointIdCounter=="number"?qp(c.pointIdCounter):(console.warn("Project file missing pointIdCounter. Starting from 1."),qp(1)),c.locks&&(typeof c.locks.areImagesLocked=="boolean"&&da(c.locks.areImagesLocked),typeof c.locks.areViasLocked=="boolean"&&fa(c.locks.areViasLocked),typeof c.locks.arePadsLocked=="boolean"&&ws(c.locks.arePadsLocked),typeof c.locks.areTracesLocked=="boolean"&&ha(c.locks.areTracesLocked),typeof c.locks.areComponentsLocked=="boolean"&&za(c.locks.areComponentsLocked),typeof c.locks.areGroundNodesLocked=="boolean"&&rs(c.locks.areGroundNodesLocked),typeof c.locks.arePowerNodesLocked=="boolean"&&Yr(c.locks.arePowerNodesLocked)),c.visibility&&(typeof c.visibility.showViasLayer=="boolean"&&Ga(c.visibility.showViasLayer),typeof c.visibility.showTopPadsLayer=="boolean"&&oa(c.visibility.showTopPadsLayer),typeof c.visibility.showBottomPadsLayer=="boolean"&&va(c.visibility.showBottomPadsLayer),typeof c.visibility.showTopTracesLayer=="boolean"&&ds(c.visibility.showTopTracesLayer),typeof c.visibility.showBottomTracesLayer=="boolean"&&Li(c.visibility.showBottomTracesLayer),typeof c.visibility.showTopComponents=="boolean"&&ie(c.visibility.showTopComponents),typeof c.visibility.showBottomComponents=="boolean"&&ce(c.visibility.showBottomComponents),typeof c.visibility.showPowerLayer=="boolean"&&je(c.visibility.showPowerLayer),typeof c.visibility.showGroundLayer=="boolean"&&ji(c.visibility.showGroundLayer),typeof c.visibility.showConnectionsLayer=="boolean"&&Yi(c.visibility.showConnectionsLayer),typeof c.visibility.showTraceCornerDots=="boolean"&&Rr(c.visibility.showTraceCornerDots)),c.autoSave?(typeof c.autoSave.enabled=="boolean"&&so(c.autoSave.enabled),typeof c.autoSave.interval=="number"&&ko(c.autoSave.interval),typeof c.autoSave.baseName=="string"&&c.autoSave.baseName?(Xr(c.autoSave.baseName),Zr.current=c.autoSave.baseName,c.autoSave.enabled&&!Ls&&(console.log("Auto save: Directory handle not available after page reload (expected). Auto save disabled. Use File -> Auto Save -> Enable to re-enable."),so(!1),ko(null))):c.autoSave.enabled&&(console.warn("Auto save was enabled in project file but base name is missing. Disabling auto save."),so(!1),ko(null),Xr(""),Zr.current="")):(so(!1),ko(null),xo(null),Xr(""),lr.current=null,Zr.current="",zi.current&&(clearInterval(zi.current),zi.current=null)),c.drawing?.drawingStrokes&&Array.isArray(c.drawing.drawingStrokes)){const Ie=c.drawing.drawingStrokes.map(Ae=>({...Ae,points:Ae.points.map(ge=>({...ge,...sr(ge)}))})).filter(Ae=>!(Ae.type==="trace"&&Ae.points.length<2));at(Ie);for(const Ae of Ie)for(const ge of Ae.points)ge.id&&typeof ge.id=="number"&&lg(ge.id)}else console.warn("Project file missing drawingStrokes. Starting with empty strokes."),at([]);if(c.drawing?.componentsTop){const Ie=c.drawing.componentsTop.map(Ae=>{const ge=sr({x:Ae.x,y:Ae.y});return{...Ae,x:ge.x,y:ge.y,layer:Ae.layer||"top",pinConnections:Ae.pinConnections||new Array(Ae.pinCount||0).fill("")}});ri(Ie)}if(c.drawing?.componentsBottom){const Ie=c.drawing.componentsBottom.map(Ae=>{const ge=sr({x:Ae.x,y:Ae.y});return{...Ae,x:ge.x,y:ge.y,layer:Ae.layer||"bottom",pinConnections:Ae.pinConnections||new Array(Ae.pinCount||0).fill("")}});Si(Ie)}if(c.designatorCounters&&typeof c.designatorCounters=="object"){const Ie=c.designatorCounters;ai.current={...Ie}}else ai.current={};if(typeof c.autoAssignDesignators=="boolean"&&eo(c.autoAssignDesignators),typeof c.useGlobalDesignatorCounters=="boolean"?ii(c.useGlobalDesignatorCounters):ii(!1),c.drawing?.grounds){const Ae=c.drawing.grounds.map(ge=>{ge.pointId||console.warn("Ground symbol missing pointId - this may cause issues");const me=sr({x:ge.x,y:ge.y});return{...ge,x:me.x,y:me.y}}).filter(ge=>{const me=typeof ge.x=="number"&&typeof ge.y=="number"&&!isNaN(ge.x)&&!isNaN(ge.y)&&isFinite(ge.x)&&isFinite(ge.y);return me||console.warn(`Filtered out invalid ground symbol at (${ge.x}, ${ge.y})`),me});on(Ae);for(const ge of Ae)ge.pointId&&typeof ge.pointId=="number"&&lg(ge.pointId)}else on([]);let P;if(c.powerBuses&&Array.isArray(c.powerBuses)&&c.powerBuses.length>0?(P=c.powerBuses,Me(P)):(P=[{id:"powerbus-default",name:"+5VDC",voltage:"+5",color:"#ff0000"}],Me(P)),c.groundBuses&&Array.isArray(c.groundBuses)&&c.groundBuses.length>0?xt(c.groundBuses):xt([{id:"groundbus-circuit",name:"GND",color:"#000000"}]),c.drawing?.powers){const Ae=c.drawing.powers.map(ge=>{ge.pointId||console.warn("Power symbol missing pointId - this may cause issues");const me=sr({x:ge.x,y:ge.y});return{...ge,x:me.x,y:me.y}}).filter(ge=>{const me=typeof ge.x=="number"&&typeof ge.y=="number"&&!isNaN(ge.x)&&!isNaN(ge.y)&&isFinite(ge.x)&&isFinite(ge.y);return me||console.warn(`Filtered out invalid power node at (${ge.x}, ${ge.y})`),me});Wt(Ae);for(const ge of Ae)ge.pointId&&typeof ge.pointId=="number"&&lg(ge.pointId)}else Wt([]);let Ne=0;if(c.drawing?.drawingStrokes&&Array.isArray(c.drawing.drawingStrokes))for(const Ie of c.drawing.drawingStrokes)for(const Ae of Ie.points)Ae.id&&typeof Ae.id=="number"&&Ae.id>Ne&&(Ne=Ae.id);if(c.drawing?.componentsTop&&Array.isArray(c.drawing.componentsTop)){for(const Ie of c.drawing.componentsTop)if(Ie.pinConnections&&Array.isArray(Ie.pinConnections)){for(const Ae of Ie.pinConnections)if(Ae&&typeof Ae=="string"){const ge=parseInt(Ae,10);!isNaN(ge)&&ge>Ne&&(Ne=ge)}}}if(c.drawing?.componentsBottom&&Array.isArray(c.drawing.componentsBottom)){for(const Ie of c.drawing.componentsBottom)if(Ie.pinConnections&&Array.isArray(Ie.pinConnections)){for(const Ae of Ie.pinConnections)if(Ae&&typeof Ae=="string"){const ge=parseInt(Ae,10);!isNaN(ge)&&ge>Ne&&(Ne=ge)}}}if(c.drawing?.grounds&&Array.isArray(c.drawing.grounds))for(const Ie of c.drawing.grounds)Ie.pointId&&typeof Ie.pointId=="number"&&Ie.pointId>Ne&&(Ne=Ie.pointId);if(c.drawing?.powers&&Array.isArray(c.drawing.powers))for(const Ie of c.drawing.powers)Ie.pointId&&typeof Ie.pointId=="number"&&Ie.pointId>Ne&&(Ne=Ie.pointId);const be=Ne+1,Le=sg();Le<be&&(console.warn(`pointIdCounter was ${Le} but max existing ID is ${Ne}. Correcting to ${be}.`),qp(be)),Ci.current=!1,go(!1),rr(!1),setTimeout(()=>{ad.current=!1},100)}catch(z){console.error("Failed to open project",z),alert("Failed to open project file. See console for details."),ad.current=!1}},[N,mt,oi,s,d,qp,da,fa,ws,ha,za,rs,Yr,Ga,oa,va,ds,Li,ie,ce,je,ji,Yi,so,ko,xo,Xr,at,ri,Si,on,Me,xt,Wt,pc,sr,cg,y2,Uf,eo,ii,wr]),ps=I.useCallback(async()=>{},[ya]),ld=I.useCallback(async c=>{const x=lr.current;if(!x){console.warn("Cannot load file: no directory handle");return}try{const B=await(await x.getFileHandle(c)).getFile();if(B.size===0){console.warn(`File ${c} is empty, skipping`);const Le=Jr.current.filter(Ie=>Ie!==c);Ha(Le),Jr.current=Le;return}const K=await B.text();if(!K||K.trim().length===0){console.warn(`File ${c} contains no data, skipping`);const Le=Jr.current.filter(Ie=>Ie!==c);Ha(Le),Jr.current=Le;return}let ne;try{ne=JSON.parse(K)}catch(be){console.error(`Failed to parse JSON from file ${c}:`,be);const Ie=Jr.current.filter(Ae=>Ae!==c);Ha(Ie),Jr.current=Ie,await ps();return}uc(),Bt(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),jn(new Set),mn(new Set),xn(new Set),Tn(new Set),er(),await ql(ne),Zi(c);const Ne=Jr.current.indexOf(c);Ne>=0?(Fr(Ne),cs.current=Ne):await ps(),Ci.current=!1,go(!1)}catch(z){console.error("Failed to load file from history:",z);const B=Jr.current;if(B.includes(c)){const K=B.filter(ne=>ne!==c);Ha(K),Jr.current=K,await ps()}}},[ql,ps,er]),zu=I.useCallback(async c=>{if(!oi){console.warn("Cannot restore file: no project directory handle"),alert("No project directory available. Please open or create a project first.");return}try{let x;try{x=await oi.getDirectoryHandle("history")}catch(P){console.error("History directory not found:",P),alert("History directory not found.");return}const B=await(await x.getFileHandle(c)).getFile();if(B.size===0){alert(`File ${c} is empty.`);return}const K=await B.text();if(!K||K.trim().length===0){alert(`File ${c} contains no data.`);return}let ne;try{ne=JSON.parse(K)}catch(P){console.error(`Failed to parse JSON from file ${c}:`,P),alert(`Failed to parse file ${c}. It may be corrupted.`);return}uc(),Bt(1),document.body&&(document.body.style.zoom="1"),document.documentElement&&(document.documentElement.style.zoom="1"),jn(new Set),mn(new Set),xn(new Set),Tn(new Set),er(),await ql(ne),Zi(c),Ci.current=!1,console.log(`Successfully restored file: ${c}`)}catch(x){console.error("Failed to restore file from history:",x),alert(`Failed to restore file ${c}. Please try again.`)}},[oi,ql,jn,mn,xn,Tn,Zi,Bt,uc,er]);At.useEffect(()=>{et&&!wt&&It({x:window.innerWidth/2-300,y:window.innerHeight/2-250})},[et,wt]);const cd=I.useCallback(c=>{if(!wt)return;wn(!0);const x=c.clientX-wt.x,z=c.clientY-wt.y,B=ne=>{It({x:ne.clientX-x,y:ne.clientY-z})},K=()=>{wn(!1),document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",K)};document.addEventListener("mousemove",B),document.addEventListener("mouseup",K)},[wt]);I.useCallback(async()=>{const c=cs.current,x=Jr.current;if(c>=0&&c<x.length-1){const z=c+1,B=x[z];B&&await ld(B)}},[ld]),I.useCallback(async()=>{const c=cs.current,x=Jr.current;if(c<=0||c>=x.length||x.length===0){console.warn("Cannot navigate to newer file: index is",c,"history length is",x.length);return}if(c>0&&c<x.length&&x.length>0){const z=c-1;if(z>=0&&z<x.length){const B=x[z];B?await ld(B):(console.warn("No newer file found at index",z),await ps())}else console.warn("Cannot navigate to newer file: prevIndex",z,"is out of bounds")}},[ld,ps]),At.useEffect(()=>{gn.current=jt},[jt]);const uu=At.useRef(mt),Vc=At.useRef(_t);At.useEffect(()=>{const c=mt!==uu.current;if(N==="draw"&&uu.current==="trace"&&c){if(gn.current.length>=2){Mi($e,Jt,Qt,vt,Zt);const x={id:`${Date.now()}-trace-autofinalize`,points:gn.current,color:Y,size:U,layer:Vc.current,type:"trace"};at(z=>[...z,x]),Vc.current==="top"?Fo(z=>[...z,x.id]):xs(z=>[...z,x.id])}Ft([]),Vt(!1)}uu.current=mt,Vc.current=_t},[mt,_t,N,Y,U]);const jf=At.useRef(N);At.useEffect(()=>{if(jf.current==="draw"&&N!=="draw"&&mt==="trace"&&gn.current.length>=2){const c={id:`${Date.now()}-trace-autofinalize`,points:gn.current,color:Y,size:U,layer:_t,type:"trace"};at(x=>[...x,c]),_t==="top"?Fo(x=>[...x,c.id]):xs(x=>[...x,c.id]),Ft([]),Vt(!1)}jf.current=N},[N,mt,Y,U,_t]);const Tf=At.useMemo(()=>r2,[]);At.useEffect(()=>{su()},[$e]),At.useEffect(()=>{su()},[Jt,Qt,Ee,Qi]);const nn=ea>0,Cf=I.useCallback(async c=>await w1(wo,kr,Zi,zo,ta,ll,ql,async(B,K,ne,P)=>{await Hd(B,K,ne,so,ko,xo,Xr,lr,Zr,zi,Ci,No,ao,kr,us,P)},c),[wo,kr,Zi,zo,ta,ll,ql,so,ko,xo,Xr,lr,Zr,zi,Ci,No,ao,kr,us,Hd]);I.useCallback(async()=>{const x=await w1(wo,kr,Zi,zo,ta,ll,ql,async(z,B,K,ne)=>{await Hd(z,B,K,so,ko,xo,Xr,lr,Zr,zi,Ci,No,ao,kr,us,ne)});if(!x.success){if(x.error&&x.error!=="User cancelled directory selection."&&alert(x.error),x.error==="User cancelled directory selection.")return;x.error?.includes("not supported")&&cl.current?.click()}},[wo,kr,Zi,zo,ta,ll,ql,Kr,oi,so,ko,xo,Xr,lr,Zr,zi,Ci,No,ao,kr,us,cl,Hd]);const Md=I.useCallback(async()=>{const c=window;if(typeof c.showDirectoryPicker!="function"){alert("Directory picker is not supported in this browser.");return}let x=null;try{x=await c.showDirectoryPicker({mode:"readwrite"});try{if(x&&"queryPermission"in x&&typeof x.queryPermission=="function"&&await x.queryPermission({mode:"readwrite"})!=="granted"&&"requestPermission"in x&&typeof x.requestPermission=="function"&&await x.requestPermission({mode:"readwrite"})!=="granted"){alert("Full access to the project directory is required to open and manage project files.");return}}catch(B){console.warn("Permission check failed (may not be supported in this browser):",B)}}catch(B){if(B?.name==="AbortError")return;alert(`Failed to open directory picker: ${B instanceof Error?B.message:String(B)}`);return}if(sd()&&oi)try{await Ec()}catch(B){console.warn("Failed to auto-save before opening project:",B)}const z=await Cf(x);!z.success&&z.error&&z.error!=="User cancelled directory selection."&&alert(z.error)},[sd,Ec,oi,Cf]),vp=I.useCallback(async()=>{if(sd()&&oi)try{await Ec()}catch(c){console.warn("Failed to save before closing project:",c)}od()},[sd,Ec,oi,od]);return i.jsxs("div",{className:"app",children:[i.jsxs("header",{className:"app-header",children:[i.jsx("h1",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)"},children:" PCB Tracer"}),i.jsxs("button",{onClick:()=>{window.open("https://github.com/sponsors/pgiacalo","_blank","noopener,noreferrer")},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"#ffffff",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:6,cursor:"pointer",fontSize:12,fontWeight:500,color:"#000000",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",transition:"background 0.2s",marginLeft:"auto"},onMouseEnter:c=>{c.currentTarget.style.background="#f0f0f0"},onMouseLeave:c=>{c.currentTarget.style.background="#ffffff"},title:"Donate to support this project",children:[i.jsx("svg",{height:"16",width:"16",viewBox:"0 0 16 16",fill:"#ff0000","aria-hidden":"true",children:i.jsx("path",{d:"M4.25 2.5c-1.336 0-2.75 1.164-2.75 3 0 2.15 1.58 4.144 3.365 5.682A20.565 20.565 0 008 13.393a20.561 20.561 0 003.135-2.211C12.92 9.644 14.5 7.65 14.5 5.5c0-1.836-1.414-3-2.75-3-1.373 0-2.609.986-3.029 2.456a.749.749 0 01-1.442 0C6.859 3.486 5.623 2.5 4.25 2.5z"})}),"Donate"]})]}),i.jsx(D5,{openMenu:Dc,setOpenMenu:Ds,isReadOnlyMode:nn,currentProjectFilePath:ya,isProjectActive:!!oi,autoSaveEnabled:Va,autoSaveInterval:Cl,hasUnsavedChangesState:jl,onNewProject:qc,onOpenProject:Md,onSaveProject:Ec,onCloseProject:vp,onPrint:yp,onExportBOM:uo,bomExportFormat:ae,setBomExportFormat:E,onExportNetlist:Us,netlistExportFormat:q,setNetlistExportFormat:re,hasUnsavedChanges:sd,setNewProjectDialog:Ea,setAutoSaveDialog:No,onShowGeminiSettings:()=>ra(!0),topImage:o,bottomImage:l,setCurrentTool:g,resetImageTransform:hf,areImagesLocked:Ki,setAreImagesLocked:da,onEnterBoardDimensions:()=>Bs(!0),fileInputTopRef:eu,fileInputBottomRef:js,openProjectRef:cl,increaseSize:Bl,decreaseSize:td,brushSize:U,drawingStrokes:$e,selectedIds:vn,selectedComponentIds:En,selectedPowerIds:Ai,selectedGroundIds:wi,componentsTop:Jt,componentsBottom:Qt,powers:Pe,grounds:Ee,powerNodeNames:rp,groundNodeNames:op,setSetSizeDialog:os,areViasLocked:Nr,setAreViasLocked:fa,arePadsLocked:pa,setArePadsLocked:ws,areTestPointsLocked:Zo,setAreTestPointsLocked:Aa,areTracesLocked:oo,setAreTracesLocked:ha,areComponentsLocked:Hi,setAreComponentsLocked:za,areGroundNodesLocked:ho,setAreGroundNodesLocked:rs,arePowerNodesLocked:Wi,setArePowerNodesLocked:Yr,showTraceCornerDots:Ui,setShowTraceCornerDots:Rr,showCrosshairs:lo,setShowCrosshairs:jr,setSelectedIds:jn,setSelectedComponentIds:mn,setSelectedPowerIds:xn,setSelectedGroundIds:Tn,selectAllVias:mh,selectAllTraces:Zf,selectAllPads:Jf,selectAllComponents:Qf,selectDisconnectedComponents:ep,selectAllComponentConnections:tp,selectAllPowerNodes:af,selectAllGroundNodes:ap,selectPowerNodesByName:sp,selectGroundNodesByName:vh,setShowPowerBusManager:He,setShowGroundBusManager:ar,setShowPastMachine:yt,toolRegistry:pi,updateToolSettings:Gl,updateToolLayerSettings:po,setBrushSize:$,setBrushColor:ee,saveToolSettings:By,saveToolLayerSettings:Yd,colorPalette:Tf,currentTool:N,drawingMode:mt,traceToolLayer:di,padToolLayer:Gn,testPointToolLayer:fi,componentToolLayer:Di,setTopTraceSize:te,setBottomTraceSize:Ce,setTopPadSize:W,setBottomPadSize:Te,setTopTestPointSize:st,setBottomTestPointSize:qt,setTopComponentSize:Qe,setBottomComponentSize:dn,setComponentConnectionSize:Be,topTraceColor:H,bottomTraceColor:Z,topPadColor:Re,bottomPadColor:k,topTestPointColor:le,bottomTestPointColor:ve,topComponentColor:ye,bottomComponentColor:Gt,setTopTraceColor:R,setBottomTraceColor:G,setTopPadColor:xe,setBottomPadColor:A,setTopTestPointColor:_e,setBottomTestPointColor:De,setTopComponentColor:ut,setBottomComponentColor:Et,setComponentConnectionColor:kn,saveDefaultSize:fe,saveDefaultColor:lt,menuBarRef:ul,onOpenProjectNotes:yf,onOpenTestPoints:xf,onOpenTransformImages:()=>Js(!0),onOpenTransformAll:()=>Ho(!0)}),i.jsx("div",{style:{display:"block",padding:0,margin:0,width:"100vw",height:"calc(100vh - 70px)",boxSizing:"border-box",position:"relative"},children:i.jsxs("div",{ref:Ic,style:{position:"relative",width:"100%",height:"100%",margin:0,padding:0,boxSizing:"border-box",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",borderRadius:"16px",overflow:"hidden"},children:[i.jsxs("div",{style:{position:"absolute",top:6,left:6,bottom:6,width:46,display:"flex",flexDirection:"column",gap:8,padding:"6px 3px",background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:20},children:[i.jsxs("button",{onClick:()=>{nn||lu()},onMouseDown:c=>c.currentTarget.blur(),disabled:nn,title:"Select (S)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="select"?"2px solid #000":"1px solid #ddd",background:N==="select"?"#e6f0ff":"#fff",color:nn?"#999":"#222",outline:"none",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[i.jsx(e2,{size:14}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"S"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onMouseDown:c=>{if(c.altKey&&!nn){c.preventDefault(),c.stopPropagation(),oc(!1),gl(!0);return}},onClick:c=>{!nn&&!c.altKey&&(console.log("Via tool clicked"),Ut(),cn("via"),g("draw"),Ga(!0))},disabled:nn,title:"Draw Vias (V), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="draw"&&mt==="via"?"2px solid #000":"1px solid #ddd",background:N==="draw"&&mt==="via"?"#e6f0ff":"#fff",color:nn?"#999":"#222",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const c=Un.get("via").color;return i.jsxs(i.Fragment,{children:[i.jsx("circle",{cx:"12",cy:"12",r:"8",fill:"none",stroke:c,strokeWidth:"3"}),i.jsx("circle",{cx:"12",cy:"12",r:"4",fill:c})]})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"V"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Un.get("via").size})]})]}),i.jsxs("button",{ref:zd,onMouseDown:c=>{if(c.altKey&&!nn){c.preventDefault(),c.stopPropagation(),oc(!0),gl(!0);return}},onClick:c=>{!nn&&!c.altKey&&(console.log("Pad tool clicked"),Ut(),cn("pad"),g("draw"),setTimeout(()=>Dd(),0))},disabled:nn,title:"Draw Pads (P), Option+click for Pattern Placement",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="draw"&&mt==="pad"?"2px solid #000":"1px solid #ddd",background:N==="draw"&&mt==="pad"?"#e6f0ff":"#fff",color:nn?"#999":"#222",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[i.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const x=Gn==="top"?"padTop":"padBottom",z=Un.get(x).color,B=14,K=(24-B)/2,ne=(24-B)/2;return i.jsx("rect",{x:K,y:ne,width:B,height:B,fill:z})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"P"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(N==="draw"&&mt==="pad"&&br.toolInstanceId&&(br.toolInstanceId==="padTop"||br.toolInstanceId==="padBottom"))return br.size;const c=Gn==="top"?"padTop":"padBottom";return Un.get(c).size})()})]})]}),i.jsxs("button",{ref:Cu,onClick:()=>{nn||(console.log("Test Point tool clicked"),Ut(),cn("testPoint"),g("draw"),setTimeout(()=>cu(),0))},disabled:nn,title:"Draw Test Points (Y)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="draw"&&mt==="testPoint"?"2px solid #000":"1px solid #ddd",background:N==="draw"&&mt==="testPoint"?"#e6f0ff":"#fff",color:nn?"#999":"#222",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[i.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:(()=>{const x=fi==="top"?"testPointTop":"testPointBottom",z=Un.get(x).color,B=14,K=12,ne=12;return i.jsx("path",{d:`M ${K} ${ne-B/2} L ${K+B/2} ${ne} L ${K} ${ne+B/2} L ${K-B/2} ${ne} Z`,fill:z,stroke:"#000",strokeWidth:"1.5"})})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"Y"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{if(N==="draw"&&mt==="testPoint"&&br.toolInstanceId&&(br.toolInstanceId==="testPointTop"||br.toolInstanceId==="testPointBottom"))return br.size;const c=fi==="top"?"testPointTop":"testPointBottom";return Un.get(c).size})()})]})]}),i.jsxs("button",{ref:Xu,onMouseDown:c=>{if(c.altKey&&!nn){c.preventDefault(),c.stopPropagation(),oc(!1),gl(!0);return}},onClick:c=>{!nn&&!c.altKey&&(console.log("Trace tool clicked"),Ut(),cn("trace"),g("draw"),Rl(!0),setTimeout(()=>gf(),0))},disabled:nn,title:"Draw Traces (T)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="draw"&&mt==="trace"?"2px solid #000":"1px solid #ddd",background:N==="draw"&&mt==="trace"?"#e6f0ff":"#fff",color:nn?"#999":"#222",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[i.jsx(n2,{size:14,color:(()=>{const x=di==="top"?"traceTop":"traceBottom";return Un.get(x).color})()}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"T"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const c=di==="top"?"traceTop":"traceBottom";return Un.get(c).size})()})]})]}),i.jsxs("button",{ref:aa,onClick:()=>{nn||(console.log("Component tool clicked"),Ut(),g("component"))},disabled:nn,title:"Draw Component (C)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="component"?"2px solid #000":"1px solid #ddd",background:N==="component"?"#e6f0ff":"#fff",color:nn?"#999":"#222",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[(()=>{const x=(Di||"top")==="top"?"componentTop":"componentBottom",z=Un.get(x).color;return Ll?i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("rect",{x:"4",y:"4",width:"16",height:"16",fill:"rgba(255,255,255,0.9)",stroke:z,strokeWidth:"1.5"}),i.jsx("text",{x:"12",y:"14",textAnchor:"middle",fontSize:"7",fill:z,fontWeight:"bold",fontFamily:"monospace",children:(()=>{const B=Tc?.componentDefinition?.designator??Tc?.designator;return B?B.length<=3?B:B.substring(0,3):Dg(Ll)})()})]}):i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("rect",{x:"5",y:"3",width:"14",height:"7",fill:z,stroke:z,strokeWidth:"0.5"}),i.jsxs("g",{stroke:z,fill:"none",strokeWidth:"1.5",children:[i.jsx("rect",{x:"5",y:"10",width:"14",height:"4",rx:"1.2"}),i.jsx("path",{d:"M7 14 v4 M10 14 v4 M13 14 v4 M16 14 v4",stroke:z})]})]})})(),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"C"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:(()=>{const c=Di==="top"?"componentTop":"componentBottom";return Un.get(c).size})()})]})]}),i.jsxs("button",{ref:wa,onClick:()=>{nn||(console.log("Power tool clicked"),Ut(),_i(!1),pe.length===1?(hi(pe[0].id),g("power"),Sn(!1),je(!0)):pe.length>1?Sn(!0):(Sn(!0),g("power"),je(!0)))},disabled:nn,title:"Draw Power (B)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="power"?"2px solid #000":"1px solid #ddd",background:N==="power"?"#e6f0ff":"#fff",color:nn?"#999":"#222",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[i.jsx("span",{style:{color:(en?pe.find(c=>c.id===en)?.color:null)||"#ff0000",fontSize:"18px",fontWeight:"bold",lineHeight:1,flexShrink:0},children:"V"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"B"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Un.get("power").size})]})]}),i.jsxs("button",{ref:Pd,onClick:()=>{nn||(console.log("Ground tool clicked"),Sn(!1),qe.length===1?($i(qe[0].id),g("ground"),_i(!1),ji(!0)):qe.length>1?_i(!0):(_i(!0),g("ground"),ji(!0)))},disabled:nn,title:"Draw Ground (G)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="ground"?"2px solid #000":"1px solid #ddd",background:N==="ground"?"#e6f0ff":"#fff",color:nn?"#999":"#222",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 20","aria-hidden":"true",style:{overflow:"visible",flexShrink:0},children:i.jsxs("g",{stroke:(ur?qe.find(c=>c.id===ur)?.color:null)||"#000000",strokeWidth:"2",strokeLinecap:"round",children:[i.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10"}),i.jsx("line",{x1:"5",y1:"10",x2:"19",y2:"10"}),i.jsx("line",{x1:"7",y1:"13",x2:"17",y2:"13"}),i.jsx("line",{x1:"9.5",y1:"16",x2:"14.5",y2:"16"})]})}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"G"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:Un.get("ground").size})]})]}),i.jsx("div",{style:{height:32}}),i.jsxs("button",{onClick:()=>{nn||(Ut(),g(c=>c==="pan"?"draw":"pan"))},disabled:nn,title:"Move (H)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:6,padding:"4px 6px",borderRadius:6,border:N==="pan"?"2px solid #000":"1px solid #ddd",background:N==="pan"?"#e6f0ff":"#fff",color:nn?"#999":"#222",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[i.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:i.jsxs("g",{stroke:"#111",fill:"none",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("path",{d:"M8 11v-4c0-.8.6-1.3 1.3-1.3S11 6.2 11 7v4"}),i.jsx("path",{d:"M11 11V6.5c0-.8.6-1.3 1.3-1.3S14 5.7 14 6.5V11"}),i.jsx("path",{d:"M14 11V7.2c0-.8.6-1.3 1.3-1.3.7 0 1.3.5 1.3 1.3V12c1 .6 1.6 1.5 1.6 2.7A4.3 4.3 0 0 1 14 19H9.2A4.2 4.2 0 0 1 5 14.8V11c0-.6.4-1 .9-1 .6 0 1 .4 1 1v2"})]})}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"H"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{Ut(),tu(!1),g(c=>c==="magnify"?"draw":"magnify")},title:"Magnify (M)",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="magnify"?"2px solid #000":"1px solid #ddd",background:N==="magnify"?"#e6f0ff":"#fff",color:"#222",cursor:"pointer"},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("circle",{cx:"10",cy:"10",r:"7.5",fill:"none",stroke:"#111",strokeWidth:"2"}),i.jsx("line",{x1:"15.5",y1:"15.5",x2:"21",y2:"21",stroke:"#111",strokeWidth:"2",strokeLinecap:"round"}),_a?i.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}):i.jsxs(i.Fragment,{children:[i.jsx("line",{x1:"6.5",y1:"10",x2:"13.5",y2:"10",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"}),i.jsx("line",{x1:"10",y1:"6.5",x2:"10",y2:"13.5",stroke:"#111",strokeWidth:"2.4",strokeLinecap:"round"})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"M"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{nn||Ho(!0)},disabled:nn,title:"Change Perspective (E) - Open Change Perspective Dialog",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:Tl?"2px solid #000":"1px solid #ddd",background:Tl?"#e6f0ff":"#fff",color:nn?"#999":"#222",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("ellipse",{cx:"12",cy:"12",rx:"9",ry:"6",fill:"none",stroke:"#111",strokeWidth:"2"}),i.jsx("circle",{cx:"12",cy:"12",r:"4",fill:"none",stroke:"#111",strokeWidth:"2"}),i.jsx("circle",{cx:"11",cy:"11",r:"1.5",fill:"#111",stroke:"none"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"E"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("button",{onClick:()=>{nn||(Ut(),g("center"),cr(!0),Vn.current&&clearTimeout(Vn.current),Vn.current=setTimeout(()=>{cr(!1),g("select"),ki(void 0)},2e3))},disabled:nn,title:"Set View (X) - Press 0-9 to Set View",style:{width:"100%",height:32,display:"flex",alignItems:"center",gap:3,padding:"4px 3px",borderRadius:6,border:N==="center"?"2px solid #000":"1px solid #ddd",background:N==="center"?"#e6f0ff":"#fff",color:nn?"#999":"#222",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:[i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24","aria-hidden":"true",style:{flexShrink:0},children:[i.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"10",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"12",y1:"14",x2:"12",y2:"22",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"2",y1:"12",x2:"10",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"}),i.jsx("line",{x1:"14",y1:"12",x2:"22",y2:"12",stroke:"#111",strokeWidth:"3",strokeLinecap:"round"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",flex:1,minWidth:0},children:[i.jsx("span",{style:{fontSize:"10px",fontWeight:"bold",lineHeight:1},children:"X"}),i.jsx("span",{style:{fontSize:"9px",lineHeight:1,opacity:.7},children:"-"})]})]}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("button",{onClick:()=>{nn||ga(c=>!c)},disabled:nn,title:"Color Picker",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:i.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16","aria-hidden":"true",children:[i.jsx("rect",{x:"0",y:"0",width:"3.5",height:"3.5",fill:"#9E9E9E",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"0",width:"3.5",height:"3.5",fill:"#0072B2",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"0",width:"3.5",height:"3.5",fill:"#56B4E9",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"0",width:"3.5",height:"3.5",fill:"#00BFC4",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"4",width:"3.5",height:"3.5",fill:"#6A3D9A",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"4",width:"3.5",height:"3.5",fill:"#2CA02C",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"4",width:"3.5",height:"3.5",fill:"#7FC97F",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"4",width:"3.5",height:"3.5",fill:"#FF7F0E",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"8",width:"3.5",height:"3.5",fill:"#FFD700",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"8",width:"3.5",height:"3.5",fill:"#FF6B6B",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"8",width:"3.5",height:"3.5",fill:"#E74C3C",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"8",width:"3.5",height:"3.5",fill:"#FFB6C1",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"0",y:"12",width:"3.5",height:"3.5",fill:"#DDA0DD",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"4",y:"12",width:"3.5",height:"3.5",fill:"#8B4513",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"8",y:"12",width:"3.5",height:"3.5",fill:"#A0522D",stroke:"#ccc",strokeWidth:"0.3"}),i.jsx("rect",{x:"12",y:"12",width:"3.5",height:"3.5",fill:"#FF4500",stroke:"#ccc",strokeWidth:"0.3"})]})}),Vo&&i.jsx("div",{ref:Ns,style:{position:"absolute",left:42,top:0,padding:8,background:"#fff",border:"1px solid #ddd",borderRadius:6,boxShadow:"0 8px 18px rgba(0,0,0,0.18)",zIndex:50},children:i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(8, 22px)",gap:4},children:Tf.map(c=>i.jsx("div",{onClick:()=>{ee(c),ga(!1);try{let z=null;N==="draw"&&mt==="via"?z="via":N==="draw"&&mt==="pad"?z=(Gn||"top")==="bottom"?"padBottom":"padTop":N==="draw"&&mt==="testPoint"?z=(fi||"top")==="bottom"?"testPointBottom":"testPointTop":N==="draw"&&mt==="trace"?z=(di||"top")==="bottom"?"traceBottom":"traceTop":N==="component"?z=(Di||"top")==="bottom"?"componentBottom":"componentTop":N==="power"?z="power":N==="ground"&&(z="ground"),z&&Un.setColor(z,c)}catch(z){console.error("Error updating tool instance color:",z)}const x=ns(pi);if(x)if(N==="draw"&&mt==="trace"){const z=di||"top",K=x.layerSettings.get(z)?.size||x.settings.size,ne={color:c,size:K};po(x.id,z,ne),Yd(x.id),z==="top"?(R(c),lt("trace",c,"top")):(G(c),lt("trace",c,"bottom"))}else if(N==="draw"&&mt==="pad"){const z=Gn||"top",K=x.layerSettings.get(z)?.size||x.settings.size,ne={color:c,size:K};po(x.id,z,ne),Yd(x.id),z==="top"?(xe(c),lt("pad",c,"top")):(A(c),lt("pad",c,"bottom"))}else if(N==="draw"&&mt==="testPoint"){const z=fi||"top",K=x.layerSettings.get(z)?.size||x.settings.size,ne={color:c,size:K};po(x.id,z,ne),Yd(x.id),z==="top"?(_e(c),lt("testPoint",c,"top")):(De(c),lt("testPoint",c,"bottom"))}else if(N==="component"){const z=Di||"top",K=x.layerSettings.get(z)?.size||x.settings.size,ne={color:c,size:K};po(x.id,z,ne),Yd(x.id),z==="top"?(ut(c),lt("component",c,"top")):(Et(c),lt("component",c,"bottom"))}else{const z={...x.settings,color:c};Gl(x.id,z),By(x.id,c,x.settings.size),N==="draw"&&mt==="via"&&lt("via",c)}lt("brush",c),vn.size>0&&at(z=>z.map(B=>vn.has(B.id)?(B.type==="via"?(lt("via",c),dr(K=>{const ne=new Map(K),P=ne.get("via");return P&&ne.set("via",{...P,settings:{...P.settings,color:c}}),ne})):B.type==="pad"?(lt("pad",c),dr(K=>{const ne=new Map(K),P=ne.get("pad");return P&&ne.set("pad",{...P,settings:{...P.settings,color:c}}),ne})):B.type==="trace"&&lt("trace",c,B.layer),{...B,color:c}):B)),En.size>0&&(lt("component",c),ri(z=>z.map(B=>En.has(B.id)?{...B,color:c}:B)),Si(z=>z.map(B=>En.has(B.id)?{...B,color:c}:B))),Ai.size>0&&Wt(z=>z.map(B=>Ai.has(B.id)?{...B,color:c}:B)),wi.size>0&&on(z=>z.map(B=>wi.has(B.id)?{...B,color:c}:B))},title:c,style:{width:22,height:22,backgroundColor:c,border:c===Y?"2px solid #333":"1px solid #ccc",cursor:"pointer"}},c))})})]}),i.jsx("div",{style:{height:32}}),i.jsx("button",{onClick:()=>{nn||yf()},disabled:nn,title:"Project Notes",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"2",fill:"#fff",stroke:"#FFD700",strokeWidth:"1"}),i.jsx("circle",{cx:"6",cy:"7",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"6",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"11",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"10",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"15",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"14",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"19",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"18",width:"8",height:"2",rx:"1",fill:"#000"})]})}),i.jsx("button",{onClick:()=>{nn||xf()},disabled:nn,title:"Test Points",style:{width:32,height:32,display:"grid",placeItems:"center",borderRadius:6,border:"1px solid #ddd",background:"#fff",cursor:nn?"not-allowed":"pointer",opacity:nn?.5:1},children:i.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("rect",{width:"24",height:"24",fill:"#FFD700"}),i.jsx("circle",{cx:"6",cy:"7",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"6",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"11",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"10",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"15",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"14",width:"8",height:"2",rx:"1",fill:"#000"}),i.jsx("circle",{cx:"6",cy:"19",r:"1.5",fill:"#000"}),i.jsx("rect",{x:"9",y:"18",width:"8",height:"2",rx:"1",fill:"#000"})]})})]}),N==="draw"&&mt==="trace"&&wu&&i.jsxs("div",{ref:Fc,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"traceToolLayer",checked:di==="top",onChange:()=>{console.log("Trace tool Top clicked"),es.current="top",To("top"),Yt("top"),ee(H),$(we),dr(c=>{const x=new Map(c),z=x.get("trace");return z&&x.set("trace",{...z,settings:{color:H,size:we}}),x}),Rl(!1),Er(!0),ds(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"traceToolLayer",checked:di==="bottom",onChange:()=>{console.log("Trace tool Bottom clicked"),es.current="bottom",To("bottom"),Yt("bottom"),ee(Z),$(de),dr(c=>{const x=new Map(c),z=x.get("trace");return z&&x.set("trace",{...z,settings:{color:Z,size:de}}),x}),Rl(!1),bo(!0),Li(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),N==="draw"&&mt==="pad"&&ru&&i.jsxs("div",{ref:ju,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"padToolLayer",checked:Gn==="top",onChange:()=>{console.log("Pad tool Top clicked"),ts.current="top",gs("top"),Yt("top");const c=Un.get("padTop");ee(c.color),$(c.size),dr(x=>{const z=new Map(x),B=z.get("pad");return B&&z.set("pad",{...B,settings:{color:c.color,size:c.size}}),z}),Su(!1),Er(!0),oa(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"padToolLayer",checked:Gn==="bottom",onChange:()=>{console.log("Pad tool Bottom clicked"),ts.current="bottom",gs("bottom"),Yt("bottom");const c=Un.get("padBottom");ee(c.color),$(c.size),dr(x=>{const z=new Map(x),B=z.get("pad");return B&&z.set("pad",{...B,settings:{color:c.color,size:c.size}}),z}),Su(!1),bo(!0),va(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),N==="draw"&&mt==="testPoint"&&jd&&i.jsxs("div",{ref:ou,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25},children:[i.jsxs("label",{className:"radio-label",style:{marginRight:6},children:[i.jsx("input",{type:"radio",name:"testPointToolLayer",checked:fi==="top",onChange:()=>{console.log("Test Point tool Top clicked"),ys.current="top",Uo("top"),Yt("top"),ee(le),$(Xe),dr(c=>{const x=new Map(c),z=x.get("testPoint");return z&&x.set("testPoint",{...z,settings:{color:le,size:Xe}}),x}),Sc(!1),Er(!0),y(!0)}}),i.jsx("span",{children:"Top"})]}),i.jsxs("label",{className:"radio-label",children:[i.jsx("input",{type:"radio",name:"testPointToolLayer",checked:fi==="bottom",onChange:()=>{console.log("Test Point tool Bottom clicked"),ys.current="bottom",Uo("bottom"),Yt("bottom"),ee(ve),$(kt),dr(c=>{const x=new Map(c),z=x.get("testPoint");return z&&x.set("testPoint",{...z,settings:{color:ve,size:kt}}),x}),Sc(!1),bo(!0),L(!0)}}),i.jsx("span",{children:"Bottom"})]})]}),un&&i.jsxs("div",{ref:Yu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Power Bus:"}),pe.length===0?i.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No power buses defined. Use Tools  Manage Power Buses to add one."}):[...pe].sort((c,x)=>{const z=ne=>{const P=ne.match(/([+-]?)(\d+\.?\d*)/);if(P){const Ne=P[1]||"+",be=parseFloat(P[2]);return{absValue:Math.abs(be),isNegative:Ne==="-",original:ne}}return{absValue:1/0,isNegative:!1,original:ne}},B=z(c.voltage),K=z(x.voltage);return B.absValue!==K.absValue?B.absValue-K.absValue:B.isNegative!==K.isNegative?B.isNegative?-1:1:0}).map(c=>i.jsx("button",{onClick:x=>{x.preventDefault(),x.stopPropagation(),hi(c.id),N!=="power"&&(Ut(),g("power"),je(!0)),Sn(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("div",{style:{width:16,height:16,borderRadius:"50%",background:c.color,border:"1px solid #ccc"}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:c.name}),i.jsx("div",{style:{fontSize:"11px",color:"#666"},children:c.voltage})]})]})},c.id)),i.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),Sn(!1),He(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Power Buses"}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),Sn(!1),hi(null),g("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),Ji&&i.jsxs("div",{ref:Tu,style:{position:"absolute",padding:"4px 6px",background:"#fff",border:"2px solid #000",borderRadius:6,boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:25,minWidth:"200px"},children:[i.jsx("div",{style:{marginBottom:"4px",fontWeight:600,fontSize:"12px",color:"#333"},children:"Select Ground Bus:"}),qe.length===0?i.jsx("div",{style:{padding:"8px",color:"#666",fontSize:"12px"},children:"No ground buses defined. Use Tools  Manage Ground Buses to add one."}):[...qe].sort((c,x)=>c.name.localeCompare(x.name)).map(c=>{const x=c.id==="groundbus-earth",z=ur===c.id;return i.jsx("button",{onClick:B=>{B.preventDefault(),B.stopPropagation(),$i(c.id),N!=="ground"&&(Ut(),g("ground"),ji(!0)),_i(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:z?"#e0e0e0":"#f5f5f5",border:z?"2px solid #000":"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#222"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("div",{style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:x?i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[i.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"4",y1:"10",x2:"16",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"5",y1:"12.5",x2:"15",y2:"12.5",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"6",y1:"15",x2:"14",y2:"15",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]}):i.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",style:{display:"block"},children:[i.jsx("circle",{cx:"10",cy:"10",r:"6",fill:"none",stroke:"#000",strokeWidth:"2"}),i.jsx("line",{x1:"10",y1:"2",x2:"10",y2:"18",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"}),i.jsx("line",{x1:"2",y1:"10",x2:"18",y2:"10",stroke:"#000",strokeWidth:"2",strokeLinecap:"round"})]})}),i.jsx("div",{children:i.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:c.name})})]})},c.id)}),i.jsx("div",{style:{height:1,background:"#ddd",margin:"4px 0"}}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),_i(!1),ar(!0)},style:{display:"block",width:"100%",textAlign:"left",padding:"4px 6px",marginBottom:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#333",fontSize:"11px"},children:"Manage Ground Buses"}),i.jsx("button",{onClick:c=>{c.preventDefault(),c.stopPropagation(),_i(!1),$i(null),g("select")},style:{display:"block",width:"100%",textAlign:"center",padding:"4px 6px",marginTop:"2px",background:"#f0f0f0",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",color:"#666",fontSize:"11px"},children:"Cancel"})]}),i.jsxs("div",{style:{position:"absolute",top:6,left:60,bottom:6,width:168,padding:6,display:"flex",flexDirection:"column",gap:2,background:"rgba(250,250,255,0.95)",borderRadius:8,border:"1px solid #ddd",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",zIndex:15},children:[i.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#333",marginBottom:2},children:"Layers"}),i.jsxs("div",{onClick:()=>Yt("top"),title:"Top layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Dn==="top"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[i.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Top Image"}),i.jsx("label",{className:"radio-label",style:{margin:0},children:i.jsx("input",{type:"checkbox",checked:ks,onChange:c=>Er(c.target.checked)})})]}),i.jsx("canvas",{ref:el,width:60,height:40,style:{width:"60px",height:"40px"}})]}),i.jsxs("div",{onClick:()=>Yt("bottom"),title:"Bottom layer",style:{cursor:"pointer",padding:2,borderRadius:4,border:Dn==="bottom"?"2px solid #0b5fff":"1px solid #ddd",background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:2},children:[i.jsx("div",{style:{fontSize:10,color:"#444",fontWeight:600},children:"Bottom Image"}),i.jsx("label",{className:"radio-label",style:{margin:0},children:i.jsx("input",{type:"checkbox",checked:$a,onChange:c=>bo(c.target.checked)})})]}),i.jsx("canvas",{ref:Al,width:60,height:40,style:{width:"60px",height:"40px"}})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:vo,onChange:c=>Ga(c.target.checked)}),i.jsx("span",{children:"Vias"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Da,onChange:c=>ds(c.target.checked)}),i.jsx("span",{children:"Traces (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:X,onChange:c=>ie(c.target.checked)}),i.jsx("span",{children:"Components (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:_o,onChange:c=>oa(c.target.checked)}),i.jsx("span",{children:"Pads (Top)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:f,onChange:c=>y(c.target.checked)}),i.jsx("span",{children:"Test Points (Top)"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Ra,onChange:c=>Li(c.target.checked)}),i.jsx("span",{children:"Traces (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:oe,onChange:c=>ce(c.target.checked)}),i.jsx("span",{children:"Components (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Wo,onChange:c=>va(c.target.checked)}),i.jsx("span",{children:"Pads (Bottom)"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:C,onChange:c=>L(c.target.checked)}),i.jsx("span",{children:"Test Points (Bottom)"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:he,onChange:c=>je(c.target.checked)}),i.jsx("span",{children:"Power"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:Qi,onChange:c=>ji(c.target.checked)}),i.jsx("span",{children:"Ground"})]}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:yi,onChange:c=>Yi(c.target.checked)}),i.jsx("span",{children:"Connections"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("label",{className:"radio-label",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:vo&&_o&&Wo&&f&&C&&Da&&Ra&&X&&oe&&he&&Qi&&yi,onChange:c=>{const x=c.target.checked;Ga(x),oa(x),va(x),y(x),L(x),ds(x),Li(x),ie(x),ce(x),je(x),ji(x),Yi(x)}}),i.jsx("span",{style:{fontWeight:600,fontSize:11},children:"Select All Layers"})]}),i.jsx("div",{style:{height:1,background:"#000",margin:"4px 0"}}),i.jsxs("div",{style:{marginTop:6},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Transparency: ",b,"%"]}),i.jsxs("label",{className:"radio-label",style:{margin:0},children:[i.jsx("input",{type:"checkbox",checked:T,onChange:c=>{const x=c.target.checked;x?(Er(!0),bo(!0)):(m(50),g("select")),D(x)}}),i.jsx("span",{style:{marginLeft:6,fontSize:10},children:"Cycle"})]})]}),i.jsx("input",{type:"range",min:"0",max:"100",value:b,onChange:c=>m(Number(c.target.value)),onDoubleClick:()=>rd("transparency"),className:"slider",style:{width:"100%",marginTop:3}}),T&&i.jsxs("div",{style:{marginTop:6},children:[i.jsxs("label",{style:{fontSize:10,color:"#333"},children:["Cycle Speed: ",(M/1e3).toFixed(1),"s"]}),i.jsx("input",{type:"range",min:"500",max:"8000",step:"100",value:8500-M,onChange:c=>S(8500-Number(c.target.value)),onDoubleClick:()=>S(2e3),className:"slider",style:{width:"100%",marginTop:3}})]})]})]}),i.jsx(R5,{visible:!o&&!l&&!fr,canvasSize:_r,canvasPosition:{left:244,top:6},onDismiss:()=>Xl(!0)}),i.jsx("canvas",{ref:Tt,width:_r.width,height:_r.height,tabIndex:0,onMouseDown:pp,onMouseMove:pf,onMouseUp:Qu,onMouseLeave:Qu,onWheel:uf,onDoubleClick:df,className:`pcb-canvas ${N==="transform"?"transform-cursor":N==="draw"?"draw-cursor":N==="erase"?"erase-cursor":"default-cursor"}`,style:{position:"absolute",left:"244px",top:"6px",...Or?{cursor:Or}:N==="pan"?{cursor:na?"grabbing":"grab"}:{},width:`${_r.width}px`,height:`${_r.height}px`,maxHeight:"none",aspectRatio:"auto",border:"none"}}),ss&&i.jsxs("div",{style:{position:"absolute",left:`${244+_r.width-120}px`,top:`${6+_r.height+4}px`,fontSize:"11px",fontFamily:"monospace",color:"#333",backgroundColor:"rgba(255, 255, 255, 0.9)",padding:"2px 6px",borderRadius:"3px",border:"1px solid #ccc",pointerEvents:"none",zIndex:1e3},children:["(",ss.x.toFixed(1),"mm, ",ss.y.toFixed(1),"mm)"]}),i.jsx(W5,{componentEditor:Ua,setComponentEditor:Fa,componentsTop:Jt,componentsBottom:Qt,setComponentsTop:ri,setComponentsBottom:Si,connectingPin:ro,setConnectingPin:ka,componentDialogPosition:bs,setComponentDialogPosition:is,isDraggingDialog:Xs,setIsDraggingDialog:Zc,dialogDragOffset:vs,setDialogDragOffset:Jc,areComponentsLocked:Hi,setSelectedComponentIds:mn,setNotesDialogVisible:co,projectDirHandle:oi,showGeminiSettingsDialog:Zl,onGeminiSettingsDialogClose:()=>ra(!1),onFindComponent:Sd,componentDefinition:Ua?(()=>{const c=Jt.find(x=>x.id===Ua.id)||Qt.find(x=>x.id===Ua.id);return c?Hl(c):void 0})():void 0}),xa&&ia&&(()=>{const c=xa.component,x=xa.layer;if(!c)return null;const z=c.componentType||"Component",B=c.componentType==="IntegratedCircuit"&&"icType"in c?c.icType:null,K=wh(c),ne=Hl(c),P=ne?.category==="Semiconductors",Ne=c?.pinNames,be=ne?.properties?.pinNames,Le=8,Ie=8,Ae=200,ge=150,me=10;let Se=xa.x+Le,ze=xa.y+Ie;return Se+Ae+me>window.innerWidth&&(Se=xa.x-Ae-Le),ze+ge+me>window.innerHeight&&(ze=xa.y-ge-Ie),Se=Math.max(me,Math.min(Se,window.innerWidth-Ae-me)),ze=Math.max(me,Math.min(ze,window.innerHeight-ge-me)),i.jsxs("div",{style:{position:"fixed",left:`${Se}px`,top:`${ze}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:Wl(z)}),i.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["Layer: ",x==="top"?"Top":"Bottom"]}),B&&i.jsxs("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:["IC Type: ",B]}),K.length>0&&i.jsx("div",{style:{marginBottom:"4px"},children:K.map((Oe,Ue)=>i.jsx("div",{style:{color:"#e0e0e0",fontSize:"11px",marginBottom:"2px"},children:Oe},Ue))}),c.description&&i.jsx("div",{style:{marginBottom:"4px",color:"#e0e0e0",fontSize:"11px"},children:c.description}),c.notes&&i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:c.notes}),P&&c.pinCount>0&&(()=>{const Oe=Array.from({length:c.pinCount},(Ue,Ze)=>{const pt=c.pinConnections&&c.pinConnections.length>Ze?c.pinConnections[Ze]:"",Ct=Ne&&Ze<Ne.length?Ne[Ze]:"",Lt=be&&Ze<be.length?be[Ze]:"",dt=Lt==="CHIP_DEPENDENT",sn=Ct&&Ct.trim()!==""?Ct:dt?"":Lt;return{pin:Ze+1,name:sn||"-",nodeId:pt||"-"}});return i.jsxs("div",{style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid rgba(255,255,255,0.2)"},children:[i.jsx("div",{style:{fontSize:"11px",fontWeight:600,marginBottom:"4px",color:"#fff"},children:"Pin Connections:"}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"10px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.3)"},children:[i.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Pin"}),i.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Name"}),i.jsx("th",{style:{textAlign:"left",padding:"2px 6px",fontWeight:600,color:"#fff"},children:"Node ID"})]})}),i.jsx("tbody",{children:Oe.map((Ue,Ze)=>i.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[i.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:Ue.pin}),i.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontStyle:Ue.name!=="-"?"italic":"normal"},children:Ue.name}),i.jsx("td",{style:{padding:"2px 6px",color:"#e0e0e0",fontFamily:"monospace"},children:Ue.nodeId})]},Ze))})]})]})})()]})})(),Mc&&ia&&(()=>{const c=Mc.stroke;return c.notes?i.jsxs("div",{style:{position:"fixed",left:`${Mc.x+10}px`,top:`${Mc.y+10}px`,background:"rgba(0, 0, 0, 0.85)",color:"#fff",padding:"8px 12px",borderRadius:4,fontSize:"12px",lineHeight:"1.4",zIndex:1e4,pointerEvents:"none",width:"max-content",maxWidth:"400px",minWidth:"150px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)",wordWrap:"break-word",overflowWrap:"break-word"},children:[i.jsx("div",{style:{fontWeight:600,marginBottom:"4px"},children:"Test Point"}),i.jsx("div",{style:{marginTop:"4px",paddingTop:"4px",borderTop:"1px solid rgba(255,255,255,0.2)",fontSize:"11px",color:"#d0d0d0",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:c.notes})]}):null})(),qn&&qn.visible&&(()=>{if(!Pe.find(z=>z.id===qn.id))return null;const x=pe.find(z=>z.id===qn.powerBusId);return i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#fff",border:"1px solid #0b5fff",borderRadius:4,padding:"6px",boxShadow:"0 2px 6px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:"175px",maxWidth:"250px",maxHeight:"40vh",overflowY:"auto",pointerEvents:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px"},children:[i.jsx("h3",{style:{margin:0,fontSize:"12px",color:"#333",fontWeight:600},children:"Power Properties"}),i.jsx("button",{onClick:()=>ci(null),style:{background:"transparent",border:"none",fontSize:"14px",cursor:"pointer",color:"#666",padding:0,width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Power Bus:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:x?`${x.name} (${x.voltage})`:"Unknown"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`power-layer-${qn.id}`,style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Layer:"}),i.jsxs("select",{id:`power-layer-${qn.id}`,name:`power-layer-${qn.id}`,value:qn.layer,onChange:z=>ci({...qn,layer:z.target.value}),disabled:Wi,style:{width:"100%",padding:"2px 3px",border:"1px solid #ddd",borderRadius:2,fontSize:"10px",opacity:Wi?.6:1},children:[i.jsx("option",{value:"top",children:"Top"}),i.jsx("option",{value:"bottom",children:"Bottom"})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"X:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:qn.x.toFixed(2)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"9px",fontWeight:600,color:"#333",marginBottom:"1px"},children:"Y:"}),i.jsx("div",{style:{padding:"2px 3px",background:"#f5f5f5",borderRadius:2,fontSize:"10px",color:"#666"},children:qn.y.toFixed(2)})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"3px",marginTop:"6px"},children:[i.jsx("button",{onClick:()=>ci(null),style:{padding:"2px 5px",background:"#f5f5f5",border:"1px solid #ddd",borderRadius:2,cursor:"pointer",fontSize:"10px",color:"#333"},children:"Cancel"}),i.jsx("button",{onClick:()=>{Wi||(Wt(z=>z.map(B=>B.id===qn.id?{...B,layer:qn.layer}:B)),ci(null))},disabled:Wi,style:{padding:"2px 5px",background:Wi?"#f5f5f5":"#0b5fff",color:Wi?"#999":"#fff",border:"1px solid #ddd",borderRadius:2,cursor:Wi?"not-allowed":"pointer",fontSize:"10px"},children:"Save"})]})]})})(),!o&&!l&&i.jsx("div",{className:"placeholder"})]})}),i.jsx(Z5,{visible:ke,onClose:()=>He(!1),powerBuses:pe,setPowerBuses:Me,editingPowerBusId:Je,setEditingPowerBusId:bt,powers:Pe}),i.jsx(J5,{visible:Kt,onClose:()=>ar(!1),groundBuses:qe,setGroundBuses:xt,editingGroundBusId:Xn,setEditingGroundBusId:gi,grounds:Ee}),i.jsx(rw,{visible:et,projectDirHandle:oi,onClose:()=>{yt(!1),It(void 0)},onRestore:zu,position:wt,isDragging:zt,onDragStart:cd}),i.jsx(Q5,{visible:Gi,onClose:()=>hr(!1),autoAssignDesignators:Dr,setAutoAssignDesignators:eo,useGlobalDesignatorCounters:Sr,setUseGlobalDesignatorCounters:ii}),i.jsx("input",{ref:eu,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:c=>{const x=c.target.files?.[0];x&&cf(x,"top"),c.target.value=""}}),i.jsx("input",{ref:js,type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",style:{display:"none"},onChange:c=>{const x=c.target.files?.[0];x&&cf(x,"bottom"),c.target.value=""}}),i.jsx("input",{ref:cl,type:"file",accept:".json,application/json",style:{display:"none"},onChange:async c=>{const x=c.target.files?.[0];if(x)try{nd(),await new Promise(P=>setTimeout(P,0)),Zi(x.name);const z=await x.text(),B=JSON.parse(z);await ql(B,null);let ne;if(B.projectInfo?.name)ne=B.projectInfo.name;else{if(ne=x.name.replace(/\.json$/i,"").replace(/[^a-zA-Z0-9_-]/g,"_"),!ne){console.error("Failed to extract project name from filename"),alert("Warning: Could not determine project name from filename. Please ensure the project file has a valid name.");return}zo(ne)}Kr||zo(ne),setTimeout(async()=>{await Ol(5,!0)},100)}catch(z){console.error("Failed to open project",z),alert("Failed to open project file. See console for details.")}c.target.value=""}}),i.jsx(L5,{visible:qo.visible,selectedIds:vn,selectedComponentIds:En,selectedPowerIds:Ai,selectedGroundIds:wi,drawingStrokes:$e,componentsTop:Jt,componentsBottom:Qt,powers:Pe,grounds:Ee,powerBuses:pe,onClose:()=>{Ur({visible:!1,text:""})},setComponentsTop:ri,setComponentsBottom:Si,determineViaType:Ka,determinePadType:_l,determineTestPointType:yl,onFindComponent:Sd,onFindStroke:np,onFindPower:ip,onFindGround:bh,onOpenNotesDialog:()=>co(!0),position:si,isDragging:qr,onDragStart:c=>{si&&(Fi({x:c.clientX-si.x,y:c.clientY-si.y}),Bn(!0),c.preventDefault())}}),i.jsx(I5,{visible:La,selectedIds:vn,selectedComponentIds:En,selectedPowerIds:Ai,selectedGroundIds:wi,drawingStrokes:$e,componentsTop:Jt,componentsBottom:Qt,powers:Pe,grounds:Ee,powerBuses:pe,onClose:()=>{co(!1)},setComponentsTop:ri,setComponentsBottom:Si,setDrawingStrokes:at,setPowerSymbols:Wt,setGroundSymbols:on,determineViaType:Ka,determinePadType:_l,determineTestPointType:yl,position:Ro,isDragging:dl,onDragStart:c=>{Ro&&(Tr({x:c.clientX-Ro.x,y:c.clientY-Ro.y}),zl(!0),c.preventDefault())}}),i.jsx(M5,{visible:Hu,projectNotes:vc,setProjectNotes:fl,projectMetadata:Oc,setProjectMetadata:Ya,onClose:()=>{pl(!1)},position:Jl,isDragging:Lo,onDragStart:c=>{Jl?(hl({x:c.clientX-Jl.x,y:c.clientY-Jl.y}),Vr(!0),c.preventDefault()):(Ql({x:c.clientX-300,y:c.clientY-200}),hl({x:300,y:200}),Vr(!0),c.preventDefault())}}),i.jsx(B5,{visible:tc,drawingStrokes:$e,onClose:()=>{nc(!1)},onFindTestPoint:of,position:Xa,isDragging:rc,onDragStart:c=>{Xa?(tl({x:c.clientX-Xa.x,y:c.clientY-Xa.y}),Uc(!0),c.preventDefault()):(ic({x:c.clientX-300,y:c.clientY-200}),tl({x:300,y:200}),Uc(!0),c.preventDefault())},determineTestPointType:yl,powerBuses:pe}),i.jsx(ew,{visible:Zs.visible,title:"New Project",message:"You have unsaved changes. Do you want to save your project before creating a new one?",onYes:Nc,onNo:kc,onCancel:Sf,yesButtonRef:yu}),ei.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:c=>{c.target===c.currentTarget&&Id()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:c=>c.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"New Project"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Project Name:"}),i.jsx("input",{ref:Bc,type:"text",value:ei.projectName,onChange:c=>{Ss(x=>({...x,projectName:c.target.value}))},onKeyDown:c=>{c.key==="Enter"?(c.preventDefault(),ml()):c.key==="Escape"&&(c.preventDefault(),Id())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_pcb_project",autoFocus:!0}),ei.projectName&&(()=>{const c=ei.projectName.match(/[^a-zA-Z0-9_-]/g);if(c){const x=[...new Set(c)];return i.jsxs("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#3a1f1f",border:"1px solid #a44",borderRadius:4,fontSize:"12px",color:"#ffaaaa"},children:["Invalid characters: ",x.map(z=>`"${z}"`).join(", "),". Only letters, numbers, underscore (_), and hyphen (-) are allowed."]})}return null})(),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"8px"},children:[i.jsx("input",{type:"text",value:ei.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:ei.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),i.jsx("button",{onClick:Fs,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),i.jsx("div",{style:{marginBottom:"12px",padding:"6px 10px",background:"#2a2a2f",border:"1px solid #444",borderRadius:4,fontSize:"11px",color:"#aaa",fontStyle:"italic"},children:"Note: Select an existing parent directory. The project directory will be created automatically when you click Create."}),ei.projectName&&ei.locationPath&&i.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[i.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"Project will be created at:"}),i.jsx("div",{style:{color:"#4CAF50"},children:(()=>{if(!ei.projectName||!ei.locationPath)return"";const x=ei.projectName.trim().replace(/[^a-zA-Z0-9_-]/g,"_");if(!x)return"";const z=`${x}.json`;return ei.locationPath===x?`${ei.locationPath}/${z}`:`${ei.locationPath}/${x}/${z}`})()})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:Id,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:ml,disabled:!ei.projectName.trim()||!ei.locationHandle,style:{padding:"8px 16px",background:!ei.projectName.trim()||!ei.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!ei.projectName.trim()||!ei.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!ei.projectName.trim()||!ei.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!ei.projectName.trim()||!ei.locationHandle?.6:1},children:"Create"})]})]})}),Bi.visible&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10002},onClick:c=>{c.target===c.currentTarget&&El()},children:i.jsxs("div",{style:{backgroundColor:"#2b2b31",borderRadius:8,padding:"24px",minWidth:"400px",maxWidth:"500px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)",border:"1px solid #1f1f24"},onClick:c=>c.stopPropagation(),children:[i.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"18px",fontWeight:600,color:"#f2f2f2"},children:"Save As"}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"File Name:"}),i.jsx("input",{ref:xu,type:"text",value:Bi.filename,onChange:c=>{Qo(x=>({...x,filename:c.target.value}))},onKeyDown:c=>{c.key==="Enter"?(c.preventDefault(),wf()):c.key==="Escape"&&(c.preventDefault(),El())},style:{width:"100%",padding:"8px 12px",marginBottom:"8px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:"#f2f2f2",fontSize:"14px"},placeholder:"e.g., my_project.json",autoFocus:!0}),i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#e0e0e0",fontWeight:500},children:"Location:"}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[i.jsx("input",{type:"text",value:Bi.locationPath||"Not selected",readOnly:!0,style:{flex:1,padding:"8px 12px",background:"#1f1f24",border:"1px solid #444",borderRadius:6,color:Bi.locationPath?"#f2f2f2":"#888",fontSize:"14px",cursor:"not-allowed"},placeholder:"Select a location..."}),i.jsx("button",{onClick:Es,style:{padding:"8px 16px",background:"#555",color:"#f2f2f2",border:"1px solid #666",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap"},children:"Browse..."})]}),Bi.filename&&Bi.locationPath&&i.jsxs("div",{style:{marginBottom:"20px",padding:"8px 12px",background:"#1a1a1f",border:"1px solid #333",borderRadius:6,fontSize:"12px",color:"#aaa",fontFamily:"monospace"},children:[i.jsx("div",{style:{marginBottom:"4px",color:"#888"},children:"File will be saved at:"}),i.jsxs("div",{style:{color:"#4CAF50"},children:[Bi.locationPath,"/",Bi.filename.endsWith(".json")?Bi.filename:`${Bi.filename}.json`]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px"},children:[i.jsx("button",{onClick:El,style:{padding:"8px 16px",background:"#444",color:"#f2f2f2",border:"1px solid #555",borderRadius:6,cursor:"pointer",fontSize:"14px",fontWeight:500},children:"Cancel"}),i.jsx("button",{onClick:wf,disabled:!Bi.filename.trim()||!Bi.locationHandle,style:{padding:"8px 16px",background:!Bi.filename.trim()||!Bi.locationHandle?"#555":"#4CAF50",color:"#fff",border:"1px solid "+(!Bi.filename.trim()||!Bi.locationHandle?"#666":"#45a049"),borderRadius:6,cursor:!Bi.filename.trim()||!Bi.locationHandle?"not-allowed":"pointer",fontSize:"14px",fontWeight:600,opacity:!Bi.filename.trim()||!Bi.locationHandle?.6:1},children:"Save"})]})]})}),i.jsx(Ux,{visible:Rs.visible,title:Rs.title,message:Rs.message,onClose:()=>Jo({visible:!1,title:"",message:""})}),i.jsx(O5,{visible:vd,dimensions:vu,onSave:c=>{Ms(c)},onClose:()=>Bs(!1)}),i.jsx(U5,{visible:Rc,onClose:()=>{let c=0,x=0;o?(c=o.x,x=o.y):l&&(c=l.x,x=l.y),Cs(z=>({...z,0:{pcbReferenceX:c,pcbReferenceY:x,x:0,y:0,zoom:tt,viewRotation:pn,viewFlipX:yn,isBottomView:qa,transparency:b,showTopImage:ks,showBottomImage:$a,showViasLayer:vo,showTopTracesLayer:Da,showBottomTracesLayer:Ra,showTopPadsLayer:_o,showBottomPadsLayer:Wo,showTopTestPointsLayer:f,showBottomTestPointsLayer:C,showTopComponents:X,showBottomComponents:oe,showPowerLayer:he,showGroundLayer:Qi,showConnectionsLayer:yi}})),Js(!1)},topImage:o,bottomImage:l,selectedImageForTransform:Dn,setSelectedImageForTransform:Cr,transformMode:Ln,setTransformMode:Rt,updateImageTransform:ed,resetImageTransform:hf,setCurrentTool:g,isGrayscale:F,setIsGrayscale:_,areImagesLocked:Ki}),i.jsx(F5,{visible:Tl,onClose:()=>Ho(!1),topImage:o,bottomImage:l,setTopImage:s,setBottomImage:d,componentsTop:Jt,componentsBottom:Qt,setComponentsTop:ri,setComponentsBottom:Si,drawingStrokes:$e,setDrawingStrokes:at,powerSymbols:Pe,groundSymbols:Ee,setPowerSymbols:Wt,setGroundSymbols:on,canvasRef:Tt,isBottomView:qa,setIsBottomView:rr,originalTopFlipX:Oi,setOriginalTopFlipX:or,originalBottomFlipX:yo,setOriginalBottomFlipX:ls,originalTopFlipY:Qs,setOriginalTopFlipY:xc,originalBottomFlipY:Qc,setOriginalBottomFlipY:qu,cameraWorldCenter:li,setCameraWorldCenter:vi,viewScale:tt,viewRotation:pn,setViewRotation:An,viewFlipX:yn,setViewFlipX:$n,contentBorder:5,setTransparency:m}),i.jsx(K5,{visible:sf,selectedLayer:Di,selectedComponentType:Ll,selectedComponentKey:lp,onLayerChange:c=>{_s(c),Pr.current=c,Yt(c),ee(c==="top"?ye:Gt),$(c==="top"?ht:$t),c==="top"?(Er(!0),ie(!0)):(bo(!0),ce(!0))},onComponentTypeChange:(c,x,z)=>{jc(c),cp(x),Cd(z||null),Nd.current=c},onClose:()=>{Td(!1),ca(!0),g("select")}}),i.jsx(tw,{visible:Pa.visible,size:Pa.size,onSizeChange:c=>os(x=>({...x,size:c})),onApply:Sh,onCancel:()=>os({visible:!1,size:6})}),i.jsx(nw,{visible:Ks.visible,interval:Ks.interval,onIntervalChange:c=>No({visible:!0,interval:c}),onApply:()=>Ol(Ks.interval,!1),onCancel:()=>No({visible:!1,interval:5})}),i.jsx(iw,{visible:as.visible,interval:as.interval,onIntervalChange:c=>ao({...as,interval:c}),onEnable:()=>Ol(as.interval,!0),onSkip:gp}),i.jsx(uw,{visible:Wu,isPad:mu,onConfirm:c=>{$u({numPins:c.numPins,type:c.type,twoSidedOrientation:c.twoSidedOrientation,point1:{x:0,y:0},point2:{x:0,y:0}}),Gu(!0),g("select"),gl(!1)},onClose:()=>{gl(!1)}})]})}Gm.createRoot(document.getElementById("root")).render(i.jsx(I.StrictMode,{children:i.jsx(zw,{})}));export{Ir as _,Pw as c,Bm as g};

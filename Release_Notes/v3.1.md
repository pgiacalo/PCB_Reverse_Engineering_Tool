# Release Notes - v3.1

**Release Date:** December 28, 2025

Version 3.1 focuses on security improvements for API key storage and fixes for auto-save functionality, along with TypeScript build error fixes.

## New Features & Improvements

### API Key Security Enhancement
- **Session-Based Storage**: Gemini API keys are now stored in `sessionStorage` instead of `localStorage`
  - API key is automatically cleared when the browser tab is closed
  - Reduces risk of key exposure from persistent storage
  - Model preference still persists in `localStorage` across sessions
- **Updated UI**: Storage & Security Information dialogs now explain session-based storage benefits
- **Simplified AI Settings**: Shortened the intro section in the AI Settings dialog for cleaner UI

### Auto-Save Fix
- **Filename Display Update**: Fixed bug where the displayed filename in the upper right corner was not updating after auto-save
  - Auto-save now correctly updates both the file and the displayed filename
  - Previous behavior: File was saved with new timestamp but UI showed old filename

## Bug Fixes

### TypeScript Build Errors (33 errors fixed)
- **Unused Imports/Variables**: Removed or suppressed unused imports and variables across multiple files
- **Type Compatibility**: Fixed `DrawingPoint.id` type mismatch between `types/index.ts` and `useDrawing.ts`
- **Null Safety**: Fixed "Object possibly undefined" errors in `netlist.ts` with proper optional chaining
- **File System API Types**: Added type assertions for File System Access API methods (`queryPermission`, `requestPermission`, `entries`) that exist at runtime but aren't in TypeScript's standard definitions
- **Import Sources**: Fixed incorrect import paths for `PowerSymbol`, `PowerBus`, `GroundBus`, `ProjectMetadata`, and `DrawingMode` types

## Documentation Updates

- Updated README.md with new API key storage behavior
- Updated DEVELOPMENT.md with "How API Keys Work" section
- Updated GitHub Pages setup guides to reflect sessionStorage usage
- Clarified that API keys are session-based while model preferences persist

## Technical Details

### Files Modified
- `src/components/ComponentEditor/ComponentEditor.tsx` - sessionStorage for API keys
- `src/utils/projectOperations/autoSave.ts` - Fixed filename display update
- `src/utils/projectOperations/projectOperations.ts` - File System API type fixes
- `src/utils/projectOperations/projectIsolation.ts` - Fixed type imports
- `src/utils/netlist.ts` - Fixed null safety and unused variables
- `src/types/index.ts` - Made `DrawingPoint.id` optional
- `src/App.tsx` - Removed unused imports, added void statements for legacy functions

## Upgrade Notes

- **API Key Re-entry Required**: Since API keys are now stored in sessionStorage, users will need to re-enter their Gemini API key when starting a new browser session
- No breaking changes to project file format
- Existing projects will open normally

## Compatibility

- **Browser**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **Node.js**: 16+
- **Previous Version**: 3.0

---

**Version**: 3.1
